// aframe@1.7.0 downloaded from https://ga.jspm.io/npm:aframe@1.7.0/dist/aframe-master.js

import e from"process";var t=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:global;var n={};var r=e;(function webpackUniversalModuleDefinition(e,t){n=t()})(self,(()=>(()=>{var e={"./node_modules/an-array/index.js":e=>{var t=Object.prototype.toString;e.exports=anArray;function anArray(e){return e.BYTES_PER_ELEMENT&&t.call(e.buffer)==="[object ArrayBuffer]"||Array.isArray(e)}},"./node_modules/as-number/index.js":e=>{e.exports=function numtype(e,t){return typeof e==="number"?e:typeof t==="number"?t:0}},"./node_modules/base64-js/index.js":(e,t)=>{t.byteLength=byteLength;t.toByteArray=toByteArray;t.fromByteArray=fromByteArray;var n=[];var r=[];var s=typeof Uint8Array!=="undefined"?Uint8Array:Array;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var o=0,l=a.length;o<l;++o){n[o]=a[o];r[a.charCodeAt(o)]=o}r["-".charCodeAt(0)]=62;r["_".charCodeAt(0)]=63;function getLens(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function byteLength(e){var t=getLens(e);var n=t[0];var r=t[1];return(n+r)*3/4-r}function _byteLength(e,t,n){return(t+n)*3/4-n}function toByteArray(e){var t;var n=getLens(e);var a=n[0];var o=n[1];var l=new s(_byteLength(e,a,o));var c=0;var u=o>0?a-4:a;var h;for(h=0;h<u;h+=4){t=r[e.charCodeAt(h)]<<18|r[e.charCodeAt(h+1)]<<12|r[e.charCodeAt(h+2)]<<6|r[e.charCodeAt(h+3)];l[c++]=t>>16&255;l[c++]=t>>8&255;l[c++]=t&255}if(o===2){t=r[e.charCodeAt(h)]<<2|r[e.charCodeAt(h+1)]>>4;l[c++]=t&255}if(o===1){t=r[e.charCodeAt(h)]<<10|r[e.charCodeAt(h+1)]<<4|r[e.charCodeAt(h+2)]>>2;l[c++]=t>>8&255;l[c++]=t&255}return l}function tripletToBase64(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function encodeChunk(e,t,n){var r;var s=[];for(var a=t;a<n;a+=3){r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(e[a+2]&255);s.push(tripletToBase64(r))}return s.join("")}function fromByteArray(e){var t;var r=e.length;var s=r%3;var a=[];var o=16383;for(var l=0,c=r-s;l<c;l+=o)a.push(encodeChunk(e,l,l+o>c?c:l+o));if(s===1){t=e[r-1];a.push(n[t>>2]+n[t<<4&63]+"==")}else if(s===2){t=(e[r-2]<<8)+e[r-1];a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")}return a.join("")}},"./node_modules/buffer-equal/index.js":(e,t,n)=>{var r=n("./node_modules/buffer/index.js").Buffer;e.exports=function(e,t){if(r.isBuffer(e)&&r.isBuffer(t)){if(typeof e.equals==="function")return e.equals(t);if(e.length!==t.length)return false;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return false;return true}}},"./node_modules/buffer/index.js":(e,n,r)=>{
/*!
         * The buffer module from node.js, for the browser.
         *
         * @author   Feross Aboukhadijeh <https://feross.org>
         * @license  MIT
         */
const s=r("./node_modules/base64-js/index.js");const a=r("./node_modules/ieee754/index.js");const o=typeof Symbol==="function"&&typeof Symbol.for==="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=Buffer;n.SlowBuffer=SlowBuffer;n.INSPECT_MAX_BYTES=50;const l=2147483647;n.kMaxLength=l;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();Buffer.TYPED_ARRAY_SUPPORT||typeof console==="undefined"||typeof console.error!=="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function typedArraySupport(){try{const e=new Uint8Array(1);const t={foo:function(){return 42}};Object.setPrototypeOf(t,Uint8Array.prototype);Object.setPrototypeOf(e,t);return e.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(Buffer.isBuffer(this||t))return(this||t).buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(Buffer.isBuffer(this||t))return(this||t).byteOffset}});function createBuffer(e){if(e>l)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);Object.setPrototypeOf(t,Buffer.prototype);return t}function Buffer(e,t,n){if(typeof e==="number"){if(typeof t==="string")throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(e)}return from(e,t,n)}Buffer.poolSize=8192;function from(e,t,n){if(typeof e==="string")return fromString(e,t);if(ArrayBuffer.isView(e))return fromArrayView(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer))return fromArrayBuffer(e,t,n);if(typeof SharedArrayBuffer!=="undefined"&&(isInstance(e,SharedArrayBuffer)||e&&isInstance(e.buffer,SharedArrayBuffer)))return fromArrayBuffer(e,t,n);if(typeof e==="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(r!=null&&r!==e)return Buffer.from(r,t,n);const s=fromObject(e);if(s)return s;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]==="function")return Buffer.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}Buffer.from=function(e,t,n){return from(e,t,n)};Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype);Object.setPrototypeOf(Buffer,Uint8Array);function assertSize(e){if(typeof e!=="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function alloc(e,t,n){assertSize(e);return e<=0?createBuffer(e):t!==void 0?typeof n==="string"?createBuffer(e).fill(t,n):createBuffer(e).fill(t):createBuffer(e)}Buffer.alloc=function(e,t,n){return alloc(e,t,n)};function allocUnsafe(e){assertSize(e);return createBuffer(e<0?0:checked(e)|0)}Buffer.allocUnsafe=function(e){return allocUnsafe(e)};Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)};function fromString(e,t){typeof t==="string"&&t!==""||(t="utf8");if(!Buffer.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=byteLength(e,t)|0;let r=createBuffer(n);const s=r.write(e,t);s!==n&&(r=r.slice(0,s));return r}function fromArrayLike(e){const t=e.length<0?0:checked(e.length)|0;const n=createBuffer(t);for(let r=0;r<t;r+=1)n[r]=e[r]&255;return n}function fromArrayView(e){if(isInstance(e,Uint8Array)){const t=new Uint8Array(e);return fromArrayBuffer(t.buffer,t.byteOffset,t.byteLength)}return fromArrayLike(e)}function fromArrayBuffer(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;r=t===void 0&&n===void 0?new Uint8Array(e):n===void 0?new Uint8Array(e,t):new Uint8Array(e,t,n);Object.setPrototypeOf(r,Buffer.prototype);return r}function fromObject(e){if(Buffer.isBuffer(e)){const t=checked(e.length)|0;const n=createBuffer(t);if(n.length===0)return n;e.copy(n,0,0,t);return n}return e.length!==void 0?typeof e.length!=="number"||numberIsNaN(e.length)?createBuffer(0):fromArrayLike(e):e.type==="Buffer"&&Array.isArray(e.data)?fromArrayLike(e.data):void 0}function checked(e){if(e>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return e|0}function SlowBuffer(e){+e!=e&&(e=0);return Buffer.alloc(+e)}Buffer.isBuffer=function isBuffer(e){return e!=null&&e._isBuffer===true&&e!==Buffer.prototype};Buffer.compare=function compare(e,t){isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength));isInstance(t,Uint8Array)&&(t=Buffer.from(t,t.offset,t.byteLength));if(!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length;let r=t.length;for(let s=0,a=Math.min(n,r);s<a;++s)if(e[s]!==t[s]){n=e[s];r=t[s];break}return n<r?-1:r<n?1:0};Buffer.isEncoding=function isEncoding(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return Buffer.alloc(0);let n;if(t===void 0){t=0;for(n=0;n<e.length;++n)t+=e[n].length}const r=Buffer.allocUnsafe(t);let s=0;for(n=0;n<e.length;++n){let t=e[n];if(isInstance(t,Uint8Array))if(s+t.length>r.length){Buffer.isBuffer(t)||(t=Buffer.from(t));t.copy(r,s)}else Uint8Array.prototype.set.call(r,t,s);else{if(!Buffer.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,s)}s+=t.length}return r};function byteLength(e,t){if(Buffer.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer))return e.byteLength;if(typeof e!=="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length;const r=arguments.length>2&&arguments[2]===true;if(!r&&n===0)return 0;let s=false;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return base64ToBytes(e).length;default:if(s)return r?-1:utf8ToBytes(e).length;t=(""+t).toLowerCase();s=true}}Buffer.byteLength=byteLength;function slowToString(e,n,r){let s=false;(n===void 0||n<0)&&(n=0);if(n>(this||t).length)return"";(r===void 0||r>(this||t).length)&&(r=(this||t).length);if(r<=0)return"";r>>>=0;n>>>=0;if(r<=n)return"";e||(e="utf8");while(true)switch(e){case"hex":return hexSlice(this||t,n,r);case"utf8":case"utf-8":return utf8Slice(this||t,n,r);case"ascii":return asciiSlice(this||t,n,r);case"latin1":case"binary":return latin1Slice(this||t,n,r);case"base64":return base64Slice(this||t,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this||t,n,r);default:if(s)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();s=true}}Buffer.prototype._isBuffer=true;function swap(e,t,n){const r=e[t];e[t]=e[n];e[n]=r}Buffer.prototype.swap16=function swap16(){const e=(this||t).length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)swap(this||t,n,n+1);return this||t};Buffer.prototype.swap32=function swap32(){const e=(this||t).length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4){swap(this||t,n,n+3);swap(this||t,n+1,n+2)}return this||t};Buffer.prototype.swap64=function swap64(){const e=(this||t).length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8){swap(this||t,n,n+7);swap(this||t,n+1,n+6);swap(this||t,n+2,n+5);swap(this||t,n+3,n+4)}return this||t};Buffer.prototype.toString=function toString(){const e=(this||t).length;return e===0?"":arguments.length===0?utf8Slice(this||t,0,e):slowToString.apply(this||t,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return(this||t)===e||Buffer.compare(this||t,e)===0};Buffer.prototype.inspect=function inspect(){let e="";const r=n.INSPECT_MAX_BYTES;e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim();(this||t).length>r&&(e+=" ... ");return"<Buffer "+e+">"};o&&(Buffer.prototype[o]=Buffer.prototype.inspect);Buffer.prototype.compare=function compare(e,n,r,s,a){isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength));if(!Buffer.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);n===void 0&&(n=0);r===void 0&&(r=e?e.length:0);s===void 0&&(s=0);a===void 0&&(a=(this||t).length);if(n<0||r>e.length||s<0||a>(this||t).length)throw new RangeError("out of range index");if(s>=a&&n>=r)return 0;if(s>=a)return-1;if(n>=r)return 1;n>>>=0;r>>>=0;s>>>=0;a>>>=0;if((this||t)===e)return 0;let o=a-s;let l=r-n;const c=Math.min(o,l);const u=this.slice(s,a);const h=e.slice(n,r);for(let e=0;e<c;++e)if(u[e]!==h[e]){o=u[e];l=h[e];break}return o<l?-1:l<o?1:0};function bidirectionalIndexOf(e,t,n,r,s){if(e.length===0)return-1;if(typeof n==="string"){r=n;n=0}else n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648);n=+n;numberIsNaN(n)&&(n=s?0:e.length-1);n<0&&(n=e.length+n);if(n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}typeof t==="string"&&(t=Buffer.from(t,r));if(Buffer.isBuffer(t))return t.length===0?-1:arrayIndexOf(e,t,n,r,s);if(typeof t==="number"){t&=255;return typeof Uint8Array.prototype.indexOf==="function"?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):arrayIndexOf(e,[t],n,r,s)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,n,r,s){let a=1;let o=e.length;let l=t.length;if(r!==void 0){r=String(r).toLowerCase();if(r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le"){if(e.length<2||t.length<2)return-1;a=2;o/=2;l/=2;n/=2}}function read(e,t){return a===1?e[t]:e.readUInt16BE(t*a)}let c;if(s){let r=-1;for(c=n;c<o;c++)if(read(e,c)===read(t,r===-1?0:c-r)){r===-1&&(r=c);if(c-r+1===l)return r*a}else{r!==-1&&(c-=c-r);r=-1}}else{n+l>o&&(n=o-l);for(c=n;c>=0;c--){let n=true;for(let r=0;r<l;r++)if(read(e,c+r)!==read(t,r)){n=false;break}if(n)return c}}return-1}Buffer.prototype.includes=function includes(e,t,n){return this.indexOf(e,t,n)!==-1};Buffer.prototype.indexOf=function indexOf(e,n,r){return bidirectionalIndexOf(this||t,e,n,r,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(e,n,r){return bidirectionalIndexOf(this||t,e,n,r,false)};function hexWrite(e,t,n,r){n=Number(n)||0;const s=e.length-n;if(r){r=Number(r);r>s&&(r=s)}else r=s;const a=t.length;r>a/2&&(r=a/2);let o;for(o=0;o<r;++o){const r=parseInt(t.substr(o*2,2),16);if(numberIsNaN(r))return o;e[n+o]=r}return o}function utf8Write(e,t,n,r){return blitBuffer(utf8ToBytes(t,e.length-n),e,n,r)}function asciiWrite(e,t,n,r){return blitBuffer(asciiToBytes(t),e,n,r)}function base64Write(e,t,n,r){return blitBuffer(base64ToBytes(t),e,n,r)}function ucs2Write(e,t,n,r){return blitBuffer(utf16leToBytes(t,e.length-n),e,n,r)}Buffer.prototype.write=function write(e,n,r,s){if(n===void 0){s="utf8";r=(this||t).length;n=0}else if(r===void 0&&typeof n==="string"){s=n;r=(this||t).length;n=0}else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n>>>=0;if(isFinite(r)){r>>>=0;s===void 0&&(s="utf8")}else{s=r;r=void 0}}const a=(this||t).length-n;(r===void 0||r>a)&&(r=a);if(e.length>0&&(r<0||n<0)||n>(this||t).length)throw new RangeError("Attempt to write outside buffer bounds");s||(s="utf8");let o=false;for(;;)switch(s){case"hex":return hexWrite(this||t,e,n,r);case"utf8":case"utf-8":return utf8Write(this||t,e,n,r);case"ascii":case"latin1":case"binary":return asciiWrite(this||t,e,n,r);case"base64":return base64Write(this||t,e,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this||t,e,n,r);default:if(o)throw new TypeError("Unknown encoding: "+s);s=(""+s).toLowerCase();o=true}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call((this||t)._arr||this||t,0)}};function base64Slice(e,t,n){return t===0&&n===e.length?s.fromByteArray(e):s.fromByteArray(e.slice(t,n))}function utf8Slice(e,t,n){n=Math.min(e.length,n);const r=[];let s=t;while(s<n){const t=e[s];let a=null;let o=t>239?4:t>223?3:t>191?2:1;if(s+o<=n){let n,r,l,c;switch(o){case 1:t<128&&(a=t);break;case 2:n=e[s+1];if((n&192)===128){c=(t&31)<<6|n&63;c>127&&(a=c)}break;case 3:n=e[s+1];r=e[s+2];if((n&192)===128&&(r&192)===128){c=(t&15)<<12|(n&63)<<6|r&63;c>2047&&(c<55296||c>57343)&&(a=c)}break;case 4:n=e[s+1];r=e[s+2];l=e[s+3];if((n&192)===128&&(r&192)===128&&(l&192)===128){c=(t&15)<<18|(n&63)<<12|(r&63)<<6|l&63;c>65535&&c<1114112&&(a=c)}}}if(a===null){a=65533;o=1}else if(a>65535){a-=65536;r.push(a>>>10&1023|55296);a=56320|a&1023}r.push(a);s+=o}return decodeCodePointsArray(r)}const c=4096;function decodeCodePointsArray(e){const t=e.length;if(t<=c)return String.fromCharCode.apply(String,e);let n="";let r=0;while(r<t)n+=String.fromCharCode.apply(String,e.slice(r,r+=c));return n}function asciiSlice(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(e[s]&127);return r}function latin1Slice(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(e[s]);return r}function hexSlice(e,t,n){const r=e.length;(!t||t<0)&&(t=0);(!n||n<0||n>r)&&(n=r);let s="";for(let r=t;r<n;++r)s+=d[e[r]];return s}function utf16leSlice(e,t,n){const r=e.slice(t,n);let s="";for(let e=0;e<r.length-1;e+=2)s+=String.fromCharCode(r[e]+r[e+1]*256);return s}Buffer.prototype.slice=function slice(e,n){const r=(this||t).length;e=~~e;n=n===void 0?r:~~n;if(e<0){e+=r;e<0&&(e=0)}else e>r&&(e=r);if(n<0){n+=r;n<0&&(n=0)}else n>r&&(n=r);n<e&&(n=e);const s=this.subarray(e,n);Object.setPrototypeOf(s,Buffer.prototype);return s};function checkOffset(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUintLE=Buffer.prototype.readUIntLE=function readUIntLE(e,n,r){e>>>=0;n>>>=0;r||checkOffset(e,n,(this||t).length);let s=(this||t)[e];let a=1;let o=0;while(++o<n&&(a*=256))s+=(this||t)[e+o]*a;return s};Buffer.prototype.readUintBE=Buffer.prototype.readUIntBE=function readUIntBE(e,n,r){e>>>=0;n>>>=0;r||checkOffset(e,n,(this||t).length);let s=(this||t)[e+--n];let a=1;while(n>0&&(a*=256))s+=(this||t)[e+--n]*a;return s};Buffer.prototype.readUint8=Buffer.prototype.readUInt8=function readUInt8(e,n){e>>>=0;n||checkOffset(e,1,(this||t).length);return(this||t)[e]};Buffer.prototype.readUint16LE=Buffer.prototype.readUInt16LE=function readUInt16LE(e,n){e>>>=0;n||checkOffset(e,2,(this||t).length);return(this||t)[e]|(this||t)[e+1]<<8};Buffer.prototype.readUint16BE=Buffer.prototype.readUInt16BE=function readUInt16BE(e,n){e>>>=0;n||checkOffset(e,2,(this||t).length);return(this||t)[e]<<8|(this||t)[e+1]};Buffer.prototype.readUint32LE=Buffer.prototype.readUInt32LE=function readUInt32LE(e,n){e>>>=0;n||checkOffset(e,4,(this||t).length);return((this||t)[e]|(this||t)[e+1]<<8|(this||t)[e+2]<<16)+(this||t)[e+3]*16777216};Buffer.prototype.readUint32BE=Buffer.prototype.readUInt32BE=function readUInt32BE(e,n){e>>>=0;n||checkOffset(e,4,(this||t).length);return(this||t)[e]*16777216+((this||t)[e+1]<<16|(this||t)[e+2]<<8|(this||t)[e+3])};Buffer.prototype.readBigUInt64LE=defineBigIntMethod((function readBigUInt64LE(e){e>>>=0;validateNumber(e,"offset");const n=(this||t)[e];const r=(this||t)[e+7];n!==void 0&&r!==void 0||boundsError(e,(this||t).length-8);const s=n+(this||t)[++e]*256+(this||t)[++e]*65536+(this||t)[++e]*2**24;const a=(this||t)[++e]+(this||t)[++e]*256+(this||t)[++e]*65536+r*2**24;return BigInt(s)+(BigInt(a)<<BigInt(32))}));Buffer.prototype.readBigUInt64BE=defineBigIntMethod((function readBigUInt64BE(e){e>>>=0;validateNumber(e,"offset");const n=(this||t)[e];const r=(this||t)[e+7];n!==void 0&&r!==void 0||boundsError(e,(this||t).length-8);const s=n*2**24+(this||t)[++e]*65536+(this||t)[++e]*256+(this||t)[++e];const a=(this||t)[++e]*2**24+(this||t)[++e]*65536+(this||t)[++e]*256+r;return(BigInt(s)<<BigInt(32))+BigInt(a)}));Buffer.prototype.readIntLE=function readIntLE(e,n,r){e>>>=0;n>>>=0;r||checkOffset(e,n,(this||t).length);let s=(this||t)[e];let a=1;let o=0;while(++o<n&&(a*=256))s+=(this||t)[e+o]*a;a*=128;s>=a&&(s-=Math.pow(2,8*n));return s};Buffer.prototype.readIntBE=function readIntBE(e,n,r){e>>>=0;n>>>=0;r||checkOffset(e,n,(this||t).length);let s=n;let a=1;let o=(this||t)[e+--s];while(s>0&&(a*=256))o+=(this||t)[e+--s]*a;a*=128;o>=a&&(o-=Math.pow(2,8*n));return o};Buffer.prototype.readInt8=function readInt8(e,n){e>>>=0;n||checkOffset(e,1,(this||t).length);return(this||t)[e]&128?(255-(this||t)[e]+1)*-1:(this||t)[e]};Buffer.prototype.readInt16LE=function readInt16LE(e,n){e>>>=0;n||checkOffset(e,2,(this||t).length);const r=(this||t)[e]|(this||t)[e+1]<<8;return r&32768?r|4294901760:r};Buffer.prototype.readInt16BE=function readInt16BE(e,n){e>>>=0;n||checkOffset(e,2,(this||t).length);const r=(this||t)[e+1]|(this||t)[e]<<8;return r&32768?r|4294901760:r};Buffer.prototype.readInt32LE=function readInt32LE(e,n){e>>>=0;n||checkOffset(e,4,(this||t).length);return(this||t)[e]|(this||t)[e+1]<<8|(this||t)[e+2]<<16|(this||t)[e+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(e,n){e>>>=0;n||checkOffset(e,4,(this||t).length);return(this||t)[e]<<24|(this||t)[e+1]<<16|(this||t)[e+2]<<8|(this||t)[e+3]};Buffer.prototype.readBigInt64LE=defineBigIntMethod((function readBigInt64LE(e){e>>>=0;validateNumber(e,"offset");const n=(this||t)[e];const r=(this||t)[e+7];n!==void 0&&r!==void 0||boundsError(e,(this||t).length-8);const s=(this||t)[e+4]+(this||t)[e+5]*256+(this||t)[e+6]*65536+(r<<24);return(BigInt(s)<<BigInt(32))+BigInt(n+(this||t)[++e]*256+(this||t)[++e]*65536+(this||t)[++e]*2**24)}));Buffer.prototype.readBigInt64BE=defineBigIntMethod((function readBigInt64BE(e){e>>>=0;validateNumber(e,"offset");const n=(this||t)[e];const r=(this||t)[e+7];n!==void 0&&r!==void 0||boundsError(e,(this||t).length-8);const s=(n<<24)+(this||t)[++e]*65536+(this||t)[++e]*256+(this||t)[++e];return(BigInt(s)<<BigInt(32))+BigInt((this||t)[++e]*2**24+(this||t)[++e]*65536+(this||t)[++e]*256+r)}));Buffer.prototype.readFloatLE=function readFloatLE(e,n){e>>>=0;n||checkOffset(e,4,(this||t).length);return a.read(this||t,e,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(e,n){e>>>=0;n||checkOffset(e,4,(this||t).length);return a.read(this||t,e,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(e,n){e>>>=0;n||checkOffset(e,8,(this||t).length);return a.read(this||t,e,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(e,n){e>>>=0;n||checkOffset(e,8,(this||t).length);return a.read(this||t,e,false,52,8)};function checkInt(e,t,n,r,s,a){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUintLE=Buffer.prototype.writeUIntLE=function writeUIntLE(e,n,r,s){e=+e;n>>>=0;r>>>=0;if(!s){const s=Math.pow(2,8*r)-1;checkInt(this||t,e,n,r,s,0)}let a=1;let o=0;(this||t)[n]=e&255;while(++o<r&&(a*=256))(this||t)[n+o]=e/a&255;return n+r};Buffer.prototype.writeUintBE=Buffer.prototype.writeUIntBE=function writeUIntBE(e,n,r,s){e=+e;n>>>=0;r>>>=0;if(!s){const s=Math.pow(2,8*r)-1;checkInt(this||t,e,n,r,s,0)}let a=r-1;let o=1;(this||t)[n+a]=e&255;while(--a>=0&&(o*=256))(this||t)[n+a]=e/o&255;return n+r};Buffer.prototype.writeUint8=Buffer.prototype.writeUInt8=function writeUInt8(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,1,255,0);(this||t)[n]=e&255;return n+1};Buffer.prototype.writeUint16LE=Buffer.prototype.writeUInt16LE=function writeUInt16LE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,2,65535,0);(this||t)[n]=e&255;(this||t)[n+1]=e>>>8;return n+2};Buffer.prototype.writeUint16BE=Buffer.prototype.writeUInt16BE=function writeUInt16BE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,2,65535,0);(this||t)[n]=e>>>8;(this||t)[n+1]=e&255;return n+2};Buffer.prototype.writeUint32LE=Buffer.prototype.writeUInt32LE=function writeUInt32LE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,4,4294967295,0);(this||t)[n+3]=e>>>24;(this||t)[n+2]=e>>>16;(this||t)[n+1]=e>>>8;(this||t)[n]=e&255;return n+4};Buffer.prototype.writeUint32BE=Buffer.prototype.writeUInt32BE=function writeUInt32BE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,4,4294967295,0);(this||t)[n]=e>>>24;(this||t)[n+1]=e>>>16;(this||t)[n+2]=e>>>8;(this||t)[n+3]=e&255;return n+4};function wrtBigUInt64LE(e,t,n,r,s){checkIntBI(t,r,s,e,n,7);let a=Number(t&BigInt(4294967295));e[n++]=a;a>>=8;e[n++]=a;a>>=8;e[n++]=a;a>>=8;e[n++]=a;let o=Number(t>>BigInt(32)&BigInt(4294967295));e[n++]=o;o>>=8;e[n++]=o;o>>=8;e[n++]=o;o>>=8;e[n++]=o;return n}function wrtBigUInt64BE(e,t,n,r,s){checkIntBI(t,r,s,e,n,7);let a=Number(t&BigInt(4294967295));e[n+7]=a;a>>=8;e[n+6]=a;a>>=8;e[n+5]=a;a>>=8;e[n+4]=a;let o=Number(t>>BigInt(32)&BigInt(4294967295));e[n+3]=o;o>>=8;e[n+2]=o;o>>=8;e[n+1]=o;o>>=8;e[n]=o;return n+8}Buffer.prototype.writeBigUInt64LE=defineBigIntMethod((function writeBigUInt64LE(e,n=0){return wrtBigUInt64LE(this||t,e,n,BigInt(0),BigInt("0xffffffffffffffff"))}));Buffer.prototype.writeBigUInt64BE=defineBigIntMethod((function writeBigUInt64BE(e,n=0){return wrtBigUInt64BE(this||t,e,n,BigInt(0),BigInt("0xffffffffffffffff"))}));Buffer.prototype.writeIntLE=function writeIntLE(e,n,r,s){e=+e;n>>>=0;if(!s){const s=Math.pow(2,8*r-1);checkInt(this||t,e,n,r,s-1,-s)}let a=0;let o=1;let l=0;(this||t)[n]=e&255;while(++a<r&&(o*=256)){e<0&&l===0&&(this||t)[n+a-1]!==0&&(l=1);(this||t)[n+a]=(e/o|0)-l&255}return n+r};Buffer.prototype.writeIntBE=function writeIntBE(e,n,r,s){e=+e;n>>>=0;if(!s){const s=Math.pow(2,8*r-1);checkInt(this||t,e,n,r,s-1,-s)}let a=r-1;let o=1;let l=0;(this||t)[n+a]=e&255;while(--a>=0&&(o*=256)){e<0&&l===0&&(this||t)[n+a+1]!==0&&(l=1);(this||t)[n+a]=(e/o|0)-l&255}return n+r};Buffer.prototype.writeInt8=function writeInt8(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,1,127,-128);e<0&&(e=255+e+1);(this||t)[n]=e&255;return n+1};Buffer.prototype.writeInt16LE=function writeInt16LE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,2,32767,-32768);(this||t)[n]=e&255;(this||t)[n+1]=e>>>8;return n+2};Buffer.prototype.writeInt16BE=function writeInt16BE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,2,32767,-32768);(this||t)[n]=e>>>8;(this||t)[n+1]=e&255;return n+2};Buffer.prototype.writeInt32LE=function writeInt32LE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,4,2147483647,-2147483648);(this||t)[n]=e&255;(this||t)[n+1]=e>>>8;(this||t)[n+2]=e>>>16;(this||t)[n+3]=e>>>24;return n+4};Buffer.prototype.writeInt32BE=function writeInt32BE(e,n,r){e=+e;n>>>=0;r||checkInt(this||t,e,n,4,2147483647,-2147483648);e<0&&(e=4294967295+e+1);(this||t)[n]=e>>>24;(this||t)[n+1]=e>>>16;(this||t)[n+2]=e>>>8;(this||t)[n+3]=e&255;return n+4};Buffer.prototype.writeBigInt64LE=defineBigIntMethod((function writeBigInt64LE(e,n=0){return wrtBigUInt64LE(this||t,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}));Buffer.prototype.writeBigInt64BE=defineBigIntMethod((function writeBigInt64BE(e,n=0){return wrtBigUInt64BE(this||t,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}));function checkIEEE754(e,t,n,r,s,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function writeFloat(e,t,n,r,s){t=+t;n>>>=0;s||checkIEEE754(e,t,n,4,34028234663852886e22,-34028234663852886e22);a.write(e,t,n,r,23,4);return n+4}Buffer.prototype.writeFloatLE=function writeFloatLE(e,n,r){return writeFloat(this||t,e,n,true,r)};Buffer.prototype.writeFloatBE=function writeFloatBE(e,n,r){return writeFloat(this||t,e,n,false,r)};function writeDouble(e,t,n,r,s){t=+t;n>>>=0;s||checkIEEE754(e,t,n,8,17976931348623157e292,-17976931348623157e292);a.write(e,t,n,r,52,8);return n+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(e,n,r){return writeDouble(this||t,e,n,true,r)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(e,n,r){return writeDouble(this||t,e,n,false,r)};Buffer.prototype.copy=function copy(e,n,r,s){if(!Buffer.isBuffer(e))throw new TypeError("argument should be a Buffer");r||(r=0);s||s===0||(s=(this||t).length);n>=e.length&&(n=e.length);n||(n=0);s>0&&s<r&&(s=r);if(s===r)return 0;if(e.length===0||(this||t).length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=(this||t).length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("sourceEnd out of bounds");s>(this||t).length&&(s=(this||t).length);e.length-n<s-r&&(s=e.length-n+r);const a=s-r;(this||t)===e&&typeof Uint8Array.prototype.copyWithin==="function"?this.copyWithin(n,r,s):Uint8Array.prototype.set.call(e,this.subarray(r,s),n);return a};Buffer.prototype.fill=function fill(e,n,r,s){if(typeof e==="string"){if(typeof n==="string"){s=n;n=0;r=(this||t).length}else if(typeof r==="string"){s=r;r=(this||t).length}if(s!==void 0&&typeof s!=="string")throw new TypeError("encoding must be a string");if(typeof s==="string"&&!Buffer.isEncoding(s))throw new TypeError("Unknown encoding: "+s);if(e.length===1){const t=e.charCodeAt(0);(s==="utf8"&&t<128||s==="latin1")&&(e=t)}}else typeof e==="number"?e&=255:typeof e==="boolean"&&(e=Number(e));if(n<0||(this||t).length<n||(this||t).length<r)throw new RangeError("Out of range index");if(r<=n)return this||t;n>>>=0;r=r===void 0?(this||t).length:r>>>0;e||(e=0);let a;if(typeof e==="number")for(a=n;a<r;++a)(this||t)[a]=e;else{const o=Buffer.isBuffer(e)?e:Buffer.from(e,s);const l=o.length;if(l===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-n;++a)(this||t)[a+n]=o[a%l]}return this||t};const u={};function E(e,t,n){u[e]=class NodeError extends n{constructor(){super();Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:true,configurable:true});this.name=`${this.name} [${e}]`;this.stack;delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:true,enumerable:true,value:e,writable:true})}toString(){return`${this.name} [${e}]: ${this.message}`}}}E("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError);E("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError);E("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`;let s=n;if(Number.isInteger(n)&&Math.abs(n)>2**32)s=addNumericalSeparator(String(n));else if(typeof n==="bigint"){s=String(n);(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(s=addNumericalSeparator(s));s+="n"}r+=` It must be ${t}. Received ${s}`;return r}),RangeError);function addNumericalSeparator(e){let t="";let n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function checkBounds(e,t,n){validateNumber(t,"offset");e[t]!==void 0&&e[t+n]!==void 0||boundsError(t,e.length-(n+1))}function checkIntBI(e,t,n,r,s,a){if(e>n||e<t){const r=typeof t==="bigint"?"n":"";let s;s=a>3?t===0||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${(a+1)*8}${r}`:`>= -(2${r} ** ${(a+1)*8-1}${r}) and < 2 ** ${(a+1)*8-1}${r}`:`>= ${t}${r} and <= ${n}${r}`;throw new u.ERR_OUT_OF_RANGE("value",s,e)}checkBounds(r,s,a)}function validateNumber(e,t){if(typeof e!=="number")throw new u.ERR_INVALID_ARG_TYPE(t,"number",e)}function boundsError(e,t,n){if(Math.floor(e)!==e){validateNumber(e,n);throw new u.ERR_OUT_OF_RANGE(n||"offset","an integer",e)}if(t<0)throw new u.ERR_BUFFER_OUT_OF_BOUNDS;throw new u.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}const h=/[^+/0-9A-Za-z-_]/g;function base64clean(e){e=e.split("=")[0];e=e.trim().replace(h,"");if(e.length<2)return"";while(e.length%4!==0)e+="=";return e}function utf8ToBytes(e,t){t=t||Infinity;let n;const r=e.length;let s=null;const a=[];for(let o=0;o<r;++o){n=e.charCodeAt(o);if(n>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189);s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&a.push(239,191,189);s=null;if(n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,n&63|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,n&63|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}}return a}function asciiToBytes(e){const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n)&255);return t}function utf16leToBytes(e,t){let n,r,s;const a=[];for(let o=0;o<e.length;++o){if((t-=2)<0)break;n=e.charCodeAt(o);r=n>>8;s=n%256;a.push(s);a.push(r)}return a}function base64ToBytes(e){return s.toByteArray(base64clean(e))}function blitBuffer(e,t,n,r){let s;for(s=0;s<r;++s){if(s+n>=t.length||s>=e.length)break;t[s+n]=e[s]}return s}function isInstance(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function numberIsNaN(e){return e!==e}const d=function(){const e="0123456789abcdef";const t=new Array(256);for(let n=0;n<16;++n){const r=n*16;for(let s=0;s<16;++s)t[r+s]=e[n]+e[s]}return t}();function defineBigIntMethod(e){return typeof BigInt==="undefined"?BufferBigIntNotDefined:e}function BufferBigIntNotDefined(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":e=>{e.exports=function(e){var n=[];n.toString=function toString(){return this.map((function(t){var n="";var r=typeof t[5]!=="undefined";t[4]&&(n+="@supports (".concat(t[4],") {"));t[2]&&(n+="@media ".concat(t[2]," {"));r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {"));n+=e(t);r&&(n+="}");t[2]&&(n+="}");t[4]&&(n+="}");return n})).join("")};n.i=function i(e,r,s,a,o){typeof e==="string"&&(e=[[null,e,void 0]]);var l={};if(s)for(var c=0;c<(this||t).length;c++){var u=(this||t)[c][0];u!=null&&(l[u]=true)}for(var h=0;h<e.length;h++){var d=[].concat(e[h]);if(!s||!l[d[0]]){if(typeof o!=="undefined")if(typeof d[5]==="undefined")d[5]=o;else{d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}");d[5]=o}if(r)if(d[2]){d[1]="@media ".concat(d[2]," {").concat(d[1],"}");d[2]=r}else d[2]=r;if(a)if(d[4]){d[1]="@supports (".concat(d[4],") {").concat(d[1],"}");d[4]=a}else d[4]="".concat(a);n.push(d)}}};return n}},"./node_modules/css-loader/dist/runtime/getUrl.js":e=>{e.exports=function(e,t){t||(t={});if(!e)return e;e=String(e.__esModule?e.default:e);/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1));t.hash&&(e+=t.hash);return/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":e=>{e.exports=function(e){var t=e[1];var n=e[3];if(!n)return t;if(typeof btoa==="function"){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n))));var s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r);var a="/*# ".concat(s," */");return[t].concat([a]).join("\n")}return[t].join("\n")}},"./node_modules/debug/src/browser.js":(e,n,s)=>{n.formatArgs=formatArgs;n.save=save;n.load=load;n.useColors=useColors;n.storage=localstorage();n.destroy=(()=>{let e=false;return()=>{if(!e){e=true;console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}}})();n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function useColors(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return true;if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return false;let e;return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function formatArgs(n){n[0]=((this||t).useColors?"%c":"")+(this||t).namespace+((this||t).useColors?" %c":" ")+n[0]+((this||t).useColors?"%c ":" ")+"+"+e.exports.humanize((this||t).diff);if(!(this||t).useColors)return;const r="color: "+(this||t).color;n.splice(1,0,r,"color: inherit");let s=0;let a=0;n[0].replace(/%[a-zA-Z%]/g,(e=>{if(e!=="%%"){s++;e==="%c"&&(a=s)}}));n.splice(a,0,r)}n.log=console.debug||console.log||(()=>{});
/**
         * Save `namespaces`.
         *
         * @param {String} namespaces
         * @api private
         */function save(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}}function load(){let e;try{e=n.storage.getItem("debug")}catch(e){}!e&&typeof r!=="undefined"&&"env"in r&&(e=r.env.DEBUG);return e}function localstorage(){try{return localStorage}catch(e){}}e.exports=s("./node_modules/debug/src/common.js")(n);const{formatters:a}=e.exports;a.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},"./node_modules/debug/src/common.js":(e,n,r)=>{function setup(e){createDebug.debug=createDebug;createDebug.default=createDebug;createDebug.coerce=coerce;createDebug.disable=disable;createDebug.enable=enable;createDebug.enabled=enabled;createDebug.humanize=r("./node_modules/ms/index.js");createDebug.destroy=destroy;Object.keys(e).forEach((t=>{createDebug[t]=e[t]}));createDebug.names=[];createDebug.skips=[];createDebug.formatters={};
/**
          * Selects a color for a debug namespace
          * @param {String} namespace The namespace string for the debug instance to be colored
          * @return {Number|String} An ANSI color code for the given namespace
          * @api private
          */function selectColor(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n);t|=0}return createDebug.colors[Math.abs(t)%createDebug.colors.length]}createDebug.selectColor=selectColor;
/**
          * Create a debugger with the given `namespace`.
          *
          * @param {String} namespace
          * @return {Function}
          * @api public
          */function createDebug(e){let t;let n=null;let r;let s;function debug(...e){if(!debug.enabled)return;const n=debug;const r=Number(new Date);const s=r-(t||r);n.diff=s;n.prev=t;n.curr=r;t=r;e[0]=createDebug.coerce(e[0]);typeof e[0]!=="string"&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,r)=>{if(t==="%%")return"%";a++;const s=createDebug.formatters[r];if(typeof s==="function"){const r=e[a];t=s.call(n,r);e.splice(a,1);a--}return t}));createDebug.formatArgs.call(n,e);const o=n.log||createDebug.log;o.apply(n,e)}debug.namespace=e;debug.useColors=createDebug.useColors();debug.color=createDebug.selectColor(e);debug.extend=extend;debug.destroy=createDebug.destroy;Object.defineProperty(debug,"enabled",{enumerable:true,configurable:false,get:()=>{if(n!==null)return n;if(r!==createDebug.namespaces){r=createDebug.namespaces;s=createDebug.enabled(e)}return s},set:e=>{n=e}});typeof createDebug.init==="function"&&createDebug.init(debug);return debug}function extend(e,n){const r=createDebug((this||t).namespace+(typeof n==="undefined"?":":n)+e);r.log=(this||t).log;return r}
/**
          * Enables a debug mode by namespaces. This can include modes
          * separated by a colon and wildcards.
          *
          * @param {String} namespaces
          * @api public
          */function enable(e){createDebug.save(e);createDebug.namespaces=e;createDebug.names=[];createDebug.skips=[];let t;const n=(typeof e==="string"?e:"").split(/[\s,]+/);const r=n.length;for(t=0;t<r;t++)if(n[t]){e=n[t].replace(/\*/g,".*?");e[0]==="-"?createDebug.skips.push(new RegExp("^"+e.slice(1)+"$")):createDebug.names.push(new RegExp("^"+e+"$"))}}function disable(){const e=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map((e=>"-"+e))].join(",");createDebug.enable("");return e}
/**
          * Returns true if the given mode name is enabled, false otherwise.
          *
          * @param {String} name
          * @return {Boolean}
          * @api public
          */function enabled(e){if(e[e.length-1]==="*")return true;let t;let n;for(t=0,n=createDebug.skips.length;t<n;t++)if(createDebug.skips[t].test(e))return false;for(t=0,n=createDebug.names.length;t<n;t++)if(createDebug.names[t].test(e))return true;return false}
/**
          * Convert regexp to namespace
          *
          * @param {RegExp} regxep
          * @return {String} namespace
          * @api private
          */function toNamespace(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}
/**
          * Coerce `val`.
          *
          * @param {Mixed} val
          * @return {Mixed}
          * @api private
          */function coerce(e){return e instanceof Error?e.stack||e.message:e}function destroy(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}createDebug.enable(createDebug.load());return createDebug}e.exports=setup},"./node_modules/deep-assign/index.js":(e,t,n)=>{var r=n("./node_modules/is-obj/index.js");var s=Object.prototype.hasOwnProperty;var a=Object.prototype.propertyIsEnumerable;function toObject(e){if(e===null||e===void 0)throw new TypeError("Sources cannot be null or undefined");return Object(e)}function assignKey(e,t,n){var a=t[n];if(a!==void 0&&a!==null){if(s.call(e,n)&&(e[n]===void 0||e[n]===null))throw new TypeError("Cannot convert undefined or null to object ("+n+")");s.call(e,n)&&r(a)?e[n]=assign(Object(e[n]),t[n]):e[n]=a}}function assign(e,t){if(e===t)return e;t=Object(t);for(var n in t)s.call(t,n)&&assignKey(e,t,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(var o=0;o<r.length;o++)a.call(t,r[o])&&assignKey(e,t,r[o])}return e}e.exports=function deepAssign(e){e=toObject(e);for(var t=1;t<arguments.length;t++)assign(e,arguments[t]);return e}},"./node_modules/dtype/index.js":e=>{e.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(e,t,n)=>{var r;r=typeof window!=="undefined"?window:typeof n.g!=="undefined"?n.g:typeof self!=="undefined"?self:{};e.exports=r},"./node_modules/ieee754/index.js":(e,t)=>{t.read=function(e,t,n,r,s){var a,o;var l=s*8-r-1;var c=(1<<l)-1;var u=c>>1;var h=-7;var d=n?s-1:0;var p=n?-1:1;var f=e[t+d];d+=p;a=f&(1<<-h)-1;f>>=-h;h+=l;for(;h>0;a=a*256+e[t+d],d+=p,h-=8);o=a&(1<<-h)-1;a>>=-h;h+=r;for(;h>0;o=o*256+e[t+d],d+=p,h-=8);if(a===0)a=1-u;else{if(a===c)return o?NaN:(f?-1:1)*Infinity;o+=Math.pow(2,r);a-=u}return(f?-1:1)*o*Math.pow(2,a-r)};t.write=function(e,t,n,r,s,a){var o,l,c;var u=a*8-s-1;var h=(1<<u)-1;var d=h>>1;var p=s===23?Math.pow(2,-24)-Math.pow(2,-77):0;var f=r?0:a-1;var m=r?1:-1;var g=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){l=isNaN(t)?1:0;o=h}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(c=Math.pow(2,-o))<1){o--;c*=2}t+=o+d>=1?p/c:p*Math.pow(2,1-d);if(t*c>=2){o++;c/=2}if(o+d>=h){l=0;o=h}else if(o+d>=1){l=(t*c-1)*Math.pow(2,s);o+=d}else{l=t*Math.pow(2,d-1)*Math.pow(2,s);o=0}}for(;s>=8;e[n+f]=l&255,f+=m,l/=256,s-=8);o=o<<s|l;u+=s;for(;u>0;e[n+f]=o&255,f+=m,o/=256,u-=8);e[n+f-m]|=g*128}},"./node_modules/is-buffer/index.js":e=>{
/*!
         * Determine if an object is a Buffer
         *
         * @author   Feross Aboukhadijeh <https://feross.org>
         * @license  MIT
         */
e.exports=function(e){return e!=null&&(isBuffer(e)||isSlowBuffer(e)||!!e._isBuffer)};function isBuffer(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&isBuffer(e.slice(0,0))}},"./node_modules/is-function/index.js":e=>{e.exports=isFunction;var t=Object.prototype.toString;function isFunction(e){if(!e)return false;var n=t.call(e);return n==="[object Function]"||typeof e==="function"&&n!=="[object RegExp]"||typeof window!=="undefined"&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}},"./node_modules/is-obj/index.js":e=>{e.exports=function(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}},"./node_modules/layout-bmfont-text/index.js":(e,n,r)=>{var s=r("./node_modules/word-wrapper/index.js");var a=r("./node_modules/xtend/immutable.js");var o=r("./node_modules/as-number/index.js");var l=["x","e","a","o","n","s","r","c","u","m","v","w","z"];var c=["m","w"];var u=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"];var h="\t".charCodeAt(0);var d=" ".charCodeAt(0);var p=0,f=1,m=2;e.exports=function createLayout(e){return new TextLayout(e)};function TextLayout(e){(this||t).glyphs=[];(this||t)._measure=(this||t).computeMetrics.bind(this||t);this.update(e)}TextLayout.prototype.update=function(e){e=a({measure:(this||t)._measure},e);(this||t)._opt=e;(this||t)._opt.tabSize=o((this||t)._opt.tabSize,4);if(!e.font)throw new Error("must provide a valid bitmap font");var n=(this||t).glyphs;var r=e.text||"";var l=e.font;this._setupSpaceGlyphs(l);var c=s.lines(r,e);var u=e.width||0;n.length=0;var h=c.reduce((function(e,t){return Math.max(e,t.width,u)}),0);var d=0;var p=0;var g=o(e.lineHeight,l.common.lineHeight);var y=l.common.base;var b=g-y;var x=e.letterSpacing||0;var _=g*c.length-b;var M=getAlignType((this||t)._opt.align);p-=_;(this||t)._width=h;(this||t)._height=_;(this||t)._descender=g-y;(this||t)._baseline=y;(this||t)._xHeight=getXHeight(l);(this||t)._capHeight=getCapHeight(l);(this||t)._lineHeight=g;(this||t)._ascender=g-b-(this||t)._xHeight;var w=this||t;c.forEach((function(e,t){var s=e.start;var a=e.end;var o=e.width;var c;for(var u=s;u<a;u++){var y=r.charCodeAt(u);var b=w.getGlyph(l,y);if(b){c&&(d+=getKerning(l,c.id,b.id));var _=d;M===f?_+=(h-o)/2:M===m&&(_+=h-o);n.push({position:[_,p],data:b,index:u,line:t});d+=b.xadvance+x;c=b}}p+=g;d=0}));(this||t)._linesTotal=c.length};TextLayout.prototype._setupSpaceGlyphs=function(e){(this||t)._fallbackSpaceGlyph=null;(this||t)._fallbackTabGlyph=null;if(e.chars&&e.chars.length!==0){var n=getGlyphById(e,d)||getMGlyph(e)||e.chars[0];var r=(this||t)._opt.tabSize*n.xadvance;(this||t)._fallbackSpaceGlyph=n;(this||t)._fallbackTabGlyph=a(n,{x:0,y:0,xadvance:r,id:h,xoffset:0,yoffset:0,width:0,height:0})}};TextLayout.prototype.getGlyph=function(e,n){var r=getGlyphById(e,n);return r||(n===h?(this||t)._fallbackTabGlyph:n===d?(this||t)._fallbackSpaceGlyph:null)};TextLayout.prototype.computeMetrics=function(e,n,r,s){var a=(this||t)._opt.letterSpacing||0;var o=(this||t)._opt.font;var l=0;var c=0;var u=0;var h;if(!o.chars||o.chars.length===0)return{start:n,end:n,width:0};r=Math.min(e.length,r);for(var d=n;d<r;d++){var p=e.charCodeAt(d);var f=this.getGlyph(o,p);if(f){f.xoffset;var m=h?getKerning(o,h.id,f.id):0;l+=m;var g=l+f.xadvance+a;var y=l+f.width;if(y>=s||g>=s)break;l=g;c=y;h=f}u++}h&&(c+=h.xoffset);return{start:n,end:n+u,width:c}};["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(addGetter);function addGetter(e){Object.defineProperty(TextLayout.prototype,e,{get:wrapper(e),configurable:true})}function wrapper(e){return new Function(["return function "+e+"() {","  return this._"+e,"}"].join("\n"))()}function getGlyphById(e,t){if(!e.chars||e.chars.length===0)return null;var n=findChar(e.chars,t);return n>=0?e.chars[n]:null}function getXHeight(e){for(var t=0;t<l.length;t++){var n=l[t].charCodeAt(0);var r=findChar(e.chars,n);if(r>=0)return e.chars[r].height}return 0}function getMGlyph(e){for(var t=0;t<c.length;t++){var n=c[t].charCodeAt(0);var r=findChar(e.chars,n);if(r>=0)return e.chars[r]}return 0}function getCapHeight(e){for(var t=0;t<u.length;t++){var n=u[t].charCodeAt(0);var r=findChar(e.chars,n);if(r>=0)return e.chars[r].height}return 0}function getKerning(e,t,n){if(!e.kernings||e.kernings.length===0)return 0;var r=e.kernings;for(var s=0;s<r.length;s++){var a=r[s];if(a.first===t&&a.second===n)return a.amount}return 0}function getAlignType(e){return e==="center"?f:e==="right"?m:p}function findChar(e,t,n){n=n||0;for(var r=n;r<e.length;r++)if(e[r].id===t)return r;return-1}},"./node_modules/load-bmfont/browser.js":(e,t,n)=>{var r=n("./node_modules/buffer/index.js").Buffer;var s=n("./node_modules/xhr/index.js");var noop=function(){};var a=n("./node_modules/parse-bmfont-ascii/index.js");var o=n("./node_modules/parse-bmfont-xml/lib/browser.js");var l=n("./node_modules/parse-bmfont-binary/index.js");var c=n("./node_modules/load-bmfont/lib/is-binary.js");var u=n("./node_modules/xtend/immutable.js");var h=function hasXML2(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();e.exports=function(e,t){t=typeof t==="function"?t:noop;typeof e==="string"?e={uri:e}:e||(e={});var n=e.binary;n&&(e=getBinaryOpts(e));s(e,(function(n,s,u){if(n)return t(n);if(!/^2/.test(s.statusCode))return t(new Error("http status code: "+s.statusCode));if(!u)return t(new Error("no body result"));var h=false;if(isArrayBuffer(u)){var d=new Uint8Array(u);u=r.from(d,"binary")}if(c(u)){h=true;typeof u==="string"&&(u=r.from(u,"binary"))}if(!h){r.isBuffer(u)&&(u=u.toString(e.encoding));u=u.trim()}var p;try{var f=s.headers["content-type"];p=h?l(u):/json/.test(f)||u.charAt(0)==="{"?JSON.parse(u):/xml/.test(f)||u.charAt(0)==="<"?o(u):a(u)}catch(e){t(new Error("error parsing font "+e.message));t=noop}t(null,p)}))};function isArrayBuffer(e){var t=Object.prototype.toString;return t.call(e)==="[object ArrayBuffer]"}function getBinaryOpts(e){if(h)return u(e,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest==="undefined")throw new Error("your browser does not support XHR loading");var t=new self.XMLHttpRequest;t.overrideMimeType("text/plain; charset=x-user-defined");return u({xhr:t},e)}},"./node_modules/load-bmfont/lib/is-binary.js":(e,t,n)=>{var r=n("./node_modules/buffer/index.js").Buffer;var s=n("./node_modules/buffer-equal/index.js");var a=r.from([66,77,70,3]);e.exports=function(e){return typeof e==="string"?e.substring(0,3)==="BMF":e.length>4&&s(e.slice(0,4),a)}},"./node_modules/ms/index.js":e=>{var t=1e3;var n=t*60;var r=n*60;var s=r*24;var a=s*7;var o=s*365.25;
/**
         * Parse or format the given `val`.
         *
         * Options:
         *
         *  - `long` verbose formatting [false]
         *
         * @param {String|Number} val
         * @param {Object} [options]
         * @throws {Error} throw an error if val is not a non-empty string or a number
         * @return {String|Number}
         * @api public
         */e.exports=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return parse(e);if(n==="number"&&isFinite(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};
/**
         * Parse the given `str` and return milliseconds.
         *
         * @param {String} str
         * @return {Number}
         * @api private
         */function parse(e){e=String(e);if(!(e.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(l){var c=parseFloat(l[1]);var u=(l[2]||"ms").toLowerCase();switch(u){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*s;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}
/**
         * Short format for `ms`.
         *
         * @param {Number} ms
         * @return {String}
         * @api private
         */function fmtShort(e){var a=Math.abs(e);return a>=s?Math.round(e/s)+"d":a>=r?Math.round(e/r)+"h":a>=n?Math.round(e/n)+"m":a>=t?Math.round(e/t)+"s":e+"ms"}
/**
         * Long format for `ms`.
         *
         * @param {Number} ms
         * @return {String}
         * @api private
         */function fmtLong(e){var a=Math.abs(e);return a>=s?plural(e,a,s,"day"):a>=r?plural(e,a,r,"hour"):a>=n?plural(e,a,n,"minute"):a>=t?plural(e,a,t,"second"):e+" ms"}function plural(e,t,n,r){var s=t>=n*1.5;return Math.round(e/n)+" "+r+(s?"s":"")}},"./node_modules/parse-bmfont-ascii/index.js":e=>{e.exports=function parseBMFontAscii(e){if(!e)throw new Error("no data provided");e=e.toString().trim();var t={pages:[],chars:[],kernings:[]};var n=e.split(/\r\n?|\n/g);if(n.length===0)throw new Error("no data in BMFont file");for(var r=0;r<n.length;r++){var s=splitLine(n[r],r);if(s)if(s.key==="page"){if(typeof s.data.id!=="number")throw new Error("malformed file at line "+r+" -- needs page id=N");if(typeof s.data.file!=="string")throw new Error("malformed file at line "+r+' -- needs page file="path"');t.pages[s.data.id]=s.data.file}else s.key==="chars"||s.key==="kernings"||(s.key==="char"?t.chars.push(s.data):s.key==="kerning"?t.kernings.push(s.data):t[s.key]=s.data)}return t};function splitLine(e,t){e=e.replace(/\t+/g," ").trim();if(!e)return null;var n=e.indexOf(" ");if(n===-1)throw new Error("no named row at line "+t);var r=e.substring(0,n);e=e.substring(n+1);e=e.replace(/letter=[\'\"]\S+[\'\"]/gi,"");e=e.split("=");e=e.map((function(e){return e.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}));var s=[];for(var a=0;a<e.length;a++){var o=e[a];if(a===0)s.push({key:o[0],data:""});else if(a===e.length-1)s[s.length-1].data=parseData(o[0]);else{s[s.length-1].data=parseData(o[0]);s.push({key:o[1],data:""})}}var l={key:r,data:{}};s.forEach((function(e){l.data[e.key]=e.data}));return l}function parseData(e){return e&&e.length!==0?e.indexOf('"')===0||e.indexOf("'")===0?e.substring(1,e.length-1):e.indexOf(",")!==-1?parseIntList(e):parseInt(e,10):""}function parseIntList(e){return e.split(",").map((function(e){return parseInt(e,10)}))}},"./node_modules/parse-bmfont-binary/index.js":e=>{var t=[66,77,70];e.exports=function readBMFontBinary(e){if(e.length<6)throw new Error("invalid buffer length for BMFont");var n=t.every((function(t,n){return e.readUInt8(n)===t}));if(!n)throw new Error("BMFont missing BMF byte header");var r=3;var s=e.readUInt8(r++);if(s>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");var a={kernings:[],chars:[]};for(var o=0;o<5;o++)r+=readBlock(a,e,r);return a};function readBlock(e,t,n){if(n>t.length-1)return 0;var r=t.readUInt8(n++);var s=t.readInt32LE(n);n+=4;switch(r){case 1:e.info=readInfo(t,n);break;case 2:e.common=readCommon(t,n);break;case 3:e.pages=readPages(t,n,s);break;case 4:e.chars=readChars(t,n,s);break;case 5:e.kernings=readKernings(t,n,s);break}return 5+s}function readInfo(e,t){var n={};n.size=e.readInt16LE(t);var r=e.readUInt8(t+2);n.smooth=r>>7&1;n.unicode=r>>6&1;n.italic=r>>5&1;n.bold=r>>4&1;r>>3&1&&(n.fixedHeight=1);n.charset=e.readUInt8(t+3)||"";n.stretchH=e.readUInt16LE(t+4);n.aa=e.readUInt8(t+6);n.padding=[e.readInt8(t+7),e.readInt8(t+8),e.readInt8(t+9),e.readInt8(t+10)];n.spacing=[e.readInt8(t+11),e.readInt8(t+12)];n.outline=e.readUInt8(t+13);n.face=readStringNT(e,t+14);return n}function readCommon(e,t){var n={};n.lineHeight=e.readUInt16LE(t);n.base=e.readUInt16LE(t+2);n.scaleW=e.readUInt16LE(t+4);n.scaleH=e.readUInt16LE(t+6);n.pages=e.readUInt16LE(t+8);e.readUInt8(t+10);n.packed=0;n.alphaChnl=e.readUInt8(t+11);n.redChnl=e.readUInt8(t+12);n.greenChnl=e.readUInt8(t+13);n.blueChnl=e.readUInt8(t+14);return n}function readPages(e,t,n){var r=[];var s=readNameNT(e,t);var a=s.length+1;var o=n/a;for(var l=0;l<o;l++){r[l]=e.slice(t,t+s.length).toString("utf8");t+=a}return r}function readChars(e,t,n){var r=[];var s=n/20;for(var a=0;a<s;a++){var o={};var l=a*20;o.id=e.readUInt32LE(t+0+l);o.x=e.readUInt16LE(t+4+l);o.y=e.readUInt16LE(t+6+l);o.width=e.readUInt16LE(t+8+l);o.height=e.readUInt16LE(t+10+l);o.xoffset=e.readInt16LE(t+12+l);o.yoffset=e.readInt16LE(t+14+l);o.xadvance=e.readInt16LE(t+16+l);o.page=e.readUInt8(t+18+l);o.chnl=e.readUInt8(t+19+l);r[a]=o}return r}function readKernings(e,t,n){var r=[];var s=n/10;for(var a=0;a<s;a++){var o={};var l=a*10;o.first=e.readUInt32LE(t+0+l);o.second=e.readUInt32LE(t+4+l);o.amount=e.readInt16LE(t+8+l);r[a]=o}return r}function readNameNT(e,t){var n=t;for(;n<e.length;n++)if(e[n]===0)break;return e.slice(t,n)}function readStringNT(e,t){return readNameNT(e,t).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(e,t,n)=>{var r=n("./node_modules/parse-bmfont-xml/lib/parse-attribs.js");var s=n("./node_modules/xml-parse-from-string/index.js");var a={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};e.exports=function parse(e){e=e.toString();var t=s(e);var n={pages:[],chars:[],kernings:[]};["info","common"].forEach((function(e){var s=t.getElementsByTagName(e)[0];s&&(n[e]=r(getAttribs(s)))}));var a=t.getElementsByTagName("pages")[0];if(!a)throw new Error("malformed file -- no <pages> element");var o=a.getElementsByTagName("page");for(var l=0;l<o.length;l++){var c=o[l];var u=parseInt(c.getAttribute("id"),10);var h=c.getAttribute("file");if(isNaN(u))throw new Error('malformed file -- page "id" attribute is NaN');if(!h)throw new Error('malformed file -- needs page "file" attribute');n.pages[parseInt(u,10)]=h}["chars","kernings"].forEach((function(e){var s=t.getElementsByTagName(e)[0];if(s){var a=e.substring(0,e.length-1);var o=s.getElementsByTagName(a);for(var l=0;l<o.length;l++){var c=o[l];n[e].push(r(getAttribs(c)))}}}));return n};function getAttribs(e){var t=getAttribList(e);return t.reduce((function(e,t){var n=mapName(t.nodeName);e[n]=t.nodeValue;return e}),{})}function getAttribList(e){var t=[];for(var n=0;n<e.attributes.length;n++)t.push(e.attributes[n]);return t}function mapName(e){return a[e.toLowerCase()]||e}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":e=>{var t="chasrset";e.exports=function parseAttributes(e){e=Object.assign({},e);if(t in e){e.charset=e[t];delete e[t]}for(var n in e)n!=="face"&&n!=="charset"&&(e[n]=n==="padding"||n==="spacing"?parseIntList(e[n]):parseInt(e[n],10));return e};function parseIntList(e){return e.split(",").map((function(e){return parseInt(e,10)}))}},"./node_modules/parse-headers/parse-headers.js":e=>{var trim=function(e){return e.replace(/^\s+|\s+$/g,"")},isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"};e.exports=function(e){if(!e)return{};var t={};var n=trim(e).split("\n");for(var r=0;r<n.length;r++){var s=n[r];var a=s.indexOf(":"),o=trim(s.slice(0,a)).toLowerCase(),l=trim(s.slice(a+1));typeof t[o]==="undefined"?t[o]=l:isArray(t[o])?t[o].push(l):t[o]=[t[o],l]}return t}},"./node_modules/quad-indices/index.js":(e,t,n)=>{var r=n("./node_modules/dtype/index.js");var s=n("./node_modules/an-array/index.js");var a=n("./node_modules/is-buffer/index.js");var o=[0,2,3];var l=[2,1,3];e.exports=function createQuadElements(e,t){if(!e||!(s(e)||a(e))){t=e||{};e=null}t=typeof t==="number"?{count:t}:t||{};var n=typeof t.type==="string"?t.type:"uint16";var c=typeof t.count==="number"?t.count:1;var u=t.start||0;var h=t.clockwise!==false?o:l,d=h[0],p=h[1],f=h[2];var m=c*6;var g=e||new(r(n))(m);for(var y=0,b=0;y<m;y+=6,b+=4){var x=y+u;g[x+0]=b+0;g[x+1]=b+1;g[x+2]=b+2;g[x+3]=b+d;g[x+4]=b+p;g[x+5]=b+f}return g}},"./node_modules/super-animejs/lib/anime.es.js":(e,t,n)=>{n.r(t);n.d(t,{default:()=>k});var r={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:true,timelineOffset:0};var s={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0};var a=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"];var o={CSS:{},springs:{}};function minMax(e,t,n){return Math.min(Math.max(e,t),n)}function stringContains(e,t){return e.indexOf(t)>-1}function applyArguments(e,t){return e.apply(null,t)}var l=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;var c=/^rgb/;var u=/^hsl/;var h={arr:function(e){return Array.isArray(e)},obj:function(e){return stringContains(Object.prototype.toString.call(e),"Object")},pth:function(e){return h.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||h.svg(e)},str:function(e){return typeof e==="string"},fnc:function(e){return typeof e==="function"},und:function(e){return typeof e==="undefined"},hex:function(e){return l.test(e)},rgb:function(e){return c.test(e)},hsl:function(e){return u.test(e)},col:function(e){return h.hex(e)||h.rgb(e)||h.hsl(e)},key:function(e){return!r.hasOwnProperty(e)&&!s.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};var d=/\(([^)]+)\)/;function parseEasingParameters(e){var t=d.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function spring(e,t){var n=parseEasingParameters(e);var r=minMax(h.und(n[0])?1:n[0],.1,100);var s=minMax(h.und(n[1])?100:n[1],.1,100);var a=minMax(h.und(n[2])?10:n[2],.1,100);var l=minMax(h.und(n[3])?0:n[3],.1,100);var c=Math.sqrt(s/r);var u=a/(2*Math.sqrt(s*r));var d=u<1?c*Math.sqrt(1-u*u):0;var p=1;var f=u<1?(u*c-l)/d:-l+c;function solver(e){var n=t?t*e/1e3:e;n=u<1?Math.exp(-n*u*c)*(p*Math.cos(d*n)+f*Math.sin(d*n)):(p+f*n)*Math.exp(-n*c);return e===0||e===1?e:1-n}function getDuration(){var t=o.springs[e];if(t)return t;var n=1/6;var r=0;var s=0;while(true){r+=n;if(solver(r)===1){s++;if(s>=16)break}else s=0}var a=r*n*1e3;o.springs[e]=a;return a}return t?solver:getDuration}function elastic(e,t){e===void 0&&(e=1);t===void 0&&(t=.5);var n=minMax(e,1,10);var r=minMax(t,.1,2);return function(e){return e===0||e===1?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-r/(Math.PI*2)*Math.asin(1/n))*(Math.PI*2)/r)}}function steps(e){e===void 0&&(e=10);return function(t){return Math.round(t*e)*(1/e)}}var p=function(){var e=11;var t=1/(e-1);function A(e,t){return 1-3*t+3*e}function B(e,t){return 3*t-6*e}function C(e){return 3*e}function calcBezier(e,t,n){return((A(t,n)*e+B(t,n))*e+C(t))*e}function getSlope(e,t,n){return 3*A(t,n)*e*e+2*B(t,n)*e+C(t)}function binarySubdivide(e,t,n,r,s){var a,o,l=0;do{o=t+(n-t)/2;a=calcBezier(o,r,s)-e;a>0?n=o:t=o}while(Math.abs(a)>1e-7&&++l<10);return o}function newtonRaphsonIterate(e,t,n,r){for(var s=0;s<4;++s){var a=getSlope(t,n,r);if(a===0)return t;var o=calcBezier(t,n,r)-e;t-=o/a}return t}function bezier(n,r,s,a){if(0<=n&&n<=1&&0<=s&&s<=1){var o=new Float32Array(e);if(n!==r||s!==a)for(var l=0;l<e;++l)o[l]=calcBezier(l*t,n,s);return function(e){return n===r&&s===a||e===0||e===1?e:calcBezier(getTForX(e),r,a)}}function getTForX(r){var a=0;var l=1;var c=e-1;for(;l!==c&&o[l]<=r;++l)a+=t;--l;var u=(r-o[l])/(o[l+1]-o[l]);var h=a+u*t;var d=getSlope(h,n,s);return d>=.001?newtonRaphsonIterate(r,h,n,s):d===0?h:binarySubdivide(r,a,a+t,n,s)}}return bezier}();var f=function(){var e=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"];var t={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],elastic],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(e,t){return function(n){return 1-elastic(e,t)(1-n)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(e,t){return function(n){return n<.5?elastic(e,t)(n*2)/2:1-elastic(e,t)(n*-2+2)/2}}]};var n={linear:[.25,.25,.75,.75]};for(var r in t)for(var s=0,a=t[r].length;s<a;s++)n["ease"+r+e[s]]=t[r][s];return n}();function parseEasings(e,t){if(h.fnc(e))return e;var n=e.split("(")[0];var r=f[n];var s=parseEasingParameters(e);switch(n){case"spring":return spring(e,t);case"cubicBezier":return applyArguments(p,s);case"steps":return applyArguments(steps,s);default:return h.fnc(r)?applyArguments(r,s):applyArguments(p,r)}}function selectString(e){try{var t=document.querySelectorAll(e);return t}catch(e){return}}var m=[];function filterArray(e,t){var n=m;var r=e.length;var s=arguments.length>=2?arguments[1]:void 0;for(var a=0;a<r;a++)if(a in e){var o=e[a];t.call(s,o,a,e)&&n.push(o)}m=e;m.length=0;return n}function flattenArray(e,t){t||(t=[]);for(var n=0,r=e.length;n<r;n++){var s=e[n];Array.isArray(s)?flattenArray(s,t):t.push(s)}return t}function toArray(e){if(h.arr(e))return e;h.str(e)&&(e=selectString(e)||e);return e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e]}function arrayContains(e,t){return e.some((function(e){return e===t}))}function cloneObject(e){var t={};for(var n in e)t[n]=e[n];return t}function replaceObjectProps(e,t){var n=cloneObject(e);for(var r in e)n[r]=t.hasOwnProperty(r)?t[r]:e[r];return n}function mergeObjects(e,t){var n=cloneObject(e);for(var r in t)n[r]=h.und(e[r])?t[r]:e[r];return n}var g=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function rgbToRgba(e){var t=g.exec(e);return t?"rgba("+t[1]+",1)":e}var y=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function hexToRgba(e){var t=e.replace(y,(function(e,t,n,r){return t+t+n+n+r+r}));var n=b.exec(t);var r=parseInt(n[1],16);var s=parseInt(n[2],16);var a=parseInt(n[3],16);return"rgba("+r+","+s+","+a+",1)"}var x=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g;var _=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function hslToRgba(e){var t=x.exec(e)||_.exec(e);var n=parseInt(t[1],10)/360;var r=parseInt(t[2],10)/100;var s=parseInt(t[3],10)/100;var a=t[4]||1;function hue2rgb(e,t,n){n<0&&(n+=1);n>1&&(n-=1);return n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var o,l,c;if(r==0)o=l=c=s;else{var u=s<.5?s*(1+r):s+r-s*r;var h=2*s-u;o=hue2rgb(h,u,n+1/3);l=hue2rgb(h,u,n);c=hue2rgb(h,u,n-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+a+")"}function colorToRgb(e){return h.rgb(e)?rgbToRgba(e):h.hex(e)?hexToRgba(e):h.hsl(e)?hslToRgba(e):void 0}var M=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function getUnit(e){var t=M.exec(e);if(t)return t[2]}function getTransformUnit(e){return stringContains(e,"translate")||e==="perspective"?"px":stringContains(e,"rotate")||stringContains(e,"skew")?"deg":void 0}function getFunctionValue(e,t){return h.fnc(e)?e(t.target,t.id,t.total):e}function getAttribute(e,t){return e.getAttribute(t)}function convertPxToUnit(e,t,n){var r=getUnit(t);if(arrayContains([n,"deg","rad","turn"],r))return t;var s=o.CSS[t+n];if(!h.und(s))return s;var a=100;var l=document.createElement(e.tagName);var c=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;c.appendChild(l);l.style.position="absolute";l.style.width=a+n;var u=a/l.offsetWidth;c.removeChild(l);var d=u*parseFloat(t);o.CSS[t+n]=d;return d}function getCSSValue(e,t,n){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();var s=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return n?convertPxToUnit(e,s,n):s}}function getAnimationType(e,t){return h.dom(e)&&!h.inp(e)&&(getAttribute(e,t)||h.svg(e)&&e[t])?"attribute":h.dom(e)&&arrayContains(a,t)?"transform":h.dom(e)&&t!=="transform"&&getCSSValue(e,t)?"css":e[t]!=null?"object":void 0}var w=/(\w+)\(([^)]*)\)/g;function getElementTransforms(e){if(h.dom(e)){var t=e.style.transform||"";var n=new Map;var r;while(r=w.exec(t))n.set(r[1],r[2]);return n}}function getTransformValue(e,t,n,r){var s=stringContains(t,"scale")?1:0+getTransformUnit(t);var a=getElementTransforms(e).get(t)||s;if(n){n.transforms.list.set(t,a);n.transforms.last=t}return r?convertPxToUnit(e,a,r):a}function getOriginalTargetValue(e,t,n,r){switch(getAnimationType(e,t)){case"transform":return getTransformValue(e,t,r,n);case"css":return getCSSValue(e,t,n);case"attribute":return getAttribute(e,t);default:return e[t]||0}}var S=/^(\*=|\+=|-=)/;function getRelativeValue(e,t){var n=S.exec(e);if(!n)return e;var r=getUnit(e)||0;var s=parseFloat(t);var a=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return s+a+r;case"-":return s-a+r;case"*":return s*a+r}}var T=/\s/g;function validateValue(e,t){if(h.col(e))return colorToRgb(e);var n=getUnit(e);var r=n?e.substr(0,e.length-n.length):e;return t&&!T.test(e)?r+t:r}function getDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function getCircleLength(e){return Math.PI*2*getAttribute(e,"r")}function getRectLength(e){return getAttribute(e,"width")*2+getAttribute(e,"height")*2}function getLineLength(e){return getDistance({x:getAttribute(e,"x1"),y:getAttribute(e,"y1")},{x:getAttribute(e,"x2"),y:getAttribute(e,"y2")})}function getPolylineLength(e){var t=e.points;var n=0;var r;for(var s=0;s<t.numberOfItems;s++){var a=t.getItem(s);s>0&&(n+=getDistance(r,a));r=a}return n}function getPolygonLength(e){var t=e.points;return getPolylineLength(e)+getDistance(t.getItem(t.numberOfItems-1),t.getItem(0))}function getTotalLength(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return getCircleLength(e);case"rect":return getRectLength(e);case"line":return getLineLength(e);case"polyline":return getPolylineLength(e);case"polygon":return getPolygonLength(e)}}function setDashoffset(e){var t=getTotalLength(e);e.setAttribute("stroke-dasharray",t);return t}function getParentSvgEl(e){var t=e.parentNode;while(h.svg(t)){t=t.parentNode;if(!h.svg(t.parentNode))break}return t}function getParentSvg(e,t){var n=t||{};var r=n.el||getParentSvgEl(e);var s=r.getBoundingClientRect();var a=getAttribute(r,"viewBox");var o=s.width;var l=s.height;var c=n.viewBox||(a?a.split(" "):[0,0,o,l]);return{el:r,viewBox:c,x:c[0]/1,y:c[1]/1,w:o/c[2],h:l/c[3]}}function getPath(e,t){var n=h.str(e)?selectString(e)[0]:e;var r=t||100;return function(e){return{property:e,el:n,svg:getParentSvg(n),totalLength:getTotalLength(n)*(r/100)}}}function getPathProgress(e,t){function point(n){n===void 0&&(n=0);var r=t+n>=1?t+n:0;return e.el.getPointAtLength(r)}var n=getParentSvg(e.el,e.svg);var r=point();var s=point(-1);var a=point(1);switch(e.property){case"x":return(r.x-n.x)*n.w;case"y":return(r.y-n.y)*n.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}var I=/-?\d*\.?\d+/g;function decomposeValue(e,t){var n=validateValue(h.pth(e)?e.totalLength:e,t)+"";return{original:n,numbers:n.match(I)?n.match(I).map(Number):[0],strings:h.str(e)||t?n.split(I):[]}}function parseTargets(e){var t=e?flattenArray(h.arr(e)?e.map(toArray):toArray(e)):[];return filterArray(t,(function(e,t,n){return n.indexOf(e)===t}))}function getAnimatables(e){var t=parseTargets(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:getElementTransforms(e)}}}))}var R=/^spring/;function normalizePropertyTweens(e,t){var n=cloneObject(t);R.test(n.easing)&&(n.duration=spring(n.easing));if(h.arr(e)){var r=e.length;var s=r===2&&!h.obj(e[0]);s?e={value:e}:h.fnc(t.duration)||(n.duration=t.duration/r)}var a=h.arr(e)?e:[e];return a.map((function(e,n){var r=h.obj(e)&&!h.pth(e)?e:{value:e};h.und(r.delay)&&(r.delay=n?0:t.delay);h.und(r.endDelay)&&(r.endDelay=n===a.length-1?t.endDelay:0);return r})).map((function(e){return mergeObjects(e,n)}))}function flattenKeyframes(e){var t=filterArray(flattenArray(e.map((function(e){return Object.keys(e)}))),(function(e){return h.key(e)})).reduce((function(e,t){e.indexOf(t)<0&&e.push(t);return e}),[]);var n={};var loop=function(r){var s=t[r];n[s]=e.map((function(e){var t={};for(var n in e)h.key(n)?n==s&&(t.value=e[n]):t[n]=e[n];return t}))};for(var r=0;r<t.length;r++)loop(r);return n}function getProperties(e,t){var n=[];var r=t.keyframes;r&&(t=mergeObjects(flattenKeyframes(r),t));for(var s in t)h.key(s)&&n.push({name:s,tweens:normalizePropertyTweens(t[s],e)});return n}function normalizeTweenValues(e,t){var n={};for(var r in e){var s=getFunctionValue(e[r],t);if(h.arr(s)){s=s.map((function(e){return getFunctionValue(e,t)}));s.length===1&&(s=s[0])}n[r]=s}n.duration=parseFloat(n.duration);n.delay=parseFloat(n.delay);return n}function normalizeTweens(e,t){var n;return e.tweens.map((function(r){var s=normalizeTweenValues(r,t);var a=s.value;var o=h.arr(a)?a[1]:a;var l=getUnit(o);var c=getOriginalTargetValue(t.target,e.name,l,t);var u=n?n.to.original:c;var d=h.arr(a)?a[0]:u;var p=getUnit(d)||getUnit(c);var f=l||p;h.und(o)&&(o=u);s.from=decomposeValue(d,f);s.to=decomposeValue(getRelativeValue(o,d),f);s.start=n?n.end:0;s.end=s.start+s.delay+s.duration+s.endDelay;s.easing=parseEasings(s.easing,s.duration);s.isPath=h.pth(a);s.isColor=h.col(s.from.original);s.isColor&&(s.round=1);n=s;return s}))}var L={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,r,s){r.list.set(t,n);if(t===r.last||s){var a="";r.list.forEach((function(e,t){a+=t+"("+e+") "}));e.style.transform=a}}};function setTargetsValue(e,t){var n=getAnimatables(e);for(var r=0,s=n.length;r<s;r++){var a=n[r];for(var o in t){var l=getFunctionValue(t[o],a);var c=a.target;var u=getUnit(l);var h=getOriginalTargetValue(c,o,u,a);var d=u||getUnit(h);var p=getRelativeValue(validateValue(l,d),h);var f=getAnimationType(c,o);L[f](c,o,p,a.transforms,true)}}}function createAnimation(e,t){var n=getAnimationType(e.target,t.name);if(n){var r=normalizeTweens(t,e);var s=r[r.length-1];return{type:n,property:t.name,animatable:e,tweens:r,duration:s.end,delay:r[0].delay,endDelay:s.endDelay}}}function getAnimations(e,t){return filterArray(flattenArray(e.map((function(e){return t.map((function(t){return createAnimation(e,t)}))}))),(function(e){return!h.und(e)}))}function getInstanceTimings(e,t){var n=e.length;var getTlOffset=function(e){return e.timelineOffset?e.timelineOffset:0};var r={};r.duration=n?Math.max.apply(Math,e.map((function(e){return getTlOffset(e)+e.duration}))):t.duration;r.delay=n?Math.min.apply(Math,e.map((function(e){return getTlOffset(e)+e.delay}))):t.delay;r.endDelay=n?r.duration-Math.max.apply(Math,e.map((function(e){return getTlOffset(e)+e.duration-e.endDelay}))):t.endDelay;return r}var D=0;function createNewInstance(e){var t=replaceObjectProps(r,e);var n=replaceObjectProps(s,e);var a=getProperties(n,e);var o=getAnimatables(e.targets);var l=getAnimations(o,a);var c=getInstanceTimings(l,n);var u=D;D++;return mergeObjects(t,{id:u,children:[],animatables:o,animations:l,duration:c.duration,delay:c.delay,endDelay:c.endDelay})}var P=[];var F=[];var U;var O=function(){function play(){U=requestAnimationFrame(step)}function step(e){var t=P.length;if(t){var n=0;while(n<t){var r=P[n];if(r.paused){var s=P.indexOf(r);if(s>-1){P.splice(s,1);t=P.length}}else r.tick(e);n++}play()}else U=cancelAnimationFrame(U)}return play}();function handleVisibilityChange(){if(document.hidden){for(var e=0,t=P.length;e<t;e++)activeInstance[e].pause();F=P.slice(0);P=[]}else for(var n=0,r=F.length;n<r;n++)F[n].play()}document.addEventListener("visibilitychange",handleVisibilityChange);function anime(e){e===void 0&&(e={});var t=0,n=0,r=0;var s,a=0;var o=null;function makePromise(){return window.Promise&&new Promise((function(e){return o=e}))}var l=makePromise();var c=createNewInstance(e);function toggleInstanceDirection(){c.reversed=!c.reversed;for(var e=0,t=s.length;e<t;e++)s[e].reversed=c.reversed}function adjustTime(e){return c.reversed?c.duration-e:e}function resetTime(){t=0;n=adjustTime(c.currentTime)*(1/anime.speed)}function seekCild(e,t){t&&t.seek(e-t.timelineOffset)}function syncInstanceChildren(e){if(c.reversePlayback)for(var t=a;t--;)seekCild(e,s[t]);else for(var n=0;n<a;n++)seekCild(e,s[n])}function setAnimationsProgress(e){var t=0;var n=c.animations;var r=n.length;while(t<r){var s=n[t];var a=s.animatable;var o=s.tweens;var l=o.length-1;var u=o[l];l&&(u=filterArray(o,(function(t){return e<t.end}))[0]||u);var h=minMax(e-u.start-u.delay,0,u.duration)/u.duration;var d=isNaN(h)?1:u.easing(h);var p=u.to.strings;var f=u.round;var m=[];var g=u.to.numbers.length;var y=void 0;for(var b=0;b<g;b++){var x=void 0;var _=u.to.numbers[b];var M=u.from.numbers[b]||0;x=u.isPath?getPathProgress(u.value,d*_):M+d*(_-M);f&&(u.isColor&&b>2||(x=Math.round(x*f)/f));m.push(x)}var w=p.length;if(w){y=p[0];for(var S=0;S<w;S++){p[S];var T=p[S+1];var I=m[S];isNaN(I)||(y+=T?I+T:I+" ")}}else y=m[0];L[s.type](a.target,s.property,y,a.transforms);s.currentValue=y;t++}}function setCallback(e){c[e]&&!c.passThrough&&c[e](c)}function countIteration(){c.remaining&&c.remaining!==true&&c.remaining--}function setInstanceProgress(e){var a=c.duration;var u=c.delay;var h=a-c.endDelay;var d=adjustTime(e);c.progress=minMax(d/a*100,0,100);c.reversePlayback=d<c.currentTime;s&&syncInstanceChildren(d);if(!c.began&&c.currentTime>0){c.began=true;setCallback("begin");setCallback("loopBegin")}d<=u&&c.currentTime!==0&&setAnimationsProgress(0);(d>=h&&c.currentTime!==a||!a)&&setAnimationsProgress(a);if(d>u&&d<h){if(!c.changeBegan){c.changeBegan=true;c.changeCompleted=false;setCallback("changeBegin")}setCallback("change");setAnimationsProgress(d)}else if(c.changeBegan){c.changeCompleted=true;c.changeBegan=false;setCallback("changeComplete")}c.currentTime=minMax(d,0,a);c.began&&setCallback("update");if(e>=a){n=0;countIteration();if(c.remaining){t=r;setCallback("loopComplete");setCallback("loopBegin");c.direction==="alternate"&&toggleInstanceDirection()}else{c.paused=true;if(!c.completed){c.completed=true;setCallback("loopComplete");setCallback("complete");if("Promise"in window){o();l=makePromise()}}}}}c.reset=function(){var e=c.direction;c.passThrough=false;c.currentTime=0;c.progress=0;c.paused=true;c.began=false;c.changeBegan=false;c.completed=false;c.changeCompleted=false;c.reversePlayback=false;c.reversed=e==="reverse";c.remaining=c.loop;s=c.children;a=s.length;for(var t=a;t--;)c.children[t].reset();(c.reversed&&c.loop!==true||e==="alternate"&&c.loop===1)&&c.remaining++;setAnimationsProgress(0)};c.set=function(e,t){setTargetsValue(e,t);return c};c.tick=function(e){r=e;t||(t=r);setInstanceProgress((r+(n-t))*anime.speed)};c.seek=function(e){setInstanceProgress(adjustTime(e))};c.pause=function(){c.paused=true;resetTime()};c.play=function(){if(c.paused){c.paused=false;P.push(c);resetTime();U||O()}};c.reverse=function(){toggleInstanceDirection();resetTime()};c.restart=function(){c.reset();c.play()};c.finished=l;c.reset();c.autoplay&&c.play();return c}function removeTargetsFromAnimations(e,t){for(var n=t.length;n--;)arrayContains(e,t[n].animatable.target)&&t.splice(n,1)}function removeTargets(e){var t=parseTargets(e);for(var n=P.length;n--;){var r=P[n];var s=r.animations;var a=r.children;removeTargetsFromAnimations(t,s);for(var o=a.length;o--;){var l=a[o];var c=l.animations;removeTargetsFromAnimations(t,c);c.length||l.children.length||a.splice(o,1)}s.length||a.length||r.pause()}}function stagger(e,t){t===void 0&&(t={});var n=t.direction||"normal";var r=t.easing?parseEasings(t.easing):null;var s=t.grid;var a=t.axis;var o=t.from||0;var l=o==="first";var c=o==="center";var u=o==="last";var d=h.arr(e);var p=d?parseFloat(e[0]):parseFloat(e);var f=d?parseFloat(e[1]):0;var m=getUnit(d?e[1]:e)||0;var g=t.start||0+(d?p:0);var y=[];var b=0;return function(e,t,h){l&&(o=0);c&&(o=(h-1)/2);u&&(o=h-1);if(!y.length){for(var x=0;x<h;x++){if(s){var _=c?(s[0]-1)/2:o%s[0];var M=c?(s[1]-1)/2:Math.floor(o/s[0]);var w=x%s[0];var S=Math.floor(x/s[0]);var T=_-w;var I=M-S;var R=Math.sqrt(T*T+I*I);a==="x"&&(R=-T);a==="y"&&(R=-I);y.push(R)}else y.push(Math.abs(o-x));b=Math.max.apply(Math,y)}r&&(y=y.map((function(e){return r(e/b)*b})));n==="reverse"&&(y=y.map((function(e){return a?e<0?e*-1:-e:Math.abs(b-e)})))}var L=d?(f-p)/b:p;return g+L*(Math.round(y[t]*100)/100)+m}}function timeline(e){e===void 0&&(e={});var t=anime(e);t.duration=0;t.add=function(n,r){var a=P.indexOf(t);var o=t.children;a>-1&&P.splice(a,1);function passThrough(e){e.passThrough=true}for(var l=0;l<o.length;l++)passThrough(o[l]);var c=mergeObjects(n,replaceObjectProps(s,e));c.targets=c.targets||e.targets;var u=t.duration;c.autoplay=false;c.direction=t.direction;c.timelineOffset=h.und(r)?u:getRelativeValue(r,u);passThrough(t);t.seek(c.timelineOffset);var d=anime(c);passThrough(d);o.push(d);var p=getInstanceTimings(o,e);t.delay=p.delay;t.endDelay=p.endDelay;t.duration=p.duration;t.seek(0);t.reset();t.autoplay&&t.play();return t};return t}anime.version="3.0.0";anime.speed=1;anime.running=P;anime.remove=removeTargets;anime.get=getOriginalTargetValue;anime.set=setTargetsValue;anime.convertPx=convertPxToUnit;anime.path=getPath;anime.setDashoffset=setDashoffset;anime.stagger=stagger;anime.timeline=timeline;anime.easing=parseEasings;anime.penner=f;anime.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};const k=anime},"./node_modules/three-bmfont-text/index.js":(e,t,n)=>{var r=n("./node_modules/layout-bmfont-text/index.js");var s=n("./node_modules/quad-indices/index.js");var a=n("./node_modules/three-bmfont-text/lib/vertices.js");var o=n("./node_modules/three-bmfont-text/lib/utils.js");e.exports=function createTextGeometry(e){return new TextGeometry(e)};class TextGeometry extends THREE.BufferGeometry{constructor(e){super();typeof e==="string"&&(e={text:e});this._opt=Object.assign({},e);e&&this.update(e)}update(e){typeof e==="string"&&(e={text:e});e=Object.assign({},this._opt,e);if(!e.font)throw new TypeError("must specify a { font } in options");this.layout=r(e);var t=e.flipY!==false;var n=e.font;var o=n.common.scaleW;var l=n.common.scaleH;var c=this.layout.glyphs.filter((function(e){var t=e.data;return t.width*t.height>0}));this.visibleGlyphs=c;var u=a.positions(c);var h=a.uvs(c,o,l,t);var d=s([],{clockwise:true,type:"uint16",count:c.length});this.setIndex(d);this.setAttribute("position",new THREE.BufferAttribute(u,2));this.setAttribute("uv",new THREE.BufferAttribute(h,2));if(!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var p=a.pages(c);this.setAttribute("page",new THREE.BufferAttribute(p,1))}this.boundingBox!==null&&this.computeBoundingBox();this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array;var t=this.attributes.position.itemSize;if(!e||!t||e.length<2){this.boundingSphere.radius=0;this.boundingSphere.center.set(0,0,0)}else{o.computeSphere(e,this.boundingSphere);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox;var t=this.attributes.position.array;var n=this.attributes.position.itemSize;!t||!n||t.length<2?e.makeEmpty():o.computeBox(t,e)}}},"./node_modules/three-bmfont-text/lib/utils.js":e=>{var t=2;var n={min:[0,0],max:[0,0]};function bounds(e){var r=e.length/t;n.min[0]=e[0];n.min[1]=e[1];n.max[0]=e[0];n.max[1]=e[1];for(var s=0;s<r;s++){var a=e[s*t+0];var o=e[s*t+1];n.min[0]=Math.min(a,n.min[0]);n.min[1]=Math.min(o,n.min[1]);n.max[0]=Math.max(a,n.max[0]);n.max[1]=Math.max(o,n.max[1])}}e.exports.computeBox=function(e,t){bounds(e);t.min.set(n.min[0],n.min[1],0);t.max.set(n.max[0],n.max[1],0)};e.exports.computeSphere=function(e,t){bounds(e);var r=n.min[0];var s=n.min[1];var a=n.max[0];var o=n.max[1];var l=a-r;var c=o-s;var u=Math.sqrt(l*l+c*c);t.center.set(r+l/2,s+c/2,0);t.radius=u/2}},"./node_modules/three-bmfont-text/lib/vertices.js":e=>{e.exports.pages=function pages(e){var pages=new Float32Array(e.length*4*1);var t=0;e.forEach((function(e){var n=e.data.page||0;pages[t++]=n;pages[t++]=n;pages[t++]=n;pages[t++]=n}));return pages};e.exports.uvs=function uvs(e,t,n,r){var uvs=new Float32Array(e.length*4*2);var s=0;e.forEach((function(e){var a=e.data;var o=a.x+a.width;var l=a.y+a.height;var c=a.x/t;var u=a.y/n;var h=o/t;var d=l/n;if(r){u=(n-a.y)/n;d=(n-l)/n}uvs[s++]=c;uvs[s++]=u;uvs[s++]=c;uvs[s++]=d;uvs[s++]=h;uvs[s++]=d;uvs[s++]=h;uvs[s++]=u}));return uvs};e.exports.positions=function positions(e){var positions=new Float32Array(e.length*4*2);var t=0;e.forEach((function(e){var n=e.data;var r=e.position[0]+n.xoffset;var s=e.position[1]+n.yoffset;var a=n.width;var o=n.height;positions[t++]=r;positions[t++]=s;positions[t++]=r;positions[t++]=s+o;positions[t++]=r+a;positions[t++]=s+o;positions[t++]=r+a;positions[t++]=s}));return positions}},"./node_modules/word-wrapper/index.js":e=>{var t=/\n/;var n="\n";var r=/\s/;e.exports=function(t,n){var r=e.exports.lines(t,n);return r.map((function(e){return t.substring(e.start,e.end)})).join("\n")};e.exports.lines=function wordwrap(e,t){t=t||{};if(t.width===0&&t.mode!=="nowrap")return[];e=e||"";var n=typeof t.width==="number"?t.width:Number.MAX_VALUE;var r=Math.max(0,t.start||0);var s=typeof t.end==="number"?t.end:e.length;var a=t.mode;var o=t.measure||monospace;return a==="pre"?pre(o,e,r,s,n):greedy(o,e,r,s,n,a)};function idxOf(e,t,n,r){var s=e.indexOf(t,n);return s===-1||s>r?r:s}function isWhitespace(e){return r.test(e)}function pre(e,n,r,s,a){var o=[];var l=r;for(var c=r;c<s&&c<n.length;c++){var u=n.charAt(c);var h=t.test(u);if(h||c===s-1){var d=h?c:c+1;var p=e(n,l,d,a);o.push(p);l=c+1}}return o}function greedy(e,t,r,s,a,o){var l=[];var c=a;o==="nowrap"&&(c=Number.MAX_VALUE);while(r<s&&r<t.length){var u=idxOf(t,n,r,s);while(r<u){if(!isWhitespace(t.charAt(r)))break;r++}var h=e(t,r,u,c);var d=r+(h.end-h.start);var p=d+n.length;if(d<u){while(d>r){if(isWhitespace(t.charAt(d)))break;d--}if(d===r){p>r+n.length&&p--;d=p}else{p=d;while(d>r){if(!isWhitespace(t.charAt(d-n.length)))break;d--}}}if(d>=r){var f=e(t,r,d,c);l.push(f)}r=p}return l}function monospace(e,t,n,r){var s=Math.min(r,n-t);return{start:t,end:t+s}}},"./node_modules/xhr/index.js":(e,t,n)=>{var r=n("./node_modules/global/window.js");var s=n("./node_modules/is-function/index.js");var a=n("./node_modules/parse-headers/parse-headers.js");var o=n("./node_modules/xtend/immutable.js");e.exports=createXHR;e.exports.default=createXHR;createXHR.XMLHttpRequest=r.XMLHttpRequest||noop;createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:r.XDomainRequest;forEachArray(["get","put","post","patch","head","delete"],(function(e){createXHR[e==="delete"?"del":e]=function(t,n,r){n=initParams(t,n,r);n.method=e.toUpperCase();return _createXHR(n)}}));function forEachArray(e,t){for(var n=0;n<e.length;n++)t(e[n])}function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return false;return true}function initParams(e,t,n){var r=e;if(s(t)){n=t;typeof e==="string"&&(r={uri:e})}else r=o(t,{uri:e});r.callback=n;return r}function createXHR(e,t,n){t=initParams(e,t,n);return _createXHR(t)}function _createXHR(e){if(typeof e.callback==="undefined")throw new Error("callback argument missing");var t=false;var n=function cbOnce(n,r,s){if(!t){t=true;e.callback(n,r,s)}};function readystatechange(){r.readyState===4&&setTimeout(loadFunc,0)}function getBody(){var e=void 0;e=r.response?r.response:r.responseText||getXml(r);if(p)try{e=JSON.parse(e)}catch(e){}return e}function errorFunc(e){clearTimeout(f);e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error")));e.statusCode=0;return n(e,m)}function loadFunc(){if(!o){var t;clearTimeout(f);t=e.useXDR&&r.status===void 0?200:r.status===1223?204:r.status;var s=m;var u=null;if(t!==0){s={body:getBody(),statusCode:t,method:c,headers:{},url:l,rawRequest:r};r.getAllResponseHeaders&&(s.headers=a(r.getAllResponseHeaders()))}else u=new Error("Internal XMLHttpRequest Error");return n(u,s,s.body)}}var r=e.xhr||null;r||(r=e.cors||e.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var s;var o;var l=r.url=e.uri||e.url;var c=r.method=e.method||"GET";var u=e.body||e.data;var h=r.headers=e.headers||{};var d=!!e.sync;var p=false;var f;var m={body:void 0,headers:{},statusCode:0,method:c,url:l,rawRequest:r};if("json"in e&&e.json!==false){p=true;h.accept||h.Accept||(h.Accept="application/json");if(c!=="GET"&&c!=="HEAD"){h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json");u=JSON.stringify(e.json===true?u:e.json)}}r.onreadystatechange=readystatechange;r.onload=loadFunc;r.onerror=errorFunc;r.onprogress=function(){};r.onabort=function(){o=true};r.ontimeout=errorFunc;r.open(c,l,!d,e.username,e.password);d||(r.withCredentials=!!e.withCredentials);!d&&e.timeout>0&&(f=setTimeout((function(){if(!o){o=true;r.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";errorFunc(e)}}),e.timeout));if(r.setRequestHeader)for(s in h)h.hasOwnProperty(s)&&r.setRequestHeader(s,h[s]);else if(e.headers&&!isEmpty(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");"responseType"in e&&(r.responseType=e.responseType);"beforeSend"in e&&typeof e.beforeSend==="function"&&e.beforeSend(r);r.send(u||null);return r}function getXml(e){try{if(e.responseType==="document")return e.responseXML;var t=e.responseXML&&e.responseXML.documentElement.nodeName==="parsererror";if(e.responseType===""&&!t)return e.responseXML}catch(e){}return null}function noop(){}},"./node_modules/xml-parse-from-string/index.js":e=>{e.exports=function xmlparser(){return typeof self.DOMParser!=="undefined"?function(e){var t=new self.DOMParser;return t.parseFromString(e,"application/xml")}:typeof self.ActiveXObject!=="undefined"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new self.ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e);return t}:function(e){var t=document.createElement("div");t.innerHTML=e;return t}}()},"./node_modules/xtend/immutable.js":e=>{e.exports=extend;var t=Object.prototype.hasOwnProperty;function extend(){var e={};for(var n=0;n<arguments.length;n++){var r=arguments[n];for(var s in r)t.call(r,s)&&(e[s]=r[s])}return e}},"./src/components/anchored.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l=o.debug("components:anchored:warn");var c=(0,a.registerComponent)("anchored",{schema:{persistent:{default:false}},init:function(){var e=(this||t).el.sceneEl;var n=e.getAttribute("webxr");var r=n.optionalFeatures;if(r.indexOf("anchors")===-1){r.push("anchors");(this||t).el.sceneEl.setAttribute("webxr",n)}(this||t).auxQuaternion=new s.Quaternion;(this||t).onEnterVR=(this||t).onEnterVR.bind(this||t);(this||t).el.sceneEl.addEventListener("enter-vr",(this||t).onEnterVR)},onEnterVR:function(){(this||t).anchor=void 0;(this||t).requestPersistentAnchorPending=(this||t).data.persistent;(this||t).requestAnchorPending=!(this||t).data.persistent},tick:function(){var e=(this||t).el.sceneEl;var n=e.renderer.xr;var r;var s;var a;var o=(this||t).el.object3D;if(e.is("ar-mode")||e.is("vr-mode")){!(this||t).anchor&&(this||t).requestPersistentAnchorPending&&this.restorePersistentAnchor();!(this||t).anchor&&(this||t).requestAnchorPending&&this.createAnchor();if((this||t).anchor){r=e.frame;s=n.getReferenceSpace();a=r.getPose((this||t).anchor.anchorSpace,s);o.position.copy(a.transform.position);o.quaternion.copy(a.transform.orientation)}}},createAnchor:async function createAnchor(e,n){var r=(this||t).el.sceneEl;var s=r.renderer.xr;var a;var o;var c;var u;var h=(this||t).el.object3D;e=e||h.position;n=n||(this||t).auxQuaternion.setFromEuler(h.rotation);if(anchorsSupported(r)){(this||t).anchor&&this.deleteAnchor();a=r.frame;o=s.getReferenceSpace();c=new XRRigidTransform({x:e.x,y:e.y,z:e.z},{x:n.x,y:n.y,z:n.z,w:n.w});(this||t).requestAnchorPending=false;u=await a.createAnchor(c,o);if((this||t).data.persistent)if((this||t).el.id){(this||t).persistentHandle=await u.requestPersistentHandle();localStorage.setItem((this||t).el.id,(this||t).persistentHandle)}else l("The anchor won't be persisted because the entity has no assigned id.");r.object3D.attach((this||t).el.object3D);(this||t).anchor=u}else l("This browser doesn't support the WebXR anchors module")},restorePersistentAnchor:async function restorePersistentAnchor(){var e=(this||t).el.sceneEl.renderer.xr;var n=e.getSession();var r=n.persistentAnchors;var s;(this||t).requestPersistentAnchorPending=false;if((this||t).el.id)if(r){s=localStorage.getItem((this||t).el.id);for(var a=0;a<r.length;++a)if(s===r[a]){(this||t).anchor=await n.restorePersistentAnchor(r[a]);(this||t).anchor&&((this||t).persistentHandle=r[a]);break}(this||t).anchor||((this||t).requestAnchorPending=true)}else(this||t).requestPersistentAnchorPending=true;else{l("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id.");(this||t).requestAnchorPending=true}},deleteAnchor:function(){var e;var n;var r=(this||t).anchor;if(r){e=(this||t).el.sceneEl.renderer.xr;n=e.getSession();r.delete();(this||t).el.sceneEl.object3D.add((this||t).el.object3D);(this||t).persistentHandle&&n.deletePersistentAnchor((this||t).persistentHandle);(this||t).anchor=void 0}}});function anchorsSupported(e){var t=e.renderer.xr;var n=t.getSession();return n&&n.restorePersistentAnchor}},"./src/components/animation.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>_});var s=r("./node_modules/three/build/three.core.js");var a=r("./node_modules/super-animejs/lib/anime.es.js");var o=r("./src/core/component.js");var l=r("./src/utils/index.js");var c=new s.Color;var u=new s.Color;var h=l.entity.getComponentProperty;var d=l.entity.setComponentProperty;var p={};var f="color";var m="position";var g="rotation";var y="scale";var b="components";var x="object3D";var _=(0,o.registerComponent)("animation",{schema:{autoplay:{default:true},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:true},from:{default:""},loop:{default:0,parse:function(e){return e===true||e==="true"||e!==false&&e!=="false"&&parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:false},to:{default:""},type:{default:""},isRawProperty:{default:false}},multiple:true,init:function(){var e=this||t;(this||t).eventDetail={name:(this||t).attrName};(this||t).time=0;(this||t).animation=null;(this||t).animationIsPlaying=false;(this||t).onStartEvent=(this||t).onStartEvent.bind(this||t);(this||t).beginAnimation=(this||t).beginAnimation.bind(this||t);(this||t).pauseAnimation=(this||t).pauseAnimation.bind(this||t);(this||t).resumeAnimation=(this||t).resumeAnimation.bind(this||t);(this||t).fromColor={};(this||t).toColor={};(this||t).targets={};(this||t).targetsArray=[];(this||t).updateConfigForDefault=(this||t).updateConfigForDefault.bind(this||t);(this||t).updateConfigForRawColor=(this||t).updateConfigForRawColor.bind(this||t);(this||t).config={complete:function(){e.animationIsPlaying=false;e.el.emit("animationcomplete",e.eventDetail,false);e.id&&e.el.emit("animationcomplete__"+e.id,e.eventDetail,false)}}},update:function(e){var n=(this||t).config;var r=(this||t).data;(this||t).animationIsPlaying=false;if((this||t).data.enabled&&r.property){n.autoplay=false;n.direction=r.dir;n.duration=r.dur;n.easing=r.easing;n.elasticity=r.elasticity;n.loop=r.loop;n.round=r.round;this.createAndStartAnimation()}},tick:function(e,n){if((this||t).animationIsPlaying){(this||t).time+=n;(this||t).animation.tick((this||t).time)}},remove:function(){this.pauseAnimation();this.removeEventListeners()},pause:function(){(this||t).paused=true;(this||t).pausedWasPlaying=(this||t).animationIsPlaying;this.pauseAnimation();this.removeEventListeners()},play:function(){if((this||t).paused){(this||t).paused=false;this.addEventListeners();if((this||t).pausedWasPlaying){this.resumeAnimation();(this||t).pausedWasPlaying=false}}},createAndStartAnimation:function(){var e=(this||t).data;this.updateConfig();(this||t).animationIsPlaying=false;(this||t).animation=(0,a.default)((this||t).config);(this||t).animation.began=true;this.removeEventListeners();this.addEventListeners();!e.autoplay||e.startEvents&&e.startEvents.length||(e.delay?setTimeout((this||t).beginAnimation,e.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig();(this||t).animation.began=true;(this||t).time=0;(this||t).animationIsPlaying=true;this.stopRelatedAnimations();(this||t).el.emit("animationbegin",(this||t).eventDetail,false)},pauseAnimation:function(){(this||t).animationIsPlaying=false},resumeAnimation:function(){(this||t).animationIsPlaying=true},onStartEvent:function(){if((this||t).data.enabled){this.updateConfig();(this||t).animation&&(this||t).animation.pause();(this||t).animation=(0,a.default)((this||t).config);(this||t).data.delay?setTimeout((this||t).beginAnimation,(this||t).data.delay):this.beginAnimation()}},updateConfigForRawColor:function(){var e=(this||t).config;var n=(this||t).data;var r=(this||t).el;var s;var a;var o;if(!this.waitComponentInitRawProperty((this||t).updateConfigForRawColor)){s=n.from===""?getRawProperty(r,n.property):n.from;o=n.to;this.setColorConfig(s,o);s=(this||t).fromColor;o=(this||t).toColor;(this||t).targetsArray.length=0;(this||t).targetsArray.push(s);e.targets=(this||t).targetsArray;for(a in o)e[a]=o[a];e.update=function(){var e={};return function(t){var s;s=t.animatables[0].target;s.r===e.r&&s.g===e.g&&s.b===e.b||setRawProperty(r,n.property,s,n.type)}}()}},updateConfigForDefault:function(){var e=(this||t).config;var n=(this||t).data;var r=(this||t).el;var s;var a;var o;var l;if(!this.waitComponentInitRawProperty((this||t).updateConfigForDefault)){s=n.from===""?isRawProperty(n)?getRawProperty(r,n.property):h(r,n.property):n.from;l=n.to;o=!isNaN(s||l);if(o){s=parseFloat(s);l=parseFloat(l)}else{s=s?s.toString():s;l=l?l.toString():l}a=n.to==="true"||n.to==="false"||n.to===true||n.to===false;if(a){s=n.from==="true"||n.from===true?1:0;l=n.to==="true"||n.to===true?1:0}(this||t).targets.aframeProperty=s;e.targets=(this||t).targets;e.aframeProperty=l;e.update=function(){var e;return function(t){var s;s=t.animatables[0].target.aframeProperty;if(s!==e){e=s;a&&(s=s>=1);isRawProperty(n)?setRawProperty(r,n.property,s,n.type):d(r,n.property,s)}}}()}},updateConfigForVector:function(){var e=(this||t).config;var n=(this||t).data;var r=(this||t).el;var s;var a;var o;var c=splitDot(n.property);var u=c[0]==="object3D"?c[1]:c[0];a=n.from!==""?l.coordinates.parse(n.from):h(r,u);o=l.coordinates.parse(n.to);if(u===g){toRadians(a);toRadians(o)}(this||t).targetsArray.length=0;(this||t).targetsArray.push(a);e.targets=(this||t).targetsArray;for(s in o)e[s]=o[s];e.update=u!==m&&u!==g&&u!==y?function(){var e={};return function(t){var s=t.animatables[0].target;if(s.x!==e.x||s.y!==e.y||s.z!==e.z){e.x=s.x;e.y=s.y;e.z=s.z;d(r,n.property,s)}}}():function(){var e={};return function(t){var n=t.animatables[0].target;if(n.x!==e.x||n.y!==e.y||n.z!==e.z){e.x=n.x;e.y=n.y;e.z=n.z;r.object3D[u].set(n.x,n.y,n.z)}}}()},updateConfig:function(){var e;e=getPropertyType((this||t).el,(this||t).data.property);isRawProperty((this||t).data)&&(this||t).data.type===f?this.updateConfigForRawColor():e==="vec2"||e==="vec3"||e==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(e){var n;var r=(this||t).data;var s=(this||t).el;var o=this||t;if(r.from!=="")return false;if(!r.property.startsWith(b))return false;n=splitDot(r.property)[1];if(s.components[n])return false;s.addEventListener("componentinitialized",(function wait(t){if(t.detail.name===n){e();o.animation=(0,a.default)(o.config);s.removeEventListener("componentinitialized",wait)}}));return true},stopRelatedAnimations:function(){var e;var n;for(n in(this||t).el.components){e=(this||t).el.components[n];n!==(this||t).attrName&&(e.name==="animation"&&e.animationIsPlaying&&e.data.property===(this||t).data.property&&(e.animationIsPlaying=false))}},addEventListeners:function(){var e=(this||t).data;var n=(this||t).el;addEventListeners(n,e.startEvents,(this||t).onStartEvent);addEventListeners(n,e.pauseEvents,(this||t).pauseAnimation);addEventListeners(n,e.resumeEvents,(this||t).resumeAnimation)},removeEventListeners:function(){var e=(this||t).data;var n=(this||t).el;removeEventListeners(n,e.startEvents,(this||t).onStartEvent);removeEventListeners(n,e.pauseEvents,(this||t).pauseAnimation);removeEventListeners(n,e.resumeEvents,(this||t).resumeAnimation)},setColorConfig:function(e,n){c.set(e);u.set(n);e=(this||t).fromColor;n=(this||t).toColor;e.r=c.r;e.g=c.g;e.b=c.b;n.r=u.r;n.g=u.g;n.b=u.b}});function getPropertyType(e,t){var n;var r;var s;var a;s=t.split(".");if(s[0]==="object3D"&&!s[2]&&(s[1]==="position"||s[1]==="rotation"||s[1]==="scale"))return"vec3";r=s[0];a=s[1];n=e.components[r]||o.components[r];return n?a&&!n.schema[a]?null:a?n.schema[a].type:n.schema.type:null}function toRadians(e){e.x=s.MathUtils.degToRad(e.x);e.y=s.MathUtils.degToRad(e.y);e.z=s.MathUtils.degToRad(e.z)}function addEventListeners(e,t,n){var r;for(r=0;r<t.length;r++)e.addEventListener(t[r],n)}function removeEventListeners(e,t,n){var r;for(r=0;r<t.length;r++)e.removeEventListener(t[r],n)}function getRawProperty(e,t){var n;var r;var s;r=splitDot(t);s=e;for(n=0;n<r.length;n++)s=s[r[n]];if(s===void 0){console.log(e);throw new Error("[animation] property ("+t+") could not be found")}return s}function setRawProperty(e,t,n,r){var a;var o;var l;var c;t.startsWith("object3D.rotation")&&(n=s.MathUtils.degToRad(n));o=splitDot(t);c=e;for(a=0;a<o.length-1;a++)c=c[o[a]];l=o[o.length-1];if(r!==f)c[l]=n;else if("r"in c[l]){c[l].r=n.r;c[l].g=n.g;c[l].b=n.b}else{c[l].x=n.r;c[l].y=n.g;c[l].z=n.b}}function splitDot(e){if(e in p)return p[e];p[e]=e.split(".");return p[e]}function isRawProperty(e){return e.isRawProperty||e.property.startsWith(b)||e.property.startsWith(x)}},"./src/components/camera.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=(0,a.registerComponent)("camera",{schema:{active:{default:true},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:false},zoom:{default:1,min:0}},init:function(){var e;var n=(this||t).el;e=(this||t).camera=new s.PerspectiveCamera;n.setObject3D("camera",e)},update:function(e){var n=(this||t).data;var r=(this||t).camera;r.aspect=n.aspect||window.innerWidth/window.innerHeight;r.far=n.far;r.fov=n.fov;r.near=n.near;r.zoom=n.zoom;r.updateProjectionMatrix();this.updateActiveCamera(e);this.updateSpectatorCamera(e)},updateActiveCamera:function(e){var n=(this||t).data;var r=(this||t).el;var s=(this||t).system;e&&e.active===n.active||n.spectator||(n.active&&s.activeCameraEl!==r?s.setActiveCamera(r):n.active||s.activeCameraEl!==r||s.disableActiveCamera())},updateSpectatorCamera:function(e){var n=(this||t).data;var r=(this||t).el;var s=(this||t).system;e&&e.spectator===n.spectator||(n.spectator&&s.spectatorCameraEl!==r?s.setSpectatorCamera(r):n.spectator||s.spectatorCameraEl!==r||s.disableSpectatorCamera())},remove:function(){(this||t).el.removeObject3D("camera")}})},"./src/components/cursor.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>p});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"};var c={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"};var u={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]};var h={DOWN:["selectstart"],UP:["selectend"]};var d="a-mouse-cursor-hover";var p=(0,a.registerComponent)("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:o.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:true},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:true,init:function(){var e=this||t;(this||t).fuseTimeout=void 0;(this||t).cursorDownEl=null;(this||t).intersectedEl=null;(this||t).canvasBounds=document.body.getBoundingClientRect();(this||t).isCursorDown=false;(this||t).activeXRInput=null;(this||t).updateCanvasBounds=o.debounce((function updateCanvasBounds(){e.canvasBounds=e.el.sceneEl.canvas.getBoundingClientRect()}),500);(this||t).eventDetail={};(this||t).intersectedEventDetail={cursorEl:(this||t).el};(this||t).onCursorDown=(this||t).onCursorDown.bind(this||t);(this||t).onCursorUp=(this||t).onCursorUp.bind(this||t);(this||t).onIntersection=(this||t).onIntersection.bind(this||t);(this||t).onIntersectionCleared=(this||t).onIntersectionCleared.bind(this||t);(this||t).onMouseMove=(this||t).onMouseMove.bind(this||t);(this||t).onEnterVR=(this||t).onEnterVR.bind(this||t)},update:function(e){var n=(this||t).data.rayOrigin;if(n!==e.rayOrigin){n==="entity"&&this.resetRaycaster();this.updateMouseEventListeners();n!=="xrselect"&&n!=="entity"||this.addWebXREventListeners();e.rayOrigin!=="xrselect"&&e.rayOrigin!=="entity"||this.removeWebXREventListeners()}},tick:function(){var e=(this||t).el.sceneEl.frame;var n=(this||t).activeXRInput;(this||t).data.rayOrigin==="xrselect"&&e&&n&&this.onMouseMove({frame:e,inputSource:n,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var e=(this||t).el;e.removeState(c.HOVERING);e.removeState(c.FUSING);clearTimeout((this||t).fuseTimeout);(this||t).intersectedEl&&(this||t).intersectedEl.removeState(c.HOVERED);this.removeEventListeners()},addEventListeners:function(){var e;var n=(this||t).data;var r=(this||t).el;var s=this||t;function addCanvasListeners(){e=r.sceneEl.canvas;if(!n.downEvents.length&&!n.upEvents.length){u.DOWN.forEach((function(t){e.addEventListener(t,s.onCursorDown,{passive:false})}));u.UP.forEach((function(t){e.addEventListener(t,s.onCursorUp,{passive:false})}))}}e=r.sceneEl.canvas;e?addCanvasListeners():r.sceneEl.addEventListener("render-target-loaded",addCanvasListeners);n.downEvents.forEach((function(e){r.addEventListener(e,s.onCursorDown)}));n.upEvents.forEach((function(e){r.addEventListener(e,s.onCursorUp)}));r.addEventListener("raycaster-intersection",(this||t).onIntersection);r.addEventListener("raycaster-closest-entity-changed",(this||t).onIntersection);r.addEventListener("raycaster-intersection-cleared",(this||t).onIntersectionCleared);r.sceneEl.addEventListener("rendererresize",(this||t).updateCanvasBounds);r.sceneEl.addEventListener("enter-vr",(this||t).onEnterVR);window.addEventListener("resize",(this||t).updateCanvasBounds);window.addEventListener("scroll",(this||t).updateCanvasBounds);this.updateMouseEventListeners()},removeEventListeners:function(){var e;var n=(this||t).data;var r=(this||t).el;var s=this||t;e=r.sceneEl.canvas;if(e&&!n.downEvents.length&&!n.upEvents.length){u.DOWN.forEach((function(t){e.removeEventListener(t,s.onCursorDown)}));u.UP.forEach((function(t){e.removeEventListener(t,s.onCursorUp)}))}n.downEvents.forEach((function(e){r.removeEventListener(e,s.onCursorDown)}));n.upEvents.forEach((function(e){r.removeEventListener(e,s.onCursorUp)}));r.removeEventListener("raycaster-intersection",(this||t).onIntersection);r.removeEventListener("raycaster-closest-entity-changed",(this||t).onIntersection);r.removeEventListener("raycaster-intersection-cleared",(this||t).onIntersectionCleared);e.removeEventListener("mousemove",(this||t).onMouseMove);e.removeEventListener("touchstart",(this||t).onMouseMove);e.removeEventListener("touchmove",(this||t).onMouseMove);r.sceneEl.removeEventListener("rendererresize",(this||t).updateCanvasBounds);r.sceneEl.removeEventListener("enter-vr",(this||t).onEnterVR);window.removeEventListener("resize",(this||t).updateCanvasBounds);window.removeEventListener("scroll",(this||t).updateCanvasBounds);this.removeWebXREventListeners()},updateMouseEventListeners:function(){var e;var n=(this||t).el;e=n.sceneEl.canvas;e.removeEventListener("mousemove",(this||t).onMouseMove);e.removeEventListener("touchmove",(this||t).onMouseMove);n.setAttribute("raycaster","useWorldCoordinates",false);if((this||t).data.rayOrigin==="mouse"){e.addEventListener("mousemove",(this||t).onMouseMove);e.addEventListener("touchmove",(this||t).onMouseMove,{passive:false});n.setAttribute("raycaster","useWorldCoordinates",true);this.updateCanvasBounds()}},resetRaycaster:function(){(this||t).el.setAttribute("raycaster",{direction:(new s.Vector3).set(0,0,-1),origin:new s.Vector3})},addWebXREventListeners:function(){var e=this||t;var n=(this||t).el.sceneEl.xrSession;if(n){h.DOWN.forEach((function(t){n.addEventListener(t,e.onCursorDown)}));h.UP.forEach((function(t){n.addEventListener(t,e.onCursorUp)}))}},removeWebXREventListeners:function(){var e=this||t;var n=(this||t).el.sceneEl.xrSession;if(n){h.DOWN.forEach((function(t){n.removeEventListener(t,e.onCursorDown)}));h.UP.forEach((function(t){n.removeEventListener(t,e.onCursorUp)}))}},onMouseMove:function(){var e=new s.Vector3;var n=new s.Vector2;var r=new s.Vector3;var a={origin:r,direction:e};return function(s){var o=(this||t).canvasBounds;var l=(this||t).el.sceneEl.camera;var c;var u;var h;var d;var p;var f;var m;var g;var y;l.parent.updateMatrixWorld();h=s.type==="touchmove"||s.type==="touchstart"?s.touches.item(0):s;u=h.clientX-o.left;d=h.clientY-o.top;n.x=u/o.width*2-1;n.y=-d/o.height*2+1;if((this||t).data.rayOrigin!=="xrselect"||s.type!=="selectstart"&&s.type!=="fakeselectevent")if(s.type==="fakeselectout"){e.set(0,1,0);r.set(0,9999,0)}else if(l&&l.isPerspectiveCamera){r.setFromMatrixPosition(l.matrixWorld);e.set(n.x,n.y,.5).unproject(l).sub(r).normalize()}else if(l&&l.isOrthographicCamera){r.set(n.x,n.y,(l.near+l.far)/(l.near-l.far)).unproject(l);e.set(0,0,-1).transformDirection(l.matrixWorld)}else console.error("AFRAME.Raycaster: Unsupported camera type: "+l.type);else{p=s.frame;f=s.inputSource;m=(this||t).el.sceneEl.renderer.xr.getReferenceSpace();g=p.getPose(f.targetRaySpace,m);if(g){y=g.transform;e.set(0,0,-1);e.applyQuaternion(y.orientation);r.copy(y.position);c=l.el.object3D.parent;c.localToWorld(r);e.transformDirection(c.matrixWorld)}}(this||t).el.setAttribute("raycaster",a);s.type==="touchmove"&&s.preventDefault()}}(),onCursorDown:function(e){(this||t).isCursorDown=true;if((this||t).data.rayOrigin==="mouse"&&e.type==="touchstart"){this.onMouseMove(e);(this||t).el.components.raycaster.checkIntersections();e.preventDefault()}if((this||t).data.rayOrigin==="xrselect"&&e.type==="selectstart"){(this||t).activeXRInput=e.inputSource;this.onMouseMove(e);(this||t).el.components.raycaster.checkIntersections();if((this||t).el.components.raycaster.intersectedEls.length&&(this||t).el.sceneEl.components["ar-hit-test"]!==void 0&&(this||t).el.sceneEl.getAttribute("ar-hit-test").enabled){(this||t).el.sceneEl.setAttribute("ar-hit-test","enabled",false);(this||t).reenableARHitTest=true}}this.twoWayEmit(l.MOUSEDOWN,e);(this||t).cursorDownEl=(this||t).intersectedEl},onCursorUp:function(e){if((this||t).isCursorDown&&((this||t).data.rayOrigin!=="xrselect"||(this||t).activeXRInput===e.inputSource)){(this||t).isCursorDown=false;var n=(this||t).data;this.twoWayEmit(l.MOUSEUP,e);if((this||t).reenableARHitTest===true){(this||t).el.sceneEl.setAttribute("ar-hit-test","enabled",true);(this||t).reenableARHitTest=void 0}if((this||t).cursorDownEl&&(this||t).cursorDownEl!==(this||t).intersectedEl){(this||t).intersectedEventDetail.intersection=null;(this||t).cursorDownEl.emit(l.MOUSEUP,(this||t).intersectedEventDetail)}n.fuse&&n.rayOrigin!=="mouse"&&n.rayOrigin!=="xrselect"||!(this||t).intersectedEl||(this||t).cursorDownEl!==(this||t).intersectedEl||this.twoWayEmit(l.CLICK,e);n.rayOrigin==="xrselect"&&this.onMouseMove({type:"fakeselectout"});(this||t).activeXRInput=null;(this||t).cursorDownEl=null;e.type==="touchend"&&e.preventDefault()}},onIntersection:function(e){var n;var r=(this||t).el;var s;var a;var o;s=e.detail.els[0]===r?1:0;o=e.detail.intersections[s];a=e.detail.els[s];if(a&&(this||t).intersectedEl!==a){if((this||t).intersectedEl){n=(this||t).el.components.raycaster.getIntersection((this||t).intersectedEl);if(n&&n.distance<=o.distance)return}this.clearCurrentIntersection(true);this.setIntersection(a,o)}},onIntersectionCleared:function(e){var n=e.detail.clearedEls;n.indexOf((this||t).intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){var e=(this||t).data.rayOrigin;this.clearCurrentIntersection(true);e!=="xrselect"&&e!=="entity"||this.addWebXREventListeners()},setIntersection:function(e,n){var r=(this||t).el;var s=(this||t).data;var a=this||t;if((this||t).intersectedEl!==e){(this||t).intersectedEl=e;r.addState(c.HOVERING);e.addState(c.HOVERED);this.twoWayEmit(l.MOUSEENTER);(this||t).data.mouseCursorStylesEnabled&&(this||t).data.rayOrigin==="mouse"&&(this||t).el.sceneEl.canvas.classList.add(d);if(s.fuseTimeout!==0&&s.fuse&&s.rayOrigin!=="xrselect"&&s.rayOrigin!=="mouse"){r.addState(c.FUSING);this.twoWayEmit(l.FUSING);(this||t).fuseTimeout=setTimeout((function fuse(){r.removeState(c.FUSING);a.twoWayEmit(l.CLICK)}),s.fuseTimeout)}}},clearCurrentIntersection:function(e){var n;var r;var s;var a=(this||t).el;if((this||t).intersectedEl){(this||t).intersectedEl.removeState(c.HOVERED);a.removeState(c.HOVERING);a.removeState(c.FUSING);this.twoWayEmit(l.MOUSELEAVE);(this||t).data.mouseCursorStylesEnabled&&(this||t).data.rayOrigin==="mouse"&&(this||t).el.sceneEl.canvas.classList.remove(d);(this||t).intersectedEl=null;clearTimeout((this||t).fuseTimeout);if(e!==true){s=(this||t).el.components.raycaster.intersections;if(s.length!==0){n=s[0].object.el===a?1:0;r=s[n];r&&this.setIntersection(r.object.el,r)}}}},twoWayEmit:function(e,n){var r=(this||t).el;var s=(this||t).intersectedEl;var a;function addOriginalEvent(e,t){n instanceof MouseEvent?e.mouseEvent=n:typeof TouchEvent!=="undefined"&&n instanceof TouchEvent&&(e.touchEvent=n)}a=(this||t).el.components.raycaster.getIntersection(s);(this||t).eventDetail.intersectedEl=s;(this||t).eventDetail.intersection=a;addOriginalEvent((this||t).eventDetail,n);r.emit(e,(this||t).eventDetail);if(s){(this||t).intersectedEventDetail.intersection=a;addOriginalEvent((this||t).intersectedEventDetail,n);s.emit(e,(this||t).intersectedEventDetail)}}})},"./src/components/generic-tracked-controller-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./src/core/component.js");var a=r("./src/utils/tracked-controls.js");var o="generic";var l={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};var c=(0,s.registerComponent)("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:true},defaultModelColor:{default:"gray"},disabled:{default:false}},after:["tracked-controls"],mapping:l,bindMethods:function(){(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},init:function(){var e=this||t;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,a.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,a.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchStart=function(t){(0,a.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).onButtonTouchEnd=function(t){(0,a.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).controllerPresent=false;(this||t).wasControllerConnected=false;this.bindMethods();(this||t).el.addEventListener("controllerconnected",(function(t){if(t.detail.name!==e.name){e.wasControllerConnected=true;e.removeEventListeners();e.removeControllersUpdateListener()}}))},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).data;var n=e.hand?e.hand:void 0;(0,a.checkControllerPresentAndSetup)(this||t,o,{hand:n,iterateControllerProfiles:true})},play:function(){if(!(this||t).wasControllerConnected){this.checkIfControllerPresent();this.addControllersUpdateListener()}},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;if((this||t).el.components["tracked-controls"])this.removeEventListeners();else{e.setAttribute("tracked-controls",{hand:n.hand,idPrefix:o,iterateControllerProfiles:true});(this||t).data.defaultModel&&this.initDefaultModel()}},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){(this||t).wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];n&&(this||t).el.emit(n+"changed",e.detail.state)},onAxisMoved:function(e){(0,a.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},initDefaultModel:function(){var e=(this||t).modelEl=document.createElement("a-entity");e.setAttribute("geometry",{primitive:"sphere",radius:.03});e.setAttribute("material",{color:(this||t).data.color});(this||t).el.appendChild(e);(this||t).el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:(this||t).modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=r("./src/core/component.js");var l=new s.BufferGeometry;var c=(0,o.registerComponent)("geometry",{schema:{buffer:{default:true},primitive:{default:"box",oneOf:a.geometryNames,schemaChange:true},skipCache:{default:false}},init:function(){(this||t).geometry=null},update:function(e){var n=(this||t).data;var r=(this||t).el;var a;var o=(this||t).system;if((this||t).geometry){o.unuseGeometry(e);(this||t).geometry=null}(this||t).geometry=o.getOrCreateGeometry(n);a=r.getObject3D("mesh");if(a)a.geometry=(this||t).geometry;else{a=new s.Mesh;a.geometry=(this||t).geometry;(this||t).el.getAttribute("material")||(a.material=new s.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5}));r.setObject3D("mesh",a)}},remove:function(){(this||t).system.unuseGeometry((this||t).data);(this||t).el.getObject3D("mesh").geometry=l;(this||t).geometry=null},updateSchema:function(e){var n=(this||t).oldData&&(this||t).oldData.primitive;var r=e.primitive;var s=a.geometries[r]&&a.geometries[r].schema;if(!s)throw new Error("Unknown geometry schema `"+r+"`");n&&n===r||this.extendSchema(s)}})},"./src/components/gltf-model.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./node_modules/three/examples/jsm/loaders/GLTFLoader.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l=o.debug("components:gltf-model:warn");var c=(0,a.registerComponent)("gltf-model",{schema:{type:"model"},init:function(){var e=this||t;var n=(this||t).system.getDRACOLoader();var r=(this||t).system.getMeshoptDecoder();var a=(this||t).system.getKTX2Loader();(this||t).model=null;(this||t).loader=new s.GLTFLoader;n&&(this||t).loader.setDRACOLoader(n);(this||t).ready=r?r.then((function(t){e.loader.setMeshoptDecoder(t)})):Promise.resolve();a&&(this||t).loader.setKTX2Loader(a)},update:function(){var e=this||t;var n=(this||t).el;var r=(this||t).data;if(r){this.remove();(this||t).ready.then((function(){e.loader.load(r,(function gltfLoaded(t){e.model=t.scene||t.scenes[0];e.model.animations=t.animations;n.setObject3D("mesh",e.model);n.emit("model-loaded",{format:"gltf",model:e.model})}),void 0,(function gltfFailed(e){var t=e&&e.message?e.message:"Failed to load glTF model";l(t);n.emit("model-error",{format:"gltf",src:r})}))}))}},remove:function(){(this||t).model&&(this||t).el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(e,n,r)=>{r.r(n);var s=r("./src/core/component.js");(0,s.registerComponent)("grabbable",{init:function(){(this||t).el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>d});var s=r("./node_modules/three/build/three.core.js");var a=r("./node_modules/three/examples/jsm/loaders/GLTFLoader.js");var o=r("./src/core/component.js");var l=r("./src/constants/index.js");var c={toonLeft:l.AFRAME_CDN_ROOT+"controllers/hands/leftHand.glb",toonRight:l.AFRAME_CDN_ROOT+"controllers/hands/rightHand.glb",lowPolyLeft:l.AFRAME_CDN_ROOT+"controllers/hands/leftHandLow.glb",lowPolyRight:l.AFRAME_CDN_ROOT+"controllers/hands/rightHandLow.glb",highPolyLeft:l.AFRAME_CDN_ROOT+"controllers/hands/leftHandHigh.glb",highPolyRight:l.AFRAME_CDN_ROOT+"controllers/hands/rightHandHigh.glb"};var u={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"};var h={};h[u.fist]="grip";h[u.thumbUp]="pistol";h[u.point]="pointing";var d=(0,o.registerComponent)("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var e=this||t;var n=(this||t).el;(this||t).pressedButtons={};(this||t).touchedButtons={};(this||t).loader=new a.GLTFLoader;(this||t).loader.setCrossOrigin("anonymous");(this||t).onGripDown=function(){e.handleButton("grip","down")};(this||t).onGripUp=function(){e.handleButton("grip","up")};(this||t).onTrackpadDown=function(){e.handleButton("trackpad","down")};(this||t).onTrackpadUp=function(){e.handleButton("trackpad","up")};(this||t).onTrackpadTouchStart=function(){e.handleButton("trackpad","touchstart")};(this||t).onTrackpadTouchEnd=function(){e.handleButton("trackpad","touchend")};(this||t).onTriggerDown=function(){e.handleButton("trigger","down")};(this||t).onTriggerUp=function(){e.handleButton("trigger","up")};(this||t).onTriggerTouchStart=function(){e.handleButton("trigger","touchstart")};(this||t).onTriggerTouchEnd=function(){e.handleButton("trigger","touchend")};(this||t).onGripTouchStart=function(){e.handleButton("grip","touchstart")};(this||t).onGripTouchEnd=function(){e.handleButton("grip","touchend")};(this||t).onThumbstickDown=function(){e.handleButton("thumbstick","down")};(this||t).onThumbstickUp=function(){e.handleButton("thumbstick","up")};(this||t).onAorXTouchStart=function(){e.handleButton("AorX","touchstart")};(this||t).onAorXTouchEnd=function(){e.handleButton("AorX","touchend")};(this||t).onBorYTouchStart=function(){e.handleButton("BorY","touchstart")};(this||t).onBorYTouchEnd=function(){e.handleButton("BorY","touchend")};(this||t).onSurfaceTouchStart=function(){e.handleButton("surface","touchstart")};(this||t).onSurfaceTouchEnd=function(){e.handleButton("surface","touchend")};(this||t).onControllerConnected=(this||t).onControllerConnected.bind(this||t);(this||t).onControllerDisconnected=(this||t).onControllerDisconnected.bind(this||t);n.addEventListener("controllerconnected",(this||t).onControllerConnected);n.addEventListener("controllerdisconnected",(this||t).onControllerDisconnected);n.object3D.visible=false},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(e,n){var r=(this||t).el.getObject3D("mesh");r&&r.mixer&&r.mixer.update(n/1e3)},onControllerConnected:function(e){var n=(this||t).el;var r=(this||t).data.hand;var s=(this||t).el.getObject3D("mesh");n.object3D.visible=true;var a=r==="left"?Math.PI/2:-Math.PI/2;var o=n.sceneEl.hasWebXR?-Math.PI/2:0;e.detail.name==="pico-controls"&&(o+=Math.PI/4);s.position.set(0,0,0);s.rotation.set(o,0,a)},onControllerDisconnected:function(){(this||t).el.object3D.visible=false},addEventListeners:function(){var e=(this||t).el;e.addEventListener("gripdown",(this||t).onGripDown);e.addEventListener("gripup",(this||t).onGripUp);e.addEventListener("trackpaddown",(this||t).onTrackpadDown);e.addEventListener("trackpadup",(this||t).onTrackpadUp);e.addEventListener("trackpadtouchstart",(this||t).onTrackpadTouchStart);e.addEventListener("trackpadtouchend",(this||t).onTrackpadTouchEnd);e.addEventListener("triggerdown",(this||t).onTriggerDown);e.addEventListener("triggerup",(this||t).onTriggerUp);e.addEventListener("triggertouchstart",(this||t).onTriggerTouchStart);e.addEventListener("triggertouchend",(this||t).onTriggerTouchEnd);e.addEventListener("griptouchstart",(this||t).onGripTouchStart);e.addEventListener("griptouchend",(this||t).onGripTouchEnd);e.addEventListener("thumbstickdown",(this||t).onThumbstickDown);e.addEventListener("thumbstickup",(this||t).onThumbstickUp);e.addEventListener("abuttontouchstart",(this||t).onAorXTouchStart);e.addEventListener("abuttontouchend",(this||t).onAorXTouchEnd);e.addEventListener("bbuttontouchstart",(this||t).onBorYTouchStart);e.addEventListener("bbuttontouchend",(this||t).onBorYTouchEnd);e.addEventListener("xbuttontouchstart",(this||t).onAorXTouchStart);e.addEventListener("xbuttontouchend",(this||t).onAorXTouchEnd);e.addEventListener("ybuttontouchstart",(this||t).onBorYTouchStart);e.addEventListener("ybuttontouchend",(this||t).onBorYTouchEnd);e.addEventListener("surfacetouchstart",(this||t).onSurfaceTouchStart);e.addEventListener("surfacetouchend",(this||t).onSurfaceTouchEnd)},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("gripdown",(this||t).onGripDown);e.removeEventListener("gripup",(this||t).onGripUp);e.removeEventListener("trackpaddown",(this||t).onTrackpadDown);e.removeEventListener("trackpadup",(this||t).onTrackpadUp);e.removeEventListener("trackpadtouchstart",(this||t).onTrackpadTouchStart);e.removeEventListener("trackpadtouchend",(this||t).onTrackpadTouchEnd);e.removeEventListener("triggerdown",(this||t).onTriggerDown);e.removeEventListener("triggerup",(this||t).onTriggerUp);e.removeEventListener("triggertouchstart",(this||t).onTriggerTouchStart);e.removeEventListener("triggertouchend",(this||t).onTriggerTouchEnd);e.removeEventListener("griptouchstart",(this||t).onGripTouchStart);e.removeEventListener("griptouchend",(this||t).onGripTouchEnd);e.removeEventListener("thumbstickdown",(this||t).onThumbstickDown);e.removeEventListener("thumbstickup",(this||t).onThumbstickUp);e.removeEventListener("abuttontouchstart",(this||t).onAorXTouchStart);e.removeEventListener("abuttontouchend",(this||t).onAorXTouchEnd);e.removeEventListener("bbuttontouchstart",(this||t).onBorYTouchStart);e.removeEventListener("bbuttontouchend",(this||t).onBorYTouchEnd);e.removeEventListener("xbuttontouchstart",(this||t).onAorXTouchStart);e.removeEventListener("xbuttontouchend",(this||t).onAorXTouchEnd);e.removeEventListener("ybuttontouchstart",(this||t).onBorYTouchStart);e.removeEventListener("ybuttontouchend",(this||t).onBorYTouchEnd);e.removeEventListener("surfacetouchstart",(this||t).onSurfaceTouchStart);e.removeEventListener("surfacetouchend",(this||t).onSurfaceTouchEnd)},update:function(e){var n;var r=(this||t).el;var a=(this||t).data.hand;var o=(this||t).data.handModelStyle;var l=(this||t).data.color;var u=this||t;n={hand:a,model:false};if(a!==e){var h=c[o+a.charAt(0).toUpperCase()+a.slice(1)];(this||t).loader.load(h,(function(e){var t=e.scene.children[0];t.mixer=new s.AnimationMixer(t);u.clips=e.animations;r.setObject3D("mesh",t);t.traverse((function(e){e.isMesh&&(e.material.color=new s.Color(l))}));r.setAttribute("magicleap-controls",n);r.setAttribute("vive-controls",n);r.setAttribute("meta-touch-controls",n);r.setAttribute("pico-controls",n);r.setAttribute("windows-motion-controls",n);r.setAttribute("hp-mixed-reality-controls",n)}))}},remove:function(){(this||t).el.removeObject3D("mesh")},
/**
           * Play model animation, based on which button was pressed and which kind of event.
           *
           * 1. Process buttons.
           * 2. Determine gesture (this.determineGesture()).
           * 3. Animation gesture (this.animationGesture()).
           * 4. Emit gesture events (this.emitGestureEvents()).
           *
           * @param {string} button - Name of the button.
           * @param {string} evt - Type of event for the button (i.e., down/up/touchstart/touchend).
           */
handleButton:function(e,n){var r;var s=n==="down";var a=n==="touchstart";if(n.indexOf("touch")===0){if(a===(this||t).touchedButtons[e])return;(this||t).touchedButtons[e]=a}else{if(s===(this||t).pressedButtons[e])return;(this||t).pressedButtons[e]=s}r=(this||t).gesture;(this||t).gesture=this.determineGesture();if((this||t).gesture!==r){this.animateGesture((this||t).gesture,r);this.emitGestureEvents((this||t).gesture,r)}},determineGesture:function(){var e;var n=(this||t).pressedButtons.grip;var r=(this||t).pressedButtons.surface||(this||t).touchedButtons.surface;var s=(this||t).pressedButtons.trackpad||(this||t).touchedButtons.trackpad;var a=(this||t).pressedButtons.trigger||(this||t).touchedButtons.trigger;var o=(this||t).touchedButtons.AorX||(this||t).touchedButtons.BorY;var l=isViveController((this||t).el.components["tracked-controls"]);l?n||a?e=u.fist:s&&(e=u.point):n?e=r||o||s?a?u.fist:u.point:a?u.thumbUp:u.pointThumb:a&&(e=u.hold);return e},getClip:function(e){var n;var r;for(r=0;r<(this||t).clips.length;r++){n=(this||t).clips[r];if(n.name===e)return n}},
/**
           * Play gesture animation.
           *
           * @param {string} gesture - Which pose to animate to. If absent, then animate to open.
           * @param {string} lastGesture - Previous gesture, to reverse back to open if needed.
           */
animateGesture:function(e,t){e?this.playAnimation(e||u.open,t,false):this.playAnimation(t,t,true)},emitGestureEvents:function(e,n){var r=(this||t).el;var s;if(n!==e){s=getGestureEventName(n,false);s&&r.emit(s);s=getGestureEventName(e,true);s&&r.emit(s)}},
/**
          * Play hand animation based on button state.
          *
          * @param {string} gesture - Name of the animation as specified by the model.
          * @param {string} lastGesture - Previous pose.
          * @param {boolean} reverse - Whether animation should play in reverse.
          */
playAnimation:function(e,n,r){var a;var o;var l=(this||t).el.getObject3D("mesh");var c;if(l){a=this.getClip(e);c=l.mixer.clipAction(a);if(r){c.paused=false;c.timeScale=-1}else{c.clampWhenFinished=true;c.loop=s.LoopOnce;c.repetitions=0;c.timeScale=1;c.time=0;c.weight=1;if(n){a=this.getClip(n);c.reset();c.play();o=l.mixer.clipAction(a);o.crossFadeTo(c,.15,true)}else{l.mixer.stopAllAction();c.play()}}}}});
/**
         * Suffix gestures based on toggle state (e.g., open/close, up/down, start/end).
         *
         * @param {string} gesture
         * @param {boolean} active
         */function getGestureEventName(e,t){var n;if(e){n=h[e];return n==="grip"?n+(t?"close":"open"):n==="point"?n+(t?"up":"down"):n==="pointing"||n==="pistol"?n+(t?"start":"end"):void 0}}function isViveController(e){var t=e&&e.controller;var n=t&&(t.id&&t.id.indexOf("OpenVR ")===0||t.profiles&&t.profiles[0]&&t.profiles[0]==="htc-vive");return n}},"./src/components/hand-tracking-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>b});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/core/a-entity.js");var l=r("./src/utils/tracked-controls.js");var c=r("./src/constants/index.js");var u=c.AFRAME_CDN_ROOT+"controllers/oculus-hands/v4/left.glb";var h=c.AFRAME_CDN_ROOT+"controllers/oculus-hands/v4/right.glb";var d=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"];var p=0;var f=4;var m=9;var g=.015;var y=.02;var b=(0,a.registerComponent)("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t)},addEventListeners:function(){(this||t).el.addEventListener("model-loaded",(this||t).onModelLoaded);for(var e=0;e<(this||t).jointEls.length;++e)(this||t).jointEls[e].object3D.visible=true},removeEventListeners:function(){(this||t).el.removeEventListener("model-loaded",(this||t).onModelLoaded);for(var e=0;e<(this||t).jointEls.length;++e)(this||t).jointEls[e].object3D.visible=false},init:function(){var e=(this||t).el.sceneEl;var n=e.getAttribute("webxr");var r=n.optionalFeatures;if(r.indexOf("hand-tracking")===-1){r.push("hand-tracking");e.setAttribute("webxr",n)}(this||t).wristObject3D=new s.Object3D;(this||t).el.sceneEl.object3D.add((this||t).wristObject3D);(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onChildAttached=(this||t).onChildAttached.bind(this||t);(this||t).jointEls=[];(this||t).controllerPresent=false;(this||t).isPinched=false;(this||t).pinchEventDetail={position:new s.Vector3,wristRotation:new s.Quaternion};(this||t).indexTipPosition=new s.Vector3;(this||t).hasPoses=false;(this||t).jointPoses=new Float32Array(16*d.length);(this||t).jointRadii=new Float32Array(d.length);this.bindMethods();(this||t).updateReferenceSpace=(this||t).updateReferenceSpace.bind(this||t);(this||t).el.sceneEl.addEventListener("enter-vr",(this||t).updateReferenceSpace);(this||t).el.sceneEl.addEventListener("exit-vr",(this||t).updateReferenceSpace);(this||t).el.addEventListener("child-attached",(this||t).onChildAttached);(this||t).wristObject3D.visible=false},onChildAttached:function(e){this.addChildEntity(e.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var e=(this||t).jointEls;var n=(this||t).skinnedMesh;var r=!((this||t).data.modelOpacity===1);if(n){(this||t).skinnedMesh.material.color.set((this||t).data.modelColor);(this||t).skinnedMesh.material.transparent=r;(this||t).skinnedMesh.material.opacity=(this||t).data.modelOpacity}for(var s=0;s<e.length;s++)e[s].setAttribute("material",{color:(this||t).data.modelColor,transparent:r,opacity:(this||t).data.modelOpacity})},updateReferenceSpace:function(){var e=this||t;var n=(this||t).el.sceneEl.xrSession;(this||t).referenceSpace=void 0;if(n){var r=e.el.sceneEl.systems.webxr.sessionReferenceSpaceType;n.requestReferenceSpace(r).then((function(t){e.referenceSpace=t})).catch((function(t){e.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(r,"tracked-controls-webxr uses reference space "+r);throw t}))}},checkIfControllerPresent:function(){var e=(this||t).data;var n=e.hand?e.hand:void 0;(0,l.checkControllerPresentAndSetup)(this||t,"",{hand:n,iterateControllerProfiles:true,handTracking:true})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},tick:function(){var e=(this||t).el.sceneEl;var n=(this||t).el.components["tracked-controls"]&&(this||t).el.components["tracked-controls"].controller;var r=e.frame;var s=(this||t).el.components["tracked-controls"];var a=(this||t).referenceSpace;if(n&&r&&a&&s){(this||t).hasPoses=false;if(n.hand){(this||t).el.object3D.position.set(0,0,0);(this||t).el.object3D.rotation.set(0,0,0);(this||t).hasPoses=r.fillPoses(n.hand.values(),a,(this||t).jointPoses)&&r.fillJointRadii(n.hand.values(),(this||t).jointRadii);this.updateHandModel();this.detectGesture();this.updateWristObject()}}},updateWristObject:function(){var e=new s.Matrix4;return function(){var n=(this||t).wristObject3D;if(n&&(this||t).hasPoses){e.fromArray((this||t).jointPoses,p*16);n.position.setFromMatrixPosition(e);n.quaternion.setFromRotationMatrix(e)}}}(),updateHandModel:function(){(this||t).wristObject3D.visible=true;(this||t).el.object3D.visible=true;(this||t).data.modelStyle==="dots"&&this.updateHandDotsModel();(this||t).data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(e){var n=(this||t).bones;for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},updateHandMeshModel:function(){var e=new s.Matrix4;return function(){var n=0;var r=(this||t).jointPoses;var s=(this||t).el.components["tracked-controls"]&&(this||t).el.components["tracked-controls"].controller;if(s&&(this||t).mesh){(this||t).mesh.visible=false;if((this||t).hasPoses)for(var a of s.hand.values()){var o=this.getBone(a.jointName);if(o!=null){(this||t).mesh.visible=true;e.fromArray(r,n*16);o.position.setFromMatrixPosition(e);o.quaternion.setFromRotationMatrix(e)}n++}}}}(),updateHandDotsModel:function(){var e=(this||t).jointPoses;var n=(this||t).jointRadii;var r=(this||t).el.components["tracked-controls"]&&(this||t).el.components["tracked-controls"].controller;var s;var a;for(var o=0;o<r.hand.size;o++){s=(this||t).jointEls[o];a=s.object3D;s.object3D.visible=(this||t).hasPoses;if((this||t).hasPoses){a.matrix.fromArray(e,o*16);a.matrix.decompose(a.position,a.rotation,a.scale);s.setAttribute("scale",{x:n[o],y:n[o],z:n[o]})}}},detectGesture:function(){this.detectPinch()},detectPinch:function(){var e=new s.Vector3;var n=new s.Matrix4;return function(){var r=(this||t).indexTipPosition;var s=(this||t).pinchEventDetail;if((this||t).hasPoses){e.setFromMatrixPosition(n.fromArray((this||t).jointPoses,f*16));r.setFromMatrixPosition(n.fromArray((this||t).jointPoses,m*16));s.wristRotation.setFromRotationMatrix(n.fromArray((this||t).jointPoses,p*16));var a=r.distanceTo(e);if(a<g&&(this||t).isPinched===false){(this||t).isPinched=true;s.position.copy(r).add(e).multiplyScalar(.5);(this||t).el.emit("pinchstarted",s)}if(a>y&&(this||t).isPinched===true){(this||t).isPinched=false;s.position.copy(r).add(e).multiplyScalar(.5);(this||t).el.emit("pinchended",s)}if((this||t).isPinched){s.position.copy(r).add(e).multiplyScalar(.5);(this||t).el.emit("pinchmoved",s)}}}}(),pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{id:"",hand:n.hand,iterateControllerProfiles:true,handTrackingEnabled:true});(this||t).mesh?(this||t).mesh!==e.getObject3D("mesh")&&e.setObject3D("mesh",(this||t).mesh):this.initDefaultModel()},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){var e=(this||t).el;var n;this.checkIfControllerPresent();n=e.components["tracked-controls"]&&e.components["tracked-controls"].controller;(this||t).mesh&&n&&n.hand&&n.hand instanceof XRHand&&e.setObject3D("mesh",(this||t).mesh)},initDefaultModel:function(){var e=(this||t).data;e.modelStyle==="dots"&&this.initDotsModel();e.modelStyle==="mesh"&&this.initMeshHandModel();(this||t).el.object3D.visible=true;(this||t).wristObject3D.visible=true},initDotsModel:function(){if((this||t).jointEls.length===0){for(var e=0;e<d.length;++e){var n=(this||t).jointEl=document.createElement("a-entity");n.setAttribute("geometry",{primitive:"sphere",radius:1});n.object3D.visible=false;(this||t).el.appendChild(n);(this||t).jointEls.push(n)}this.updateModelMaterial()}},initMeshHandModel:function(){var e=(this||t).data.hand==="left"?u:h;(this||t).el.setAttribute("gltf-model",e)},onModelLoaded:function(){var e=(this||t).mesh=(this||t).el.getObject3D("mesh").children[0];var n=(this||t).skinnedMesh=e.getObjectByProperty("type","SkinnedMesh");if((this||t).skinnedMesh){(this||t).bones=n.skeleton.bones;(this||t).el.removeObject3D("mesh");e.position.set(0,0,0);e.rotation.set(0,0,0);n.frustumCulled=false;n.material=new s.MeshStandardMaterial;this.updateModelMaterial();this.setupChildrenEntities();(this||t).el.setObject3D("mesh",e)}},setupChildrenEntities:function(){var e=(this||t).el.children;for(var n=0;n<e.length;++n)e[n]instanceof o.AEntity&&this.addChildEntity(e[n])},addChildEntity:function(e){e instanceof o.AEntity&&(this||t).wristObject3D.add(e.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(e,n,r)=>{r.r(n);var s=r("./src/core/component.js");var a=r("./node_modules/three/build/three.core.js");(0,s.registerComponent)("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:false}},init:function(){var e=(this||t).el;var n=(this||t).data;var r;r=n.hand==="right"?"components.hand-tracking-controls.bones.3":"components.hand-tracking-controls.bones.21";e.setAttribute("hand-tracking-controls",{hand:n.hand});e.setAttribute("obb-collider",{trackedObject3D:r,size:.04});(this||t).auxMatrix=new a.Matrix4;(this||t).onCollisionStarted=(this||t).onCollisionStarted.bind(this||t);(this||t).el.addEventListener("obbcollisionstarted",(this||t).onCollisionStarted);(this||t).onCollisionEnded=(this||t).onCollisionEnded.bind(this||t);(this||t).el.addEventListener("obbcollisionended",(this||t).onCollisionEnded);(this||t).onPinchStarted=(this||t).onPinchStarted.bind(this||t);(this||t).el.addEventListener("pinchstarted",(this||t).onPinchStarted);(this||t).onPinchEnded=(this||t).onPinchEnded.bind(this||t);(this||t).el.addEventListener("pinchended",(this||t).onPinchEnded)},transferEntityOwnership:function(){var e;var n=(this||t).el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]");for(var r=0;r<n.length;++r){e=n[r].components["hand-tracking-grab-controls"];e!==(this||t)&&((this||t).grabbedEl&&(this||t).grabbedEl===e.grabbedEl&&e.releaseGrabbedEntity())}return false},onCollisionStarted:function(e){var n=e.detail.withEl;if(!(this||t).collidedEl&&n.getAttribute("grabbable")){(this||t).collidedEl=n;(this||t).grabbingObject3D=e.detail.trackedObject3D;(this||t).data.hoverEnabled&&(this||t).el.setAttribute("hand-tracking-controls","modelColor",(this||t).data.hoverColor)}},onCollisionEnded:function(){(this||t).collidedEl=void 0;if(!(this||t).grabbedEl){(this||t).grabbingObject3D=void 0;(this||t).data.hoverEnabled&&(this||t).el.setAttribute("hand-tracking-controls","modelColor",(this||t).data.color)}},onPinchStarted:function(e){if((this||t).collidedEl){(this||t).grabbedEl=(this||t).collidedEl;this.transferEntityOwnership();this.grab()}},onPinchEnded:function(){this.releaseGrabbedEntity()},releaseGrabbedEntity:function(){var e=(this||t).grabbedEl;if(e){var n=e.object3D;var r=n.parent;var s=(this||t).originalParent;n.applyMatrix4(r.matrixWorld);n.applyMatrix4((this||t).auxMatrix.copy(s.matrixWorld).invert());r.remove(n);s.add(n);(this||t).el.emit("grabended",{grabbedEl:e});(this||t).grabbedEl=void 0;(this||t).originalParent=void 0}},grab:function(){var e=(this||t).grabbedEl;var n=e.object3D;var r=n.parent;(this||t).originalParent=r;var s=(this||t).el.components["hand-tracking-controls"].wristObject3D;n.applyMatrix4(r.matrixWorld);n.applyMatrix4((this||t).auxMatrix.copy(s.matrixWorld).invert());r.remove(n);s.add(n);(this||t).el.emit("grabstarted",{grabbedEl:e})}})},"./src/components/hide-on-enter-ar.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>a});var s=r("./src/core/component.js");var a=(0,s.registerComponent)("hide-on-enter-ar",{init:function(){var e=this||t;(this||t).el.sceneEl.addEventListener("enter-vr",(function(){e.el.sceneEl.is("ar-mode")&&(e.el.object3D.visible=false)}));(this||t).el.sceneEl.addEventListener("exit-vr",(function(){e.el.object3D.visible=true}))}})},"./src/components/hide-on-enter-vr.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>a});var s=r("./src/core/component.js");var a=(0,s.registerComponent)("hide-on-enter-vr",{init:function(){var e=this||t;(this||t).el.sceneEl.addEventListener("enter-vr",(function(){e.el.sceneEl.is("vr-mode")&&(e.el.object3D.visible=false)}));(this||t).el.sceneEl.addEventListener("exit-vr",(function(){e.el.object3D.visible=true}))}})},"./src/components/hp-mixed-reality-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>f});var s=r("./src/core/component.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./src/constants/index.js");var l=r("./src/utils/tracked-controls.js");var c="hp-mixed-reality";var u=o.AFRAME_CDN_ROOT+"controllers/hp/mixed-reality/";var h={x:0,y:0,z:.06};var d={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"};var p={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};var f=(0,s.registerComponent)("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:true}},mapping:p,init:function(){var e=this||t;(this||t).controllerPresent=false;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,l.onButtonEvent)(t.detail.id,"down",e,e.data.hand)};(this||t).onButtonUp=function(t){(0,l.onButtonEvent)(t.detail.id,"up",e,e.data.hand)};(this||t).onButtonTouchEnd=function(t){(0,l.onButtonEvent)(t.detail.id,"touchend",e,e.data.hand)};(this||t).onButtonTouchStart=function(t){(0,l.onButtonEvent)(t.detail.id,"touchstart",e,e.data.hand)};(this||t).previousButtonValues={};this.bindMethods()},update:function(){var e=(this||t).data;(this||t).controllerIndex=e.hand==="right"?0:e.hand==="left"?1:2},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);e.addEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);e.removeEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).data;(0,l.checkControllerPresentAndSetup)(this||t,c,{index:(this||t).controllerIndex,hand:e.hand})},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{idPrefix:c,hand:n.hand,controller:(this||t).controllerIndex});(this||t).data.model&&(this||t).el.setAttribute("gltf-model",u+(this||t).data.hand+".glb")},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping[(this||t).data.hand].buttons[e.detail.id];var r;if(n){if(n==="trigger"){r=e.detail.state.value;console.log("analog value of trigger press: "+r)}(this||t).el.emit(n+"changed",e.detail.state)}},onModelLoaded:function(e){var n=e.detail.model;if((this||t).data.model){n.position.copy(h);n.rotation.copy(d);(this||t).el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:(this||t).data.model,rayOrigin:new a.Vector3(0,0,0)})}},onAxisMoved:function(e){(0,l.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)}})},"./src/components/index.js":(e,t,n)=>{n.r(t);n("./src/components/animation.js");n("./src/components/anchored.js");n("./src/components/camera.js");n("./src/components/cursor.js");n("./src/components/geometry.js");n("./src/components/generic-tracked-controller-controls.js");n("./src/components/gltf-model.js");n("./src/components/grabbable.js");n("./src/components/hand-tracking-controls.js");n("./src/components/hand-tracking-grab-controls.js");n("./src/components/hand-controls.js");n("./src/components/hide-on-enter-ar.js");n("./src/components/hide-on-enter-vr.js");n("./src/components/hp-mixed-reality-controls.js");n("./src/components/layer.js");n("./src/components/laser-controls.js");n("./src/components/light.js");n("./src/components/line.js");n("./src/components/link.js");n("./src/components/logitech-mx-ink-controls.js");n("./src/components/look-controls.js");n("./src/components/magicleap-controls.js");n("./src/components/material.js");n("./src/components/meta-touch-controls.js");n("./src/components/obb-collider.js");n("./src/components/obj-model.js");n("./src/components/oculus-go-controls.js");n("./src/components/pico-controls.js");n("./src/components/position.js");n("./src/components/raycaster.js");n("./src/components/rotation.js");n("./src/components/scale.js");n("./src/components/shadow.js");n("./src/components/sound.js");n("./src/components/text.js");n("./src/components/tracked-controls.js");n("./src/components/visible.js");n("./src/components/valve-index-controls.js");n("./src/components/vive-controls.js");n("./src/components/vive-focus-controls.js");n("./src/components/wasd-controls.js");n("./src/components/windows-motion-controls.js");n("./src/components/scene/ar-hit-test.js");n("./src/components/scene/background.js");n("./src/components/scene/debug.js");n("./src/components/scene/device-orientation-permission-ui.js");n("./src/components/scene/embedded.js");n("./src/components/scene/inspector.js");n("./src/components/scene/fog.js");n("./src/components/scene/keyboard-shortcuts.js");n("./src/components/scene/pool.js");n("./src/components/scene/real-world-meshing.js");n("./src/components/scene/reflection.js");n("./src/components/scene/screenshot.js");n("./src/components/scene/stats.js");n("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(e,n,r)=>{r.r(n);var s=r("./src/core/component.js");var a=r("./src/utils/index.js");(0,s.registerComponent)("laser-controls",{schema:{hand:{default:"right"},model:{default:true},defaultModelColor:{type:"color",default:"grey"}},init:function(){var e=(this||t).config;var n=(this||t).data;var r=(this||t).el;var s=this||t;var o={hand:n.hand,model:n.model};r.setAttribute("hp-mixed-reality-controls",o);r.setAttribute("magicleap-controls",o);r.setAttribute("oculus-go-controls",o);r.setAttribute("meta-touch-controls",o);r.setAttribute("pico-controls",o);r.setAttribute("valve-index-controls",o);r.setAttribute("vive-controls",o);r.setAttribute("vive-focus-controls",o);r.setAttribute("windows-motion-controls",o);r.setAttribute("generic-tracked-controller-controls",{hand:o.hand});r.addEventListener("controllerconnected",createRay);r.addEventListener("controllerdisconnected",hideRay);r.addEventListener("controllermodelready",(function(e){createRay(e);s.modelReady=true}));function createRay(t){var n=e[t.detail.name];if(n){var o=a.extend({showLine:true},n.raycaster||{});if(t.detail.rayOrigin){o.origin=t.detail.rayOrigin.origin;o.direction=t.detail.rayOrigin.direction;o.showLine=true}t.detail.rayOrigin||!s.modelReady?r.setAttribute("raycaster",o):r.setAttribute("raycaster","showLine",true);r.setAttribute("cursor",a.extend({fuse:false},n.cursor))}}function hideRay(t){var n=e[t.detail.name];n&&r.setAttribute("raycaster","showLine",false)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"meta-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:false}}}})},"./src/components/layer.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l=o.debug("components:layer:warn");var c=(0,a.registerComponent)("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:false},width:{default:0},height:{default:0}},init:function(){var e=(this||t).el.sceneEl.renderer.getContext();(this||t).quaternion=new s.Quaternion;(this||t).position=new s.Vector3;this.bindMethods();(this||t).needsRedraw=false;(this||t).frameBuffer=e.createFramebuffer();var n=(this||t).el.sceneEl.getAttribute("webxr");var r=n.requiredFeatures;if(r.indexOf("layers")===-1){r.push("layers");(this||t).el.sceneEl.setAttribute("webxr",n)}(this||t).el.sceneEl.addEventListener("enter-vr",(this||t).onEnterVR);(this||t).el.sceneEl.addEventListener("exit-vr",(this||t).onExitVR)},bindMethods:function(){(this||t).onRequestedReferenceSpace=(this||t).onRequestedReferenceSpace.bind(this||t);(this||t).onEnterVR=(this||t).onEnterVR.bind(this||t);(this||t).onExitVR=(this||t).onExitVR.bind(this||t)},update:function(e){(this||t).data.src!==e.src&&this.updateSrc()},updateSrc:function(){var e=(this||t).data.type;(this||t).texture=void 0;e!=="quad"?e!=="monocubemap"&&e!=="stereocubemap"||this.loadCubeMapImages():this.loadQuadImage()},loadCubeMapImages:function(){var e;var n=(this||t).xrGLFactory;var r=(this||t).el.sceneEl.frame;var s=(this||t).data.src;var a=(this||t).data.type;(this||t).visibilityChanged=false;if((this||t).layer&&(a==="monocubemap"||a==="stereocubemap")){s.complete?(this||t).pendingCubeMapUpdate=false:(this||t).pendingCubeMapUpdate=true;(this||t).loadingScreen?(this||t).loadingScreen=false:(this||t).loadingScreen=true;if(a==="monocubemap"){e=n.getSubImage((this||t).layer,r);this.loadCubeMapImage(e.colorTexture,s,0)}else{e=n.getSubImage((this||t).layer,r,"left");this.loadCubeMapImage(e.colorTexture,s,0);e=n.getSubImage((this||t).layer,r,"right");this.loadCubeMapImage(e.colorTexture,s,6)}}},loadQuadImage:function(){var e=(this||t).data.src;var n=this||t;(this||t).el.sceneEl.systems.material.loadTexture(e,{src:e},(function textureLoaded(t){n.el.sceneEl.renderer.initTexture(t);n.texture=t;e.tagName==="VIDEO"&&setTimeout((function(){n.textureIsVideo=true}),1e3);if(n.layer){n.layer.height=n.data.height/2||n.texture.image.height/1e3;n.layer.width=n.data.width/2||n.texture.image.width/1e3;n.needsRedraw=true}n.updateQuadPanel()}))},preGenerateCubeMapTextures:function(e,n){if((this||t).data.type==="monocubemap")this.generateCubeMapTextures(e,0,n);else{this.generateCubeMapTextures(e,0,n);this.generateCubeMapTextures(e,6,n)}},generateCubeMapTextures:function(e,n,r){var s=(this||t).data;var a=(this||t).cubeFaceSize;var o=Math.min(e.width,e.height);var l=[];var c;var u;for(var h=0;h<6;h++){var d=document.createElement("CANVAS");d.width=d.height=a;var p=d.getContext("2d");if(s.rotateCubemap&&(h===2||h===3)){p.save();p.translate(a,a);p.rotate(Math.PI)}p.drawImage(e,(h+n)*o,0,o,o,0,0,a,a);p.restore();r&&r();l.push(d)}if(s.rotateCubemap){c=l[0];u=l[1];l[0]=u;l[1]=c;c=l[4];u=l[5];l[4]=u;l[5]=c}r&&r();return l},loadCubeMapImage:function(e,n,r){var s=(this||t).el.sceneEl.renderer.getContext();var a;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,false);s.bindTexture(s.TEXTURE_CUBE_MAP,e);a=!n.complete||(this||t).loadingScreen?(this||t).loadingScreenImages:this.generateCubeMapTextures(n,r);var o=0;a.forEach((function(e,t){s.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,s.RGBA,s.UNSIGNED_BYTE,e);o=s.getError()}));o!==0&&console.log("renderingError, WebGL Error Code: "+o);s.bindTexture(s.TEXTURE_CUBE_MAP,null)},tick:function(){if((this||t).el.sceneEl.xrSession&&(this||t).referenceSpace){(this||t).layer||!(this||t).el.sceneEl.is("vr-mode")&&!(this||t).el.sceneEl.is("ar-mode")||this.initLayer();this.updateTransform();(this||t).data.src.complete&&((this||t).pendingCubeMapUpdate||(this||t).loadingScreen||(this||t).visibilityChanged)&&this.loadCubeMapImages();if((this||t).needsRedraw||(this||t).layer.needsRedraw||(this||t).textureIsVideo){(this||t).data.type==="quad"&&this.draw();(this||t).needsRedraw=false}}},initLayer:function(){var e=this||t;var n=(this||t).data.type;(this||t).el.sceneEl.xrSession.onvisibilitychange=function(t){e.visibilityChanged=t.session.visibilityState!=="hidden"};n!=="quad"?n!=="monocubemap"&&n!=="stereocubemap"||this.initCubeMapLayer():this.initQuadLayer()},initQuadLayer:function(){var e=(this||t).el.sceneEl;var n=e.renderer.getContext();var r=(this||t).xrGLFactory=new XRWebGLBinding(e.xrSession,n);if((this||t).texture){(this||t).layer=r.createQuadLayer({space:(this||t).referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:(this||t).data.height/2||(this||t).texture.image.height/1e3,width:(this||t).data.width/2||(this||t).texture.image.width/1e3});this.initLoadingScreenImages();e.renderer.xr.addLayer((this||t).layer)}},initCubeMapLayer:function(){var e=(this||t).data.src;var n=(this||t).el.sceneEl;var r=n.renderer.getContext();var s=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE);var a=(this||t).cubeFaceSize=Math.min(s,Math.min(e.width,e.height));var o=(this||t).xrGLFactory=new XRWebGLBinding(n.xrSession,r);(this||t).layer=o.createCubeLayer({space:(this||t).referenceSpace,viewPixelWidth:a,viewPixelHeight:a,layout:(this||t).data.type==="monocubemap"?"mono":"stereo",isStatic:false});this.initLoadingScreenImages();this.loadCubeMapImages();n.renderer.xr.addLayer((this||t).layer)},initLoadingScreenImages:function(){var e=(this||t).cubeFaceSize;var n=(this||t).loadingScreenImages=[];for(var r=0;r<6;r++){var s=document.createElement("CANVAS");s.width=s.height=e;var a=s.getContext("2d");s.width=s.height=e;a.fillStyle="black";a.fillRect(0,0,e,e);if(r!==2&&r!==3){a.translate(e,0);a.scale(-1,1);a.fillStyle="white";a.font="30px Arial";a.fillText("Loading",e/2,e/2)}n.push(s)}},destroyLayer:function(){if((this||t).layer){(this||t).el.sceneEl.renderer.xr.removeLayer((this||t).layer);(this||t).layer.destroy();(this||t).layer=void 0}},toggleCompositorLayer:function(){this.enableCompositorLayer(!(this||t).layerEnabled)},enableCompositorLayer:function(e){(this||t).layerEnabled=e;(this||t).quadPanelEl.object3D.visible=!(this||t).layerEnabled},updateQuadPanel:function(){var e=(this||t).quadPanelEl;if(!(this||t).quadPanelEl){e=(this||t).quadPanelEl=document.createElement("a-entity");(this||t).el.appendChild(e)}e.setAttribute("material",{shader:"flat",src:(this||t).data.src,transparent:true});e.setAttribute("geometry",{primitive:"plane",height:(this||t).data.height||(this||t).texture.image.height/1e3,width:(this||t).data.width||(this||t).texture.image.height/1e3})},draw:function(){var e=(this||t).el.sceneEl;var n=(this||t).el.sceneEl.renderer.getContext();var r=(this||t).xrGLFactory.getSubImage((this||t).layer,e.frame);var s=e.renderer.properties.get((this||t).texture).__webglTexture;var a=n.getParameter(n.FRAMEBUFFER_BINDING);n.viewport(r.viewport.x,r.viewport.y,r.viewport.width,r.viewport.height);n.bindFramebuffer(n.FRAMEBUFFER,(this||t).frameBuffer);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r.colorTexture,0);blitTexture(n,s,r,(this||t).data.src);n.bindFramebuffer(n.FRAMEBUFFER,a)},updateTransform:function(){var e=(this||t).el;var n=(this||t).position;var r=(this||t).quaternion;e.object3D.updateMatrixWorld();n.setFromMatrixPosition(e.object3D.matrixWorld);r.setFromRotationMatrix(e.object3D.matrixWorld);(this||t).layerEnabled||n.set(0,0,1e8);(this||t).layer.transform=new XRRigidTransform(n,r)},onEnterVR:function(){var e=(this||t).el.sceneEl;var n=e.xrSession;if(e.hasWebXR&&XRWebGLBinding&&n){n.requestReferenceSpace("local-floor").then((this||t).onRequestedReferenceSpace);(this||t).layerEnabled=true;(this||t).quadPanelEl&&((this||t).quadPanelEl.object3D.visible=false);(this||t).data.src.play&&(this||t).data.src.play()}else l("The layer component requires WebXR and the layers API enabled")},onExitVR:function(){(this||t).quadPanelEl&&((this||t).quadPanelEl.object3D.visible=true);this.destroyLayer()},onRequestedReferenceSpace:function(e){(this||t).referenceSpace=e}});function blitTexture(e,t,n,r){var s=e.createFramebuffer();var a=n.viewport.x;var o=n.viewport.y;var l=n.viewport.x+n.viewport.width;var c=n.viewport.y+n.viewport.height;if(r.tagName==="VIDEO"){e.bindTexture(e.TEXTURE_2D,t);e.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,e.RGB,e.UNSIGNED_BYTE,r)}e.bindFramebuffer(e.READ_FRAMEBUFFER,s);e.framebufferTexture2D(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);e.readBuffer(e.COLOR_ATTACHMENT0);e.blitFramebuffer(0,0,r.width,r.height,a,o,l,c,e.COLOR_BUFFER_BIT,e.NEAREST);e.bindFramebuffer(e.READ_FRAMEBUFFER,null);e.deleteFramebuffer(s)}},"./src/components/light.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>f});var s=r("./node_modules/three/build/three.core.js");var a=r("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js");var o=r("./src/utils/index.js");var l=r("./src/core/component.js");var c=r("./src/utils/math.js");var u=s.MathUtils.degToRad;var h=(0,o.debug)("components:light:warn");var d=new s.CubeTextureLoader;var p={};var f=(0,l.registerComponent)("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:3.14,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:true},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:false,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:true}},shadowCameraFar:{default:500,if:{castShadow:true}},shadowCameraFov:{default:90,if:{castShadow:true}},shadowCameraNear:{default:.5,if:{castShadow:true}},shadowCameraTop:{default:5,if:{castShadow:true}},shadowCameraRight:{default:5,if:{castShadow:true}},shadowCameraBottom:{default:-5,if:{castShadow:true}},shadowCameraLeft:{default:-5,if:{castShadow:true}},shadowCameraVisible:{default:false,if:{castShadow:true}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:true}},shadowMapWidth:{default:512,if:{castShadow:true}},shadowRadius:{default:1,if:{castShadow:true}}},init:function(){var e=(this||t).el;(this||t).light=null;(this||t).defaultTarget=null;(this||t).system.registerLight(e)},update:function(e){var n=(this||t).data;var r=(0,o.diff)(n,e);var s=(this||t).light;var a=this||t;if(!s||"type"in r){this.setLight((this||t).data);this.updateShadow()}else{var l=false;Object.keys(r).forEach((function(e){var t=n[e];switch(e){case"color":s.color.set(t);break;case"groundColor":s.groundColor.set(t);break;case"angle":s.angle=u(t);break;case"target":t===null?n.type!=="spot"&&n.type!=="directional"||(s.target=a.defaultTarget):t.hasLoaded?a.onSetTarget(t,s):t.addEventListener("loaded",a.onSetTarget.bind(a,t,s));break;case"envMap":a.updateProbeMap(n,s);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":if(!l){a.updateShadow();l=true}break;case"shadowCameraAutomatic":n.shadowCameraAutomatic?a.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(n.shadowCameraAutomatic)):a.shadowCameraAutomaticEls=[];break;default:s[e]=t}}))}},tick:function(){var e=new s.Box3;var n=new s.Vector3;var r=new s.Vector3;var a=new s.Matrix4;var o=new s.Sphere;var l=new s.Vector3;return function(){if((this||t).data.type==="directional"&&(this||t).light.shadow&&(this||t).light.shadow.camera instanceof s.OrthographicCamera&&(this||t).shadowCameraAutomaticEls.length){var u=(this||t).light.shadow.camera;u.getWorldDirection(n);u.getWorldPosition(r);a.copy(u.matrixWorld);a.invert();u.near=1;u.left=1e5;u.right=-1e5;u.top=-1e5;u.bottom=1e5;(this||t).shadowCameraAutomaticEls.forEach((function(t){e.setFromObject(t.object3D);e.getBoundingSphere(o);var s=c.distanceOfPointFromPlane(r,n,o.center);var h=c.nearestPointInPlane(r,n,o.center,l);var d=h.applyMatrix4(a);u.near=Math.min(-s-o.radius-1,u.near);u.left=Math.min(-o.radius+d.x,u.left);u.right=Math.max(o.radius+d.x,u.right);u.top=Math.max(o.radius+d.y,u.top);u.bottom=Math.min(-o.radius+d.y,u.bottom)}));u.updateProjectionMatrix()}}}(),setLight:function(e){var n=(this||t).el;var r=this.getLight(e);if(r){(this||t).light&&n.removeObject3D("light");(this||t).light=r;(this||t).light.el=n;n.setObject3D("light",(this||t).light);e.type!=="spot"&&e.type!=="directional"&&e.type!=="hemisphere"||n.getObject3D("light").translateY(-1);if(e.type==="spot"){n.setObject3D("light-target",(this||t).defaultTarget);n.getObject3D("light-target").position.set(0,0,-1)}e.shadowCameraAutomatic?(this||t).shadowCameraAutomaticEls=Array.from(document.querySelectorAll(e.shadowCameraAutomatic)):(this||t).shadowCameraAutomaticEls=[]}},updateShadow:function(){var e=(this||t).el;var n=(this||t).data;var r=(this||t).light;r.castShadow=n.castShadow;var a=e.getObject3D("cameraHelper");if(n.shadowCameraVisible&&!a){a=new s.CameraHelper(r.shadow.camera);e.setObject3D("cameraHelper",a)}else!n.shadowCameraVisible&&a&&e.removeObject3D("cameraHelper");if(!n.castShadow)return r;r.shadow.bias=n.shadowBias;r.shadow.radius=n.shadowRadius;r.shadow.mapSize.height=n.shadowMapHeight;r.shadow.mapSize.width=n.shadowMapWidth;r.shadow.camera.near=n.shadowCameraNear;r.shadow.camera.far=n.shadowCameraFar;if(r.shadow.camera instanceof s.OrthographicCamera){r.shadow.camera.top=n.shadowCameraTop;r.shadow.camera.right=n.shadowCameraRight;r.shadow.camera.bottom=n.shadowCameraBottom;r.shadow.camera.left=n.shadowCameraLeft}else r.shadow.camera.fov=n.shadowCameraFov;r.shadow.camera.updateProjectionMatrix();a&&a.update()},
/**
           * Creates a new three.js light object given data object defining the light.
           *
           * @param {object} data
           */
getLight:function(e){var n=e.angle;var r=new s.Color(e.color);r=r.getHex();var a=e.decay;var o=e.distance;var l=new s.Color(e.groundColor);l=l.getHex();var c=e.intensity;var d=e.type;var p=e.target;var f=null;switch(d.toLowerCase()){case"ambient":return new s.AmbientLight(r,c);case"directional":f=new s.DirectionalLight(r,c);(this||t).defaultTarget=f.target;p&&(p.hasLoaded?this.onSetTarget(p,f):p.addEventListener("loaded",(this||t).onSetTarget.bind(this||t,p,f)));return f;case"hemisphere":return new s.HemisphereLight(r,l,c);case"point":return new s.PointLight(r,c,o,a);case"spot":f=new s.SpotLight(r,c,o,u(n),e.penumbra,a);(this||t).defaultTarget=f.target;p&&(p.hasLoaded?this.onSetTarget(p,f):p.addEventListener("loaded",(this||t).onSetTarget.bind(this||t,p,f)));return f;case"probe":f=new s.LightProbe;this.updateProbeMap(e,f);return f;default:h("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",d)}},updateProbeMap:function(e,t){if(e.envMap){p[e.envMap]===void 0&&(p[e.envMap]=new window.Promise((function(t){o.srcLoader.validateCubemapSrc(e.envMap,(function loadEnvMap(n){d.load(n,(function(n){var r=a.LightProbeGenerator.fromCubeTexture(n);p[e.envMap]=r;t(r)}))}))})));p[e.envMap]instanceof window.Promise?p[e.envMap].then((function(e){t.copy(e)})):p[e.envMap]instanceof s.LightProbe&&t.copy(p[e.envMap])}else t.copy(new s.LightProbe)},onSetTarget:function(e,t){t.target=e.object3D},remove:function(){var e=(this||t).el;e.removeObject3D("light");e.getObject3D("cameraHelper")&&e.removeObject3D("cameraHelper")}})},"./src/components/line.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=(0,a.registerComponent)("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:true}},multiple:true,init:function(){var e=(this||t).data;var n;var r;r=(this||t).material=new s.LineBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.opacity<1,visible:e.visible});n=(this||t).geometry=new s.BufferGeometry;n.setAttribute("position",new s.BufferAttribute(new Float32Array(6),3));(this||t).line=new s.Line(n,r);(this||t).el.setObject3D((this||t).attrName,(this||t).line)},update:function(e){var n=(this||t).data;var r=(this||t).geometry;var s=false;var a=(this||t).material;var o=r.attributes.position.array;if(!isEqualVec3(n.start,e.start)){o[0]=n.start.x;o[1]=n.start.y;o[2]=n.start.z;s=true}if(!isEqualVec3(n.end,e.end)){o[3]=n.end.x;o[4]=n.end.y;o[5]=n.end.z;s=true}if(s){r.attributes.position.needsUpdate=true;r.computeBoundingSphere()}a.color.setStyle(n.color);a.opacity=n.opacity;a.transparent=n.opacity<1;a.visible=n.visible},remove:function(){(this||t).el.removeObject3D((this||t).attrName,(this||t).line)}});function isEqualVec3(e,t){return!(!e||!t)&&(e.x===t.x&&e.y===t.y&&e.z===t.z)}},"./src/components/link.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/core/shader.js");var l=15;var c=(0,a.registerComponent)("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:false},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:false},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:false}},init:function(){(this||t).navigate=(this||t).navigate.bind(this||t);(this||t).previousQuaternion=void 0;(this||t).quaternionClone=new s.Quaternion;(this||t).hiddenEls=[]},update:function(e){var n=(this||t).data;var r=(this||t).el;var s;var a;if(n.visualAspectEnabled){var o=(this||t).el.getAttribute("scale");(this||t).previewDistance=l*(o.x+o.y)/2;this.initVisualAspect();s=n.highlighted?n.highlightedColor:n.backgroundColor;a=n.highlighted?n.highlightedColor:n.borderColor;r.setAttribute("material","backgroundColor",s);r.setAttribute("material","strokeColor",a);n.on!==e.on&&this.updateEventListener();e.peekMode!==void 0&&n.peekMode!==e.peekMode&&this.updatePeekMode();n.image&&e.image!==n.image&&r.setAttribute("material","pano",typeof n.image==="string"?n.image:n.image.src)}},updatePeekMode:function(){var e=(this||t).el;var n=(this||t).sphereEl;if((this||t).data.peekMode){this.hideAll();e.getObject3D("mesh").visible=false;n.setAttribute("visible",true)}else{this.showAll();e.getObject3D("mesh").visible=true;n.setAttribute("visible",false)}},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var e=(this||t).el;if(e.isPlaying){this.removeEventListener();e.addEventListener((this||t).data.on,(this||t).navigate)}},removeEventListener:function(){var e=(this||t).data.on;e&&(this||t).el.removeEventListener(e,(this||t).navigate)},initVisualAspect:function(){var e=(this||t).el;var n;var r;var s;if((this||t).data.visualAspectEnabled&&!(this||t).visualAspectInitialized){s=(this||t).textEl=(this||t).textEl||document.createElement("a-entity");r=(this||t).sphereEl=(this||t).sphereEl||document.createElement("a-entity");n=(this||t).semiSphereEl=(this||t).semiSphereEl||document.createElement("a-entity");e.setAttribute("geometry",{primitive:"circle",radius:1,segments:64});e.setAttribute("material",{shader:"portal",pano:(this||t).data.image,side:"double",previewDistance:(this||t).previewDistance});s.setAttribute("text",{color:(this||t).data.titleColor,align:"center",font:"kelsonsans",value:(this||t).data.title||(this||t).data.href,width:4});s.setAttribute("position","0 1.5 0");e.appendChild(s);n.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360});n.setAttribute("material",{shader:"portal",borderEnabled:0,pano:(this||t).data.image,side:"back",previewDistance:(this||t).previewDistance});n.setAttribute("rotation","0 180 0");n.setAttribute("position","0 0 0");n.setAttribute("visible",false);e.appendChild(n);r.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64});r.setAttribute("material",{shader:"portal",borderEnabled:0,pano:(this||t).data.image,side:"back",previewDistance:(this||t).previewDistance});r.setAttribute("visible",false);e.appendChild(r);(this||t).visualAspectInitialized=true}},navigate:function(){window.location=(this||t).data.href},tick:function(){var e=new s.Vector3;var n=new s.Vector3;var r=new s.Quaternion;var a=new s.Vector3;return function(){var s=(this||t).el;var o=s.object3D;var l=s.sceneEl.camera;var c;var u;var h=(this||t).textEl;if((this||t).data.visualAspectEnabled){o.updateMatrixWorld();l.parent.updateMatrixWorld();l.updateMatrixWorld();o.matrix.decompose(n,r,a);n.setFromMatrixPosition(o.matrixWorld);e.setFromMatrixPosition(l.matrixWorld);u=n.distanceTo(e);if(u>(this||t).previewDistance*1.33333){if(!(this||t).previousQuaternion){(this||t).quaternionClone.copy(r);(this||t).previousQuaternion=(this||t).quaternionClone}o.lookAt(e)}else{c=this.calculateCameraPortalOrientation();if(u<.5){if((this||t).semiSphereEl.getAttribute("visible")===true)return;h.setAttribute("text","width",1.5);if(c<=0){h.setAttribute("position","0 0 0.75");h.setAttribute("rotation","0 180 0");(this||t).semiSphereEl.setAttribute("rotation","0 0 0")}else{h.setAttribute("position","0 0 -0.75");h.setAttribute("rotation","0 0 0");(this||t).semiSphereEl.setAttribute("rotation","0 180 0")}s.getObject3D("mesh").visible=false;(this||t).semiSphereEl.setAttribute("visible",true);(this||t).peekCameraPortalOrientation=c}else{c<=0?h.setAttribute("rotation","0 180 0"):h.setAttribute("rotation","0 0 0");h.setAttribute("text","width",5);h.setAttribute("position","0 1.5 0");s.getObject3D("mesh").visible=true;(this||t).semiSphereEl.setAttribute("visible",false);(this||t).peekCameraPortalOrientation=void 0}if((this||t).previousQuaternion){o.quaternion.copy((this||t).previousQuaternion);(this||t).previousQuaternion=void 0}}}}}(),hideAll:function(){var e=(this||t).el;var n=(this||t).hiddenEls;var r=this||t;n.length>0||e.sceneEl.object3D.traverse((function(t){if(!(t&&t.el&&t.el.hasAttribute("link-controls"))&&t.el&&t!==e.sceneEl.object3D&&t.el!==e&&t.el!==r.sphereEl&&t.el!==e.sceneEl.cameraEl&&t.el.getAttribute("visible")!==false&&t.el!==r.textEl&&t.el!==r.semiSphereEl){t.el.setAttribute("visible",false);n.push(t.el)}}))},showAll:function(){(this||t).hiddenEls.forEach((function(e){e.setAttribute("visible",true)}));(this||t).hiddenEls=[]},
/**
           * Calculate whether the camera faces the front or back face of the portal.
           * @returns {number} > 0 if camera faces front of portal, < 0 if it faces back of portal.
           */
calculateCameraPortalOrientation:function(){var e=new s.Matrix4;var n=new s.Vector3;var r=new s.Vector3(0,0,1);var a=new s.Vector3(0,0,0);return function(){var s=(this||t).el;var o=s.sceneEl.camera;n.set(0,0,0);r.set(0,0,1);a.set(0,0,0);s.object3D.matrixWorld.extractRotation(e);r.applyMatrix4(e);s.object3D.updateMatrixWorld();s.object3D.localToWorld(a);o.parent.parent.updateMatrixWorld();o.parent.updateMatrixWorld();o.updateMatrixWorld();o.localToWorld(n);n.sub(a).normalize();r.normalize();return Math.sign(r.dot(n))}}(),remove:function(){this.removeEventListener()}});(0,o.registerShader)("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"},previewDistance:{default:l,type:"float",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","uniform float previewDistance;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / previewDistance), 2.0), 0.0, 1.0));","}","}"].join("\n")})},"./src/components/logitech-mx-ink-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>d});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/constants/index.js");var l=r("./src/utils/tracked-controls.js");var c="logitech-mx-ink";var u=o.AFRAME_CDN_ROOT+"controllers/logitech/";var h={left:{buttons:["front","back","none","none","none","tip"]},right:{buttons:["front","back","none","none","none","tip"]}};var d=(0,a.registerComponent)("logitech-mx-ink-controls",{schema:{hand:{default:"left"},model:{default:true},orientationOffset:{type:"vec3"}},mapping:h,init:function(){var e=this||t;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,l.onButtonEvent)(t.detail.id,"down",e,e.data.hand)};(this||t).onButtonUp=function(t){(0,l.onButtonEvent)(t.detail.id,"up",e,e.data.hand)};(this||t).onButtonTouchEnd=function(t){(0,l.onButtonEvent)(t.detail.id,"touchend",e,e.data.hand)};(this||t).onButtonTouchStart=function(t){(0,l.onButtonEvent)(t.detail.id,"touchstart",e,e.data.hand)};this.bindMethods()},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);e.addEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);e.removeEventListener("model-loaded",(this||t).onModelLoaded);e.sceneEl.removeEventListener("enter-vr",(this||t).onEnterVR);e.sceneEl.removeEventListener("exit-vr",(this||t).onExitVR);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).controllerObject3D;e&&(e.visible=false);(0,l.checkControllerPresentAndSetup)(this||t,c,{hand:(this||t).data.hand,iterateControllerProfiles:true})},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;var r=c;e.setAttribute("tracked-controls",{id:r,hand:n.hand,handTrackingEnabled:false,iterateControllerProfiles:true,orientationOffset:n.orientationOffset});this.loadModel()},loadModel:function(){var e=(this||t).controllerObject3D;if((this||t).data.model)if(e){e.visible=(this||t).el.sceneEl.is("vr-mode");(this||t).el.setObject3D("mesh",e)}else(this||t).el.setAttribute("gltf-model",u+"logitech-mx-ink.glb")},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping[(this||t).data.hand].buttons[e.detail.id];var r;if(n){if(n==="trigger"){r=e.detail.state.value;console.log("analog value of trigger press: "+r)}(this||t).el.emit(n+"changed",e.detail.state)}},onModelLoaded:function(e){if(e.target===(this||t).el&&(this||t).data.model){(this||t).el.emit("controllermodelready",{name:"logitech-mx-ink-controls",model:(this||t).data.model,rayOrigin:new s.Vector3(0,0,0)});(this||t).controllerObject3D=(this||t).el.getObject3D("mesh");(this||t).controllerObject3D.visible=(this||t).el.sceneEl.is("vr-mode")}},onAxisMoved:function(e){(0,l.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)}})},"./src/components/look-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>u});var s=r("./node_modules/three/build/three.core.js");var a=r("./vendor/DeviceOrientationControls.js");var o=r("./src/core/component.js");var l=r("./src/utils/index.js");var c=Math.PI/2;var u=(0,o.registerComponent)("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:true},magicWindowTrackingEnabled:{default:true},pointerLockEnabled:{default:false},reverseMouseDrag:{default:false},reverseTouchDrag:{default:false},touchEnabled:{default:true},mouseEnabled:{default:true}},init:function(){(this||t).deltaYaw=0;(this||t).previousHMDPosition=new s.Vector3;(this||t).hmdQuaternion=new s.Quaternion;(this||t).magicWindowAbsoluteEuler=new s.Euler;(this||t).magicWindowDeltaEuler=new s.Euler;(this||t).position=new s.Vector3;(this||t).magicWindowObject=new s.Object3D;(this||t).rotation={};(this||t).deltaRotation={};(this||t).savedPose=null;(this||t).pointerLocked=false;this.setupMouseControls();this.bindMethods();(this||t).previousMouseEvent={};this.setupMagicWindowControls();(this||t).savedPose={position:new s.Vector3,rotation:new s.Euler};((this||t).el.sceneEl.is("vr-mode")||(this||t).el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var e;var n=(this||t).data;if(l.device.isMobile()||l.device.isMobileDeviceRequestingDesktopSite()){e=(this||t).magicWindowControls=new a.DeviceOrientationControls((this||t).magicWindowObject);if(typeof DeviceOrientationEvent!=="undefined"&&DeviceOrientationEvent.requestPermission){e.enabled=false;(this||t).el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?e.enabled=n.magicWindowTrackingEnabled:(this||t).el.sceneEl.addEventListener("deviceorientationpermissiongranted",(function(){e.enabled=n.magicWindowTrackingEnabled}))}}},update:function(e){var n=(this||t).data;n.enabled!==e.enabled&&this.updateGrabCursor(n.enabled);if(e&&!n.magicWindowTrackingEnabled&&e.magicWindowTrackingEnabled){(this||t).magicWindowAbsoluteEuler.set(0,0,0);(this||t).magicWindowDeltaEuler.set(0,0,0)}(this||t).magicWindowControls&&((this||t).magicWindowControls.enabled=n.magicWindowTrackingEnabled);if(e&&!n.pointerLockEnabled!==e.pointerLockEnabled){this.removeEventListeners();this.addEventListeners();(this||t).pointerLocked&&this.exitPointerLock()}},tick:function(e){var n=(this||t).data;n.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners();(this||t).pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners();(this||t).pointerLocked&&this.exitPointerLock()},bindMethods:function(){(this||t).onMouseDown=(this||t).onMouseDown.bind(this||t);(this||t).onMouseMove=(this||t).onMouseMove.bind(this||t);(this||t).onMouseUp=(this||t).onMouseUp.bind(this||t);(this||t).onTouchStart=(this||t).onTouchStart.bind(this||t);(this||t).onTouchMove=(this||t).onTouchMove.bind(this||t);(this||t).onTouchEnd=(this||t).onTouchEnd.bind(this||t);(this||t).onEnterVR=(this||t).onEnterVR.bind(this||t);(this||t).onExitVR=(this||t).onExitVR.bind(this||t);(this||t).onPointerLockChange=(this||t).onPointerLockChange.bind(this||t);(this||t).onPointerLockError=(this||t).onPointerLockError.bind(this||t)},setupMouseControls:function(){(this||t).mouseDown=false;(this||t).pitchObject=new s.Object3D;(this||t).yawObject=new s.Object3D;(this||t).yawObject.position.y=10;(this||t).yawObject.add((this||t).pitchObject)},addEventListeners:function(){var e=(this||t).el.sceneEl;var n=e.canvas;if(n){n.addEventListener("mousedown",(this||t).onMouseDown,false);window.addEventListener("mousemove",(this||t).onMouseMove,false);window.addEventListener("mouseup",(this||t).onMouseUp,false);n.addEventListener("touchstart",(this||t).onTouchStart,{passive:true});window.addEventListener("touchmove",(this||t).onTouchMove,{passive:true});window.addEventListener("touchend",(this||t).onTouchEnd,{passive:true});e.addEventListener("enter-vr",(this||t).onEnterVR);e.addEventListener("exit-vr",(this||t).onExitVR);if((this||t).data.pointerLockEnabled){document.addEventListener("pointerlockchange",(this||t).onPointerLockChange,false);document.addEventListener("mozpointerlockchange",(this||t).onPointerLockChange,false);document.addEventListener("pointerlockerror",(this||t).onPointerLockError,false)}}else e.addEventListener("render-target-loaded",(this||t).addEventListeners.bind(this||t))},removeEventListeners:function(){var e=(this||t).el.sceneEl;var n=e&&e.canvas;if(n){n.removeEventListener("mousedown",(this||t).onMouseDown);window.removeEventListener("mousemove",(this||t).onMouseMove);window.removeEventListener("mouseup",(this||t).onMouseUp);n.removeEventListener("touchstart",(this||t).onTouchStart);window.removeEventListener("touchmove",(this||t).onTouchMove);window.removeEventListener("touchend",(this||t).onTouchEnd);e.removeEventListener("enter-vr",(this||t).onEnterVR);e.removeEventListener("exit-vr",(this||t).onExitVR);document.removeEventListener("pointerlockchange",(this||t).onPointerLockChange,false);document.removeEventListener("mozpointerlockchange",(this||t).onPointerLockChange,false);document.removeEventListener("pointerlockerror",(this||t).onPointerLockError,false)}},updateOrientation:function(){var e=(this||t).el.object3D;var n=(this||t).pitchObject;var r=(this||t).yawObject;var s=(this||t).el.sceneEl;if(!s.is("vr-mode")&&!s.is("ar-mode")||!s.checkHeadsetConnected()){this.updateMagicWindowOrientation();e.rotation.x=(this||t).magicWindowDeltaEuler.x+n.rotation.x;e.rotation.y=(this||t).magicWindowDeltaEuler.y+r.rotation.y;e.rotation.z=(this||t).magicWindowDeltaEuler.z}},updateMagicWindowOrientation:function(){var e=(this||t).magicWindowAbsoluteEuler;var n=(this||t).magicWindowDeltaEuler;if((this||t).magicWindowControls&&(this||t).magicWindowControls.enabled){(this||t).magicWindowControls.update();e.setFromQuaternion((this||t).magicWindowObject.quaternion,"YXZ");(this||t).previousMagicWindowYaw||e.y===0||((this||t).previousMagicWindowYaw=e.y);if((this||t).previousMagicWindowYaw){n.x=e.x;n.y+=e.y-(this||t).previousMagicWindowYaw;n.z=e.z;(this||t).previousMagicWindowYaw=e.y}}},onMouseMove:function(e){var n;var r;var s;var a=(this||t).pitchObject;var o=(this||t).previousMouseEvent;var l=(this||t).yawObject;if((this||t).data.enabled&&((this||t).mouseDown||(this||t).pointerLocked)){if((this||t).pointerLocked){r=e.movementX||e.mozMovementX||0;s=e.movementY||e.mozMovementY||0}else{r=e.screenX-o.screenX;s=e.screenY-o.screenY}(this||t).previousMouseEvent.screenX=e.screenX;(this||t).previousMouseEvent.screenY=e.screenY;n=(this||t).data.reverseMouseDrag?1:-1;l.rotation.y+=r*.002*n;a.rotation.x+=s*.002*n;a.rotation.x=Math.max(-c,Math.min(c,a.rotation.x))}},onMouseDown:function(e){var n=(this||t).el.sceneEl;if((this||t).data.enabled&&(this||t).data.mouseEnabled&&(!n.is("vr-mode")&&!n.is("ar-mode")||!n.checkHeadsetConnected())&&e.button===0){var r=n&&n.canvas;(this||t).mouseDown=true;(this||t).previousMouseEvent.screenX=e.screenX;(this||t).previousMouseEvent.screenY=e.screenY;this.showGrabbingCursor();(this||t).data.pointerLockEnabled&&!(this||t).pointerLocked&&(r.requestPointerLock?r.requestPointerLock():r.mozRequestPointerLock&&r.mozRequestPointerLock())}},showGrabbingCursor:function(){(this||t).el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){(this||t).el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){(this||t).mouseDown=false;this.hideGrabbingCursor()},onTouchStart:function(e){if(e.touches.length===1&&(this||t).data.touchEnabled&&!(this||t).el.sceneEl.is("vr-mode")&&!(this||t).el.sceneEl.is("ar-mode")){(this||t).touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY};(this||t).touchStarted=true}},onTouchMove:function(e){var n;var r=(this||t).el.sceneEl.canvas;var s;var a=(this||t).yawObject;if((this||t).touchStarted&&(this||t).data.touchEnabled){s=2*Math.PI*(e.touches[0].pageX-(this||t).touchStart.x)/r.clientWidth;n=(this||t).data.reverseTouchDrag?1:-1;a.rotation.y-=s*.5*n;(this||t).touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY}}},onTouchEnd:function(){(this||t).touchStarted=false},onEnterVR:function(){var e=(this||t).el.sceneEl;if(e.checkHeadsetConnected()){this.saveCameraPose();(this||t).el.object3D.position.set(0,0,0);(this||t).el.object3D.rotation.set(0,0,0);if(e.hasWebXR){(this||t).el.object3D.matrixAutoUpdate=false;(this||t).el.object3D.updateMatrix()}}},onExitVR:function(){if((this||t).el.sceneEl.checkHeadsetConnected()){this.restoreCameraPose();(this||t).previousHMDPosition.set(0,0,0);(this||t).el.object3D.matrixAutoUpdate=true}},onPointerLockChange:function(){(this||t).pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){(this||t).pointerLocked=false},exitPointerLock:function(){document.exitPointerLock();(this||t).pointerLocked=false},updateGrabCursor:function(e){var n=(this||t).el.sceneEl;function enableGrabCursor(){n.canvas.classList.add("a-grab-cursor")}function disableGrabCursor(){n.canvas.classList.remove("a-grab-cursor")}n.canvas?e?enableGrabCursor():disableGrabCursor():e?n.addEventListener("render-target-loaded",enableGrabCursor):n.addEventListener("render-target-loaded",disableGrabCursor)},saveCameraPose:function(){var e=(this||t).el;(this||t).savedPose.position.copy(e.object3D.position);(this||t).savedPose.rotation.copy(e.object3D.rotation);(this||t).hasSavedPose=true},restoreCameraPose:function(){var e=(this||t).el;var n=(this||t).savedPose;if((this||t).hasSavedPose){e.object3D.position.copy(n.position);e.object3D.rotation.copy(n.rotation);(this||t).hasSavedPose=false}}})},"./src/components/magicleap-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>p});var s=r("./src/core/component.js");var a=r("./src/constants/index.js");var o=r("./src/utils/tracked-controls.js");var l="magicleap";var c="-one";var u=l+c;var h=a.AFRAME_CDN_ROOT+"controllers/magicleap/magicleap-one-controller.glb";var d={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};var p=(0,s.registerComponent)("magicleap-controls",{schema:{hand:{default:"none"},model:{default:true}},mapping:d,init:function(){var e=this||t;(this||t).controllerPresent=false;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,o.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,o.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchEnd=function(t){(0,o.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).onButtonTouchStart=function(t){(0,o.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).previousButtonValues={};this.bindMethods()},update:function(){var e=(this||t).data;(this||t).controllerIndex=e.hand==="right"?0:e.hand==="left"?1:2},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);e.addEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);e.removeEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).data;(0,o.checkControllerPresentAndSetup)(this||t,u,{index:(this||t).controllerIndex,hand:e.hand})},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{idPrefix:u,hand:n.hand,controller:(this||t).controllerIndex});(this||t).data.model&&(this||t).el.setAttribute("gltf-model",h)},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];var r;if(n){if(n==="trigger"){r=e.detail.state.value;console.log("analog value of trigger press: "+r)}(this||t).el.emit(n+"changed",e.detail.state)}},onModelLoaded:function(e){var t=e.detail.model;t.scale.set(.01,.01,.01)},onAxisMoved:function(e){(0,o.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},updateModel:function(e,t){},setButtonColor:function(e,t){}})},"./src/components/material.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>u});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/utils/index.js");var o=r("./src/core/component.js");var l=r("./src/core/shader.js");var c=a.debug("components:material:error");var u=(0,o.registerComponent)("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:true},depthWrite:{default:true},flatShading:{default:false},npot:{default:false},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:l.shaderNames,schemaChange:true},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:false},vertexColorsEnabled:{default:false},visible:{default:true},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:true},anisotropy:{default:0,min:0}},init:function(){(this||t).material=null},
/**
           * Update or create material.
           *
           * @param {object|null} oldData
           */
update:function(e){var n=(this||t).data;(this||t).shader&&n.shader===e.shader||this.updateShader(n.shader);(this||t).shader.update((this||t).data);this.updateMaterial(e)},updateSchema:function(e){var n;var r;var s;var a;r=e&&e.shader;n=(this||t).oldData&&(this||t).oldData.shader;a=r||n;s=l.shaders[a]&&l.shaders[a].schema;s||c("Unknown shader schema "+a);if(!n||r!==n){this.extendSchema(s);this.updateBehavior()}},updateBehavior:function(){var e;var n=(this||t).el.sceneEl;var r=(this||t).schema;var s=this||t;var a;function tickTime(e,t){var n;for(n in a)a[n]=e;s.shader.update(a)}(this||t).tick=void 0;a={};for(e in r)if(r[e].type==="time"){(this||t).tick=tickTime;a[e]=true}n&&((this||t).tick?n.addBehavior(this||t):n.removeBehavior(this||t))},updateShader:function(e){var n=(this||t).data;var r=l.shaders[e]&&l.shaders[e].Shader;var s;if(!r)throw new Error("Unknown shader "+e);s=(this||t).shader=new r;s.el=(this||t).el;s.init(n);this.setMaterial(s.material);this.updateSchema(n)},updateMaterial:function(e){var n=(this||t).data;var r=(this||t).material;var s;r.alphaTest=n.alphaTest;r.depthTest=n.depthTest!==false;r.depthWrite=n.depthWrite!==false;r.opacity=n.opacity;r.flatShading=n.flatShading;r.side=parseSide(n.side);r.transparent=n.transparent!==false||n.opacity<1;r.vertexColors=n.vertexColorsEnabled;r.visible=n.visible;r.blending=parseBlending(n.blending);r.dithering=n.dithering;for(s in e)break;!s||e.alphaTest===n.alphaTest&&e.side===n.side&&e.vertexColorsEnabled===n.vertexColorsEnabled||(r.needsUpdate=true)},remove:function(){var e=new s.MeshBasicMaterial;var n=(this||t).material;var r=(this||t).el.getObject3D("mesh");r&&(r.material=e);disposeMaterial(n,(this||t).system)},
/**
           * (Re)create new material. Has side-effects of setting `this.material` and updating
           * material registration in scene.
           *
           * @param {THREE.Material} material - Material to register.
           */
setMaterial:function(e){var n=(this||t).el;var r;var s=(this||t).system;(this||t).material&&disposeMaterial((this||t).material,s);(this||t).material=e;s.registerMaterial(e);r=n.getObject3D("mesh");r?r.material=e:n.addEventListener("object3dset",(function waitForMesh(t){if(t.detail.type==="mesh"&&t.target===n){n.getObject3D("mesh").material=e;n.removeEventListener("object3dset",waitForMesh)}}))}});
/**
         * Return a three.js constant determining which material face sides to render
         * based on the side parameter (passed as a component property).
         *
         * @param {string} [side=front] - `front`, `back`, or `double`.
         * @returns {number} THREE.FrontSide, THREE.BackSide, or THREE.DoubleSide.
         */function parseSide(e){switch(e){case"back":return s.BackSide;case"double":return s.DoubleSide;default:return s.FrontSide}}
/**
         * Return a three.js constant determining blending
         *
         * @param {string} [blending=normal] - `none`, additive`, `subtractive`,`multiply` or `normal`.
         * @returns {number}
         */function parseBlending(e){switch(e){case"none":return s.NoBlending;case"additive":return s.AdditiveBlending;case"subtractive":return s.SubtractiveBlending;case"multiply":return s.MultiplyBlending;default:return s.NormalBlending}}function disposeMaterial(e,t){e.dispose();t.unregisterMaterial(e);Object.keys(e).filter((function(t){return e[t]&&e[t].isTexture})).forEach((function(t){e[t].dispose()}))}},"./src/components/meta-touch-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>y});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/constants/index.js");var l=r("./src/utils/tracked-controls.js");var c="oculus-touch";var u=o.AFRAME_CDN_ROOT+"controllers/oculus/oculus-touch-controller-";var h=o.AFRAME_CDN_ROOT+"controllers/meta/";var d={left:{modelUrl:u+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new s.Vector3(-.005,.036,-.037),modelPivotRotation:new s.Euler(Math.PI/4.5,0,0)},right:{modelUrl:u+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new s.Vector3(.005,.036,-.037),modelPivotRotation:new s.Euler(Math.PI/4.5,0,0)}};var p="oculus-touch";var f={"oculus-touch":d,"oculus-touch-v2":{left:{modelUrl:u+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new s.Vector3(0,-.007,-.021),modelPivotRotation:new s.Euler(-Math.PI/4,0,0)},right:{modelUrl:u+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new s.Vector3(0,-.007,-.021),modelPivotRotation:new s.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:u+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new s.Vector3(0,0,0),modelPivotRotation:new s.Euler(0,0,0)},right:{modelUrl:u+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new s.Vector3(0,0,0),modelPivotRotation:new s.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:h+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new s.Vector3(0,0,0),modelPivotRotation:new s.Euler(0,0,0)},right:{modelUrl:h+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new s.Vector3(0,0,0),modelPivotRotation:new s.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:h+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new s.Vector3(0,0,0),modelPivotRotation:new s.Euler(0,0,0)},right:{modelUrl:h+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new s.Vector3(0,0,0),modelPivotRotation:new s.Euler(0,0,0)}}};var m={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}};var g={schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:true},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]}},after:["tracked-controls"],mapping:m,bindMethods:function(){(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onThumbstickMoved=(this||t).onThumbstickMoved.bind(this||t);(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},init:function(){var e=this||t;(this||t).onButtonDown=function(t){(0,l.onButtonEvent)(t.detail.id,"down",e,e.data.hand)};(this||t).onButtonUp=function(t){(0,l.onButtonEvent)(t.detail.id,"up",e,e.data.hand)};(this||t).onButtonTouchStart=function(t){(0,l.onButtonEvent)(t.detail.id,"touchstart",e,e.data.hand)};(this||t).onButtonTouchEnd=function(t){(0,l.onButtonEvent)(t.detail.id,"touchend",e,e.data.hand)};(this||t).controllerPresent=false;(this||t).previousButtonValues={};this.bindMethods();(this||t).triggerEuler=new s.Euler},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);e.addEventListener("model-loaded",(this||t).onModelLoaded);e.addEventListener("thumbstickmoved",(this||t).onThumbstickMoved);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);e.removeEventListener("model-loaded",(this||t).onModelLoaded);e.removeEventListener("thumbstickmoved",(this||t).onThumbstickMoved);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).controllerObject3D;e&&(e.visible=false);(0,l.checkControllerPresentAndSetup)(this||t,c,{hand:(this||t).data.hand,iterateControllerProfiles:true})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},loadModel:function(e){var n=(this||t).data;var r;if(n.model)if((this||t).controllerObject3D){(this||t).controllerObject3D.visible=true;(this||t).el.setObject3D("mesh",(this||t).controllerObject3D)}else{(this||t).displayModel=f[n.controllerType]||f[p];if(n.controllerType==="auto"){r=p;var s=Object.keys(f);for(var a=0;a<e.profiles.length;a++)if(s.indexOf(e.profiles[a])!==-1){r=e.profiles[a];break}(this||t).displayModel=f[r]}var o=(this||t).displayModel[n.hand].modelUrl;(this||t).isTouchV3orPROorPlus=(this||t).displayModel===f["oculus-touch-v3"]||(this||t).displayModel===f["meta-quest-touch-pro"]||(this||t).displayModel===f["meta-quest-touch-plus"];(this||t).el.setAttribute("gltf-model",o)}},injectTrackedControls:function(e){var n=(this||t).data;var r=c;(this||t).el.setAttribute("tracked-controls",{id:r,hand:n.hand,handTrackingEnabled:false,iterateControllerProfiles:true});this.loadModel(e)},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping[(this||t).data.hand].buttons[e.detail.id];if(n){if((this||t).isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(e);else{var r=(this||t).buttonMeshes;var s;n!=="trigger"&&n!=="grip"||(s=e.detail.state.value);if(r){n==="trigger"&&r.trigger&&(r.trigger.rotation.x=(this||t).originalXRotationTrigger-s*(Math.PI/26));if(n==="grip"&&r.grip){s*=(this||t).data.hand==="left"?-1:1;r.grip.position.x=(this||t).originalXPositionGrip+s*.004}}}(this||t).el.emit(n+"changed",e.detail.state)}},onButtonChangedV3orPROorPlus:function(e){var n=(this||t).mapping[(this||t).data.hand].buttons[e.detail.id];var r=(this||t).buttonObjects;var s;if(r&&r[n]){s=e.detail.state.value;r[n].quaternion.slerpQuaternions((this||t).buttonRanges[n].min.quaternion,(this||t).buttonRanges[n].max.quaternion,s);r[n].position.lerpVectors((this||t).buttonRanges[n].min.position,(this||t).buttonRanges[n].max.position,s)}},onModelLoaded:function(e){if(e.target===(this||t).el&&(this||t).data.model){if((this||t).isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(e);else{var n=(this||t).controllerObject3D=e.detail.model;var r;r=(this||t).buttonMeshes={};r.grip=n.getObjectByName("buttonHand");(this||t).originalXPositionGrip=r.grip&&r.grip.position.x;r.trigger=n.getObjectByName("buttonTrigger");(this||t).originalXRotationTrigger=r.trigger&&r.trigger.rotation.x;r.thumbstick=n.getObjectByName("stick");r.xbutton=n.getObjectByName("buttonX");r.abutton=n.getObjectByName("buttonA");r.ybutton=n.getObjectByName("buttonY");r.bbutton=n.getObjectByName("buttonB")}for(var s in(this||t).buttonMeshes)(this||t).buttonMeshes[s]&&cloneMeshMaterial((this||t).buttonMeshes[s]);this.applyOffset(e.detail.model);(this||t).el.emit("controllermodelready",{name:"meta-touch-controls",model:(this||t).data.model,rayOrigin:(this||t).displayModel[(this||t).data.hand].rayOrigin})}},applyOffset:function(e){e.position.copy((this||t).displayModel[(this||t).data.hand].modelPivotOffset);e.rotation.copy((this||t).displayModel[(this||t).data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(e){var n=(this||t).controllerObject3D=e.detail.model;var r=(this||t).buttonObjects={};var s=(this||t).buttonMeshes={};var a=(this||t).buttonRanges={};s.grip=n.getObjectByName("squeeze");r.grip=n.getObjectByName("xr_standard_squeeze_pressed_value");a.grip={min:n.getObjectByName("xr_standard_squeeze_pressed_min"),max:n.getObjectByName("xr_standard_squeeze_pressed_max")};r.grip.minX=r.grip.position.x;s.thumbstick=n.getObjectByName("thumbstick");r.thumbstick=n.getObjectByName("xr_standard_thumbstick_pressed_value");a.thumbstick={min:n.getObjectByName("xr_standard_thumbstick_pressed_min"),max:n.getObjectByName("xr_standard_thumbstick_pressed_max")};r.thumbstickXAxis=n.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value");a.thumbstickXAxis={min:n.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:n.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")};r.thumbstickYAxis=n.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value");a.thumbstickYAxis={min:n.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:n.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")};s.trigger=n.getObjectByName("trigger");r.trigger=n.getObjectByName("xr_standard_trigger_pressed_value");a.trigger={min:n.getObjectByName("xr_standard_trigger_pressed_min"),max:n.getObjectByName("xr_standard_trigger_pressed_max")};a.trigger.diff={x:Math.abs(a.trigger.max.rotation.x)-Math.abs(a.trigger.min.rotation.x),y:Math.abs(a.trigger.max.rotation.y)-Math.abs(a.trigger.min.rotation.y),z:Math.abs(a.trigger.max.rotation.z)-Math.abs(a.trigger.min.rotation.z)};var o=(this||t).data.hand==="left"?"x":"a";var l=(this||t).data.hand==="left"?"y":"b";var c=o+"button";var u=l+"button";s[c]=n.getObjectByName(o+"_button");r[c]=n.getObjectByName(o+"_button_pressed_value");a[c]={min:n.getObjectByName(o+"_button_pressed_min"),max:n.getObjectByName(o+"_button_pressed_max")};s[u]=n.getObjectByName(l+"_button");r[u]=n.getObjectByName(l+"_button_pressed_value");a[u]={min:n.getObjectByName(l+"_button_pressed_min"),max:n.getObjectByName(l+"_button_pressed_max")}},onAxisMoved:function(e){(0,l.emitIfAxesChanged)(this||t,(this||t).mapping[(this||t).data.hand].axes,e)},onThumbstickMoved:function(e){if((this||t).buttonMeshes&&(this||t).buttonMeshes.thumbstick)if((this||t).isTouchV3orPROorPlus)this.updateThumbstickTouchV3orPROorPlus(e);else for(var n in e.detail)(this||t).buttonObjects.thumbstick.rotation[(this||t).axisMap[n]]=(this||t).buttonRanges.thumbstick.originalRotation[(this||t).axisMap[n]]-Math.PI/8*e.detail[n]*(n==="y"||(this||t).data.hand==="right"?-1:1)},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(e){var n=(e.detail.x+1)/2;(this||t).buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions((this||t).buttonRanges.thumbstickXAxis.min.quaternion,(this||t).buttonRanges.thumbstickXAxis.max.quaternion,n);var r=(e.detail.y+1)/2;(this||t).buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions((this||t).buttonRanges.thumbstickYAxis.min.quaternion,(this||t).buttonRanges.thumbstickYAxis.max.quaternion,r)},updateModel:function(e,n){(this||t).data.model&&this.updateButtonModel(e,n)},updateButtonModel:function(e,n){var r=(this||t).buttonMeshes;var s;var a;if(r&&r[e]){a=n==="up"||n==="touchend"?r[e].originalColor||(this||t).data.buttonColor:n==="touchstart"?(this||t).data.buttonTouchColor:(this||t).data.buttonHighlightColor;s=r[e];s.material.color.set(a)}}};(0,a.registerComponent)("oculus-touch-controls",g);var y=(0,a.registerComponent)("meta-touch-controls",g);function cloneMeshMaterial(e){e.traverse((function(t){var n;if(t.type==="Mesh"){n=t.material.clone();e.originalColor=t.material.color;t.material.dispose();t.material=n}}))}},"./src/components/obb-collider.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./node_modules/three/examples/jsm/math/OBB.js");var o=r("./src/core/component.js");(0,o.registerComponent)("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:false}},init:function(){(this||t).previousScale=(new s.Vector3).copy((this||t).el.object3D.scale);(this||t).auxEuler=new s.Euler;(this||t).boundingBox=new s.Box3;(this||t).boundingBoxSize=new s.Vector3;(this||t).updateCollider=(this||t).updateCollider.bind(this||t);(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).updateBoundingBox=(this||t).updateBoundingBox.bind(this||t);(this||t).el.addEventListener("model-loaded",(this||t).onModelLoaded);this.updateCollider();(this||t).system.addCollider((this||t).el)},remove:function(){(this||t).system.removeCollider((this||t).el)},update:function(){(this||t).data.trackedObject3D&&((this||t).trackedObject3DPath=(this||t).data.trackedObject3D.split("."))},onModelLoaded:function(){(this||t).data.centerModel&&this.centerModel();this.updateCollider()},centerModel:function(){var e=(this||t).el;var n=e.components["gltf-model"]&&e.components["gltf-model"].model;var r;var a;if(n){(this||t).el.removeObject3D("mesh");r=(new s.Box3).setFromObject(n);a=r.getCenter(new s.Vector3);n.position.x+=n.position.x-a.x;n.position.y+=n.position.y-a.y;n.position.z+=n.position.z-a.z;(this||t).el.setObject3D("mesh",n)}},updateCollider:function(){var e=(this||t).el;var n=(this||t).boundingBoxSize;var r=(this||t).aabb=(this||t).aabb||new a.OBB;(this||t).obb=(this||t).obb||new a.OBB;if(e.hasLoaded){this.updateBoundingBox();r.halfSize.copy(n).multiplyScalar(.5);(this||t).el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()}else e.addEventListener("loaded",(this||t).updateCollider)},showCollider:function(){this.updateColliderMesh();(this||t).renderColliderMesh.visible=true},updateColliderMesh:function(){var e=(this||t).renderColliderMesh;var n=(this||t).boundingBoxSize;if(e){e.geometry.dispose();e.geometry=new s.BoxGeometry(n.x,n.y,n.z)}else this.initColliderMesh()},hideCollider:function(){(this||t).renderColliderMesh&&((this||t).renderColliderMesh.visible=false)},initColliderMesh:function(){var e;var n;var r;e=(this||t).boundingBoxSize;n=(this||t).renderColliderGeometry=new s.BoxGeometry(e.x,e.y,e.z);r=(this||t).renderColliderMesh=new s.Mesh(n,new s.MeshLambertMaterial({color:65280,side:s.DoubleSide}));r.matrixAutoUpdate=false;r.matrixWorldAutoUpdate=false;r.updateMatrixWorld=function(){};(this||t).el.sceneEl.object3D.add(r)},updateBoundingBox:function(){var e=new s.Vector3;var n=new s.Vector3;var r=new s.Quaternion;var a=new s.Quaternion;var o=new s.Matrix4;return function(){var s=(this||t).auxEuler;var l=(this||t).boundingBox;var c=(this||t).data.size;var u=(this||t).trackedObject3D||(this||t).el.object3D;var h=(this||t).boundingBoxSize;var d=(this||t).data.minimumColliderDimension;if(c){(this||t).boundingBoxSize.x=c;(this||t).boundingBoxSize.y=c;(this||t).boundingBoxSize.z=c}else{s.copy(u.rotation);u.rotation.set(0,0,0);u.parent.matrixWorld.decompose(e,r,n);o.compose(e,a,n);u.parent.matrixWorld.copy(o);l.setFromObject(u,true);l.getSize(h);h.x=h.x<d?d:h.x;h.y=h.y<d?d:h.y;h.z=h.z<d?d:h.z;u.parent.matrixWorld.compose(e,r,n);(this||t).el.object3D.rotation.copy(s)}}}(),checkTrackedObject:function(){var e=(this||t).trackedObject3DPath;var n;if(e&&e.length&&!(this||t).trackedObject3D){n=(this||t).el;for(var r=0;r<e.length;r++){n=n[e[r]];if(!n)break}if(n){(this||t).trackedObject3D=n;this.updateCollider()}}return(this||t).trackedObject3D},tick:function(){var e=new s.Vector3;var n=new s.Vector3;var r=new s.Quaternion;var a=new s.Matrix4;return function(){var s=(this||t).obb;var o=(this||t).renderColliderMesh;var l=this.checkTrackedObject()||(this||t).el.object3D;if(l){l.updateMatrix();l.updateMatrixWorld(true);l.matrixWorld.decompose(e,r,n);(Math.abs(n.x-(this||t).previousScale.x)>1e-4||Math.abs(n.y-(this||t).previousScale.y)>1e-4||Math.abs(n.z-(this||t).previousScale.z)>1e-4)&&this.updateCollider();(this||t).previousScale.copy(n);n.set(1,1,1);a.compose(e,r,n);o&&o.matrixWorld.copy(a);s.copy((this||t).aabb);s.applyMatrix4(a)}}}()})},"./src/components/obj-model.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>h});var s=r("./node_modules/three/build/three.core.js");var a=r("./node_modules/three/examples/jsm/loaders/OBJLoader.js");var o=r("./node_modules/three/examples/jsm/loaders/MTLLoader.js");var l=r("./src/utils/index.js");var c=r("./src/core/component.js");var u=(0,l.debug)("components:obj-model:warn");var h=(0,c.registerComponent)("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var e=this||t;(this||t).model=null;(this||t).objLoader=new a.OBJLoader;(this||t).mtlLoader=new o.MTLLoader((this||t).objLoader.manager);(this||t).mtlLoader.crossOrigin="";(this||t).el.addEventListener("componentinitialized",(function(t){e.model&&t.detail.name==="material"&&e.applyMaterial()}))},update:function(){var e=(this||t).data;if(e.obj){this.resetMesh();this.loadObj(e.obj,e.mtl)}},remove:function(){this.resetMesh()},resetMesh:function(){(this||t).model&&(this||t).el.removeObject3D("mesh")},loadObj:function(e,n){var r=this||t;var s=(this||t).el;var a=(this||t).mtlLoader;var o=(this||t).objLoader;var l=(this||t).el.sceneEl.systems.renderer;var c=n.substr(0,n.lastIndexOf("/")+1);if(n){s.hasAttribute("material")&&u("Material component properties are ignored when a .MTL is provided");a.setResourcePath(c);a.load(n,(function(t){t.preload();o.setMaterials(t);o.load(e,(function(e){r.model=e;r.model.traverse((function(e){if(e.isMesh){var t=e.material;t.map&&l.applyColorCorrection(t.map);t.emissiveMap&&l.applyColorCorrection(t.emissiveMap)}}));s.setObject3D("mesh",e);s.emit("model-loaded",{format:"obj",model:e})}))}))}else o.load(e,(function loadObjOnly(e){r.model=e;r.applyMaterial();s.setObject3D("mesh",e);s.emit("model-loaded",{format:"obj",model:e})}))},applyMaterial:function(){var e=(this||t).el.components.material;e&&(this||t).model.traverse((function(t){t instanceof s.Mesh&&(t.material=e.material)}))}})},"./src/components/oculus-go-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>h});var s=r("./src/core/component.js");var a=r("./src/constants/index.js");var o=r("./src/utils/tracked-controls.js");var l=a.AFRAME_CDN_ROOT+"controllers/oculus/go/oculus-go-controller.gltf";var c="oculus-go";var u={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]};var h=(0,s.registerComponent)("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:true}},mapping:u,bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},init:function(){var e=this||t;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,o.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,o.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchStart=function(t){(0,o.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).onButtonTouchEnd=function(t){(0,o.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).controllerPresent=false;this.bindMethods()},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("model-loaded",(this||t).onModelLoaded);e.addEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("model-loaded",(this||t).onModelLoaded);e.removeEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){(0,o.checkControllerPresentAndSetup)(this||t,c,(this||t).data.hand?{hand:(this||t).data.hand}:{})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{hand:n.hand,idPrefix:c});(this||t).data.model&&(this||t).el.setAttribute("gltf-model",l)},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var n=e.detail.model;var r;if(e.target===(this||t).el&&(this||t).data.model){r=(this||t).buttonMeshes={};r.trigger=n.getObjectByName("oculus_go_button_trigger");r.trackpad=n.getObjectByName("oculus_go_touchpad");r.touchpad=n.getObjectByName("oculus_go_touchpad")}},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];n&&(this||t).el.emit(n+"changed",e.detail.state)},onAxisMoved:function(e){(0,o.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},updateModel:function(e,n){(this||t).data.model&&this.updateButtonModel(e,n)},updateButtonModel:function(e,n){var r=(this||t).buttonMeshes;if(r&&r[e]){var s;var a;switch(n){case"down":s=(this||t).data.buttonHighlightColor;break;case"touchstart":s=(this||t).data.buttonTouchedColor;break;default:s=(this||t).data.buttonColor}a=r[e];a.material.color.set(s)}}})},"./src/components/pico-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>d});var s=r("./src/core/component.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./src/constants/index.js");var l=r("./src/utils/tracked-controls.js");var c="pico-4";var u=o.AFRAME_CDN_ROOT+"controllers/pico/pico4/";var h={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};var d=(0,s.registerComponent)("pico-controls",{schema:{hand:{default:"none"},model:{default:true}},mapping:h,init:function(){var e=this||t;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,l.onButtonEvent)(t.detail.id,"down",e,e.data.hand)};(this||t).onButtonUp=function(t){(0,l.onButtonEvent)(t.detail.id,"up",e,e.data.hand)};(this||t).onButtonTouchEnd=function(t){(0,l.onButtonEvent)(t.detail.id,"touchend",e,e.data.hand)};(this||t).onButtonTouchStart=function(t){(0,l.onButtonEvent)(t.detail.id,"touchstart",e,e.data.hand)};this.bindMethods()},update:function(){var e=(this||t).data;(this||t).controllerIndex=e.hand==="right"?0:e.hand==="left"?1:2},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);e.addEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);e.removeEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).data;(0,l.checkControllerPresentAndSetup)(this||t,c,{index:(this||t).controllerIndex,hand:e.hand})},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{idPrefix:c,hand:n.hand,controller:(this||t).controllerIndex});(this||t).data.model&&(this||t).el.setAttribute("gltf-model",u+(this||t).data.hand+".glb")},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping[(this||t).data.hand].buttons[e.detail.id];var r;if(n){if(n==="trigger"){r=e.detail.state.value;console.log("analog value of trigger press: "+r)}(this||t).el.emit(n+"changed",e.detail.state)}},onModelLoaded:function(e){e.target===(this||t).el&&(this||t).data.model&&(this||t).el.emit("controllermodelready",{name:"pico-controls",model:(this||t).data.model,rayOrigin:new a.Vector3(0,0,0)})},onAxisMoved:function(e){(0,l.emitIfAxesChanged)(this||t,(this||t).mapping[(this||t).data.hand].axes,e)}})},"./src/components/position.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>a});var s=r("./src/core/component.js");var a=(0,s.registerComponent)("position",{schema:{type:"vec3"},update:function(){var e=(this||t).el.object3D;var n=(this||t).data;e.position.set(n.x,n.y,n.z)},remove:function(){(this||t).el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>d});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l=o.debug("components:raycaster:warn");var c=/^[\w\s-.,[\]#]*$/;var u={childList:true,attributes:true,subtree:true};var h={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};var d=(0,a.registerComponent)("raycaster",{schema:{autoRefresh:{default:true},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:true},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:false},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:false}},multiple:true,init:function(){(this||t).clearedIntersectedEls=[];(this||t).unitLineEndVec3=new s.Vector3;(this||t).intersectedEls=[];(this||t).intersections=[];(this||t).newIntersectedEls=[];(this||t).newIntersections=[];(this||t).objects=[];(this||t).prevCheckTime=void 0;(this||t).prevIntersectedEls=[];(this||t).rawIntersections=[];(this||t).raycaster=new s.Raycaster;this.updateOriginDirection();(this||t).setDirty=(this||t).setDirty.bind(this||t);(this||t).updateLine=(this||t).updateLine.bind(this||t);(this||t).observer=new MutationObserver((this||t).setDirty);(this||t).dirty=true;(this||t).lineEndVec3=new s.Vector3;(this||t).otherLineEndVec3=new s.Vector3;(this||t).lineData={end:(this||t).lineEndVec3};(this||t).getIntersection=(this||t).getIntersection.bind(this||t);(this||t).intersectedDetail={el:(this||t).el,getIntersection:(this||t).getIntersection};(this||t).intersectedClearedDetail={el:(this||t).el};(this||t).intersectionClearedDetail={clearedEls:(this||t).clearedIntersectedEls};(this||t).intersectionDetail={}},update:function(e){var n=(this||t).data;var r=(this||t).el;var s=(this||t).raycaster;s.far=n.far;s.near=n.near;if(n.showLine&&(n.far!==e.far||n.origin!==e.origin||n.direction!==e.direction||!e.showLine)){(this||t).unitLineEndVec3.copy(n.direction).normalize();this.drawLine()}!n.showLine&&e.showLine&&r.removeAttribute("line");n.objects===e.objects||c.test(n.objects)||l('[raycaster] Selector "'+n.objects+'" may not update automatically with DOM changes.');n.objects||l('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".');n.autoRefresh!==e.autoRefresh&&r.isPlaying&&(n.autoRefresh?this.addEventListeners():this.removeEventListeners());e.enabled&&!n.enabled&&this.clearAllIntersections();n.objects!==e.objects&&this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){(this||t).data.showLine&&(this||t).el.removeAttribute("line");this.clearAllIntersections()},addEventListeners:function(){if((this||t).data.autoRefresh){(this||t).observer.observe((this||t).el.sceneEl,u);(this||t).el.sceneEl.addEventListener("object3dset",(this||t).setDirty);(this||t).el.sceneEl.addEventListener("object3dremove",(this||t).setDirty)}},removeEventListeners:function(){(this||t).observer.disconnect();(this||t).el.sceneEl.removeEventListener("object3dset",(this||t).setDirty);(this||t).el.sceneEl.removeEventListener("object3dremove",(this||t).setDirty)},setDirty:function(){(this||t).dirty=true},refreshObjects:function(){var e=(this||t).data;var n;n=e.objects?(this||t).el.sceneEl.querySelectorAll(e.objects):(this||t).el.sceneEl.querySelectorAll("*");(this||t).objects=this.flattenObject3DMaps(n);(this||t).dirty=false},tock:function(e){var n=(this||t).data;var r=(this||t).prevCheckTime;if(n.enabled&&!(r&&e-r<n.interval)){(this||t).prevCheckTime=e;this.checkIntersections()}},checkIntersections:function(){var e=(this||t).clearedIntersectedEls;var n=(this||t).el;var r=(this||t).data;var s;var a=(this||t).intersectedEls;var o;var l=(this||t).intersections;var c=(this||t).newIntersectedEls;var u=(this||t).newIntersections;var d=(this||t).prevIntersectedEls;var p=(this||t).rawIntersections;(this||t).dirty&&this.refreshObjects();copyArray((this||t).prevIntersectedEls,(this||t).intersectedEls);this.updateOriginDirection();p.length=0;(this||t).raycaster.intersectObjects((this||t).objects,true,p);l.length=0;a.length=0;for(s=0;s<p.length;s++){o=p[s];if((!r.showLine||o.object!==n.getObject3D("line"))&&o.object.el){l.push(o);a.push(o.object.el)}}u.length=0;c.length=0;for(s=0;s<l.length;s++)if(d.indexOf(l[s].object.el)===-1){u.push(l[s]);c.push(l[s].object.el)}e.length=0;for(s=0;s<d.length;s++)if(a.indexOf(d[s])===-1){d[s].emit(h.INTERSECT_CLEAR,(this||t).intersectedClearedDetail);e.push(d[s])}e.length&&n.emit(h.INTERSECTION_CLEAR,(this||t).intersectionClearedDetail);for(s=0;s<c.length;s++)c[s].emit(h.INTERSECT,(this||t).intersectedDetail);if(u.length){(this||t).intersectionDetail.els=c;(this||t).intersectionDetail.intersections=u;n.emit(h.INTERSECTION,(this||t).intersectionDetail)}if(d.length===0&&l.length>0||d.length>0&&l.length===0||d.length&&l.length&&d[0]!==l[0].object.el){(this||t).intersectionDetail.els=(this||t).intersectedEls;(this||t).intersectionDetail.intersections=l;n.emit(h.INTERSECTION_CLOSEST_ENTITY_CHANGED,(this||t).intersectionDetail)}r.showLine&&setTimeout((this||t).updateLine)},updateLine:function(){var e=(this||t).el;var n=(this||t).intersections;var r;n.length&&(r=n[0].object.el===e&&n[1]?n[1].distance:n[0].distance);this.drawLine(r)},
/**
           * Return the most recent intersection details for a given entity, if any.
           * @param {AEntity} el
           * @returns {object|null}
           */
getIntersection:function(e){var n;var r;for(n=0;n<(this||t).intersections.length;n++){r=(this||t).intersections[n];if(r.object.el===e)return r}return null},updateOriginDirection:function(){var e=new s.Vector3;var n=new s.Vector3;return function updateOriginDirection(){var r=(this||t).el;var s=(this||t).data;if(s.useWorldCoordinates)(this||t).raycaster.set(s.origin,s.direction);else{r.object3D.updateMatrixWorld();n.setFromMatrixPosition(r.object3D.matrixWorld);s.origin.x===0&&s.origin.y===0&&s.origin.z===0||(n=r.object3D.localToWorld(n.copy(s.origin)));e.copy(s.direction).transformDirection(r.object3D.matrixWorld).normalize();(this||t).raycaster.set(n,e)}}}(),
/**
           * Create or update line to give raycaster visual representation.
           * Customize the line through through line component.
           * We draw the line in the raycaster component to customize the line to the
           * raycaster's origin, direction, and far.
           *
           * Unlike the raycaster, we create the line as a child of the object. The line will
           * be affected by the transforms of the objects, so we don't have to calculate transforms
           * like we do with the raycaster.
           *
           * @param {number} length - Length of line. Pass in to shorten the line to the intersection
           *   point. If not provided, length will default to the max length, `raycaster.far`.
           */
drawLine:function(e){var n=(this||t).data;var r=(this||t).el;var s;s=(this||t).lineData.end===(this||t).lineEndVec3?(this||t).otherLineEndVec3:(this||t).lineEndVec3;e===void 0&&(e=n.far===Infinity?1e3:n.far);(this||t).lineData.start=n.origin;(this||t).lineData.end=s.copy((this||t).unitLineEndVec3).multiplyScalar(e).add(n.origin);(this||t).lineData.color=n.lineColor;(this||t).lineData.opacity=n.lineOpacity;r.setAttribute("line",(this||t).lineData)},
/**
           * Return A-Frame attachments of each element's object3D group (e.g., mesh).
           * Children are flattened by one level, removing the THREE.Group wrapper,
           * so that non-recursive raycasting remains useful.
           *
           * Only push children defined as component attachments (e.g., setObject3D),
           * NOT actual children in the scene graph hierarchy.
           *
           * @param {Array<Element>} els
           * @returns {Array<THREE.Object3D>}
           */
flattenObject3DMaps:function(e){var n;var r;var s=(this||t).objects;var a=(this||t).el.sceneEl.object3D;function isAttachedToScene(e){return e.parent?isAttachedToScene(e.parent):e===a}s.length=0;for(r=0;r<e.length;r++){var o=e[r];if(o.isEntity&&o.object3D&&isAttachedToScene(o.object3D))for(n in o.object3DMap)s.push(o.getObject3D(n))}return s},clearAllIntersections:function(){var e;for(e=0;e<(this||t).intersectedEls.length;e++)(this||t).intersectedEls[e].emit(h.INTERSECT_CLEAR,(this||t).intersectedClearedDetail);copyArray((this||t).clearedIntersectedEls,(this||t).intersectedEls);(this||t).intersectedEls.length=0;(this||t).intersections.length=0;(this||t).el.emit(h.INTERSECTION_CLEAR,(this||t).intersectionClearedDetail)}});function copyArray(e,t){var n;e.length=t.length;for(n=0;n<t.length;n++)e[n]=t[n]}},"./src/components/rotation.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>l});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=s.MathUtils.degToRad;var l=(0,a.registerComponent)("rotation",{schema:{type:"vec3"},update:function(){var e=(this||t).data;var n=(this||t).el.object3D;n.rotation.set(o(e.x),o(e.y),o(e.z),"YXZ")},remove:function(){(this||t).el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>a});var s=r("./src/core/component.js");var a=(0,s.registerComponent)("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var e=(this||t).data;var n=(this||t).el.object3D;n.scale.set(e.x,e.y,e.z)},remove:function(){(this||t).el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>h});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=";var l=21;var c=function(){var e=new s.Quaternion;var t=new s.Vector3;function applyPose(n,r,s){r.position.copy(n.transform.position);r.quaternion.copy(n.transform.orientation);t.copy(s);e.copy(n.transform.orientation);t.applyQuaternion(e);r.position.sub(t)}return applyPose}();c.tempFakePose={transform:{orientation:new s.Quaternion,position:new s.Vector3}};
/**
         * Class to handle hit-test from a single source
         *
         * For a normal space provide it as a space option
         * new HitTest(renderer, {
         *   space: viewerSpace
         * });
         *
         * this is also useful for the targetRaySpace of an XRInputSource
         *
         * It can also describe a transient input source like so:
         *
         * var profileToSupport = 'generic-touchscreen';
         * var transientHitTest = new HitTest(renderer, {
         *   profile: profileToSupport
         * });
         *
         * Where the profile matches an item in a type of controller, profiles matching 'generic-touchscreen'
         * will always be a transient input and as of 08/2021 all transient inputs are 'generic-touchscreen'
         *
         * @param {WebGLRenderer} renderer THREE.JS Renderer
         * @param {object} hitTestSourceDetails The source information either as the information for a transient hit-test or a regular hit-test
         */function HitTest(e,n){(this||t).renderer=e;(this||t).xrHitTestSource=null;e.xr.addEventListener("sessionend",function(){(this||t).xrHitTestSource=null}.bind(this||t));e.xr.addEventListener("sessionstart",function(){this.sessionStart(n)}.bind(this||t));(this||t).renderer.xr.isPresenting&&this.sessionStart(n)}HitTest.prototype.previousFrameAnchors=new Set;HitTest.prototype.anchorToObject3D=new Map;function warnAboutHitTest(e){console.warn(e.message);console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}HitTest.prototype.sessionStart=function sessionStart(e){(this||t).session=(this||t).renderer.xr.getSession();"requestHitTestSource"in(this||t).session?e.space?(this||t).session.requestHitTestSource(e).then(function(e){(this||t).xrHitTestSource=e}.bind(this||t)).catch(warnAboutHitTest):e.profile&&(this||t).session.requestHitTestSourceForTransientInput(e).then(function(e){(this||t).xrHitTestSource=e;(this||t).transient=true}.bind(this||t)).catch(warnAboutHitTest):warnAboutHitTest({message:"No requestHitTestSource on the session."})};
/**
         * Turns the last hit test into an anchor, the provided Object3D will have its
         * position update to track the anchor.
         *
         * @param {Object3D} object3D object to track
         * @param {Vector3} offset offset of the object from the origin that gets subtracted
         */HitTest.prototype.anchorFromLastHitTestResult=function(e,n){var r=(this||t).lastHitTest;if(r){var s={object3D:e,offset:n};Array.from((this||t).anchorToObject3D.entries()).forEach(function(n){var r=n[1].object3D;var s=n[0];if(r===e){(this||t).anchorToObject3D.delete(s);s.delete()}}.bind(this||t));r.createAnchor&&r.createAnchor().then(function(e){(this||t).anchorToObject3D.set(e,s)}.bind(this||t)).catch((function(e){console.warn(e.message);console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')}))}};HitTest.prototype.doHit=function doHit(e){if((this||t).renderer.xr.isPresenting){var n=(this||t).renderer.xr.getReferenceSpace();var r=e.getViewerPose(n);var s;var a;if((this||t).xrHitTestSource&&r){if((this||t).transient){s=e.getHitTestResultsForTransientInput((this||t).xrHitTestSource);if(s.length>0){a=s[0].results;if(a.length>0){(this||t).lastHitTest=a[0];return a[0].getPose(n)}return false}return false}s=e.getHitTestResults((this||t).xrHitTestSource);if(s.length>0){(this||t).lastHitTest=s[0];return s[0].getPose(n)}return false}}};HitTest.updateAnchorPoses=function(e,t){var n=e.trackedAnchors||HitTest.prototype.previousFrameAnchors;HitTest.prototype.previousFrameAnchors.forEach((function(e){n.has(e)||HitTest.prototype.anchorToObject3D.delete(e)}));n.forEach((function(n){var r;var s;var a;var o;try{r=e.getPose(n.anchorSpace,t);if(r){s=HitTest.prototype.anchorToObject3D.get(n);if(!s)return;a=s.offset;o=s.object3D;c(r,o,a)}}catch(e){console.error("while updating anchor poses:",e)}}));HitTest.prototype.previousFrameAnchors=n};var u;var h=(0,a.registerComponent)("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:true},src:{default:o,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:true,init:function(){(this||t).hitTest=null;(this||t).imageDataArray=new Uint8ClampedArray(1048576);(this||t).imageData=new ImageData((this||t).imageDataArray,512,512);(this||t).textureCache=new Map;(this||t).orthoCam=new s.OrthographicCamera;(this||t).orthoCam.layers.set(l);(this||t).textureTarget=new s.WebGLRenderTarget(512,512,{});(this||t).basicMaterial=new s.MeshBasicMaterial({color:0,side:s.DoubleSide});(this||t).canvas=document.createElement("canvas");(this||t).context=(this||t).canvas.getContext("2d");(this||t).context.imageSmoothingEnabled=false;(this||t).canvas.width=512;(this||t).canvas.height=512;(this||t).canvasTexture=new s.CanvasTexture((this||t).canvas,{alpha:true});(this||t).canvasTexture.flipY=false;var e=(this||t).el.getAttribute("webxr");var n=e.optionalFeatures;if(!n.includes("hit-test")||!n.includes("anchors")){n.push("hit-test");n.push("anchors");(this||t).el.setAttribute("webxr",e)}(this||t).el.sceneEl.renderer.xr.addEventListener("sessionend",function(){(this||t).hitTest=null}.bind(this||t));(this||t).el.sceneEl.renderer.xr.addEventListener("sessionstart",function(){if((this||t).el.is("ar-mode")){var e=(this||t).el.sceneEl.renderer;var n=(this||t).session=e.xr.getSession();(this||t).hasPosedOnce=false;(this||t).bboxMesh.visible=false;u||(u=new Map);n.requestReferenceSpace("viewer").then(function(n){(this||t).viewerHitTest=(this||t).hitTest=new HitTest(e,{space:n});(this||t).el.emit("ar-hit-test-start")}.bind(this||t));var r=this||t;(this||t).el.sceneEl.addEventListener("controllersupdated",(function(){var n=this||t;var s=n.xrSession&&n.xrSession.inputSources;if(s)for(var a=0;a<s.length;++a)if(s[a].targetRayMode==="tracked-pointer"){r.hitTest=new HitTest(e,{space:s[a].targetRaySpace});u.set(s[a],r.hitTest);if(r.viewerHitTest&&typeof r.viewerHitTest.cancel==="function"){r.viewerHitTest.cancel();r.viewerHitTest=null}break}}));var s="generic-touchscreen";var a=new HitTest(e,{profile:s});n.addEventListener("selectstart",function(n){if((this||t).data.enabled===true){var r=n.inputSource;(this||t).bboxMesh.visible=true;if((this||t).hasPosedOnce===true){(this||t).el.emit("ar-hit-test-select-start",{inputSource:r,position:(this||t).bboxMesh.position,orientation:(this||t).bboxMesh.quaternion});if(r.profiles[0]===s)(this||t).hitTest=a;else{(this||t).hitTest=u.get(r)||new HitTest(e,{space:r.targetRaySpace});u.set(r,(this||t).hitTest)}}}}.bind(this||t));n.addEventListener("selectend",function(e){if((this||t).hitTest&&(this||t).data.enabled===true){var n=e.inputSource;var r;if((this||t).hasPosedOnce===true){(this||t).bboxMesh.visible=false;if((this||t).data.target){r=(this||t).data.target.object3D;if(r){c.tempFakePose.transform.position.copy((this||t).bboxMesh.position);c.tempFakePose.transform.orientation.copy((this||t).bboxMesh.quaternion);c(c.tempFakePose,r,(this||t).bboxOffset);r.visible=true;(this||t).hitTest.anchorFromLastHitTestResult(r,(this||t).bboxOffset)}}(this||t).el.emit("ar-hit-test-select",{inputSource:n,position:(this||t).bboxMesh.position,orientation:(this||t).bboxMesh.quaternion});(this||t).hitTest=null}}else(this||t).hitTest=null}.bind(this||t))}}.bind(this||t));(this||t).bboxOffset=new s.Vector3;(this||t).update=(this||t).update.bind(this||t);this.makeBBox()},update:function(){if((this||t).data.enabled===false){(this||t).hitTest=null;(this||t).bboxMesh.visible=false}if((this||t).data.target)if((this||t).data.target.object3D){(this||t).data.target.addEventListener("model-loaded",(this||t).update);(this||t).data.target.object3D.layers.enable(l);(this||t).data.target.object3D.traverse((function(e){e.layers.enable(l)}))}else(this||t).data.target.addEventListener("loaded",(this||t).update,{once:true});(this||t).bboxNeedsUpdate=true},makeBBox:function(){var e=new s.PlaneGeometry(1,1);var n=new s.MeshBasicMaterial({transparent:true,color:16777215});e.rotateX(-Math.PI/2);e.rotateY(-Math.PI/2);(this||t).bbox=new s.Box3;(this||t).bboxMesh=new s.Mesh(e,n);(this||t).el.setObject3D("ar-hit-test",(this||t).bboxMesh);(this||t).bboxMesh.visible=false},updateFootprint:function(){var e;var n=(this||t).el.sceneEl.renderer;var r,s;var a=n.xr.enabled;(this||t).bboxMesh.material.map=(this||t).canvasTexture;(this||t).bboxMesh.material.needsUpdate=true;(this||t).orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2);(this||t).orthoCam.position.copy((this||t).bboxMesh.position);(this||t).orthoCam.position.y-=(this||t).bboxMesh.scale.y/2;(this||t).orthoCam.near=.1;(this||t).orthoCam.far=(this||t).orthoCam.near+(this||t).data.footprintDepth*(this||t).bboxMesh.scale.y;(this||t).orthoCam.position.y+=(this||t).orthoCam.far;(this||t).orthoCam.right=(this||t).bboxMesh.scale.z/2;(this||t).orthoCam.left=-(this||t).bboxMesh.scale.z/2;(this||t).orthoCam.top=(this||t).bboxMesh.scale.x/2;(this||t).orthoCam.bottom=-(this||t).bboxMesh.scale.x/2;(this||t).orthoCam.updateProjectionMatrix();r=n.getRenderTarget();n.setRenderTarget((this||t).textureTarget);n.xr.enabled=false;s=(this||t).el.object3D.background;(this||t).el.object3D.overrideMaterial=(this||t).basicMaterial;(this||t).el.object3D.background=null;n.render((this||t).el.object3D,(this||t).orthoCam);(this||t).el.object3D.background=s;(this||t).el.object3D.overrideMaterial=null;n.xr.enabled=a;n.setRenderTarget(r);n.readRenderTargetPixels((this||t).textureTarget,0,0,512,512,(this||t).imageDataArray);(this||t).context.putImageData((this||t).imageData,0,0);(this||t).context.shadowColor="white";(this||t).context.shadowBlur=10;(this||t).context.drawImage((this||t).canvas,0,0);e=(this||t).context.getImageData(0,0,512,512);for(var o=0;o<262144;o++)e.data[o*4+3]!==0&&e.data[o*4+3]!==255&&(e.data[o*4+3]=128);(this||t).context.putImageData(e,0,0);(this||t).canvasTexture.needsUpdate=true},tick:function(){var e;var n=(this||t).el.sceneEl.frame;var r=(this||t).el.sceneEl.renderer;n&&HitTest.updateAnchorPoses(n,r.xr.getReferenceSpace());if((this||t).bboxNeedsUpdate){(this||t).bboxNeedsUpdate=false;if(!(this||t).data.target||(this||t).data.type==="map"){var a;if((this||t).textureCache.has((this||t).data.src))a=(this||t).textureCache.get((this||t).data.src);else{a=(new s.TextureLoader).load((this||t).data.src);(this||t).textureCache.set((this||t).data.src,a)}(this||t).bboxMesh.material.map=a;(this||t).bboxMesh.material.needsUpdate=true}if((this||t).data.target&&(this||t).data.target.object3D){(this||t).bbox.setFromObject((this||t).data.target.object3D);(this||t).bbox.getCenter((this||t).bboxMesh.position);(this||t).bbox.getSize((this||t).bboxMesh.scale);if((this||t).data.type==="footprint"){(this||t).bboxMesh.scale.x*=1.04;(this||t).bboxMesh.scale.z*=1.04;this.updateFootprint()}(this||t).bboxMesh.position.y-=(this||t).bboxMesh.scale.y/2;(this||t).bboxOffset.copy((this||t).bboxMesh.position);(this||t).bboxOffset.sub((this||t).data.target.object3D.position)}else(this||t).bboxMesh.scale.set((this||t).data.mapSize.x,1,(this||t).data.mapSize.y)}if((this||t).hitTest){e=(this||t).hitTest.doHit(n);if(e){if((this||t).hasPosedOnce!==true){(this||t).hasPosedOnce=true;(this||t).el.emit("ar-hit-test-achieved")}(this||t).bboxMesh.visible=true;(this||t).bboxMesh.position.copy(e.transform.position);(this||t).bboxMesh.quaternion.copy(e.transform.orientation)}}}})},"./src/components/scene/background.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=(0,a.registerComponent)("background",{schema:{color:{type:"color",default:"black"},transparent:{default:false}},sceneOnly:true,update:function(){var e=(this||t).data;var n=(this||t).el.object3D;e.transparent?n.background=null:n.background=new s.Color(e.color)},remove:function(){var e=(this||t).el.object3D;e.background=null}})},"./src/components/scene/debug.js":(e,t,n)=>{n.r(t);n.d(t,{Component:()=>s});var r=n("./src/core/component.js");var s=(0,r.registerComponent)("debug",{schema:{default:true},sceneOnly:true})},"./src/components/scene/device-orientation-permission-ui.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>g});var s=r("./src/core/component.js");var a=r("./src/constants/index.js");var o="a-modal";var l="a-dialog";var c="a-dialog-text";var u="a-dialog-text-container";var h="a-dialog-buttons-container";var d="a-dialog-button";var p="a-dialog-allow-button";var f="a-dialog-deny-button";var m="a-dialog-ok-button";var g=(0,s.registerComponent)("device-orientation-permission-ui",{schema:{enabled:{default:true},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:true,init:function(){var e=this||t;if((this||t).data.enabled){window.isSecureContext||this.showHTTPAlert();if(typeof DeviceOrientationEvent!=="undefined"&&DeviceOrientationEvent.requestPermission){(this||t).onDeviceMotionDialogAllowClicked=(this||t).onDeviceMotionDialogAllowClicked.bind(this||t);(this||t).onDeviceMotionDialogDenyClicked=(this||t).onDeviceMotionDialogDenyClicked.bind(this||t);DeviceOrientationEvent.requestPermission().then((function(){e.el.emit("deviceorientationpermissiongranted");e.permissionGranted=true})).catch((function(){e.devicePermissionDialogEl=createPermissionDialog(e.data.denyButtonText,e.data.allowButtonText,e.data.deviceMotionMessage,e.onDeviceMotionDialogAllowClicked,e.onDeviceMotionDialogDenyClicked);e.el.appendChild(e.devicePermissionDialogEl)}))}else(this||t).permissionGranted=true}},remove:function(){(this||t).devicePermissionDialogEl&&(this||t).el.removeChild((this||t).devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var e=this||t;var n=createAlertDialog(e.data.cancelButtonText,e.data.httpsMessage,(function(){e.el.removeChild(n)}));(this||t).el.appendChild(n)},onDeviceMotionDialogAllowClicked:function(){var e=this||t;(this||t).el.emit("deviceorientationpermissionrequested");DeviceOrientationEvent.requestPermission().then((function(t){if(t==="granted"){e.el.emit("deviceorientationpermissiongranted");e.permissionGranted=true}else e.el.emit("deviceorientationpermissionrejected");e.remove()})).catch(console.error)}});
/**
         * Create a modal dialog that request users permission to access the Device Motion API.
         *
         * @param {string} denyText
         * @param {string} allowText
         * @param {string} dialogText
         * @param {function} onAllowClicked - click event handler
         * @param {function} onDenyClicked - click event handler
         *
         * @returns {Element} Wrapper <div>.
         */function createPermissionDialog(e,t,n,r,s){var o;var l;var c;o=document.createElement("div");o.classList.add(h);l=document.createElement("button");l.classList.add(d,f);l.setAttribute(a.AFRAME_INJECTED,"");l.innerHTML=e;o.appendChild(l);c=document.createElement("button");c.classList.add(d,p);c.setAttribute(a.AFRAME_INJECTED,"");c.innerHTML=t;o.appendChild(c);c.addEventListener("click",(function(e){e.stopPropagation();r()}));l.addEventListener("click",(function(e){e.stopPropagation();s()}));return createDialog(n,o)}function createAlertDialog(e,t,n){var r;var s;r=document.createElement("div");r.classList.add(h);s=document.createElement("button");s.classList.add(d,m);s.setAttribute(a.AFRAME_INJECTED,"");s.innerHTML=e;r.appendChild(s);s.addEventListener("click",(function(e){e.stopPropagation();n()}));return createDialog(t,r)}function createDialog(e,t){var n;var r;var s;var h;n=document.createElement("div");n.classList.add(o);n.setAttribute(a.AFRAME_INJECTED,"");r=document.createElement("div");r.className=l;r.setAttribute(a.AFRAME_INJECTED,"");n.appendChild(r);s=document.createElement("div");s.classList.add(u);r.appendChild(s);h=document.createElement("div");h.classList.add(c);h.innerHTML=e;s.appendChild(h);r.appendChild(t);return n}},"./src/components/scene/embedded.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>a});var s=r("./src/core/component.js");var a=(0,s.registerComponent)("embedded",{dependencies:["xr-mode-ui"],schema:{default:true},sceneOnly:true,update:function(){var e=(this||t).el;var n=e.querySelector(".a-enter-vr");if((this||t).data===true){n&&n.classList.add("embedded");e.removeFullScreenStyles()}else{n&&n.classList.remove("embedded");e.addFullScreenStyles()}}})},"./src/components/scene/fog.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./src/core/component.js");var a=r("./node_modules/three/build/three.core.js");var o=(0,s.registerComponent)("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:true,update:function(){var e=(this||t).data;var n=(this||t).el;var r=(this||t).el.object3D.fog;r&&e.type===r.name?Object.keys((this||t).schema).forEach((function(t){var n=e[t];t==="color"&&(n=new a.Color(n));r[t]=n})):n.object3D.fog=getFog(e)},remove:function(){var e=(this||t).el;var n=(this||t).el.object3D.fog;n&&(e.object3D.fog=null)}});
/**
         * Creates a fog object. Sets fog.name to be able to detect fog type changes.
         *
         * @param {object} data - Fog data.
         * @returns {object} fog
         */function getFog(e){var t;t=e.type==="exponential"?new a.FogExp2(e.color,e.density):new a.Fog(e.color,e.near,e.far);t.name=e.type;return t}},"./src/components/scene/inspector.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>p});var s=r("./src/constants/index.js");var a=r("./src/core/component.js");var o=r("./package.json");var l=r("./src/utils/index.js");function getFuzzyPatchVersion(e){var t=e.split(".");t[2]="x";return t.join(".")}var c="https://unpkg.com/aframe-inspector@"+getFuzzyPatchVersion(o.version)+"/dist/aframe-inspector.min.js";var u=c;var h="Loading Inspector";var d="Error loading Inspector";var p=(0,a.registerComponent)("inspector",{schema:{url:{default:u}},sceneOnly:true,init:function(){(this||t).firstPlay=true;(this||t).onKeydown=(this||t).onKeydown.bind(this||t);(this||t).onMessage=(this||t).onMessage.bind(this||t);this.initOverlay();window.addEventListener("keydown",(this||t).onKeydown);window.addEventListener("message",(this||t).onMessage)},play:function(){var e;if((this||t).firstPlay){e=l.getUrlParameter("inspector");if(e!=="false"&&!!e){this.openInspector();(this||t).firstPlay=false}}},initOverlay:function(){var e='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';(this||t).loadingMessageEl=document.createElement("div");(this||t).loadingMessageEl.classList.add("a-inspector-loader");(this||t).loadingMessageEl.innerHTML=h+e},remove:function(){this.removeEventListeners()},onKeydown:function(e){var t=e.keyCode===73&&(e.ctrlKey&&e.altKey||e.getModifierState("AltGraph"));t&&this.openInspector()},showLoader:function(){document.body.appendChild((this||t).loadingMessageEl)},hideLoader:function(){document.body.removeChild((this||t).loadingMessageEl)},onMessage:function(e){e.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(e){var n=this||t;var r;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected)AFRAME.INSPECTOR.open(e);else{this.showLoader();r=document.createElement("script");r.src=(this||t).data.url;r.setAttribute("data-name","aframe-inspector");r.setAttribute(s.AFRAME_INJECTED,"");r.onload=function(){AFRAME.INSPECTOR.open(e);n.hideLoader();n.removeEventListeners()};r.onerror=function(){n.loadingMessageEl.innerHTML=d};document.head.appendChild(r);AFRAME.inspectorInjected=true}},removeEventListeners:function(){window.removeEventListener("keydown",(this||t).onKeydown);window.removeEventListener("message",(this||t).onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./src/core/component.js");var a=r("./src/utils/index.js");var o=(0,s.registerComponent)("keyboard-shortcuts",{schema:{enterVR:{default:true},exitVR:{default:true}},sceneOnly:true,init:function(){(this||t).onKeyup=(this||t).onKeyup.bind(this||t)},play:function(){window.addEventListener("keyup",(this||t).onKeyup,false)},pause:function(){window.removeEventListener("keyup",(this||t).onKeyup)},onKeyup:function(e){var n=(this||t).el;if((0,a.shouldCaptureKeyEvent)(e)){(this||t).data.enterVR&&e.keyCode===70&&n.enterVR();(this||t).data.exitVR&&e.keyCode===27&&n.exitVR()}}})},"./src/components/scene/pool.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>l});var s=r("./src/utils/index.js");var a=r("./src/core/component.js");var o=(0,s.debug)("components:pool:warn");var l=(0,a.registerComponent)("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:false}},sceneOnly:true,multiple:true,initPool:function(){var e;(this||t).availableEls=[];(this||t).usedEls=[];(this||t).data.mixin||o("No mixin provided for pool component.");if((this||t).data.container){(this||t).container=document.querySelector((this||t).data.container);(this||t).container||o("Container "+(this||t).data.container+" not found.")}(this||t).container=(this||t).container||(this||t).el;for(e=0;e<(this||t).data.size;++e)this.createEntity()},update:function(e){var n=(this||t).data;e.mixin===n.mixin&&e.size===n.size||this.initPool()},createEntity:function(){var e;e=document.createElement("a-entity");e.play=this.wrapPlay(e.play);e.setAttribute("mixin",(this||t).data.mixin);e.object3D.visible=false;e.pause();(this||t).container.appendChild(e);(this||t).availableEls.push(e);var n=(this||t).usedEls;e.addEventListener("loaded",(function(){if(n.indexOf(e)===-1){e.object3DParent=e.object3D.parent;e.object3D.parent.remove(e.object3D)}}))},wrapPlay:function(e){var n=(this||t).usedEls;return function(){n.indexOf(this||t)!==-1&&e.call(this||t)}},requestEntity:function(){var e;if((this||t).availableEls.length===0){if((this||t).data.dynamic===false){o("Requested entity from empty pool: "+(this||t).attrName);return}o("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+(this||t).attrName);this.createEntity()}e=(this||t).availableEls.shift();(this||t).usedEls.push(e);if(e.object3DParent){e.object3DParent.add(e.object3D);this.updateRaycasters()}e.object3D.visible=true;return e},returnEntity:function(e){var n=(this||t).usedEls.indexOf(e);if(n!==-1){(this||t).usedEls.splice(n,1);(this||t).availableEls.push(e);e.object3DParent=e.object3D.parent;e.object3D.parent.remove(e.object3D);this.updateRaycasters();e.object3D.visible=false;e.pause();return e}o("The returned entity was not previously pooled from "+(this||t).attrName)},updateRaycasters:function(){var e=document.querySelectorAll("[raycaster]");e.forEach((function(e){e.components.raycaster.setDirty()}))}})},"./src/components/scene/real-world-meshing.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=(0,a.registerComponent)("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:true},meshMixin:{default:true},planesEnabled:{default:true},planeMixin:{default:""}},sceneOnly:true,init:function(){var e=(this||t).el.getAttribute("webxr");var n=e.requiredFeatures;if(n.indexOf("mesh-detection")===-1){n.push("mesh-detection");(this||t).el.setAttribute("webxr",e)}if(n.indexOf("plane-detection")===-1){n.push("plane-detection");(this||t).el.setAttribute("webxr",e)}(this||t).meshEntities=[];(this||t).initWorldMeshEntity=(this||t).initWorldMeshEntity.bind(this||t)},tick:function(){if((this||t).el.is("ar-mode")){this.detectMeshes();this.updateMeshes()}},detectMeshes:function(){var e=(this||t).data;var n;var r;var s=(this||t).el;var a;var o=(this||t).meshEntities;var l=false;var c=[];var u=(this||t).data.filterLabels;a=s.frame;n=a.detectedMeshes;r=a.detectedPlanes;for(var h=0;h<o.length;h++)o[h].present=false;if(e.meshesEnabled)for(var d of n.values())if(!u.length||u.indexOf(d.semanticLabel)!==-1){for(h=0;h<o.length;h++)if(d===o[h].mesh){l=true;o[h].present=true;o[h].lastChangedTime<d.lastChangedTime&&this.updateMeshGeometry(o[h].el,d);o[h].lastChangedTime=d.lastChangedTime;break}l||c.push(d);l=false}if(e.planesEnabled)for(d of r.values())if(!u.length||u.indexOf(d.semanticLabel)!==-1){for(h=0;h<o.length;h++)if(d===o[h].mesh){l=true;o[h].present=true;o[h].lastChangedTime<d.lastChangedTime&&this.updateMeshGeometry(o[h].el,d);o[h].lastChangedTime=d.lastChangedTime;break}l||c.push(d);l=false}this.deleteMeshes();this.createNewMeshes(c)},updateMeshes:function(){var e=new s.Matrix4;return function(){var n;var r=(this||t).el;var s;var a=r.frame;var o=(this||t).meshEntities;var l=r.renderer.xr.getReferenceSpace();var c;for(var u=0;u<o.length;u++){c=o[u].mesh.meshSpace||o[u].mesh.planeSpace;n=a.getPose(c,l);s=o[u].el;if(s.hasLoaded){e.fromArray(n.transform.matrix);e.decompose(s.object3D.position,s.object3D.quaternion,s.object3D.scale)}}}}(),deleteMeshes:function(){var e=(this||t).meshEntities;var n=[];for(var r=0;r<e.length;r++)e[r].present?n.push(e[r]):(this||t).el.removeChild(e[r]);(this||t).meshEntities=n},createNewMeshes:function(e){var n;for(var r=0;r<e.length;r++){n=document.createElement("a-entity");(this||t).meshEntities.push({mesh:e[r],el:n});n.addEventListener("loaded",(this||t).initWorldMeshEntity);(this||t).el.appendChild(n)}},initMeshGeometry:function(e){var t;var n;var r;if(e instanceof XRPlane){n=new s.Shape;r=e.polygon;for(var a=0;a<r.length;++a)a===0?n.moveTo(r[a].x,r[a].z):n.lineTo(r[a].x,r[a].z);t=new s.ShapeGeometry(n);t.rotateX(Math.PI/2);return t}t=new s.BufferGeometry;t.setAttribute("position",new s.BufferAttribute(e.vertices,3));t.setIndex(new s.BufferAttribute(e.indices,1));return t},initWorldMeshEntity:function(e){var n=e.target;var r;var a;var o;var l=(this||t).meshEntities;for(var c=0;c<l.length;c++)if(l[c].el===n){o=l[c];break}r=this.initMeshGeometry(o.mesh);a=new s.Mesh(r,new s.MeshBasicMaterial({color:Math.random()*16777215,side:s.DoubleSide}));n.setObject3D("mesh",a);o.mesh instanceof XRPlane&&(this||t).data.planeMixin?n.setAttribute("mixin",(this||t).data.planeMixin):(this||t).data.meshMixin&&n.setAttribute("mixin",(this||t).data.meshMixin);n.setAttribute("data-world-mesh",o.mesh.semanticLabel)},updateMeshGeometry:function(e,t){var n=e.getObject3D("mesh");n.geometry.dispose();n.geometry=this.initMeshGeometry(t)}})},"./src/components/scene/reflection.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");function updateLights(e,t,n,r){var s=Math.max(e.primaryLightIntensity.x,Math.max(e.primaryLightIntensity.y,e.primaryLightIntensity.z));t.sh.fromArray(e.sphericalHarmonicsCoefficients);t.intensity=3.14;if(n){n.color.setRGB(e.primaryLightIntensity.x/s,e.primaryLightIntensity.y/s,e.primaryLightIntensity.z/s);n.intensity=s;r.copy(e.primaryLightDirection)}}var o=(0,a.registerComponent)("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:true,init:function(){var e=this||t;(this||t).cubeRenderTarget=new s.WebGLCubeRenderTarget(16);(this||t).cubeCamera=new s.CubeCamera(.1,1e3,(this||t).cubeRenderTarget);(this||t).lightingEstimationTexture=new s.WebGLCubeRenderTarget(16).texture;(this||t).needsVREnvironmentUpdate=true;var n=(this||t).el.getAttribute("webxr");var r=n.optionalFeatures;if(!r.includes("light-estimation")){r.push("light-estimation");(this||t).el.setAttribute("webxr",n)}(this||t).el.addEventListener("enter-vr",(function(){if(e.el.is("ar-mode")){var t=e.el.renderer;var n=t.xr.getSession();n.requestLightProbe&&e.startLightProbe()}}));(this||t).el.addEventListener("exit-vr",(function(){e.xrLightProbe&&e.stopLightProbe()}));(this||t).el.object3D.environment=(this||t).cubeRenderTarget.texture},stopLightProbe:function(){(this||t).xrLightProbe=null;(this||t).probeLight&&((this||t).probeLight.components.light.light.intensity=0);(this||t).needsVREnvironmentUpdate=true;(this||t).el.object3D.environment=(this||t).cubeRenderTarget.texture},startLightProbe:function(){(this||t).needsLightProbeUpdate=true},setupLightProbe:function(){var e=(this||t).el.renderer;var n=e.xr.getSession();var r=this||t;var s=e.getContext();if(!(this||t).probeLight){var a=document.createElement("a-light");a.setAttribute("type","probe");a.setAttribute("intensity",0);(this||t).el.appendChild(a);(this||t).probeLight=a}switch(n.preferredReflectionFormat){case"srgba8":s.getExtension("EXT_sRGB");break;case"rgba16f":s.getExtension("OES_texture_half_float");break}(this||t).glBinding=new XRWebGLBinding(n,s);s.getExtension("EXT_sRGB");s.getExtension("OES_texture_half_float");n.requestLightProbe().then((function(e){r.xrLightProbe=e;e.addEventListener("reflectionchange",r.updateXRCubeMap.bind(r))})).catch((function(e){console.warn("Lighting estimation not supported: "+e.message);console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')}))},updateXRCubeMap:function(){var e=(this||t).el.renderer;var n=(this||t).glBinding.getReflectionCubeMap((this||t).xrLightProbe);if(n){var r=e.properties.get((this||t).lightingEstimationTexture);r.__webglTexture=n;(this||t).lightingEstimationTexture.needsPMREMUpdate=true;(this||t).el.object3D.environment=(this||t).lightingEstimationTexture}},tick:function(){var e=(this||t).el.object3D;var n=(this||t).el.renderer;var r=(this||t).el.frame;if(r&&(this||t).xrLightProbe){var s=r.getLightEstimate((this||t).xrLightProbe);s&&updateLights(s,(this||t).probeLight.components.light.light,(this||t).data.directionalLight&&(this||t).data.directionalLight.components.light.light,(this||t).data.directionalLight&&(this||t).data.directionalLight.object3D.position)}if((this||t).needsVREnvironmentUpdate){e.environment=null;(this||t).needsVREnvironmentUpdate=false;(this||t).cubeCamera.position.set(0,1.6,0);(this||t).cubeCamera.update(n,e);e.environment=(this||t).cubeRenderTarget.texture}if((this||t).needsLightProbeUpdate&&r){this.setupLightProbe();(this||t).needsLightProbeUpdate=false}},remove:function(){(this||t).el.object3D.environment=null;(this||t).probeLight&&(this||t).el.removeChild((this||t).probeLight)}})},"./src/components/scene/screenshot.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./src/core/component.js");var a=r("./node_modules/three/build/three.core.js");var o=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n");var l=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join("\n");var c=(0,s.registerComponent)("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:true,setup:function(){var e=(this||t).el;if(!(this||t).canvas){var n=e.renderer.getContext();if(n){(this||t).cubeMapSize=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE);(this||t).material=new a.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:o,fragmentShader:l,side:a.DoubleSide});(this||t).quad=new a.Mesh(new a.PlaneGeometry(1,1),(this||t).material);(this||t).quad.visible=false;(this||t).camera=new a.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4);(this||t).canvas=document.createElement("canvas");(this||t).ctx=(this||t).canvas.getContext("2d");e.object3D.add((this||t).quad);(this||t).onKeyDown=(this||t).onKeyDown.bind(this||t)}}},getRenderTarget:function(e,n){return new a.WebGLRenderTarget(e,n,{colorSpace:(this||t).el.sceneEl.renderer.outputColorSpace,minFilter:a.LinearFilter,magFilter:a.LinearFilter,wrapS:a.ClampToEdgeWrapping,wrapT:a.ClampToEdgeWrapping,format:a.RGBAFormat,type:a.UnsignedByteType})},resize:function(e,n){(this||t).quad.scale.set(e,n,1);(this||t).camera.left=-1*e/2;(this||t).camera.right=e/2;(this||t).camera.top=n/2;(this||t).camera.bottom=-1*n/2;(this||t).camera.updateProjectionMatrix();(this||t).canvas.width=e;(this||t).canvas.height=n},play:function(){window.addEventListener("keydown",(this||t).onKeyDown)},onKeyDown:function(e){var n=e.keyCode===83&&e.ctrlKey&&e.altKey;if((this||t).data&&n){var r=e.shiftKey?"equirectangular":"perspective";this.capture(r)}},
/**
           * Capture a screenshot of the scene.
           *
           * @param {string} projection - Screenshot projection (equirectangular or perspective).
           */
setCapture:function(e){var n=(this||t).el;var r;var s;var o;var l;if(e==="perspective"){(this||t).quad.visible=false;s=(this||t).data.camera&&(this||t).data.camera.components.camera.camera||n.camera;r={width:(this||t).data.width,height:(this||t).data.height}}else{s=(this||t).camera;l=new a.WebGLCubeRenderTarget(Math.min((this||t).cubeMapSize,2048),{format:a.RGBFormat,generateMipmaps:true,minFilter:a.LinearMipmapLinearFilter,colorSpace:a.SRGBColorSpace});o=new a.CubeCamera(n.camera.near,n.camera.far,l);n.camera.getWorldPosition(o.position);n.camera.getWorldQuaternion(o.quaternion);o.update(n.renderer,n.object3D);(this||t).quad.material.uniforms.map.value=o.renderTarget.texture;r={width:(this||t).data.width,height:(this||t).data.height};(this||t).quad.visible=true}return{camera:s,size:r,projection:e}},capture:function(e){var n=(this||t).el.renderer.xr.enabled;var r=(this||t).el.renderer;var s;this.setup();r.xr.enabled=false;s=this.setCapture(e);this.renderCapture(s.camera,s.size,s.projection);this.saveCapture();r.xr.enabled=n},getCanvas:function(e){var n=(this||t).el.renderer.xr.enabled;var r=(this||t).el.renderer;this.setup();var s=this.setCapture(e);r.xr.enabled=false;this.renderCapture(s.camera,s.size,s.projection);r.xr.enabled=n;return(this||t).canvas},renderCapture:function(e,n,r){var s=(this||t).el.renderer.autoClear;var a=(this||t).el;var o;var l;var c;var u=a.renderer;l=this.getRenderTarget(n.width,n.height);c=new Uint8Array(4*n.width*n.height);this.resize(n.width,n.height);u.autoClear=true;u.clear();u.setRenderTarget(l);u.render(a.object3D,e);u.autoClear=s;u.readRenderTargetPixels(l,0,0,n.width,n.height,c);u.setRenderTarget(null);r==="perspective"&&(c=this.flipPixelsVertically(c,n.width,n.height));o=new ImageData(new Uint8ClampedArray(c),n.width,n.height);(this||t).quad.visible=false;(this||t).ctx.putImageData(o,0,0)},flipPixelsVertically:function(e,t,n){var r=e.slice(0);for(var s=0;s<t;++s)for(var a=0;a<n;++a){r[s*4+a*t*4]=e[s*4+(n-a)*t*4];r[s*4+1+a*t*4]=e[s*4+1+(n-a)*t*4];r[s*4+2+a*t*4]=e[s*4+2+(n-a)*t*4];r[s*4+3+a*t*4]=e[s*4+3+(n-a)*t*4]}return r},saveCapture:function(){(this||t).canvas.toBlob((function(e){var t="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png";var n=document.createElement("a");var r=URL.createObjectURL(e);n.href=r;n.setAttribute("download",t);n.innerHTML="downloading...";n.style.display="none";document.body.appendChild(n);setTimeout((function(){n.click();document.body.removeChild(n)}),1)}),"image/png")}})},"./src/components/scene/stats.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>f});var s=r("./src/core/component.js");var a=r("./vendor/rStats.js");var o=r.n(a);var l=r("./src/utils/index.js");var c=r("./vendor/rStats.extras.js");r.n(c);var u=r("./src/lib/rStatsAframe.js");r.n(u);var h=window.aframeStats;var d="a-hidden";var p=window.threeStats;var f=(0,s.registerComponent)("stats",{schema:{default:true},sceneOnly:true,init:function(){var e=(this||t).el;if(l.getUrlParameter("stats")!=="false"){(this||t).stats=createStats(e);(this||t).statsEl=document.querySelector(".rs-base");(this||t).hideBound=(this||t).hide.bind(this||t);(this||t).showBound=(this||t).show.bind(this||t);e.addEventListener("enter-vr",(this||t).hideBound);e.addEventListener("exit-vr",(this||t).showBound)}},update:function(){if((this||t).stats)return(this||t).data?this.show():this.hide()},remove:function(){(this||t).el.removeEventListener("enter-vr",(this||t).hideBound);(this||t).el.removeEventListener("exit-vr",(this||t).showBound);(this||t).statsEl&&(this||t).statsEl.parentNode.removeChild((this||t).statsEl)},tick:function(){var e=(this||t).stats;if(e){e("rAF").tick();e("FPS").frame();e().update()}},hide:function(){(this||t).statsEl.classList.add(d)},show:function(){(this||t).statsEl.classList.remove(d)}});function createStats(e){var t=new p(e.renderer);var n=new h(e);var r=e.isMobile?[]:[t,n];return new(o())({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:r})}},"./src/components/scene/xr-mode-ui.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>f});var s=r("./src/core/component.js");var a=r("./src/constants/index.js");var o=r("./src/utils/index.js");var l="a-enter-vr";var c="a-enter-ar";var u="a-enter-vr-button";var h="a-enter-ar-button";var d="a-hidden";var p="a-orientation-modal";var f=(0,s.registerComponent)("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:true},enterVRButton:{default:""},enterVREnabled:{default:true},enterARButton:{default:""},enterAREnabled:{default:true},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:true,init:function(){var e=this||t;var n=(this||t).el;if(o.getUrlParameter("ui")!=="false"){(this||t).insideLoader=false;(this||t).enterVREl=null;(this||t).enterAREl=null;(this||t).orientationModalEl=null;this.bindMethods();n.addEventListener("enter-vr",(this||t).updateEnterInterfaces);n.addEventListener("exit-vr",(this||t).updateEnterInterfaces);n.addEventListener("update-vr-devices",(this||t).updateEnterInterfaces);window.addEventListener("message",(function(t){if(t.data.type==="loaderReady"){e.insideLoader=true;e.remove()}}));window.addEventListener("orientationchange",(this||t).toggleOrientationModalIfNeeded)}},bindMethods:function(){(this||t).onEnterVRButtonClick=(this||t).onEnterVRButtonClick.bind(this||t);(this||t).onEnterARButtonClick=(this||t).onEnterARButtonClick.bind(this||t);(this||t).onModalClick=(this||t).onModalClick.bind(this||t);(this||t).toggleOrientationModalIfNeeded=(this||t).toggleOrientationModalIfNeeded.bind(this||t);(this||t).updateEnterInterfaces=(this||t).updateEnterInterfaces.bind(this||t)},onModalClick:function(){(this||t).el.exitVR()},onEnterVRButtonClick:function(){(this||t).el.enterVR()},onEnterARButtonClick:function(){(this||t).el.enterAR()},update:function(){var e=(this||t).data;var n=(this||t).el;if(!e.enabled||(this||t).insideLoader||o.getUrlParameter("ui")==="false")return this.remove();if(!((this||t).enterVREl||(this||t).enterAREl||(this||t).orientationModalEl)){if(!(this||t).enterVREl&&e.enterVREnabled&&(e.XRMode==="xr"||e.XRMode==="vr"))if(e.enterVRButton){(this||t).enterVREl=document.querySelector(e.enterVRButton);(this||t).enterVREl.addEventListener("click",(this||t).onEnterVRButtonClick)}else{(this||t).enterVREl=createEnterVRButton((this||t).onEnterVRButtonClick);n.appendChild((this||t).enterVREl)}if(!(this||t).enterAREl&&e.enterAREnabled&&(e.XRMode==="xr"||e.XRMode==="ar"))if(e.enterARButton){(this||t).enterAREl=document.querySelector(e.enterARButton);(this||t).enterAREl.addEventListener("click",(this||t).onEnterARButtonClick)}else{(this||t).enterAREl=createEnterARButton((this||t).onEnterARButtonClick,e.XRMode==="xr");n.appendChild((this||t).enterAREl)}(this||t).orientationModalEl=createOrientationModal((this||t).onModalClick);n.appendChild((this||t).orientationModalEl);this.updateEnterInterfaces()}},remove:function(){[(this||t).enterVREl,(this||t).enterAREl,(this||t).orientationModalEl].forEach((function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}));(this||t).enterVREl=void 0;(this||t).enterAREl=void 0;(this||t).orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded();this.toggleEnterARButtonIfNeeded();this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var e=(this||t).el;if((this||t).enterVREl)if(e.is("vr-mode")||(e.isMobile||o.device.isMobileDeviceRequestingDesktopSite())&&!o.device.checkVRSupport())(this||t).enterVREl.classList.add(d);else{o.device.checkVRSupport()||(this||t).enterVREl.classList.add("fullscreen");(this||t).enterVREl.classList.remove(d);e.enterVR(false,true)}},toggleEnterARButtonIfNeeded:function(){var e=(this||t).el;if((this||t).enterAREl)if(e.is("vr-mode")||!o.device.checkARSupport())(this||t).enterAREl.classList.add(d);else{(this||t).enterAREl.classList.remove(d);e.enterVR(true,true)}},toggleOrientationModalIfNeeded:function(){var e=(this||t).el;var n=(this||t).orientationModalEl;n&&e.isMobile&&(!o.device.isLandscape()&&e.is("vr-mode")?n.classList.remove(d):n.classList.add(d))}});
/**
         * Create a button that when clicked will enter into stereo-rendering mode for VR.
         *
         * Structure: <div><button></div>
         *
         * @param {function} onClick - click event handler
         * @returns {Element} Wrapper <div>.
         */function createEnterVRButton(e){var t;var n;n=document.createElement("div");n.classList.add(l);n.setAttribute(a.AFRAME_INJECTED,"");t=document.createElement("button");t.className=u;t.setAttribute("title","Enter VR mode with a headset or fullscreen without");t.setAttribute(a.AFRAME_INJECTED,"");o.device.isMobile()&&applyStickyHoverFix(t);n.appendChild(t);t.addEventListener("click",(function(t){e();t.stopPropagation()}));return n}
/**
         * Create a button that when clicked will enter into AR mode
         *
         * Structure: <div><button></div>
         *
         * @param {function} onClick - click event handler
         * @returns {Element} Wrapper <div>.
         */function createEnterARButton(e,t){var n;var r;r=document.createElement("div");r.classList.add(c);t&&r.classList.add("xr");r.setAttribute(a.AFRAME_INJECTED,"");n=document.createElement("button");n.className=h;n.setAttribute("title","Enter AR mode with a headset or handheld device.");n.setAttribute(a.AFRAME_INJECTED,"");o.device.isMobile()&&applyStickyHoverFix(n);r.appendChild(n);n.addEventListener("click",(function(t){e();t.stopPropagation()}));return r}
/**
         * Creates a modal dialog to request the user to switch to landscape orientation.
         *
         * @param {function} onClick - click event handler
         * @returns {Element} Wrapper <div>.
         */function createOrientationModal(e){var t=document.createElement("div");t.className=p;t.classList.add(d);t.setAttribute(a.AFRAME_INJECTED,"");var n=document.createElement("button");n.setAttribute(a.AFRAME_INJECTED,"");n.innerHTML="Exit VR";n.addEventListener("click",e);t.appendChild(n);return t}
/**
         * CSS hover state is sticky in iOS (as in 12/18/2019)
         * They are not removed on mouseleave and this function applies a class
         * to resets the style.
         *
         * @param {function} buttonEl - Button element
         */function applyStickyHoverFix(e){e.addEventListener("touchstart",(function(){e.classList.remove("resethover")}),{passive:true});e.addEventListener("touchend",(function(){e.classList.add("resethover")}),{passive:true})}},"./src/components/shadow.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=(0,a.registerComponent)("shadow",{schema:{cast:{default:true},receive:{default:true}},init:function(){(this||t).onMeshChanged=(this||t).update.bind(this||t);(this||t).el.addEventListener("object3dset",(this||t).onMeshChanged);(this||t).system.setShadowMapEnabled(true)},update:function(){var e=(this||t).data;this.updateDescendants(e.cast,e.receive)},remove:function(){var e=(this||t).el;e.removeEventListener("object3dset",(this||t).onMeshChanged);this.updateDescendants(false,false)},updateDescendants:function(e,n){var r=(this||t).el.sceneEl;(this||t).el.object3D.traverse((function(t){if(t instanceof s.Mesh){t.castShadow=e;t.receiveShadow=n;if(r.hasLoaded&&t.material){var a=Array.isArray(t.material)?t.material:[t.material];for(var o=0;o<a.length;o++)a[o].needsUpdate=true}}}))}})},"./src/components/sound.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>c});var s=r("./src/core/component.js");var a=r("./src/utils/index.js");var o=r("./node_modules/three/build/three.core.js");var l=(0,a.debug)("components:sound:warn");var c=(0,s.registerComponent)("sound",{schema:{autoplay:{default:false},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:false},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:true},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:true,init:function(){var e=this||t;(this||t).listener=null;(this||t).audioLoader=new o.AudioLoader;(this||t).pool=new o.Group;(this||t).loaded=false;(this||t).mustPlay=false;(this||t).playSoundBound=function(){e.playSound()}},update:function(e){var n=(this||t).data;var r;var s;var a=n.src!==e.src;if(a){if(!n.src)return;this.setupSound()}for(r=0;r<(this||t).pool.children.length;r++){s=(this||t).pool.children[r];if(n.positional){s.setDistanceModel(n.distanceModel);s.setMaxDistance(n.maxDistance);s.setRefDistance(n.refDistance);s.setRolloffFactor(n.rolloffFactor)}s.setLoop(n.loop);s.setLoopStart(n.loopStart);n.loopStart!==0&&n.loopEnd===0?s.setLoopEnd(s.buffer.duration):s.setLoopEnd(n.loopEnd);s.setVolume(n.volume);s.isPaused=false}n.on!==e.on&&this.updateEventListener(e.on);if(a){var l=this||t;(this||t).loaded=false;(this||t).audioLoader.load(n.src,(function(e){for(r=0;r<l.pool.children.length;r++){s=l.pool.children[r];s.setBuffer(e)}l.loaded=true;o.Cache.remove(n.src);(l.data.autoplay||l.mustPlay)&&l.playSound(l.processSound);l.el.emit("sound-loaded",l.evtDetail,false)}))}},pause:function(){this.stopSound();this.removeEventListener()},play:function(){(this||t).data.autoplay&&this.playSound();this.updateEventListener()},remove:function(){var e;var n;this.removeEventListener();(this||t).el.getObject3D((this||t).attrName)&&(this||t).el.removeObject3D((this||t).attrName);try{for(e=0;e<(this||t).pool.children.length;e++){n=(this||t).pool.children[e];n.disconnect()}}catch(e){l("Audio source not properly disconnected")}},updateEventListener:function(e){var n=(this||t).el;e&&n.removeEventListener(e,(this||t).playSoundBound);n.addEventListener((this||t).data.on,(this||t).playSoundBound)},removeEventListener:function(){(this||t).el.removeEventListener((this||t).data.on,(this||t).playSoundBound)},setupSound:function(){var e=(this||t).el;var n;var r=e.sceneEl;var s=this||t;var a;if((this||t).pool.children.length>0){this.stopSound();e.removeObject3D("sound")}var l=(this||t).listener=r.audioListener||new o.AudioListener;r.audioListener=l;r.camera&&r.camera.add(l);r.addEventListener("camera-set-active",(function(e){e.detail.cameraEl.getObject3D("camera").add(l)}));(this||t).pool=new o.Group;for(n=0;n<(this||t).data.poolSize;n++){a=(this||t).data.positional?new o.PositionalAudio(l):new o.Audio(l);(this||t).pool.add(a)}e.setObject3D((this||t).attrName,(this||t).pool);for(n=0;n<(this||t).pool.children.length;n++){a=(this||t).pool.children[n];a.onEnded=function(){(this||t).isPlaying=false;s.el.emit("sound-ended",s.evtDetail,false)}}},pauseSound:function(){var e;var n;(this||t).isPlaying=false;for(e=0;e<(this||t).pool.children.length;e++){n=(this||t).pool.children[e];if(n.source&&n.source.buffer&&n.isPlaying&&!n.isPaused){n.isPaused=true;n.pause()}}},playSound:function(e){var n;var r;var s;if((this||t).loaded){n=false;(this||t).isPlaying=true;for(r=0;r<(this||t).pool.children.length;r++){s=(this||t).pool.children[r];if(s.isPlaying||!s.buffer||n);else{e&&e(s);s.play();s.isPaused=false;n=true}}if(n){(this||t).mustPlay=false;(this||t).processSound=void 0}else l("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",(this||t).el)}else{l("Sound not loaded yet. It will be played once it finished loading");(this||t).mustPlay=true;(this||t).processSound=e}},stopSound:function(){var e;var n;(this||t).isPlaying=false;for(e=0;e<(this||t).pool.children.length;e++){n=(this||t).pool.children[e];if(!n.source||!n.source.buffer)return;n.stop()}}})},"./src/components/text.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>R,FONTS:()=>x});var s=r("./node_modules/three-bmfont-text/index.js");var a=r.n(s);var o=r("./node_modules/load-bmfont/browser.js");var l=r.n(o);var c=r("./src/core/component.js");var u=r("./src/core/shader.js");var h=r("./node_modules/three/build/three.core.js");var d=r("./src/utils/index.js");var p=r("./src/constants/index.js");var f=d.debug("components:text:error");var m=d.debug("components:text:warn");var g=1;var y=16;var b=p.AFRAME_CDN_ROOT+"fonts/";var x={aileronsemibold:b+"Aileron-Semibold.fnt",dejavu:b+"DejaVu-sdf.fnt",exo2bold:b+"Exo2Bold.fnt",exo2semibold:b+"Exo2SemiBold.fnt",kelsonsans:b+"KelsonSans.fnt",monoid:b+"Monoid.fnt",mozillavr:b+"mozillavr.fnt",roboto:b+"Roboto-msdf.json",sourcecodepro:b+"SourceCodePro.fnt"};var _=["roboto"];var M="roboto";var w=new PromiseCache;var S={};var T={};var I=/^\w+:/;var R=(0,c.registerComponent)("text",{multiple:true,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:M},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:true},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:u.shaders},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:true},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){(this||t).shaderData={};(this||t).geometry=a()();this.createOrUpdateMaterial();(this||t).explicitGeoDimensionsChecked=false},update:function(e){var n=(this||t).data;var r=(this||t).currentFont;if(T[n.font])(this||t).texture=T[n.font];else{(this||t).texture=T[n.font]=new h.Texture;(this||t).texture.anisotropy=y}this.createOrUpdateMaterial();if(e.font===n.font){if(r){this.updateGeometry((this||t).geometry,r);this.updateLayout()}}else this.updateFont()},remove:function(){(this||t).geometry.dispose();(this||t).geometry=null;(this||t).el.removeObject3D((this||t).attrName);(this||t).material.dispose();(this||t).material=null;(this||t).texture.dispose();(this||t).texture=null;(this||t).shaderObject&&delete(this||t).shaderObject},createOrUpdateMaterial:function(){var e=(this||t).data;var n;var r=(this||t).material;var s;var a=(this||t).shaderData;var o;o=e.shader;_.indexOf(e.font)!==-1||e.font.indexOf("-msdf.")>=0?o="msdf":e.font in x&&_.indexOf(e.font)===-1&&(o="sdf");n=((this||t).shaderObject&&(this||t).shaderObject.name)!==o;a.alphaTest=e.alphaTest;a.color=e.color;a.map=(this||t).texture;a.opacity=e.opacity;a.side=parseSide(e.side);a.transparent=e.transparent;a.negate=e.negate;if(n){s=createShader((this||t).el,o,a);(this||t).material=s.material;(this||t).shaderObject=s.shader;(this||t).material.side=a.side;(this||t).mesh&&((this||t).mesh.material=(this||t).material)}else{(this||t).shaderObject.update(a);r.transparent=a.transparent;r.side=a.side}},updateFont:function(){var e=(this||t).data;var n=(this||t).el;var r;var s=(this||t).geometry;var a=this||t;e.font||m("No font specified. Using the default font.");(this||t).mesh&&((this||t).mesh.visible=false);r=this.lookupFont(e.font||M)||e.font;w.get(r,(function doLoadFont(){return loadFont(r,e.yOffset)})).then((function setFont(t){var o;if(t.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");S[r]||(t.widthFactor=S[t]=computeFontWidthFactor(t));a.currentFont=t;o=a.getFontImageSrc();w.get(o,(function(){return loadTexture(o)})).then((function(r){var o=a.texture;if(o){o.image=r;o.needsUpdate=true;T[e.font]=o;a.texture=o;a.initMesh();a.currentFont=t;a.updateGeometry(s,t);a.updateLayout();a.mesh.visible=true;n.emit("textfontset",{font:e.font,fontObj:t})}})).catch((function(e){f(e.message);f(e.stack)}))})).catch((function(e){f(e.message);f(e.stack)}))},initMesh:function(){if(!(this||t).mesh){(this||t).mesh=new h.Mesh((this||t).geometry,(this||t).material);(this||t).el.setObject3D((this||t).attrName,(this||t).mesh)}},getFontImageSrc:function(){if((this||t).data.fontImage)return(this||t).data.fontImage;var e=this.lookupFont((this||t).data.font||M)||(this||t).data.font;var n=(this||t).currentFont.pages[0];return n.match(I)&&n.indexOf("http")!==0?e.replace(/(\.fnt)|(\.json)/,".png"):h.LoaderUtils.extractUrlBase(e)+n},updateLayout:function(){var e;var n;var r=(this||t).el;var s=(this||t).data;var a=(this||t).geometry;var o;var l;var c;var u=(this||t).mesh;var h;var d;var p;var f;var m;if(u&&a.layout){o=r.getAttribute("geometry");p=s.width||o&&o.width||g;h=computeWidth(s.wrapPixels,s.wrapCount,(this||t).currentFont.widthFactor);d=p/h;c=a.layout;l=d*(c.height+c.descender);if(o&&o.primitive==="plane"){if(!(this||t).explicitGeoDimensionsChecked){(this||t).explicitGeoDimensionsChecked=true;(this||t).hasExplicitGeoWidth=!!o.width;(this||t).hasExplicitGeoHeight=!!o.height}(this||t).hasExplicitGeoWidth||r.setAttribute("geometry","width",p);(this||t).hasExplicitGeoHeight||r.setAttribute("geometry","height",l)}e=s.anchor==="align"?s.align:s.anchor;if(e==="left")f=0;else if(e==="right")f=-1*c.width;else{if(e!=="center")throw new TypeError("Invalid text.anchor property value",e);f=-1*c.width/2}n=s.baseline;if(n==="bottom")m=0;else if(n==="top")m=-1*c.height+c.ascender;else{if(n!=="center")throw new TypeError("Invalid text.baseline property value",n);m=-1*c.height/2}u.position.x=f*d+s.xOffset;u.position.y=m*d;u.position.z=s.zOffset;u.scale.set(d,-1*d,d)}},lookupFont:function(e){return x[e]},updateGeometry:function(){var e={};var n={};var r=/\\n/g;var s=/\\t/g;return function(a,o){var l=(this||t).data;n.font=o;n.lineHeight=l.lineHeight&&isFinite(l.lineHeight)?l.lineHeight:o.common.lineHeight;n.text=l.value.toString().replace(r,"\n").replace(s,"\t");n.width=computeWidth(l.wrapPixels,l.wrapCount,o.widthFactor);a.update(d.extend(e,l,n))}}()});function parseSide(e){switch(e){case"back":return h.FrontSide;case"double":return h.DoubleSide;default:return h.BackSide}}
/**
         * @returns {Promise}
         */function loadFont(e,t){return new Promise((function(n,r){l()(e,(function(s,a){if(s){f("Error loading font",e);r(s)}else{e.indexOf("/Roboto-msdf.json")>=0&&(t=30);t&&a.chars.forEach((function doOffset(e){e.yoffset+=t}));n(a)}}))}))}
/**
         * @returns {Promise}
         */function loadTexture(e){return new Promise((function(t,n){(new h.ImageLoader).load(e,(function(e){t(e)}),void 0,(function(){f("Error loading font image",e);n(null)}))}))}function createShader(e,t,n){var r;var s;s=new u.shaders[t].Shader;s.el=e;s.init(n);s.update(n);r=s.material;r.transparent=n.transparent;return{material:r,shader:s}}function computeWidth(e,t,n){return e||(.5+t)*n}function computeFontWidthFactor(e){var t=0;var n=0;var r=0;e.chars.forEach((function(e){t+=e.xadvance;if(e.id>=48&&e.id<=57){r++;n+=e.xadvance}}));return r?n/r:t/e.chars.length}function PromiseCache(){var e=(this||t).cache={};(this||t).get=function(t,n){if(t in e)return e[t];e[t]=n();return e[t]}}},"./src/components/tracked-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>l});var s=r("./src/core/component.js");var a=r("./src/utils/tracked-controls.js");var o={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};var l=(0,s.registerComponent)("tracked-controls",{schema:{id:{type:"string",default:""},controller:{default:-1},autoHide:{default:true},hand:{type:"string",default:""},handTrackingEnabled:{default:false},iterateControllerProfiles:{default:false}},init:function(){(this||t).buttonEventDetails={};(this||t).buttonStates=(this||t).el.components["tracked-controls"].buttonStates={};(this||t).axis=(this||t).el.components["tracked-controls"].axis=[0,0,0];(this||t).changedAxes=[];(this||t).axisMoveEventDetail={axis:(this||t).axis,changed:(this||t).changedAxes};(this||t).updateController=(this||t).updateController.bind(this||t)},update:function(){this.updateController()},play:function(){var e=(this||t).el.sceneEl;this.updateController();e.addEventListener("controllersupdated",(this||t).updateController)},pause:function(){var e=(this||t).el.sceneEl;e.removeEventListener("controllersupdated",(this||t).updateController)},isControllerPresent:function(e){return!(!(this||t).controller||(this||t).controller.gamepad)&&(e.inputSource.handedness==="none"||e.inputSource.handedness===(this||t).data.hand)},updateController:function(){(this||t).controller=a.findMatchingControllerWebXR((this||t).system.controllers,(this||t).data.id,(this||t).data.hand,(this||t).data.controller,(this||t).data.iterateControllerProfiles,(this||t).data.handTrackingEnabled);(this||t).el.components["tracked-controls"].controller=(this||t).controller},tick:function(){var e=(this||t).el.sceneEl;var n=(this||t).controller;var r=e.frame;(this||t).data.autoHide&&((this||t).el.object3D.visible=!!n);if(n&&e.frame&&(this||t).system.referenceSpace&&!n.hand){(this||t).pose=r.getPose(n.gripSpace,(this||t).system.referenceSpace);this.updatePose();this.updateButtons()}},updatePose:function(){var e=(this||t).el.object3D;var n=(this||t).pose;if(n){e.matrix.elements=n.transform.matrix;e.matrix.decompose(e.position,e.rotation,e.scale)}},updateButtons:function(){var e;var n;var r=(this||t).controller;var s;if(r&&r.gamepad){s=r.gamepad;for(n=0;n<s.buttons.length;++n){(this||t).buttonStates[n]||((this||t).buttonStates[n]={pressed:false,touched:false,value:0});(this||t).buttonEventDetails[n]||((this||t).buttonEventDetails[n]={id:n,state:(this||t).buttonStates[n]});e=s.buttons[n];this.handleButton(n,e)}this.handleAxes()}},
/**
           * Handle presses and touches for a single button.
           *
           * @param {number} id - Index of button in Gamepad button array.
           * @param {number} buttonState - Value of button state from 0 to 1.
           * @returns {boolean} Whether button has changed in any way.
           */
handleButton:function(e,n){var r;r=this.handlePress(e,n)|this.handleTouch(e,n)|this.handleValue(e,n);if(!r)return false;(this||t).el.emit(o.BUTTONCHANGED,(this||t).buttonEventDetails[e],false);return true},
/**
           * An axis is an array of values from -1 (up, left) to 1 (down, right).
           * Compare each component of the axis to the previous value to determine change.
           *
           * @returns {boolean} Whether axes changed.
           */
handleAxes:function(){var e=false;var n=(this||t).controller.gamepad.axes;var r;var s=(this||t).axis;var a=(this||t).changedAxes;(this||t).changedAxes.splice(0,(this||t).changedAxes.length);for(r=0;r<n.length;++r){a.push(s[r]!==n[r]);a[r]&&(e=true)}if(!e)return false;(this||t).axis.splice(0,(this||t).axis.length);for(r=0;r<n.length;r++)(this||t).axis.push(n[r]);(this||t).el.emit(o.AXISMOVE,(this||t).axisMoveEventDetail,false);return true},
/**
           * Determine whether a button press has occurred and emit events as appropriate.
           *
           * @param {string} id - ID of the button to check.
           * @param {object} buttonState - State of the button to check.
           * @returns {boolean} Whether button press state changed.
           */
handlePress:function(e,n){var r;var s=(this||t).buttonStates[e];if(n.pressed===s.pressed)return false;r=n.pressed?o.BUTTONDOWN:o.BUTTONUP;(this||t).el.emit(r,(this||t).buttonEventDetails[e],false);s.pressed=n.pressed;return true},
/**
           * Determine whether a button touch has occurred and emit events as appropriate.
           *
           * @param {string} id - ID of the button to check.
           * @param {object} buttonState - State of the button to check.
           * @returns {boolean} Whether button touch state changed.
           */
handleTouch:function(e,n){var r;var s=(this||t).buttonStates[e];if(n.touched===s.touched)return false;r=n.touched?o.TOUCHSTART:o.TOUCHEND;(this||t).el.emit(r,(this||t).buttonEventDetails[e],false);s.touched=n.touched;return true},
/**
           * Determine whether a button value has changed.
           *
           * @param {string} id - Id of the button to check.
           * @param {object} buttonState - State of the button to check.
           * @returns {boolean} Whether button value changed.
           */
handleValue:function(e,n){var r=(this||t).buttonStates[e];if(n.value===r.value)return false;r.value=n.value;return true}})},"./src/components/valve-index-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>f});var s=r("./src/core/component.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./src/constants/index.js");var l=r("./src/utils/tracked-controls.js");var c=o.AFRAME_CDN_ROOT+"controllers/valve/index/valve-index-";var u={left:c+"left.glb",right:c+"right.glb"};var h="valve";var d={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}};var p={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}};var f=(0,s.registerComponent)("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:true}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var e=this||t;(this||t).controllerPresent=false;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,l.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,l.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchEnd=function(t){(0,l.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).onButtonTouchStart=function(t){(0,l.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).previousButtonValues={};this.bindMethods()},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("model-loaded",(this||t).onModelLoaded);e.addEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("model-loaded",(this||t).onModelLoaded);e.removeEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).data;var n=e.hand==="right"?0:e.hand==="left"?1:2;(0,l.checkControllerPresentAndSetup)(this||t,h,{index:n,iterateControllerProfiles:true,hand:e.hand})},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{idPrefix:h,controller:n.hand==="right"?1:n.hand==="left"?0:2,hand:n.hand});this.loadModel()},loadModel:function(){var e=(this||t).data;e.model&&(this||t).el.setAttribute("gltf-model",""+u[e.hand])},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];var r=(this||t).buttonMeshes;var s;if(n){if(n==="trigger"){s=e.detail.state.value;r&&r.trigger&&(r.trigger.rotation.x=(this||t).triggerOriginalRotationX-s*(Math.PI/40))}(this||t).el.emit(n+"changed",e.detail.state)}},onModelLoaded:function(e){var n;var r=e.detail.model;var s=this||t;if(e.target===(this||t).el&&(this||t).data.model){n=(this||t).buttonMeshes={};n.grip={left:r.getObjectByName("leftgrip"),right:r.getObjectByName("rightgrip")};n.menu=r.getObjectByName("menubutton");n.system=r.getObjectByName("systembutton");n.trackpad=r.getObjectByName("touchpad");n.trigger=r.getObjectByName("trigger");(this||t).triggerOriginalRotationX=n.trigger.rotation.x;Object.keys(n).forEach((function(e){s.setButtonColor(e,s.data.buttonColor)}));r.position.copy(p[(this||t).data.hand]);r.rotation.copy(d[(this||t).data.hand]);(this||t).el.emit("controllermodelready",{name:"valve-index-controls",model:(this||t).data.model,rayOrigin:new a.Vector3(0,0,0)})}},onAxisMoved:function(e){(0,l.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},updateModel:function(e,n){var r;var s;if((this||t).data.model){s=n.indexOf("touch")!==-1;if(!s){r=n==="up"?(this||t).data.buttonColor:(this||t).data.buttonHighlightColor;this.setButtonColor(e,r)}}},setButtonColor:function(e,t){}})},"./src/components/visible.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>a});var s=r("./src/core/component.js");var a=(0,s.registerComponent)("visible",{schema:{default:true},update:function(){(this||t).el.object3D.visible=(this||t).data}})},"./src/components/vive-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>d});var s=r("./src/core/component.js");var a=r("./src/constants/index.js");var o=r("./src/utils/tracked-controls.js");var l=a.AFRAME_CDN_ROOT+"controllers/vive/vr_controller_vive.obj";var c=a.AFRAME_CDN_ROOT+"controllers/vive/vr_controller_vive.mtl";var u="htc-vive";var h={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]};var d=(0,s.registerComponent)("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:true}},after:["tracked-controls"],mapping:h,init:function(){var e=this||t;(this||t).controllerPresent=false;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,o.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,o.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchEnd=function(t){(0,o.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).onButtonTouchStart=function(t){(0,o.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).previousButtonValues={};this.bindMethods()},update:function(){var e=(this||t).data;(this||t).controllerIndex=e.hand==="right"?0:e.hand==="left"?1:2},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("model-loaded",(this||t).onModelLoaded);e.addEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("model-loaded",(this||t).onModelLoaded);e.removeEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){var e=(this||t).data;(0,o.checkControllerPresentAndSetup)(this||t,u,{index:(this||t).controllerIndex,hand:e.hand})},injectTrackedControls:function(){var e=(this||t).el;var n=(this||t).data;e.setAttribute("tracked-controls",{idPrefix:u,hand:n.hand,controller:(this||t).controllerIndex});(this||t).data.model&&(this||t).el.setAttribute("obj-model",{obj:l,mtl:c})},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];var r=(this||t).buttonMeshes;var s;if(n){if(n==="trigger"){s=e.detail.state.value;r&&r.trigger&&(r.trigger.rotation.x=-s*(Math.PI/12))}(this||t).el.emit(n+"changed",e.detail.state)}},onModelLoaded:function(e){var n;var r=e.detail.model;var s=this||t;if(e.target===(this||t).el&&(this||t).data.model){n=(this||t).buttonMeshes={};n.grip={left:r.getObjectByName("leftgrip"),right:r.getObjectByName("rightgrip")};n.menu=r.getObjectByName("menubutton");n.system=r.getObjectByName("systembutton");n.trackpad=r.getObjectByName("touchpad");n.touchpad=r.getObjectByName("touchpad");n.trigger=r.getObjectByName("trigger");Object.keys(n).forEach((function(e){s.setButtonColor(e,s.data.buttonColor)}));r.position.set(0,-.015,.04)}},onAxisMoved:function(e){(0,o.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},updateModel:function(e,n){var r;var s;if((this||t).data.model){s=n.indexOf("touch")!==-1;if(!s){r=n==="up"?(this||t).data.buttonColor:(this||t).data.buttonHighlightColor;this.setButtonColor(e,r)}}},setButtonColor:function(e,n){var r=(this||t).buttonMeshes;if(r)if(e!=="grip")r[e].material.color.set(n);else{r.grip.left.material.color.set(n);r.grip.right.material.color.set(n)}}})},"./src/components/vive-focus-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>h});var s=r("./src/core/component.js");var a=r("./src/constants/index.js");var o=r("./src/utils/tracked-controls.js");var l=a.AFRAME_CDN_ROOT+"controllers/vive/focus-controller/focus-controller.gltf";var c="htc-vive-focus";var u={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]};var h=(0,s.registerComponent)("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:true}},after:["tracked-controls"],mapping:u,bindMethods:function(){(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).removeControllersUpdateListener=(this||t).removeControllersUpdateListener.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},init:function(){var e=this||t;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,o.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,o.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchStart=function(t){(0,o.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).onButtonTouchEnd=function(t){(0,o.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).controllerPresent=false;this.bindMethods()},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("model-loaded",(this||t).onModelLoaded);e.addEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=true;this.addControllersUpdateListener()},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("model-loaded",(this||t).onModelLoaded);e.removeEventListener("axismove",(this||t).onAxisMoved);(this||t).controllerEventsActive=false;this.removeControllersUpdateListener()},checkIfControllerPresent:function(){(0,o.checkControllerPresentAndSetup)(this||t,c,(this||t).data.hand?{hand:(this||t).data.hand}:{})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=(this||t).el;e.setAttribute("tracked-controls",{idPrefix:c});(this||t).data.model&&(this||t).el.setAttribute("gltf-model",l)},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var n=e.detail.model;var r;if(e.target===(this||t).el&&(this||t).data.model){r=(this||t).buttonMeshes={};r.trigger=n.getObjectByName("BumperKey");r.triggerPressed=n.getObjectByName("BumperKey_Press");r.triggerPressed&&(r.triggerPressed.visible=false);r.touchpad=n.getObjectByName("TouchPad");r.touchpadPressed=n.getObjectByName("TouchPad_Press");r.trackpad=n.getObjectByName("TouchPad");r.trackpadPressed=n.getObjectByName("TouchPad_Press");r.trackpadPressed&&(r.trackpadPressed.visible=false)}},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];n&&(this||t).el.emit(n+"changed",e.detail.state)},onAxisMoved:function(e){(0,o.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},updateModel:function(e,n){(this||t).data.model&&this.updateButtonModel(e,n)},updateButtonModel:function(e,n){var r=(this||t).buttonMeshes;var s=e+"Pressed";if(r&&r[e]&&r[s]){var a;switch(n){case"down":a=(this||t).data.buttonHighlightColor;break;case"touchstart":a=(this||t).data.buttonTouchedColor;break}a&&r[s].material.color.set(a);r[s].visible=!!a;r[e].visible=!a}}})},"./src/components/wasd-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>p});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/constants/keyboardevent.js");var o=r("./src/core/component.js");var l=r("./src/utils/index.js");var c=l.shouldCaptureKeyEvent;var u=1e-5;var h=.2;var d=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];var p=(0,o.registerComponent)("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:true},adInverted:{default:false},enabled:{default:true},fly:{default:false},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:true},wsInverted:{default:false}},after:["look-controls"],init:function(){(this||t).keys={};(this||t).easing=1.1;(this||t).velocity=new s.Vector3;(this||t).onBlur=(this||t).onBlur.bind(this||t);(this||t).onContextMenu=(this||t).onContextMenu.bind(this||t);(this||t).onFocus=(this||t).onFocus.bind(this||t);(this||t).onKeyDown=(this||t).onKeyDown.bind(this||t);(this||t).onKeyUp=(this||t).onKeyUp.bind(this||t);(this||t).onVisibilityChange=(this||t).onVisibilityChange.bind(this||t);this.attachVisibilityEventListeners()},tick:function(e,n){var r=(this||t).data;var s=(this||t).el;var a=(this||t).velocity;if(a[r.adAxis]||a[r.wsAxis]||!isEmptyObject((this||t).keys)){n/=1e3;this.updateVelocity(n);(a[r.adAxis]||a[r.wsAxis])&&s.object3D.position.add(this.getMovementVector(n))}},update:function(e){e.adAxis!==(this||t).data.adAxis&&((this||t).velocity[e.adAxis]=0);e.wsAxis!==(this||t).data.wsAxis&&((this||t).velocity[e.wsAxis]=0)},remove:function(){this.removeKeyEventListeners();this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){(this||t).keys={};this.removeKeyEventListeners()},updateVelocity:function(e){var n;var r;var s;var a=(this||t).data;var o=(this||t).keys;var l=(this||t).velocity;var c;var d;r=a.adAxis;c=a.wsAxis;if(e>h){l[r]=0;l[c]=0}else{var p=Math.pow(1/(this||t).easing,e*60);l[r]!==0&&(l[r]=l[r]*p);l[c]!==0&&(l[c]=l[c]*p);Math.abs(l[r])<u&&(l[r]=0);Math.abs(l[c])<u&&(l[c]=0);if(a.enabled){n=a.acceleration;if(a.adEnabled){s=a.adInverted?-1:1;(o.KeyA||o.ArrowLeft)&&(l[r]-=s*n*e);(o.KeyD||o.ArrowRight)&&(l[r]+=s*n*e)}if(a.wsEnabled){d=a.wsInverted?-1:1;(o.KeyW||o.ArrowUp)&&(l[c]-=d*n*e);(o.KeyS||o.ArrowDown)&&(l[c]+=d*n*e)}}}},getMovementVector:function(){var e=new s.Vector3(0,0,0);var n=new s.Euler(0,0,0,"YXZ");return function(r){var a=(this||t).el.getAttribute("rotation");var o=(this||t).velocity;var l;e.copy(o);e.multiplyScalar(r);if(!a)return e;l=(this||t).data.fly?a.x:0;n.set(s.MathUtils.degToRad(l),s.MathUtils.degToRad(a.y),0);e.applyEuler(n);return e}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=(this||t).onContextMenu;window.addEventListener("blur",(this||t).onBlur);window.addEventListener("focus",(this||t).onFocus);document.addEventListener("visibilitychange",(this||t).onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",(this||t).onBlur);window.removeEventListener("focus",(this||t).onFocus);document.removeEventListener("visibilitychange",(this||t).onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",(this||t).onKeyDown);window.addEventListener("keyup",(this||t).onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",(this||t).onKeyDown);window.removeEventListener("keyup",(this||t).onKeyUp)},onContextMenu:function(){var e=Object.keys((this||t).keys);for(var n=0;n<e.length;n++)delete(this||t).keys[e[n]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(e){var n;if(c(e)){n=e.code||a.KEYCODE_TO_CODE[e.keyCode];d.indexOf(n)!==-1&&((this||t).keys[n]=true)}},onKeyUp:function(e){var n;n=e.code||a.KEYCODE_TO_CODE[e.keyCode];delete(this||t).keys[n]}});function isEmptyObject(e){var t;for(t in e)return false;return true}},"./src/components/windows-motion-controls.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>g});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l=r("./src/constants/index.js");var c=r("./src/utils/tracked-controls.js");var u=o.debug("components:windows-motion-controls:debug");var h=o.debug("components:windows-motion-controls:warn");var d=l.AFRAME_CDN_ROOT+"controllers/microsoft/";var p={left:"left.glb",right:"right.glb",default:"universal.glb"};var f="windows-mixed-reality";var m={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"};var g=(0,a.registerComponent)("windows-motion-controls",{schema:{hand:{default:l.DEFAULT_HANDEDNESS},pair:{default:0},model:{default:true}},after:["tracked-controls"],mapping:m,bindMethods:function(){(this||t).onModelError=(this||t).onModelError.bind(this||t);(this||t).onModelLoaded=(this||t).onModelLoaded.bind(this||t);(this||t).onControllersUpdate=(this||t).onControllersUpdate.bind(this||t);(this||t).checkIfControllerPresent=(this||t).checkIfControllerPresent.bind(this||t);(this||t).onAxisMoved=(this||t).onAxisMoved.bind(this||t)},init:function(){var e=this||t;var n=(this||t).el;(this||t).onButtonChanged=(this||t).onButtonChanged.bind(this||t);(this||t).onButtonDown=function(t){(0,c.onButtonEvent)(t.detail.id,"down",e)};(this||t).onButtonUp=function(t){(0,c.onButtonEvent)(t.detail.id,"up",e)};(this||t).onButtonTouchStart=function(t){(0,c.onButtonEvent)(t.detail.id,"touchstart",e)};(this||t).onButtonTouchEnd=function(t){(0,c.onButtonEvent)(t.detail.id,"touchend",e)};(this||t).onControllerConnected=function(){e.setModelVisibility(true)};(this||t).onControllerDisconnected=function(){e.setModelVisibility(false)};(this||t).controllerPresent=false;(this||t).previousButtonValues={};this.bindMethods();(this||t).loadedMeshInfo={buttonMeshes:null,axisMeshes:null};(this||t).rayOrigin={origin:new s.Vector3,direction:new s.Vector3(0,0,-1),createdFromMesh:false};n.addEventListener("controllerconnected",(this||t).onControllerConnected);n.addEventListener("controllerdisconnected",(this||t).onControllerDisconnected)},addEventListeners:function(){var e=(this||t).el;e.addEventListener("buttonchanged",(this||t).onButtonChanged);e.addEventListener("buttondown",(this||t).onButtonDown);e.addEventListener("buttonup",(this||t).onButtonUp);e.addEventListener("touchstart",(this||t).onButtonTouchStart);e.addEventListener("touchend",(this||t).onButtonTouchEnd);e.addEventListener("axismove",(this||t).onAxisMoved);e.addEventListener("model-error",(this||t).onModelError);e.addEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=true},removeEventListeners:function(){var e=(this||t).el;e.removeEventListener("buttonchanged",(this||t).onButtonChanged);e.removeEventListener("buttondown",(this||t).onButtonDown);e.removeEventListener("buttonup",(this||t).onButtonUp);e.removeEventListener("touchstart",(this||t).onButtonTouchStart);e.removeEventListener("touchend",(this||t).onButtonTouchEnd);e.removeEventListener("axismove",(this||t).onAxisMoved);e.removeEventListener("model-error",(this||t).onModelError);e.removeEventListener("model-loaded",(this||t).onModelLoaded);(this||t).controllerEventsActive=false},checkIfControllerPresent:function(){(0,c.checkControllerPresentAndSetup)(this||t,f,{hand:(this||t).data.hand,index:(this||t).data.pair,iterateControllerProfiles:true})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},updateControllerModel:function(){if((this||t).data.model&&!(this||t).rayOrigin.createdFromMesh){var e=this.createControllerModelUrl();this.loadModel(e)}else this.modelReady()},createControllerModelUrl:function(e){var n="default";var r=(this||t).data.hand;var s;s=p[r]||p.default;return d+n+"/"+s},injectTrackedControls:function(){var e=(this||t).data;(this||t).el.setAttribute("tracked-controls",{idPrefix:f,controller:e.pair,hand:e.hand});this.updateControllerModel()},addControllersUpdateListener:function(){(this||t).el.sceneEl.addEventListener("controllersupdated",(this||t).onControllersUpdate,false)},removeControllersUpdateListener:function(){(this||t).el.sceneEl.removeEventListener("controllersupdated",(this||t).onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(e){var t=this.createControllerModelUrl(true);if(e.detail.src!==t){h("Failed to load controller model for device, attempting to load default.");this.loadModel(t)}else h("Failed to load default controller model.")},loadModel:function(e){(this||t).el.setAttribute("gltf-model","url("+e+")")},onModelLoaded:function(e){var n=(this||t).controllerModel=e.detail.model;var r=(this||t).loadedMeshInfo;var s;var a;var o;var l;if(e.target===(this||t).el){u("Processing model");r.buttonMeshes={};r.axisMeshes={};if(n){for(s=0;s<(this||t).mapping.buttons.length;s++){a=(this||t).mapping.buttonMeshNames[(this||t).mapping.buttons[s]];if(a){o=n.getObjectByName(a);if(o){l={index:s,value:getImmediateChildByName(o,"VALUE"),pressed:getImmediateChildByName(o,"PRESSED"),unpressed:getImmediateChildByName(o,"UNPRESSED")};l.value&&l.pressed&&l.unpressed?r.buttonMeshes[(this||t).mapping.buttons[s]]=l:h("Missing button submesh under mesh with name: "+a+"(VALUE: "+!!l.value+", PRESSED: "+!!l.pressed+", UNPRESSED:"+!!l.unpressed+")")}else h("Missing button mesh with name: "+a)}else u("Skipping unknown button at index: "+s+" with mapped name: "+(this||t).mapping.buttons[s])}for(s=0;s<(this||t).mapping.axisMeshNames.length;s++){a=(this||t).mapping.axisMeshNames[s];if(a){o=n.getObjectByName(a);if(o){l={index:s,value:getImmediateChildByName(o,"VALUE"),min:getImmediateChildByName(o,"MIN"),max:getImmediateChildByName(o,"MAX")};l.value&&l.min&&l.max?r.axisMeshes[s]=l:h("Missing axis submesh under mesh with name: "+a+"(VALUE: "+!!l.value+", MIN: "+!!l.min+", MAX:"+!!l.max+")")}else h("Missing axis mesh with name: "+a)}else u("Skipping unknown axis at index: "+s)}this.calculateRayOriginFromMesh(n);this.setModelVisibility()}u("Model load complete.")}function getImmediateChildByName(e,t){for(var n=0,r=e.children.length;n<r;n++){var s=e.children[n];if(s&&s.name===t)return s}}},calculateRayOriginFromMesh:function(){var e=new s.Quaternion;return function(n){var r;(this||t).rayOrigin.origin.set(0,0,0);(this||t).rayOrigin.direction.set(0,0,-1);(this||t).rayOrigin.createdFromMesh=true;r=n.getObjectByName((this||t).mapping.pointingPoseMeshName);if(r){var s=n.parent;if(s){n.parent=null;n.updateMatrixWorld(true);n.parent=s}r.getWorldPosition((this||t).rayOrigin.origin);r.getWorldQuaternion(e);(this||t).rayOrigin.direction.applyQuaternion(e);s&&n.updateMatrixWorld(true)}else u("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var e=new s.Quaternion;return function(n,r){var s=(this||t).loadedMeshInfo.axisMeshes[n];if(s){var a=s.min;var o=s.max;var l=s.value;var c=r*.5+.5;l.setRotationFromQuaternion(e.copy(a.quaternion).slerp(o.quaternion,c));l.position.lerpVectors(a.position,o.position,c)}}}(),lerpButtonTransform:function(){var e=new s.Quaternion;return function(n,r){var s=(this||t).loadedMeshInfo.buttonMeshes[n];if(s){var a=s.unpressed;var o=s.pressed;var l=s.value;l.setRotationFromQuaternion(e.copy(a.quaternion).slerp(o.quaternion,r));l.position.lerpVectors(a.position,o.position,r)}}}(),modelReady:function(){(this||t).el.emit("controllermodelready",{name:"windows-motion-controls",model:(this||t).data.model,rayOrigin:(this||t).rayOrigin})},onButtonChanged:function(e){var n=(this||t).mapping.buttons[e.detail.id];if(n){(this||t).loadedMeshInfo&&(this||t).loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(n,e.detail.state.value);(this||t).el.emit(n+"changed",e.detail.state)}},onAxisMoved:function(e){var n=(this||t).mapping.axisMeshNames.length;if((this||t).loadedMeshInfo&&(this||t).loadedMeshInfo.axisMeshes)for(var r=0;r<n;r++)this.lerpAxisTransform(r,e.detail.axis[r]||0);(0,c.emitIfAxesChanged)(this||t,(this||t).mapping.axes,e)},setModelVisibility:function(e){var n=(this||t).el.getObject3D("mesh");if((this||t).controllerPresent){e=e!==void 0?e:(this||t).modelVisible;(this||t).modelVisible=e;n&&(n.visible=e)}}})},"./src/constants/index.js":(e,t,n)=>{n.r(t);n.d(t,{AFRAME_CDN_ROOT:()=>r,AFRAME_INJECTED:()=>s,DEFAULT_CAMERA_HEIGHT:()=>a,DEFAULT_HANDEDNESS:()=>o});var r=window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/";var s="aframe-injected";var a=1.6;var o="right"},"./src/constants/keyboardevent.js":(e,t,n)=>{n.r(t);n.d(t,{KEYCODE_TO_CODE:()=>r});var r={38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}},"./src/core/a-assets.js":(e,t,n)=>{n.r(t);n.d(t,{getFileNameFromURL:()=>getFileNameFromURL,inferResponseType:()=>inferResponseType});var r=n("./node_modules/three/build/three.core.js");var s=n("./src/core/a-node.js");var a=n("./src/utils/index.js");var o=new r.FileLoader;var l=(0,a.debug)("core:a-assets:warn");class AAssets extends s.ANode{constructor(){super();this.isAssets=true;this.fileLoader=o;this.timeout=null}doConnectedCallback(){var e=this;var t;var n=[];var s;var a;var o;var c;var u;var h;super.doConnectedCallback();if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");c=this.querySelectorAll("img");for(t=0;t<c.length;t++){o=fixUpMediaElement(c[t]);n.push(new Promise((function(e,n){r.Cache.add(c[t].getAttribute("src"),o);if(o.complete)e();else{o.onload=e;o.onerror=n}})))}a=this.querySelectorAll("audio, video");for(t=0;t<a.length;t++){s=fixUpMediaElement(a[t]);s.src||s.srcObject||l("Audio/video asset has neither `src` nor `srcObject` attributes.");n.push(mediaElementLoaded(s))}h=this.getChildren();h.forEach((function(e){e.isAssetItem&&e.hasAttribute("src")&&n.push(new Promise((function waitForLoaded(t,n){if(e.hasLoaded)return t();e.addEventListener("loaded",t);e.addEventListener("error",n)})))}));Promise.allSettled(n).then((function(){e.timeout!==null&&e.load()}));u=parseInt(this.getAttribute("timeout"),10)||3e3;this.timeout=setTimeout((function(){if(!e.hasLoaded){l("Asset loading timed out in",u,"ms");e.timeout=null;e.emit("timeout");e.load()}}),u)}disconnectedCallback(){super.disconnectedCallback();this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,(function(){return false}))}}customElements.define("a-assets",AAssets);class AAssetItem extends s.ANode{constructor(){super();this.data=null;this.isAssetItem=true}connectedCallback(){var e=this;var t=this.getAttribute("src");o.setResponseType(this.getAttribute("response-type")||inferResponseType(t));o.load(t,(function handleOnLoad(t){e.data=t;s.ANode.prototype.load.call(e)}),(function handleOnProgress(t){e.emit("progress",{loadedBytes:t.loaded,totalBytes:t.total,xhr:t})}),(function handleOnError(t){e.emit("error",{xhr:t},false)}))}}customElements.define("a-asset-item",AAssetItem);
/**
         * Create a Promise that resolves once the media element has finished buffering.
         *
         * @param {Element} el - HTMLMediaElement.
         * @returns {Promise}
         */function mediaElementLoaded(e){if(e.hasAttribute("autoplay")||e.getAttribute("preload")==="auto")return new Promise((function(t,n){if(e.readyState===4)return t();if(e.error)return n();e.addEventListener("loadeddata",checkProgress,false);e.addEventListener("progress",checkProgress,false);e.addEventListener("error",n,false);function checkProgress(){var n=0;for(var s=0;s<e.buffered.length;s++)n+=e.buffered.end(s)-e.buffered.start(s);if(n>=e.duration){e.tagName==="VIDEO"&&r.Cache.add(e.getAttribute("src"),e);t()}}}))}function fixUpMediaElement(e){var t=setCrossOrigin(e);if(t.tagName&&t.tagName.toLowerCase()==="video"){t.setAttribute("playsinline","");t.setAttribute("webkit-playsinline","")}if(t!==e){e.parentNode.appendChild(t);e.parentNode.removeChild(e)}return t}
/**
         * Automatically set `crossorigin` if not defined on the media element.
         * If it is not defined, we must create and re-append a new media element <img> and
         * have the browser re-request it with `crossorigin` set.
         *
         * @param {Element} mediaEl - Media element (e.g., <img>, <audio>, <video>).
         * @returns {Element} Media element to be used to listen to for loaded events.
         */function setCrossOrigin(e){var t;var n;if(e.hasAttribute("crossorigin"))return e;n=e.getAttribute("src");if(n!==null){if(n.indexOf("://")===-1)return e;if(extractDomain(n)===window.location.host)return e}l('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',n);e.crossOrigin="anonymous";t=e.cloneNode(true);return t}
/**
         * Extract domain out of URL.
         *
         * @param {string} url
         * @returns {string}
         */function extractDomain(e){var t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0];return t.substring(0,t.indexOf(":"))}
/**
         * Infer response-type attribute from src.
         * Default is text (default XMLHttpRequest.responseType)
         * and arraybuffer for .glb files.
         *
         * @param {string} src
         * @returns {string}
         */function inferResponseType(e){var t=getFileNameFromURL(e);var n=t.lastIndexOf(".");if(n>=0){var r=t.slice(n,e.search(/\?|#|$/));if(r===".glb")return"arraybuffer"}return"text"}
/**
         * Extract filename from URL
         *
         * @param {string} url
         * @returns {string}
         */function getFileNameFromURL(e){var t=document.createElement("a");t.href=e;var n=t.search.replace(/^\?/,"");var r=e.replace(n,"").replace("?","");return r.substring(r.lastIndexOf("/")+1)}},"./src/core/a-cubemap.js":(e,t,n)=>{n.r(t);var r=n("./src/utils/index.js");var s=(0,r.debug)("core:cubemap:warn");class ACubeMap extends HTMLElement{constructor(e){e=super(e);return e}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){document.readyState==="complete"?ACubeMap.prototype.doConnectedCallback.call(this):document.addEventListener("readystatechange",this.onReadyStateChange.bind(this))}doConnectedCallback(){this.srcs=this.validate()}
/**
           * Checks for exactly six elements with [src].
           * When <img>s are used they will be prefetched.
           *
           * @returns {Array<string|Element>|undefined} six URLs or <img> elements if valid, else undefined.
           */validate(){var e=this.querySelectorAll("[src]");var t;var n=[];if(e.length===6){for(t=0;t<e.length;t++)e[t].tagName==="IMG"?n.push(e[t]):n.push(e[t].getAttribute("src"));return n}s("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",ACubeMap)},"./src/core/a-entity.js":(e,t,n)=>{n.r(t);n.d(t,{AEntity:()=>AEntity});var r=n("./node_modules/three/build/three.core.js");var s=n("./src/core/a-node.js");var a=n("./src/core/component.js");var o=n("./src/utils/index.js");var l=o.debug("core:a-entity:debug");var c=o.debug("core:a-entity:warn");var u="__";var h=["position","rotation","scale","visible"];var d={once:true};class AEntity extends s.ANode{constructor(){super();this.components={};this.initializingComponents={};this.componentsToUpdate={};this.isEntity=true;this.isPlaying=false;this.object3D=new r.Group;this.object3D.rotation.order="YXZ";this.object3D.el=this;this.object3DMap={};this.parentEl=null;this.rotationObj={};this.states=[]}attributeChangedCallback(e,t,n){var r=this.components[e];super.attributeChangedCallback();r&&r.justInitialized&&n===""?delete r.justInitialized:(r||n!==null)&&this.setEntityAttribute(e,t,n)}doConnectedCallback(){var e=this;var t;var n;super.doConnectedCallback();n=this.sceneEl;this.addToParent();if(!this.isScene)if(n){t=n.querySelector("a-assets");!t||t.hasLoaded?this.load():t.addEventListener("loaded",(function(){e.load()}))}else this.load()}disconnectedCallback(){var e;if(this.parentEl){for(e in this.components)this.removeComponent(e,false);if(!this.isScene){this.removeFromParent();super.disconnectedCallback();this.object3D.el=null}}}getObject3D(e){return this.object3DMap[e]}
/**
           * Set a THREE.Object3D into the map.
           *
           * @param {string} type - Developer-set name of the type of object, will be unique per type.
           * @param {THREE.Object3D} obj - A THREE.Object3D.
           */setObject3D(e,t){var n;var s=this;if(!(t instanceof r.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");n=this.getObject3D(e);n&&this.object3D.remove(n);t.el=this;t.children.length&&t.traverse((function bindEl(e){e.el=s}));this.object3D.add(t);this.object3DMap[e]=t;this.emit("object3dset",{object:t,type:e})}removeObject3D(e){var t=this.getObject3D(e);if(t){this.object3D.remove(t);delete this.object3DMap[e];this.emit("object3dremove",{type:e})}else c("Tried to remove `Object3D` of type:",e,"which was not defined.")}
/**
           * Gets or creates an object3D of a given type.
           *
           * @param {string} type - Type of the object3D.
           * @param {string} Constructor - Constructor to use to create the object3D if needed.
           * @returns {object}
           */getOrCreateObject3D(e,t){var n=this.getObject3D(e);if(!n&&t){n=new t;this.setObject3D(e,n)}c("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead.");return n}
/**
           * Add child entity.
           *
           * @param {Element} el - Child entity.
           */add(e){if(!e.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(e.object3D);this.emit("child-attached",{el:e})}addToParent(){var e=this.parentEl=this.parentNode;if(e&&e.add&&!this.attachedToParent){e.add(this);this.attachedToParent=true}}removeFromParent(){var e=this.parentEl;this.parentEl.remove(this);this.attachedToParent=false;this.parentEl=null;e.emit("child-detached",{el:this})}load(){var e=this;!this.hasLoaded&&this.parentEl&&super.load.call(this,(function entityLoadCallback(){if(e.parentEl){e.updateComponents();(e.isScene||e.parentEl.isPlaying)&&e.play()}}))}
/**
           * Remove child entity.
           *
           * @param {Element} el - Child entity.
           */remove(e){e?this.object3D.remove(e.object3D):this.parentNode.removeChild(this)}
/**
           * @returns {Array<Element>} Direct children that are entities.
           */getChildEntities(){var e=this.children;var t=[];for(var n=0;n<e.length;n++){var r=e[n];r instanceof AEntity&&t.push(r)}return t}
/**
           * Initialize component.
           *
           * @param {string} attrName - Attribute name associated to the component.
           * @param {object} data - Component data
           * @param {boolean} isDependency - True if the component is a dependency.
           */initComponent(e,t,n){var r;var s;var c;var h;var d;c=o.split(e,u);h=c[0];s=c.length>2?c.slice(1).join("__"):c[1];if(a.components[h]){d=checkComponentDefined(this,e)||t!==void 0;if((d||n)&&!(e in this.components)){this.initComponentDependencies(h);r=new a.components[h].Component(this,t,s);this.isPlaying&&r.play();if(!this.hasAttribute(e)){r.justInitialized=true;window.HTMLElement.prototype.setAttribute.call(this,e,"")}l("Component initialized: %s",e)}}}
/**
           * Initialize dependencies of a component.
           *
           * @param {string} name - Root component name.
           */initComponentDependencies(e){var t=this;var n=a.components[e];var r;var s;if(n){r=a.components[e].dependencies;if(r)for(s=0;s<r.length;s++)t.initComponent(r[s],window.HTMLElement.prototype.getAttribute.call(t,r[s])||void 0,true)}}removeComponent(e,t){var n;n=this.components[e];if(n)if(n.initialized){n.pause();n.remove();if(t){n.destroy();delete this.components[e];this.hasAttribute(e)&&window.HTMLElement.prototype.removeAttribute.call(this,e)}this.emit("componentremoved",n.evtDetail,false)}else this.addEventListener("componentinitialized",(function tryRemoveLater(n){if(n.detail.name===e){this.removeComponent(e,t);this.removeEventListener("componentinitialized",tryRemoveLater)}}))}updateComponents(){var e;var t;var n;var r;var s=this.componentsToUpdate;if(this.hasLoaded||this.isLoading){for(n=0;n<this.mixinEls.length;n++)for(r in this.mixinEls[n].componentCache)isComponent(r)&&(s[r]=true);if(this.getExtraComponents){t=this.getExtraComponents();for(r in t)isComponent(r)&&(s[r]=true)}for(n=0;n<this.attributes.length;++n){r=this.attributes[n].name;h.indexOf(r)===-1&&(isComponent(r)&&(s[r]=true))}for(n=0;n<h.length;n++){r=h[n];this.hasAttribute(r)&&this.updateComponent(r,this.getDOMAttribute(r))}for(r in s){e=mergeComponentData(this.getDOMAttribute(r),t&&t[r]);this.updateComponent(r,e);delete s[r]}}}
/**
           * Initialize, update, or remove a single component.
           *
           * When initializing, we set the component on `this.components`.
           *
           * @param {string} attr - Component name.
           * @param {object} attrValue - Value of the DOM attribute.
           * @param {boolean} clobber - If new attrValue completely replaces previous properties.
           */updateComponent(e,t,n){var r=this.components[e];if(r){if(t===null&&!checkComponentDefined(this,e)){this.removeComponent(e,true);return}r.updateProperties(t,n)}else this.initComponent(e,t,false)}
/**
           * If `attr` is a component name, detach the component from the entity.
           *
           * If `propertyName` is given, reset the component property value to its default.
           *
           * @param {string} attr - Attribute name, which could also be a component name.
           * @param {string} propertyName - Component prop name, if resetting an individual prop.
           */removeAttribute(e,t){var n=this.components[e];n&&t===void 0&&this.removeComponent(e,true);if(n&&t!==void 0)n.resetProperty(t);else{e==="mixin"&&this.mixinUpdate("");window.HTMLElement.prototype.removeAttribute.call(this,e)}}play(){var e;var t;var n;if(!this.isPlaying&&(this.hasLoaded||this.isLoading)){this.isPlaying=true;for(n in this.components)this.components[n].play();e=this.getChildEntities();for(t=0;t<e.length;t++)e[t].play();this.emit("play")}}pause(){var e;var t;var n;if(this.isPlaying){this.isPlaying=false;for(n in this.components)this.components[n].pause();e=this.getChildEntities();for(t=0;t<e.length;t++)e[t].pause();this.emit("pause")}}
/**
           * Deals with updates on entity-specific attributes (i.e., components and mixins).
           *
           * @param {string} attr
           * @param {string} oldVal
           * @param {string|object} newVal
           */setEntityAttribute(e,t,n){if(a.components[e]||this.components[e])this.updateComponent(e,n);else if(e==="mixin"){if(n===this.computedMixinStr)return;this.mixinUpdate(n,t)}}mixinUpdate(e,t,n){var r=AEntity.componentsUpdated;var s;var a;var o;var l;var c=this;n||(t=t||this.getAttribute("mixin"));if(this.hasLoaded){o=this.updateMixins(e,t);r.length=0;for(l=0;l<this.mixinEls.length;l++)for(s in this.mixinEls[l].componentCache)if(r.indexOf(s)===-1){this.components[s]?this.components[s].handleMixinUpdate():this.initComponent(s,null);r.push(s)}for(l=0;l<o.oldMixinIds.length;l++){a=document.getElementById(o.oldMixinIds[l]);if(a)for(s in a.componentCache)r.indexOf(s)===-1&&this.components[s]&&(this.getDOMAttribute(s)?this.components[s].handleMixinUpdate():this.removeComponent(s,true))}}else this.addEventListener("loaded-private",(function(){c.mixinUpdate(e,t,true)}),d)}
/**
           * setAttribute can:
           *
           * 1. Set a single property of a multi-property component.
           * 2. Set multiple properties of a multi-property component.
           * 3. Replace properties of a multi-property component.
           * 4. Set a value for a single-property component, mixin, or normal HTML attribute.
           *
           * @param {string} attrName - Component or attribute name.
           * @param {any} arg1 - Can be a value, property name, CSS-style property string, or
           *   object of properties.
           * @param {any} arg2 - If arg1 is a property name, this should be a value. Otherwise,
           *   it is a boolean indicating whether to clobber previous values (defaults to false).
           */setAttribute(e,t,n){var r=AEntity.singlePropUpdate;var s;var l;var c;var h;var d;var p;h=e.indexOf(u);c=h>0?e.substring(0,h):e;if(a.components[c]){!this.components[e]&&this.hasAttribute(e)&&this.updateComponent(e,window.HTMLElement.prototype.getAttribute.call(this,e));if(typeof n!=="undefined"&&typeof t==="string"&&t.length>0&&typeof o.styleParser.parse(t)==="string"){for(p in r)delete r[p];s=r;s[t]=n;l=false}else{s=t;l=n===true}this.updateComponent(e,s,l);d=this.sceneEl&&this.sceneEl.getAttribute("debug");d&&this.components[e].flushToDOM()}else{e==="mixin"&&this.mixinUpdate(t);super.setAttribute.call(this,e,t)}}
/**
           * Reflect component data in the DOM (as seen from the browser DOM Inspector).
           *
           * @param {boolean} recursive - Also flushToDOM on the children.
           **/flushToDOM(e){var t=this.components;var n;var r=this.children;var s;var a;for(a in t)t[a].flushToDOM();if(e)for(s=0;s<r.length;++s){n=r[s];n.flushToDOM&&n.flushToDOM(e)}}
/**
           * If `attr` is a component, returns ALL component data including applied mixins and
           * defaults.
           *
           * If `attr` is not a component, fall back to HTML getAttribute.
           *
           * @param {string} attr
           * @returns {object|string} Object if component, else string.
           */getAttribute(e){var t;if(e==="position")return this.object3D.position;if(e==="rotation")return getRotation(this);if(e==="scale")return this.object3D.scale;if(e==="visible")return this.object3D.visible;t=this.components[e];return t?t.data:window.HTMLElement.prototype.getAttribute.call(this,e)}
/**
           * If `attr` is a component, returns JUST the component data defined on the entity.
           * Like a partial version of `getComputedAttribute` as returned component data
           * does not include applied mixins or defaults.
           *
           * If `attr` is not a component, fall back to HTML getAttribute.
           *
           * @param {string} attr
           * @returns {object|string} Object if component, else string.
           */getDOMAttribute(e){var t=this.components[e];return t?t.attrValue:window.HTMLElement.prototype.getAttribute.call(this,e)}addState(e){if(!this.is(e)){this.states.push(e);this.emit("stateadded",e)}}removeState(e){var t=this.states.indexOf(e);if(t!==-1){this.states.splice(t,1);this.emit("stateremoved",e)}}
/**
           * Checks if the element is in a given state. e.g. el.is('alive');
           *
           * @param {string} state - Name of the state we want to check
           */is(e){return this.states.indexOf(e)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var e;if(this.parentNode)c("Entity can only be destroyed if detached from scenegraph.");else for(e in this.components)this.components[e].destroy()}}
/**
         * Check if a component is *defined* for an entity, including defaults and mixins.
         * Does not check whether the component has been *initialized* for an entity.
         *
         * @param {string} el - Entity.
         * @param {string} name - Component name.
         * @returns {boolean}
         */function checkComponentDefined(e,t){return!(!e.components[t]||!e.components[t].attrValue)||isComponentMixedIn(t,e.mixinEls)}
/**
         * Check if any mixins contains a component.
         *
         * @param {string} name - Component name.
         * @param {Array<Element>} mixinEls - Array of <a-mixin>s.
         */function isComponentMixedIn(e,t){var n;var r=false;for(n=0;n<t.length;++n){r=t[n].hasAttribute(e);if(r)break}return r}
/**
         * Given entity defined value, merge in extra data if necessary.
         * Handle both single and multi-property components.
         *
         * @param {string} attrValue - Entity data.
         * @param extraData - Entity data from another source to merge in.
         */function mergeComponentData(e,t){return t?t.constructor===Object?o.extend(t,o.styleParser.parse(e||{})):e||t:e}function isComponent(e){e.indexOf(u)!==-1&&(e=o.split(e,u)[0]);return!!a.components[e]}function getRotation(e){var t=r.MathUtils.radToDeg;var n=e.object3D.rotation;var s=e.rotationObj;s.x=t(n.x);s.y=t(n.y);s.z=t(n.z);return s}AEntity.componentsUpdated=[];AEntity.singlePropUpdate={};customElements.define("a-entity",AEntity)},"./src/core/a-mixin.js":(e,t,n)=>{n.r(t);var r=n("./src/core/a-node.js");var s=n("./src/core/component.js");var a=n("./src/utils/index.js");var o=n("./src/utils/styleParser.js");var l="__";class AMixin extends r.ANode{constructor(){super();this.componentCache={};this.rawAttributeCache={};this.isMixin=true}doConnectedCallback(){super.doConnectedCallback();this.sceneEl=this.closestScene();this.id=this.getAttribute("id");this.cacheAttributes();this.updateEntities();this.load()}attributeChangedCallback(e,t,n){super.attributeChangedCallback();this.cacheAttribute(e,n);this.updateEntities()}setAttribute(e,t){window.HTMLElement.prototype.setAttribute.call(this,e,t);this.cacheAttribute(e,t)}cacheAttribute(e,t){var n;var r;r=a.split(e,l)[0];n=s.components[r];t===void 0&&(t=window.HTMLElement.prototype.getAttribute.call(this,e));this.rawAttributeCache[e]=t;n&&(this.componentCache[e]=this.parseComponentAttrValue(n,t))}
/**
           * Given an HTML attribute value parses the string based on the component schema.
           * To avoid double parsing of strings when mixed into the actual component,
           * we store the original instead of the parsed one.
           *
           * @param {object} component - The component to parse for.
           * @param {string} attrValue - HTML attribute value.
           */parseComponentAttrValue(e,t){var n;if(typeof t!=="string")return t;if(e.isSingleProperty){n=e.schema.parse(t);typeof n==="string"&&(n=t)}else n=o.parse(t);return n}getAttribute(e){return this.componentCache[e]||window.HTMLElement.prototype.getAttribute.call(this,e)}cacheAttributes(){var e=this.attributes;var t;var n;for(n=0;n<e.length;n++){t=e[n].name;this.cacheAttribute(t)}}updateEntities(){var e;var t;var n;if(this.sceneEl){t=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]");for(n=0;n<t.length;n++){e=t[n];e.hasLoaded&&!e.isMixin&&e.mixinUpdate(this.id)}}}}customElements.define("a-mixin",AMixin)},"./src/core/a-node.js":(e,t,n)=>{n.r(t);n.d(t,{ANode:()=>ANode,knownTags:()=>o});var r=n("./src/utils/index.js");var s=n("./src/core/readyState.js");var a=r.debug("core:a-node:warn");var o={"a-scene":true,"a-assets":true,"a-assets-items":true,"a-cubemap":true,"a-mixin":true,"a-node":true,"a-entity":true};function isANode(e){return e.tagName.toLowerCase()in o||e.isANode}class ANode extends HTMLElement{constructor(){super();this.computedMixinStr="";this.hasLoaded=false;this.isANode=true;this.mixinEls=[]}connectedCallback(){s.canInitializeElements?this.doConnectedCallback():document.addEventListener("aframeready",this.connectedCallback.bind(this))}doConnectedCallback(){var e;this.sceneEl=this.closestScene();this.sceneEl||a("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead.");this.hasLoaded=false;this.emit("nodeready",void 0,false);if(!this.isMixin){e=this.getAttribute("mixin");e&&this.updateMixins(e)}}attributeChangedCallback(e,t,n){n!==this.computedMixinStr&&(e!=="mixin"||this.isMixin||this.updateMixins(n,t))}closestScene(){var e=this;while(e){if(e.isScene)break;e=e.parentElement}return e}
/**
           * Returns first element matching a selector by traversing up the tree starting
           * from and including receiver element.
           *
           * @param {string} selector - Selector of element to find.
           */closest(e){var t=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;var n=this;while(n){if(t.call(n,e))break;n=n.parentElement}return n}disconnectedCallback(){this.hasLoaded=false}load(e,t){var n;var r;var s=this;if(!this.hasLoaded){t=t||isANode;n=this.getChildren();r=n.filter(t).map((function(e){return new Promise((function waitForLoaded(t,n){if(e.hasLoaded)return t();e.addEventListener("loaded",t);e.addEventListener("error",n)}))}));Promise.allSettled(r).then((function emitLoaded(t){t.forEach((function checkResultForError(e){e.status==="rejected"&&a("Rendering scene with errors on node: ",e.reason.target)}));s.isLoading=true;s.setupMutationObserver();e&&e();s.isLoading=false;s.hasLoaded=true;s.emit("loaded-private",void 0,false);s.emit("loaded",void 0,false)}))}}setupMutationObserver(){var e=this;var t={attributes:true,attributeOldValue:true};var n=new MutationObserver((function callAttributeChangedCallback(t){var n;for(n=0;n<t.length;n++)if(t[n].type==="attributes"){var r=t[n].attributeName;var s=window.HTMLElement.prototype.getAttribute.call(e,r);var a=t[n].oldValue;e.attributeChangedCallback(r,a,s)}}));n.observe(this,t)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(e,t){var n=ANode.newMixinIdArray;var s=ANode.oldMixinIdArray;var a=ANode.mixinIds;var o;var l;var c;n.length=0;s.length=0;l=e?r.split(e.trim(),/\s+/):n;c=t?r.split(t.trim(),/\s+/):s;a.newMixinIds=l;a.oldMixinIds=c;for(o=0;o<c.length;o++)l.indexOf(c[o])===-1&&this.unregisterMixin(c[o]);this.computedMixinStr="";this.mixinEls.length=0;for(o=0;o<l.length;o++)this.registerMixin(l[o]);if(this.computedMixinStr){this.computedMixinStr=this.computedMixinStr.trim();window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)}l.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin");return a}
/**
           * From mixin ID, add mixin element to `mixinEls`.
           *
           * @param {string} mixinId - ID of the mixin to register.
           */registerMixin(e){var t;var n;var s;var o=document.getElementById(e);if(o){s=o.getAttribute("mixin");if(s){t=r.split(s.trim(),/\s+/);for(n=0;n<t.length;n++)this.registerMixin(t[n])}this.computedMixinStr=this.computedMixinStr+" "+o.id;this.mixinEls.push(o)}else a("No mixin was found with id `%s`",e)}setAttribute(e,t){e==="mixin"&&this.updateMixins(t);window.HTMLElement.prototype.setAttribute.call(this,e,t)}
/**
           * Removes the mixin element from `mixinEls`.
           *
           * @param {string} mixinId - ID of the mixin to remove.
           */unregisterMixin(e){var t;var n=this.mixinEls;var r;for(t=0;t<n.length;++t){r=n[t];if(e===r.id){n.splice(t,1);break}}}
/**
           * Emit a DOM event.
           *
           * @param {string} name - Name of event.
           * @param {object} [detail={}] - Custom data to pass as `detail` to the event.
           * @param {boolean} [bubbles=true] - Whether the event should bubble.
           * @param {object} [extraData] - Extra data to pass to the event, if any.
           */emit(e,t,n,s){var a=ANode.evtData;n===void 0&&(n=true);a.bubbles=!!n;a.detail=t;s&&(a=r.extend({},s,a));this.dispatchEvent(new CustomEvent(e,a))}}ANode.evtData={};ANode.newMixinIdArray=[];ANode.oldMixinIdArray=[];ANode.mixinIds={};customElements.define("a-node",ANode)},"./src/core/component.js":(e,n,r)=>{r.r(n);r.d(n,{Component:()=>Component,components:()=>c,registerComponent:()=>registerComponent,registrationOrderWarnings:()=>S});var s=r("./src/core/schema.js");var a=r("./src/core/scene/scenes.js");var o=r("./src/core/system.js");var l=r("./src/utils/index.js");var c={};var u=s.parseProperty;var h=s.process;var d=s.isSingleProperty;var p=s.stringifyProperties;var f=s.stringifyProperty;var m=l.styleParser;var g=l.debug("core:component:warn");var y=document.currentScript;var b=new RegExp("[A-Z]+");var x={};var _=Object.freeze({});var M=[];var w={get:function(e,t){return e.getComputedPropertyValue(t)},set:function(e,t,n){t in e.schema?e.recomputeProperty(t,n):n!==void 0&&e.handleUnknownProperty(t,n);return true}};
/**
         * Component class definition.
         *
         * Components configure appearance, modify behavior, or add functionality to
         * entities. The behavior and appearance of an entity can be changed at runtime
         * by adding, removing, or updating components. Entities do not share instances
         * of components.
         *
         * @constructor
         * @param {object} el - Reference to the entity element.
         * @param {string} attrValue - Value of the corresponding HTML attribute.
         * @param {string} id - Optional id for differentiating multiple instances on the same entity.
         */var Component=function(e,n,r){var s=this||t;if((this||t).sceneOnly&&!e.isScene)throw new Error("Component `"+(this||t).name+"` can only be applied to <a-scene>");if(r&&!(this||t).multiple)throw new Error("Trying to initialize multiple components of type `"+(this||t).name+"`. There can only be one component of this type per entity.");(this||t).el=e;(this||t).id=r;(this||t).attrName=(this||t).name+(r?"__"+r:"");(this||t).evtDetail={id:(this||t).id,name:(this||t).name};(this||t).initialized=false;(this||t).el.components[(this||t).attrName]=this||t;(this||t).objectPool=x[(this||t).name];var a=(this||t).events;(this||t).events={};eventsBind(this||t,a);(this||t).attrValue=void 0;if((this||t).isObjectBased){(this||t).data=(this||t).objectPool.use();l.objectPool.removeUnusedKeys((this||t).data,(this||t).schema);(this||t).oldData=(this||t).objectPool.use();l.objectPool.removeUnusedKeys((this||t).oldData,(this||t).schema);(this||t).attrValueProxy=new Proxy(this||t,w)}else{(this||t).data=void 0;(this||t).oldData=void 0;(this||t).attrValueProxy=void 0}(this||t).deferUnknownPropertyWarnings=!!(this||t).updateSchema;(this||t).throttledEmitComponentChanged=l.throttleLeadingAndTrailing((function emitChange(){e.emit("componentchanged",s.evtDetail,false)}),200);this.updateProperties(n,true)};Component.prototype={schema:{},init:function(){},events:{},
/**
           * Update handler. Similar to attributeChangedCallback.
           * Called whenever component's data changes.
           * Also called on component initialization when the component receives initial data.
           *
           * @param {object} prevData - Previous attributes of the component.
           */
update:function(e){},
/**
           * Update schema handler. Allows the component to dynamically change its schema.
           * Called whenever a property marked as schemaChange changes.
           * Also called on initialization when the component receives initial data.
           *
           * @param {object} data - The data causing the schema change
           */
updateSchema:void 0,
/**
           * Tick handler.
           * Called on each tick of the scene render loop.
           * Affected by play and pause.
           *
           * @param {number} time - Scene tick time.
           * @param {number} timeDelta - Difference in current render time and previous render time.
           */
tick:void 0,
/**
           * Tock handler.
           * Called on each tock of the scene render loop.
           * Affected by play and pause.
           *
           * @param {number} time - Scene tick time.
           * @param {number} timeDelta - Difference in current render time and previous render time.
           * @param {object} camera - Camera used to render the last frame.
           */
tock:void 0,play:function(){},pause:function(){},remove:function(){},
/**
           * Stringify properties if necessary.
           *
           * Only called from `Entity.setAttribute` for properties whose parsers accept a non-string
           * value (e.g., selector, vec3 property types).
           *
           * @param {object} data - Complete component data.
           * @returns {string}
           */
stringify:function(e){var n=(this||t).schema;if(typeof e==="string")return e;if((this||t).isSingleProperty)return f(e,n);e=p(e,n);return m.stringify(e)},
/**
           * Write cached attribute data to the entity DOM element.
           *
           * @param {boolean} isDefault - Whether component is a default component. Always flush for
           *   default components.
           */
flushToDOM:function(e){var n=e?(this||t).data:(this||t).attrValue;n!==null&&n!==void 0&&window.HTMLElement.prototype.setAttribute.call((this||t).el,(this||t).attrName,this.stringify(n))},
/**
           * Apply new component data if data has changed (from setAttribute).
           *
           * @param {string} attrValue - HTML attribute value.
           *        If undefined, use the cached attribute value and continue updating properties.
           * @param {boolean} clobber - The previous component data is overwritten by the attrValue.
           */
updateProperties:function(e,n){var r=(this||t).el;this.updateData(e,n);(r.hasLoaded||r.isLoading)&&((this||t).initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var e=(this||t).el;var n;if(!e.initializingComponents[(this||t).name]){e.initializingComponents[(this||t).name]=true;this.init();(this||t).initialized=true;delete e.initializingComponents[(this||t).name];n=(this||t).isObjectBased?_:void 0;(this||t).dataChanged=false;this.storeOldData();this.update(n);e.isPlaying&&this.play();e.emit("componentinitialized",(this||t).evtDetail,false)}},
/**
           * @param {string|object} attrValue - Passed argument from setAttribute.
           * @param {boolean} clobber - Whether or not to overwrite previous data by the attrValue.
           */
updateData:function(e,n){if((this||t).isSingleProperty)this.recomputeProperty(void 0,e);else{if(n){l.objectPool.clearObject((this||t).attrValue);this.recomputeData(e);(this||t).schemaChangeRequired=!!(this||t).updateSchema}else typeof e==="string"?m.parse(e,(this||t).attrValueProxy):l.extend((this||t).attrValueProxy,e);this.updateSchemaIfNeeded(e)}},updateSchemaIfNeeded:function(e){if((this||t).schemaChangeRequired&&(this||t).updateSchema){M.length=0;this.updateSchema((this||t).data);l.objectPool.removeUnusedKeys((this||t).data,(this||t).schema);this.recomputeData(e);(this||t).schemaChangeRequired=false;for(var n in(this||t).attrValue)(this||t).attrValue[n]!==void 0&&M.indexOf(n)===-1&&(n in(this||t).schema||g("Unknown property `"+n+"` for component `"+(this||t).name+"`."))}for(var r=0;r<M.length;r++)g("Unknown property `"+M[r]+"` for component `"+(this||t).name+"`.");M.length=0},callUpdateHandler:function(){if((this||t).isPositionRotationScale||(this||t).dataChanged){(this||t).dataChanged=false;var e=(this||t).oldData;(this||t).oldDataInUse=true;this.update(e);e!==(this||t).oldData&&(this||t).objectPool.recycle(e);(this||t).oldDataInUse=false;this.storeOldData();this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData();this.updateSchemaIfNeeded();this.callUpdateHandler()},
/**
           * Reset value of a property to the property's default value.
           * If single property component, reset value to component's default value.
           *
           * @param {string} propertyName - Name of property to reset.
           */
resetProperty:function(e){if((this||t).isSingleProperty||e in(this||t).schema){if(e)(this||t).attrValue[e]=void 0;else{(this||t).isObjectBased&&(this||t).objectPool.recycle((this||t).attrValue);(this||t).attrValue=void 0}this.recomputeProperty(e,void 0);this.updateSchemaIfNeeded();this.callUpdateHandler()}},
/**
           * Extend schema of component given a partial schema.
           *
           * Some components might want to mutate their schema based on certain properties.
           * e.g., Material component changes its schema based on `shader` to account for different
           * uniforms.
           *
           * @param {object} schemaAddon - Schema chunk that extend base schema.
           */
extendSchema:function(e){var n;n=l.extend({},c[(this||t).name].schema);l.extend(n,e);(this||t).schema=h(n);(this||t).el.emit("schemachanged",(this||t).evtDetail)},getComputedPropertyValue:function(e){var n=(this||t).el.mixinEls;var r=(this||t).attrValue&&e?(this||t).attrValue[e]:(this||t).attrValue;if(r!==void 0)return r;for(var s=n.length-1;s>=0;s--){var a=n[s].getAttribute((this||t).attrName);if(a!==null&&(!e||e in a))return e?a[e]:a}var o=e?(this||t).schema[e].default:(this||t).schema.default;return o},recomputeProperty:function(e,n){var r=e?(this||t).schema[e]:(this||t).schema;if(n!==void 0&&n!==null){(this||t).attrValue===void 0&&(this||t).isObjectBased&&((this||t).attrValue=(this||t).objectPool.use());var s=e?(this||t).attrValue[e]:(this||t).attrValue;s=r.isCacheable?u(n,r,s):n;typeof s==="string"&&(s=n===""?void 0:n);e?(this||t).attrValue[e]=s:(this||t).attrValue=s}if((this||t).oldDataInUse){(this||t).oldData=(this||t).objectPool.use();l.objectPool.removeUnusedKeys((this||t).oldData,(this||t).schema);this.storeOldData();(this||t).oldDataInUse=false}var a=e?(this||t).oldData[e]:(this||t).oldData;var o=e?(this||t).data[e]:(this||t).data;var c=u(this.getComputedPropertyValue(e),r,o);r.type!=="array"||e||(c=l.clone(c));if(!r.equals(c,a)){(this||t).dataChanged=true;r.schemaChange&&((this||t).schemaChangeRequired=true)}e?(this||t).data[e]=c:(this||t).data=c;return c},handleUnknownProperty:function(e,n){(this||t).attrValue===void 0&&((this||t).attrValue=(this||t).objectPool.use());(this||t).attrValue[e]=n;(this||t).deferUnknownPropertyWarnings?M.push(e):(this||t).silenceUnknownPropertyWarnings||g("Unknown property `"+e+"` for component `"+(this||t).name+"`.")},storeOldData:function(){if((this||t).isObjectBased)if((this||t).isSingleProperty)(this||t).oldData=u((this||t).data,(this||t).schema,(this||t).oldData);else{var e;for(e in(this||t).schema)(this||t).data[e]!==void 0&&((this||t).data[e]&&typeof(this||t).data[e]==="object"?(this||t).oldData[e]=u((this||t).data[e],(this||t).schema[e],(this||t).oldData[e]):(this||t).oldData[e]=(this||t).data[e])}else(this||t).oldData=(this||t).data},
/**
           * Triggers a recompute of the data object.
           *
           * @param {string|object} attrValue - Optional additional data updates
           */
recomputeData:function(e){var n;if((this||t).isSingleProperty)this.recomputeProperty(void 0,e);else{for(n in(this||t).schema)(this||t).attrValueProxy[n]=void 0;e&&typeof e==="object"?l.extend((this||t).attrValueProxy,e):typeof e==="string"&&m.parse(e,(this||t).attrValueProxy)}},eventsAttach:function(){var e;this.eventsDetach();for(e in(this||t).events)(this||t).el.addEventListener(e,(this||t).events[e])},eventsDetach:function(){var e;for(e in(this||t).events)(this||t).el.removeEventListener(e,(this||t).events[e])},destroy:function(){(this||t).objectPool.recycle((this||t).attrValue);(this||t).objectPool.recycle((this||t).data);(this||t).objectPool.recycle((this||t).oldData);(this||t).attrValue=(this||t).data=(this||t).oldData=(this||t).attrValueProxy=void 0}};function eventsBind(e,t){var n;for(n in t)e.events[n]=t[n].bind(e)}var S={};
/**
         * Register a component to A-Frame.
         *
         * @param {string} name - Component name.
         * @param {object} definition - Component schema and lifecycle method handlers.
         * @returns {object} Component.
         */function registerComponent(e,n){var r;var s={};var p;var f;document.currentScript&&document.currentScript!==y&&a.default.forEach((function checkPosition(t){if(!t.hasLoaded&&document.currentScript.compareDocumentPosition(t)!==Node.DOCUMENT_POSITION_FOLLOWING){g("The component `"+e+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization.");window.debug&&(S[e]=true)}}));b.test(e)===true&&g("The component name `"+e+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+e.toLowerCase()+"`");if(e.indexOf("__")!==-1)throw new Error("The component name `"+e+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");Object.keys(n).forEach((function(e){s[e]={value:n[e],writable:true}}));if(c[e])throw new Error("The component `"+e+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");r=function(e,n,r){Component.call(this||t,e,n,r)};r.prototype=Object.create(Component.prototype,s);r.prototype.name=e;r.prototype.isPositionRotationScale=e==="position"||e==="rotation"||e==="scale";r.prototype.constructor=r;r.prototype.system=o&&o.systems[e];r.prototype.play=wrapPlay(r.prototype.play);r.prototype.pause=wrapPause(r.prototype.pause);p=l.extend(h(r.prototype.schema,r.prototype.name));r.prototype.isSingleProperty=f=d(r.prototype.schema);r.prototype.isObjectBased=!f||f&&(isObject(p.default)||isObject(u(void 0,p)));x[e]=l.objectPool.createPool();c[e]={Component:r,dependencies:r.prototype.dependencies,before:r.prototype.before,after:r.prototype.after,isSingleProperty:r.prototype.isSingleProperty,isObjectBased:r.prototype.isObjectBased,multiple:r.prototype.multiple,sceneOnly:r.prototype.sceneOnly,name:e,schema:p,stringify:r.prototype.stringify};for(var m=0;m<a.default.length;m++)a.default[m].emit("componentregistered",{name:e},false);return r}function hasBehavior(e){return e.tick||e.tock}
/**
         * Wrapper for defined pause method.
         * Pause component by removing tick behavior and calling user's pause method.
         *
         * @param {function} pauseMethod
         * @returns {function}
         */function wrapPause(e){return function pause(){var n=(this||t).el.sceneEl;if((this||t).isPlaying){e.call(this||t);(this||t).isPlaying=false;this.eventsDetach();hasBehavior(this||t)&&n.removeBehavior(this||t)}}}
/**
         * Wrapper for defined play method.
         * Play component by adding tick behavior and calling user's play method.
         *
         * @param {function} playMethod
         * @returns {function}
         */function wrapPlay(e){return function play(){var n=(this||t).el.sceneEl;var r=(this||t).el.isPlaying&&!(this||t).isPlaying;if((this||t).initialized&&r){e.call(this||t);(this||t).isPlaying=true;this.eventsAttach();hasBehavior(this||t)&&n.addBehavior(this||t)}}}function isObject(e){return e&&e.constructor===Object&&!(e instanceof window.HTMLElement)}},"./src/core/geometry.js":(e,n,r)=>{r.r(n);r.d(n,{Geometry:()=>Geometry,geometries:()=>l,geometryNames:()=>c,registerGeometry:()=>registerGeometry});var s=r("./src/core/schema.js");var a=r("./node_modules/three/build/three.core.js");var o=s.process;var l={};var c=[];var Geometry=function(){};Geometry.prototype={schema:{},init:function(e){(this||t).geometry=new a.BufferGeometry;return(this||t).geometry},
/**
           * Update handler. Similar to attributeChangedCallback.
           * Called whenever the associated geometry data changes.
           *
           * @param {object} data - New geometry data.
           */
update:function(e){}};
/**
         * Registers a geometry to A-Frame.
         *
         * @param {string} name - Geometry name.
         * @param {object} definition - Geometry property and methods.
         * @returns {object} Geometry.
         */function registerGeometry(e,n){var r;var s={};Object.keys(n).forEach((function expandDefinition(e){s[e]={value:n[e],writable:true}}));if(l[e])throw new Error("The geometry `"+e+"` has been already registered");r=function(){Geometry.call(this||t)};r.prototype=Object.create(Geometry.prototype,s);r.prototype.name=e;r.prototype.constructor=r;l[e]={Geometry:r,schema:o(r.prototype.schema)};c.push(e);return r}},"./src/core/propertyTypes.js":(e,t,n)=>{n.r(t);n.d(t,{isValidDefaultCoordinate:()=>isValidDefaultCoordinate,isValidDefaultValue:()=>isValidDefaultValue,propertyTypes:()=>l,registerPropertyType:()=>registerPropertyType});var r=n("./src/utils/coordinates.js");var s=n("./node_modules/debug/src/browser.js");var a=n.n(s);var o=a()("core:propertyTypes:warn");var l={};var c=/[,> .[\]:]/;var u=/url\((.+)\)/;registerPropertyType("audio","",assetParse,assetStringify);registerPropertyType("array",[],arrayParse,arrayStringify,arrayEquals);registerPropertyType("asset","",assetParse,assetStringify);registerPropertyType("boolean",false,boolParse);registerPropertyType("color","#FFF");registerPropertyType("int",0,intParse);registerPropertyType("number",0,numberParse);registerPropertyType("map","",assetParse,assetStringify);registerPropertyType("model","",assetParse,assetStringify);registerPropertyType("selector",null,selectorParse,selectorStringify,defaultEquals,false);registerPropertyType("selectorAll",null,selectorAllParse,selectorAllStringify,arrayEquals,false);registerPropertyType("src","",srcParse,assetStringify);registerPropertyType("string","");registerPropertyType("time",0,intParse);registerPropertyType("vec2",{x:0,y:0},vecParse,r.stringify,r.equals);registerPropertyType("vec3",{x:0,y:0,z:0},vecParse,r.stringify,r.equals);registerPropertyType("vec4",{x:0,y:0,z:0,w:1},vecParse,r.stringify,r.equals);
/**
         * Register a parser for re-use such that when someone uses `type` in the schema,
         * `schema.process` will set the property `parse` and `stringify`.
         *
         * @param {string} type - Type name.
         * @param {any} [defaultValue=null] - Default value to use if component does not define default value.
         * @param {function} [parse=defaultParse] - Parse string function.
         * @param {function} [stringify=defaultStringify] - Stringify to DOM function.
         * @param {function} [equals=defaultEquals] - Equality comparator.
         * @param {boolean} [cacheable=false] - Whether or not the parsed value of a property can be cached.
         */function registerPropertyType(e,t,n,r,s,a){if(e in l)throw new Error("Property type "+e+" is already registered.");l[e]={default:t,parse:n||defaultParse,stringify:r||defaultStringify,equals:s||defaultEquals,isCacheable:a!==false}}function arrayParse(e){return Array.isArray(e)?e:e&&typeof e==="string"?e.split(",").map(trim):[];function trim(e){return e.trim()}}function arrayStringify(e){return e.join(", ")}function arrayEquals(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return false;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return false;return true}
/**
         * For general assets.
         *
         * @param {string} value - Can either be `url(<value>)`, an ID selector to an asset, or
         *   just string.
         * @returns {string} Parsed value from `url(<value>)`, src from `<someasset src>`, or
         *   just string.
         */function assetParse(e){var t;var n;if(typeof e!=="string")return e;n=e.match(u);if(n)return n[1];if(e.charAt(0)!=="#")return e;t=document.getElementById(e.substring(1));if(t)return t.tagName==="CANVAS"||t.tagName==="VIDEO"||t.tagName==="IMG"?t:t.getAttribute("src");o('"'+e+'" asset not found.')}function assetStringify(e){if(e.getAttribute){var t=e.getAttribute("id");return t?"#"+e.getAttribute("id"):e.getAttribute("src")}return defaultStringify(e)}function defaultParse(e){return e}function defaultStringify(e){return e===null?"null":e.toString()}function defaultEquals(e,t){return e===t}function boolParse(e){return e!=="false"&&e!==false}function intParse(e){return parseInt(e,10)}function numberParse(e){return parseFloat(e,10)}function selectorParse(e){return e?typeof e!=="string"?e:e[0]!=="#"||c.test(e)?document.querySelector(e):document.getElementById(e.substring(1)):null}function selectorAllParse(e){return e?typeof e!=="string"?e:Array.prototype.slice.call(document.querySelectorAll(e),0):null}function selectorStringify(e){return e.getAttribute?"#"+e.getAttribute("id"):defaultStringify(e)}function selectorAllStringify(e){return e instanceof Array?e.map((function(e){return"#"+e.getAttribute("id")})).join(", "):defaultStringify(e)}function srcParse(e){o("`src` property type is deprecated. Use `asset` instead.");return assetParse(e)}function vecParse(e,t,n){return r.parse(e,t,n)}
/**
         * Validate the default values in a schema to match their type.
         *
         * @param {string} type - Property type name.
         * @param defaultVal - Property type default value.
         * @returns {boolean} Whether default value is accurate given the type.
         */function isValidDefaultValue(e,t){return(e!=="audio"||typeof t==="string")&&(!(e==="array"&&!Array.isArray(t))&&((e!=="asset"||typeof t==="string")&&((e!=="boolean"||typeof t==="boolean")&&((e!=="color"||typeof t==="string")&&((e!=="int"||typeof t==="number")&&((e!=="number"||typeof t==="number")&&((e!=="map"||typeof t==="string")&&((e!=="model"||typeof t==="string")&&((e!=="selector"||typeof t==="string"||t===null)&&((e!=="selectorAll"||typeof t==="string"||t===null)&&((e!=="src"||typeof t==="string")&&((e!=="string"||typeof t==="string")&&((e!=="time"||typeof t==="number")&&(e==="vec2"?isValidDefaultCoordinate(t,2):e==="vec3"?isValidDefaultCoordinate(t,3):e!=="vec4"||isValidDefaultCoordinate(t,4)))))))))))))))}
/**
         * Checks if default coordinates are valid.
         *
         * @param possibleCoordinates
         * @param {number} dimensions - 2 for 2D Vector, 3 for 3D vector.
         * @returns {boolean} Whether coordinates are parsed correctly.
         */function isValidDefaultCoordinate(e,t){if(e===null)return true;if(typeof e!=="object")return false;if(Object.keys(e).length!==t)return false;var n=e.x;var r=e.y;var s=e.z;var a=e.w;return typeof n==="number"&&typeof r==="number"&&(!(t>2&&typeof s!=="number")&&!(t>3&&typeof a!=="number"))}},"./src/core/readyState.js":(e,t,n)=>{n.r(t);n.d(t,{canInitializeElements:()=>r,emitReady:()=>emitReady,reset:()=>reset,waitForDocumentReadyState:()=>waitForDocumentReadyState});var r=false;function waitForDocumentReadyState(){document.readyState!=="complete"?document.addEventListener("readystatechange",(function onReadyStateChange(){if(document.readyState==="complete"){document.removeEventListener("readystatechange",onReadyStateChange);emitReady()}})):emitReady()}function emitReady(){if(!r){r=true;setTimeout((function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}}function reset(){r=false}},"./src/core/scene/a-scene.js":(e,t,n)=>{n.r(t);n.d(t,{AScene:()=>AScene,determineComponentBehaviorOrder:()=>determineComponentBehaviorOrder,setupCanvas:()=>setupCanvas});var r=n("./node_modules/three/build/three.core.js");var s=n("./node_modules/three/build/three.module.js");var a=n("./src/core/scene/metaTags.js");var o=n("./src/core/scene/wakelock.js");var l=n("./src/core/scene/loadingScreen.js");var c=n("./src/core/scene/scenes.js");var u=n("./src/core/system.js");var h=n("./src/core/component.js");var d=n("./src/utils/index.js");var p=n("./src/core/a-entity.js");var f=n("./src/core/a-node.js");var m=n("./src/core/scene/postMessage.js");n("./src/utils/ios-orientationchange-blank-bug.js");var g=d.debug("core:a-scene:warn");var y=d.device.isIOS();var b=d.device.isMobile();var x=d.device.isWebXRAvailable;class AScene extends p.AEntity{constructor(){var e;super();e=this;e.clock=new r.Clock;e.isIOS=y;e.isMobile=b;e.hasWebXR=x;e.isAR=false;e.isScene=true;e.object3D=new r.Scene;e.resize=e.resize.bind(e);e.render=e.render.bind(e);e.systems={};e.systemNames=[];e.time=e.delta=0;e.usedOfferSession=false;e.componentOrder=[];e.behaviors={};e.hasLoaded=false;e.isPlaying=false;e.originalHTML=e.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var e=this;var t=this.hasAttribute("embedded");this.setAttribute("inspector","");this.setAttribute("keyboard-shortcuts","");this.setAttribute("screenshot","");this.setAttribute("xr-mode-ui","");this.setAttribute("device-orientation-permission-ui","");super.doConnectedCallback();setupCanvas(this);this.setupRenderer();l.setup(this,getCanvasSize);this.resize();t||this.addFullScreenStyles();(0,m.initPostMessageAPI)(this);(0,a.inject)(this);(0,o.initWakelock)(this);this.enterVRBound=function(){e.enterVR()};this.exitVRBound=function(){e.exitVR()};window.addEventListener("sessionend",this.resize);this.addEventListener("cameraready",(function(){e.attachedCallbackPostCamera()}));this.initSystems();this.componentOrder=determineComponentBehaviorOrder(h.components,this.componentOrder);this.addEventListener("componentregistered",(function(){e.componentOrder=determineComponentBehaviorOrder(h.components,e.componentOrder)}));this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",(function(){e.enterVR()}))}attachedCallbackPostCamera(){var e;var t=this;window.addEventListener("load",e);window.addEventListener("resize",(function(){t.isIOS?setTimeout(t.resize,100):t.resize()}));this.play();c.default.push(this)}initSystems(){var e;this.initSystem("camera");for(e in u.systems)e!=="camera"&&this.initSystem(e)}initSystem(e){if(!this.systems[e]){this.systems[e]=new u.systems[e](this);this.systemNames.push(e)}}disconnectedCallback(){var e=c.default.indexOf(this);super.disconnectedCallback();c.default.splice(e,1);window.removeEventListener("sessionend",this.resize);this.removeFullScreenStyles();this.renderer.dispose()}
/**
           * Add ticks and tocks.
           *
           * @param {object} behavior - A component.
           */addBehavior(e){var t;var n=this.behaviors[e.name];var r;n||(n=this.behaviors[e.name]={tick:{inUse:false,array:[],markedForRemoval:[]},tock:{inUse:false,array:[],markedForRemoval:[]}});for(r in n)if(e[r]){t=n[r];if(t.inUse){var s=t.markedForRemoval.indexOf(e);s!==-1&&t.markedForRemoval.splice(s,1)}t.array.indexOf(e)===-1&&t.array.push(e)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return d.device.checkHeadsetConnected()}enterAR(){var e;if(!this.hasWebXR){e="Failed to enter AR mode, WebXR not supported.";throw new Error(e)}if(!d.device.checkARSupport()){e="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.";throw new Error(e)}return this.enterVR(true)}
/**
           * Call `requestPresent` if WebVR or WebVR polyfill.
           * Call `requestFullscreen` on desktop.
           * Handle events, states, fullscreen styles.
           *
           * @param {?boolean} useAR - if true, try immersive-ar mode
           * @returns {Promise}
           */enterVR(e,t){var n=this;var r=n.renderer.xr;var s;if(t&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(n.usedOfferSession&&t)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var a=n.getAttribute("renderer");r.enabled=true;if(this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var o=this.sceneEl.systems.webxr.sessionReferenceSpaceType;r.setReferenceSpaceType(o);var l=e?"immersive-ar":"immersive-vr";s=this.sceneEl.systems.webxr.sessionConfiguration;return new Promise((function(e,o){var c=t?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);n.usedOfferSession|=t;c(l,s).then((function requestSuccess(o){t&&(n.usedOfferSession=false);r.layersEnabled=s.requiredFeatures.indexOf("layers")!==-1;r.setSession(o).then((function(){r.setFoveation(a.foveationLevel);n.xrSession=o;n.systems.renderer.setWebXRFrameRate(o);o.addEventListener("end",n.exitVRBound);enterVRSuccess(e)}))}),(function requestFail(e){var t=l==="immersive-ar";var n=t?"AR":"VR";o(new Error("Failed to enter "+n+" mode (`requestSession`)",{cause:e}))}))}))}var c=e?"AR":"VR";throw new Error("Failed to enter "+c+" no WebXR")}enterVRSuccess();return Promise.resolve();function enterVRSuccess(t){e?n.addState("ar-mode"):n.addState("vr-mode");n.emit("enter-vr",{target:n});!n.hasWebXR&&n.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape");n.addFullScreenStyles();n.isMobile||n.checkHeadsetConnected()||requestFullscreen(n.canvas);n.resize();t&&t()}}
/**
           * Call `exitPresent` if WebVR / WebXR or WebVR polyfill.
           * Handle events, states, fullscreen styles.
           *
           * @returns {Promise}
           */exitVR(){var e=this;var t=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){t.enabled=false;if(!this.hasWebXR)throw Error("Failed to exit VR - no WebXR");this.xrSession.removeEventListener("end",this.exitVRBound);this.xrSession.end().then((function(){}),(function(){}));this.xrSession=void 0}else exitFullscreen();exitVRSuccess();return Promise.resolve();function exitVRSuccess(){e.removeState("vr-mode");e.removeState("ar-mode");e.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();e.hasAttribute("embedded")&&e.removeFullScreenStyles();e.resize();e.isIOS&&d.forceCanvasResizeSafariMobile(e.canvas);e.renderer.setPixelRatio(window.devicePixelRatio);e.emit("exit-vr",{target:e})}}getAttribute(e){var t=this.systems[e];return t?t.data:p.AEntity.prototype.getAttribute.call(this,e)}getDOMAttribute(e){var t=this.systems[e];return t?t.data:p.AEntity.prototype.getDOMAttribute.call(this,e)}setAttribute(e,t,n){if(u.systems[e]){f.ANode.prototype.setAttribute.call(this,e,t);var r=this.systems[e];r&&r.updateProperties(t)}else p.AEntity.prototype.setAttribute.call(this,e,t,n)}
/**
           * @param {object} behavior - A component.
           */removeBehavior(e){var t;var n;var r=this.behaviors[e.name];var s;for(n in r)if(e[n]){t=r[n];s=t.array.indexOf(e);if(s!==-1)if(t.inUse)t.markedForRemoval.indexOf(e)===-1&&t.markedForRemoval.push(e);else{t.array[s]=t.array[t.array.length-1];t.array.pop()}}}resize(){var e=this.camera;var t=this.canvas;var n;var r;var s;var a=this.renderer.xr.isPresenting;r=this.renderer.xr.enabled&&a;if(e&&t&&(!this.is("vr-mode")||!this.isMobile&&!r)){n=this.getAttribute("embedded")&&!this.is("vr-mode");s=getCanvasSize(t,n,this.maxCanvasSize,this.is("vr-mode"));e.aspect=s.width/s.height;e.updateProjectionMatrix();this.renderer.setSize(s.width,s.height,false);this.emit("rendererresize",null,false)}}setupRenderer(){var e=this;var t;var n;var r;var a;a={alpha:true,antialias:!b,canvas:this.canvas,logarithmicDepthBuffer:false,powerPreference:"high-performance"};this.maxCanvasSize={height:-1,width:-1};if(this.hasAttribute("renderer")){r=this.getAttribute("renderer");n=d.styleParser.parse(r);n.precision&&(a.precision=n.precision+"p");n.antialias&&n.antialias!=="auto"&&(a.antialias=n.antialias==="true");n.logarithmicDepthBuffer&&n.logarithmicDepthBuffer!=="auto"&&(a.logarithmicDepthBuffer=n.logarithmicDepthBuffer==="true");n.alpha&&(a.alpha=n.alpha==="true");n.stencil&&(a.stencil=n.stencil==="true");n.multiviewStereo&&(a.multiviewStereo=n.multiviewStereo==="true");this.maxCanvasSize={width:n.maxCanvasWidth?parseInt(n.maxCanvasWidth):this.maxCanvasSize.width,height:n.maxCanvasHeight?parseInt(n.maxCanvasHeight):this.maxCanvasSize.height}}var o=["WebGLRenderer","WebGPURenderer"].find((function(e){return s[e]}));t=this.renderer=new s[o](a);t.xr.setPoseTarget||(t.xr.setPoseTarget=function(){});t.setPixelRatio(window.devicePixelRatio);this.camera&&t.xr.setPoseTarget(this.camera.el.object3D);this.addEventListener("camera-set-active",(function(){t.xr.setPoseTarget(e.camera.el.object3D)}))}play(){var e=this;var t=this;if(this.renderStarted)p.AEntity.prototype.play.call(this);else{this.addEventListener("loaded",(function(){var e=this.renderer;p.AEntity.prototype.play.call(this);if(!t.renderStarted){t.resize();if(t.renderer){window.performance&&window.performance.mark("render-started");l.remove();e.setAnimationLoop(this.render);t.renderStarted=true;t.emit("renderstart")}}}));setTimeout((function(){p.AEntity.prototype.load.call(e)}))}}updateComponent(e){e in u.systems||p.AEntity.prototype.updateComponent.apply(this,arguments)}tick(e,t){var n;var r=this.systems;this.callComponentBehaviors("tick",e,t);for(n=0;n<this.systemNames.length;n++)r[this.systemNames[n]].tick&&r[this.systemNames[n]].tick(e,t)}tock(e,t,n){var r;var s=this.systems;this.callComponentBehaviors("tock",e,t);for(r=0;r<this.systemNames.length;r++)s[this.systemNames[r]].tock&&s[this.systemNames[r]].tock(e,t,n)}render(e,t){var n=this.renderer;this.frame=t;this.delta=this.clock.getDelta()*1e3;this.time=this.clock.elapsedTime*1e3;this.isPlaying&&this.tick(this.time,this.delta);var r=null;if(this.is("ar-mode")){r=this.object3D.background;this.object3D.background=null}n.render(this.object3D,this.camera);r&&(this.object3D.background=r);if(this.isPlaying){var s=n.xr.isPresenting?n.xr.getCamera():this.camera;this.tock(this.time,this.delta,s)}}callComponentBehaviors(e,t,n){var r;for(var s=0;s<this.componentOrder.length;s++){var a=this.behaviors[this.componentOrder[s]];if(a){var o=a[e];o.inUse=true;for(r=0;r<o.array.length;r++)o.array[r].isPlaying&&o.array[r][e](t,n);o.inUse=false;for(r=0;r<o.markedForRemoval.length;r++)this.removeBehavior(o.markedForRemoval[r]);o.markedForRemoval.length=0}}}}
/**
         * Derives an ordering from the components, taking any before and after
         * constraints into account.
         *
         * @param {object} components - The components to order
         * @param {Array} array - Optional array to use as output
         */function determineComponentBehaviorOrder(e,t){var n={};var r;var s;var a=t||[];a.length=0;for(s in e){var o=e[s];if(o!==void 0){var l=o.before?o.before.slice(0):[];var c=o.after?o.after.slice(0):[];n[s]={before:l,after:c,visited:false,done:false}}}for(s in n)for(r=0;r<n[s].before.length;r++){var u=n[s].before[r];u in n?n[u].after.push(s):g("Invalid ordering constraint, no component named `"+u+"` referenced by `"+s+"`")}function visit(e){if(e in n&&!n[e].done)if(n[e].visited)g("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");else{n[e].visited=true;for(var t=0;t<n[e].after.length;t++){var r=n[e].after[t];r in n||g("Invalid before/after constraint, no component named `"+r+"` referenced in `"+e+"`");visit(r)}n[e].done=true;a.push(e)}}for(s in n)n[s].done||visit(s);return a}
/**
         * Return size constrained to maxSize - maintaining aspect ratio.
         *
         * @param {object} size - size parameters (width and height).
         * @param {object} maxSize - Max size parameters (width and height).
         * @returns {object} Width and height.
         */function constrainSizeTo(e,t){var n;var r=window.devicePixelRatio;if(!t||t.width===-1&&t.height===-1)return e;if(e.width*r<t.width&&e.height*r<t.height)return e;n=e.width/e.height;if(e.width*r>t.width&&t.width!==-1){e.width=Math.round(t.width/r);e.height=Math.round(t.width/n/r)}if(e.height*r>t.height&&t.height!==-1){e.height=Math.round(t.height/r);e.width=Math.round(t.height*n/r)}return e}customElements.define("a-scene",AScene);
/**
         * Return the canvas size where the scene will be rendered.
         * Will be always the window size except when the scene is embedded.
         * The parent size will be returned in that case.
         * the returned size will be constrained to the maxSize maintaining aspect ratio.
         *
         * @param {Element} canvasEl - the canvas element
         * @param {boolean} embedded - Is the scene embedded?
         * @param {object} maxSize - Max size parameters
         * @param {boolean} isVR - If in VR
         * @returns {number} Max size
         */function getCanvasSize(e,t,n,r){if(!e.parentElement)return{height:0,width:0};if(t){var s;s={height:e.parentElement.offsetHeight,width:e.parentElement.offsetWidth};return constrainSizeTo(s,n)}return getMaxSize(n,r)}
/**
         * Return the canvas size. Will be the window size unless that size is greater than the
         * maximum size (1920x1920 by default).  The constrained size will be returned in that case,
         * maintaining aspect ratio
         *
         * @param {object} maxSize - Max size parameters (width and height).
         * @param {boolean} isVR - If in VR.
         * @returns {object} Width and height.
         */function getMaxSize(e,t){var n;n={height:document.body.offsetHeight,width:document.body.offsetWidth};return t?n:constrainSizeTo(n,e)}function requestFullscreen(e){var t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t.apply(e,[{navigationUI:"hide"}])}function exitFullscreen(){var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;e&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function setupCanvas(e){var t;t=document.createElement("canvas");t.classList.add("a-canvas");t.dataset.aframeCanvas=true;e.appendChild(t);document.addEventListener("fullscreenchange",onFullScreenChange);document.addEventListener("mozfullscreenchange",onFullScreenChange);document.addEventListener("webkitfullscreenchange",onFullScreenChange);document.addEventListener("MSFullscreenChange",onFullScreenChange);t.addEventListener("touchmove",(function(e){e.preventDefault()}),{passive:false});e.canvas=t;e.emit("render-target-loaded",{target:t});setTimeout(e.resize.bind(e),0);function onFullScreenChange(){var t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;t||e.exitVR();document.activeElement.blur();document.body.focus()}}},"./src/core/scene/loadingScreen.js":(e,t,n)=>{n.r(t);n.d(t,{remove:()=>remove,setup:()=>setup});var r=n("./node_modules/three/build/three.core.js");var s=n("./src/constants/index.js");var a=n("./src/utils/index.js");var o=a.styleParser;var l;var c;var u;var h="loading-screen";var d="a-loader-title";function setup(e,t){l=e;u=t;var n=l.hasAttribute(h)?o.parse(l.getAttribute(h)):void 0;var s=n&&n.dotsColor||"white";var a=n&&n.backgroundColor||"#24CAFF";var d=n===void 0||n.enabled==="true"||n.enabled===void 0;var p;var f;var m;var g;var y;var b;var x;var _;var M;var w;if(d){p=new r.Scene;f=new r.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI);m=new r.MeshBasicMaterial({color:s});g=new r.Mesh(f,m);y=g.clone();b=g.clone();x=new r.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4);_=new r.Clock;M=0;w=function(){l.renderer.render(p,x);M=_.getElapsedTime()%4;g.visible=M>=1;y.visible=M>=2;b.visible=M>=3};p.background=new r.Color(a);p.add(x);g.position.set(-1,0,-15);y.position.set(0,0,-15);b.position.set(1,0,-15);x.add(g);x.add(y);x.add(b);setupTitle();setTimeout((function(){if(!l.hasLoaded){resize(x);c.style.display="block";window.addEventListener("resize",(function(){resize(x)}));l.renderer.setAnimationLoop(w)}}),200)}}function remove(){window.removeEventListener("resize",resize);c&&(c.style.display="none")}function resize(e){var t=l.hasAttribute("embedded");var n=u(l.canvas,t,l.maxCanvasSize,l.is("vr-mode"));e.aspect=n.width/n.height;e.updateProjectionMatrix();l.renderer.setSize(n.width,n.height,false)}function setupTitle(){c=document.createElement("div");c.className=d;c.innerHTML=document.title;c.style.display="none";c.setAttribute(s.AFRAME_INJECTED,"");l.appendChild(c)}},"./src/core/scene/metaTags.js":(e,t,n)=>{n.r(t);n.d(t,{MOBILE_HEAD_TAGS:()=>a,MOBILE_IOS_HEAD_TAGS:()=>o,inject:()=>l});var r=n("./src/constants/index.js");var s=n("./src/utils/index.js");var a=[Meta({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),Meta({name:"mobile-web-app-capable",content:"yes"}),Meta({name:"theme-color",content:"black"})];var o=[Meta({name:"apple-mobile-web-app-capable",content:"yes"}),Meta({name:"apple-mobile-web-app-status-bar-style",content:"black"}),Link({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function Meta(e){return{tagName:"meta",attributes:e,exists:function(){return document.querySelector('meta[name="'+e.name+'"]')}}}function Link(e){return{tagName:"link",attributes:e,exists:function(){return document.querySelector('link[rel="'+e.rel+'"]')}}}
/**
         * Injects the necessary metatags in the document for mobile support:
         * 1. Prevent the user to zoom in the document.
         * 2. Ensure that window.innerWidth and window.innerHeight have the correct
         *    values and the canvas is properly scaled.
         * 3. To allow fullscreen mode when pinning a web app on the home screen on
         *    iOS.
         * Adapted from https://www.reddit.com/r/web_design/comments/3la04p/
         *
         * @param {object} scene - Scene element
         * @returns {Array}
         */var l=function injectHeadTags(e){var t=document.head;var n=t.querySelector("script");var r;var s=[];a.forEach(createAndInjectTag);e.isIOS&&o.forEach(createAndInjectTag);return s;function createAndInjectTag(e){if(e&&!e.exists()){r=createTag(e);if(r){n?n.parentNode.insertBefore(r,n):t.appendChild(r);s.push(r)}}}};function createTag(e){if(e&&e.tagName){var t=document.createElement(e.tagName);t.setAttribute(r.AFRAME_INJECTED,"");return(0,s.extend)(t,e.attributes)}}},"./src/core/scene/postMessage.js":(e,n,r)=>{r.r(n);r.d(n,{initPostMessageAPI:()=>initPostMessageAPI});var s=r("./src/utils/index.js");function initPostMessageAPI(e){(0,s.isIframed)()&&window.addEventListener("message",postMessageAPIHandler.bind(e))}function postMessageAPIHandler(e){var n=this||t;if(e.data)switch(e.data.type){case"vr":switch(e.data.data){case"enter":n.enterVR();break;case"exit":n.exitVR();break}}}},"./src/core/scene/scenes.js":(e,t,n)=>{n.r(t);n.d(t,{default:()=>r});const r=[]},"./src/core/scene/wakelock.js":(e,t,n)=>{n.r(t);n.d(t,{initWakelock:()=>initWakelock});var r=n("./vendor/wakelock/wakelock.js");var s=n.n(r);function initWakelock(e){if(e.isMobile){var t=e.wakelock=new(s());e.addEventListener("enter-vr",(function(){t.request()}));e.addEventListener("exit-vr",(function(){t.release()}))}}},"./src/core/schema.js":(e,t,n)=>{n.r(t);n.d(t,{isSingleProperty:()=>isSingleProperty,parseProperties:()=>u,parseProperty:()=>parseProperty,process:()=>process,processPropertyDefinition:()=>processPropertyDefinition,stringifyProperties:()=>stringifyProperties,stringifyProperty:()=>stringifyProperty});var r=n("./src/utils/index.js");var s=n("./src/core/propertyTypes.js");var a=r.debug;var o=s.isValidDefaultValue;var l=s.propertyTypes;var c=a("core:schema:warn");function isSingleProperty(e){return"type"in e?typeof e.type==="string":"default"in e}
/**
         * Build step to schema to use `type` to inject default value, parser, and stringifier.
         *
         * @param {object} schema
         * @param {string} componentName
         * @returns {object} Schema.
         */function process(e,t){var n;if(isSingleProperty(e))return processPropertyDefinition(e,t);for(n in e)e[n]=processPropertyDefinition(e[n],t);return e}
/**
         * Inject default value, parser, stringifier for single property.
         *
         * @param {object} propDefinition
         * @param {string} componentName
         */function processPropertyDefinition(e,t){var n=e.default;var r;var s;var a=e.type;e.type?e.type==="bool"?a="boolean":e.type==="float"&&(a="number"):a=n===void 0||typeof n!=="boolean"&&typeof n!=="number"?Array.isArray(n)?"array":"string":typeof n;s=l[a];s||c("Unknown property type for component `"+t+"`: "+a);r=!!e.parse;e.parse=e.parse||s.parse;e.stringify=e.stringify||s.stringify;e.equals=e.equals||s.equals;e.isCacheable=e.isCacheable===true||s.isCacheable;e.type=a;"default"in e?r||o(a,n)||c("Default value `"+n+"` does not match type `"+a+"` in component `"+t+"`"):e.default=s.default;return e}
/**
         * Parse propData using schema. Use default values if not existing in propData.
         *
         * @param {object} propData - Unparsed properties.
         * @param {object} schema - Property types definition.
         * @param {boolean} getPartialData - Whether to return full component data or just the data
         *        with keys in `propData`.
         * @param {string } componentName - Name of the component, used for the property warning.
         * @param {boolean} silent - Suppress warning messages.
         */var u=function(){var e=[];return function(t,n,r,s,a){var o;var l;var u;var h;e.length=0;for(l in r?t:n)r&&t[l]===void 0||e.push(l);if(t===null||typeof t!=="object")return t;for(l in t)t[l]===void 0||n[l]||a||c("Unknown property `"+l+"` for component/system `"+s+"`.");for(o=0;o<e.length;o++){l=e[o];u=n[l];h=t[l];if(!n[l])return;t[l]=parseProperty(h,u)}return t}}();
/**
         * Deserialize a single property.
         *
         * @param {any} value - The value to parse.
         * @param {object} propDefinition - The single property schema for the property.
         * @param {any} target - Optional target value to parse into (reuse).
         */function parseProperty(e,t,n){if(e===void 0||e===null||e===""){e=t.default;Array.isArray(e)&&(e=e.slice())}return t.parse(e,t.default,n)}function stringifyProperties(e,t){var n;var r;var s;var a={};var o;for(n in e){r=t[n];s=e[n];o=s;if(typeof o==="object"){o=stringifyProperty(s,r);r||c("Unknown component property: "+n)}o!==void 0&&(a[n]=o)}return a}function stringifyProperty(e,t){return typeof e!=="object"?e:t&&e!==null?t.stringify(e):JSON.stringify(e)}},"./src/core/shader.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>Shader,registerShader:()=>registerShader,shaderNames:()=>c,shaders:()=>l});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/schema.js");var o=r("./src/utils/index.js");var l={};var c=[];var u={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"};var Shader=function(){};Shader.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(e){(this||t).uniforms=this.initUniforms();(this||t).material=new((this||t).raw?s.RawShaderMaterial:s.ShaderMaterial)({uniforms:(this||t).uniforms,glslVersion:(this||t).raw||(this||t).glsl3?s.GLSL3:null,vertexShader:(this||t).vertexShader,fragmentShader:(this||t).fragmentShader});return(this||t).material},initUniforms:function(){var e;var n=(this||t).schema;var r={};var s;for(e in n)if(n[e].is==="uniform"){s=u[n[e].type];r[e]={type:s,value:void 0}}return r},
/**
           * Update handler. Similar to attributeChangedCallback.
           * Called whenever the associated material data changes.
           *
           * @param {object} data - New material data.
           */
update:function(e){var n;var r;var s=(this||t).schema;var a=(this||t).uniforms;for(n in e)if(s[n]&&s[n].is==="uniform")if(s[n].type!=="map"){a[n].value=this.parseValue(s[n].type,e[n]);a[n].needsUpdate=true}else{if(!a[n]||a[n].value===e[n])continue;r="_texture_"+n;this.setMapOnTextureLoad(a,n,r);o.material.updateMapMaterialFromData(r,n,this||t,e)}},parseValue:function(e,t){var n;switch(e){case"vec2":return new s.Vector2(t.x,t.y);case"vec3":return new s.Vector3(t.x,t.y,t.z);case"vec4":return new s.Vector4(t.x,t.y,t.z,t.w);case"color":n=new s.Color(t);return new s.Vector3(n.r,n.g,n.b);default:return t}},setMapOnTextureLoad:function(e,n,r){var s=this||t;(this||t).el.addEventListener("materialtextureloaded",(function(){e[n].value=s.material[r];e[n].needsUpdate=true}))}};
/**
         * Registers a shader to A-Frame.
         *
         * @param {string} name - shader name.
         * @param {object} definition - shader property and methods.
         * @returns {object} Shader.
         */function registerShader(e,n){var r;var s={};Object.keys(n).forEach((function(e){s[e]={value:n[e],writable:true}}));if(l[e])throw new Error("The shader "+e+" has already been registered");r=function(){Shader.call(this||t)};r.prototype=Object.create(Shader.prototype,s);r.prototype.name=e;r.prototype.constructor=r;l[e]={Shader:r,schema:(0,a.process)(r.prototype.schema)};c.push(e);return r}},"./src/core/system.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>System,registerSystem:()=>registerSystem,systems:()=>u});var s=r("./src/core/schema.js");var a=r("./src/core/component.js");var o=r("./src/utils/index.js");var l=r("./src/core/readyState.js");var c=o.styleParser;var u={};
/**
         * System class definition.
         *
         * Systems provide global scope and services to a group of instantiated components of the
         * same class. They can also help abstract logic away from components such that components
         * only have to worry about data.
         *
         * For example, a physics component that creates a physics world that oversees
         * all entities with a physics or rigid body component.
         *
         * TODO: Have the System prototype reuse the Component prototype. Most code is copied
         * and some pieces are missing from the Component facilities (e.g., attribute caching,
         * setAttribute behavior).
         *
         * @constructor
         * @param {Element} sceneEl - Handle to the scene element where system applies to.
         * @property {string} name - Name that system is registered under.
         */var System=function(e){var n=a&&a.components[(this||t).name];(this||t).el=e;(this||t).sceneEl=e;n&&(n.Component.prototype.system=this||t);this.buildData();this.init();this.update({})};System.prototype={schema:{},init:function(){},update:function(e){},updateProperties:function(e){var n=(this||t).data;if(Object.keys((this||t).schema).length!==0){this.buildData(e);this.update(n)}},buildData:function(e){var n=(this||t).schema;if(Object.keys(n).length!==0){e=e||window.HTMLElement.prototype.getAttribute.call((this||t).sceneEl,(this||t).name);(0,s.isSingleProperty)(n)?(this||t).data=(0,s.parseProperty)(e,n):(this||t).data=(0,s.parseProperties)(c.parse(e)||{},n,false,(this||t).name)}},
/**
           * Tick handler.
           * Called on each tick of the scene render loop.
           * Affected by play and pause.
           *
           * @param {number} time - Scene tick time.
           * @param {number} timeDelta - Difference in current render time and previous render time.
           */
tick:void 0,
/**
           * Tock handler.
           * Called on each tock of the scene render loop.
           * Affected by play and pause.
           *
           * @param {number} time - Scene tick time.
           * @param {number} timeDelta - Difference in current render time and previous render time.
           */
tock:void 0,play:function(){},pause:function(){}};
/**
         * Registers a system to A-Frame.
         *
         * @param {string} name - Component name.
         * @param {object} definition - Component property and methods.
         */function registerSystem(e,n){var r;var a;var c={};var h=o.findAllScenes(document);Object.keys(n).forEach((function(e){c[e]={value:n[e],writable:true}}));if(u[e])throw new Error("The system `"+e+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");a=function(e){System.call(this||t,e)};a.prototype=Object.create(System.prototype,c);a.prototype.name=e;a.prototype.constructor=a;a.prototype.schema=o.extend((0,s.process)(a.prototype.schema));u[e]=a;if(l.canInitializeElements)for(r=0;r<h.length;r++)h[r].initSystem(e)}},"./src/extras/components/index.js":(e,t,n)=>{n.r(t);n("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/component.js");var o=new s.Vector3;var l=new s.Vector3;(0,a.registerComponent)("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var e=(this||t).data;var n=(this||t).el;var r=n.object3D.parent;var a=n.object3D;var c=new s.Group;o.copy(a.position);l.copy(a.rotation);r.remove(a);c.add(a);r.add(c);n.object3D=c;a.position.set(-1*e.x,-1*e.y,-1*e.z);c.position.set(e.x+o.x,e.y+o.y,e.z+o.z);c.rotation.copy(a.rotation);a.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(e,t,n)=>{n.r(t);n.d(t,{default:()=>getMeshMixin});var r=n("./src/core/component.js");var s=n("./src/core/shader.js");var a=n("./src/utils/index.js");var o={};Object.keys(r.components.material.schema).forEach(addMapping);Object.keys(s.shaders.standard.schema).forEach(addMapping);function addMapping(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();e==="fog"&&(t="material-fog");e==="visible"&&(t="material-visible");o[t]="material."+e}function getMeshMixin(){return{defaultComponents:{material:{}},mappings:a.extend({},o)}}},"./src/extras/primitives/index.js":(e,t,n)=>{n.r(t);n("./src/extras/primitives/primitives/a-camera.js");n("./src/extras/primitives/primitives/a-cursor.js");n("./src/extras/primitives/primitives/a-curvedimage.js");n("./src/extras/primitives/primitives/a-gltf-model.js");n("./src/extras/primitives/primitives/a-image.js");n("./src/extras/primitives/primitives/a-light.js");n("./src/extras/primitives/primitives/a-link.js");n("./src/extras/primitives/primitives/a-obj-model.js");n("./src/extras/primitives/primitives/a-sky.js");n("./src/extras/primitives/primitives/a-sound.js");n("./src/extras/primitives/primitives/a-text.js");n("./src/extras/primitives/primitives/a-video.js");n("./src/extras/primitives/primitives/a-videosphere.js");n("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(e,t,n)=>{n.r(t);n.d(t,{definePrimitive:()=>definePrimitive,primitives:()=>p,registerPrimitive:()=>registerPrimitive});var r=n("./src/core/a-node.js");var s=n("./src/core/a-entity.js");var a=n("./src/core/component.js");var o=n("./src/utils/index.js");var l=o.debug;var c=o.entity.setComponentProperty;var u=l("extras:primitives:debug");var h=l("extras:primitives:warn");var d=l("extras:primitives:error");var p={};function registerPrimitive(e,t){e=e.toLowerCase();if(!r.knownTags[e]){r.knownTags[e]=true;u("Registering <%s>",e);t.defaultAttributes&&h("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var n=t.mappings||{};var l=class extends s.AEntity{constructor(){super();this.defaultComponentsFromPrimitive=t.defaultComponents||t.defaultAttributes||{};this.deprecated=t.deprecated||null;this.deprecatedMappings=t.deprecatedMappings||{};this.mappings=n;t.deprecated&&console.warn(t.deprecated);this.resolveMappingCollisions()}resolveMappingCollisions(){var e=this.mappings;var t=this;Object.keys(e).forEach((function resolveCollision(n){var r;n!==n.toLowerCase()&&h("Mapping keys should be specified in lower case. The mapping key "+n+" may not be recognized");if(a.components[n]){r=e[n].replace(".","-");e[r]=e[n];delete e[n];console.warn("The primitive "+t.tagName.toLowerCase()+" has a mapping collision. The attribute "+n+" has the same name as a registered component and has been renamed to "+r)}}))}getExtraComponents(){var e;var t;var n;var r;var s;var a=this;t=o.clone(this.defaultComponentsFromPrimitive);s=this.getAttribute("mixin");if(s){s=o.split(s.trim(),/\s+/);s.forEach((function applyMixin(e){var n=document.getElementById(e);if(n){var s=n.rawAttributeCache;var o=n.componentCache;for(var l in s){r=a.mappings[l];if(r){applyMapping(r,s[l],t);return}l in o&&(t[l]=extend(t[l],o[l]))}}}))}for(n=0;n<this.attributes.length;n++){e=this.attributes[n];r=this.mappings[e.name];r&&applyMapping(r,e.value,t)}return t;function extend(e,t){return isUndefined(e)?copy(t):isUndefined(t)?copy(e):isPureObject(e)&&isPureObject(t)?o.extendDeep(e,t):copy(t)}function isUndefined(e){return typeof e==="undefined"}function copy(e){return isPureObject(e)?o.extendDeep({},e):e}function isPureObject(e){return e!==null&&e.constructor===Object}}attributeChangedCallback(e,t,n){var r=this.mappings[e];e in this.deprecatedMappings&&console.warn(this.deprecatedMappings[e]);e&&r?c(this,r,n):super.attributeChangedCallback(e,t,n)}};customElements.define(e,l);l.mappings=n;p[e]=l;return l}d("Trying to register primitive "+e+" that has been already previously registered")}
/**
         * Sets the relevant property based on the mapping property path.
         *
         * @param {string} mapping - The mapped property path.
         * @param {string} attrValue - The (raw) attribute value.
         * @param {object} data - The data object to apply the mapping to.
         */function applyMapping(e,t,n){var r=o.entity.getComponentPropertyPath(e);if(r.constructor===Array){n[r[0]]=n[r[0]]||{};n[r[0]][r[1]]=t.trim()}else n[r]=t.trim()}function addComponentMapping(e,t){var n=a.components[e].schema;Object.keys(n).forEach((function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();t[r]!==void 0&&(r=e+"-"+n);t[r]=e+"."+n}))}function definePrimitive(e,t,n){n=n||{};Object.keys(t).forEach((function buildMappings(e){addComponentMapping(e,n)}));registerPrimitive(e,o.extendDeep({},null,{defaultComponents:t,mappings:n}))}},"./src/extras/primitives/primitives/a-camera.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/primitives.js");(0,r.registerPrimitive)("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");(0,s.registerPrimitive)("a-cursor",a.extendDeep({},(0,r.default)(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");(0,s.registerPrimitive)("a-curvedimage",a.extendDeep({},(0,r.default)(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:true,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:true,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/primitives.js");(0,r.registerPrimitive)("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");(0,s.registerPrimitive)("a-image",a.extendDeep({},(0,r.default)(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:true}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/primitives.js");(0,r.registerPrimitive)("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/primitives.js");(0,r.registerPrimitive)("a-link",{defaultComponents:{link:{visualAspectEnabled:true}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");(0,s.registerPrimitive)("a-obj-model",a.extendDeep({},(0,r.default)(),{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");var o=n("./src/extras/primitives/primitives/meshPrimitives.js");(0,s.registerPrimitive)("a-sky",a.extendDeep({},(0,r.default)(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:true},scale:"-1 1 1"},mappings:a.extendDeep({},o.default["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/primitives.js");(0,r.registerPrimitive)("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/primitives.js");(0,r.definePrimitive)("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");(0,s.registerPrimitive)("a-video",a.extendDeep({},(0,r.default)(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:true}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(e,t,n)=>{n.r(t);var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/extras/primitives/primitives.js");var a=n("./src/utils/index.js");(0,s.registerPrimitive)("a-videosphere",a.extendDeep({},(0,r.default)(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:true},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(e,t,n)=>{n.r(t);n.d(t,{default:()=>c});var r=n("./src/extras/primitives/getMeshMixin.js");var s=n("./src/core/geometry.js");var a=n("./src/extras/primitives/primitives.js");var o=n("./src/utils/index.js");const l={};const c=l;s.geometryNames.forEach((function registerMeshPrimitive(e){var t=s.geometries[e];var n=unCamelCase(e);var c={};Object.keys(t.schema).forEach((function createMapping(e){c[unCamelCase(e)]="geometry."+e}));var u="a-"+n;var h=(0,a.registerPrimitive)(u,o.extendDeep({},(0,r.default)(),{defaultComponents:{geometry:{primitive:e}},mappings:c}));l[u]=h}));function unCamelCase(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(e){(this||t).geometry=new s.BoxGeometry(e.width,e.height,e.depth,e.segmentsWidth,e.segmentsHeight,e.segmentsDepth)}})},"./src/geometries/circle.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=s.MathUtils.degToRad;(0,a.registerGeometry)("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){(this||t).geometry=new s.CircleGeometry(e.radius,e.segments,o(e.thetaStart),o(e.thetaLength))}})},"./src/geometries/cone.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=s.MathUtils.degToRad;(0,a.registerGeometry)("cone",{schema:{height:{default:1,min:0},openEnded:{default:false},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){(this||t).geometry=new s.CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,o(e.thetaStart),o(e.thetaLength))}})},"./src/geometries/cylinder.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=s.MathUtils.degToRad;(0,a.registerGeometry)("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:false},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){(this||t).geometry=new s.CylinderGeometry(e.radius,e.radius,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,o(e.thetaStart),o(e.thetaLength))}})},"./src/geometries/dodecahedron.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){(this||t).geometry=new s.DodecahedronGeometry(e.radius,e.detail)}})},"./src/geometries/icosahedron.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){(this||t).geometry=new s.IcosahedronGeometry(e.radius,e.detail)}})},"./src/geometries/index.js":(e,t,n)=>{n.r(t);n("./src/geometries/box.js");n("./src/geometries/circle.js");n("./src/geometries/cone.js");n("./src/geometries/cylinder.js");n("./src/geometries/dodecahedron.js");n("./src/geometries/icosahedron.js");n("./src/geometries/octahedron.js");n("./src/geometries/plane.js");n("./src/geometries/ring.js");n("./src/geometries/sphere.js");n("./src/geometries/tetrahedron.js");n("./src/geometries/torus.js");n("./src/geometries/torusKnot.js");n("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){(this||t).geometry=new s.OctahedronGeometry(e.radius,e.detail)}})},"./src/geometries/plane.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(e){(this||t).geometry=new s.PlaneGeometry(e.width,e.height,e.segmentsWidth,e.segmentsHeight)}})},"./src/geometries/ring.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=s.MathUtils.degToRad;(0,a.registerGeometry)("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){(this||t).geometry=new s.RingGeometry(e.radiusInner,e.radiusOuter,e.segmentsTheta,e.segmentsPhi,o(e.thetaStart),o(e.thetaLength))}})},"./src/geometries/sphere.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=s.MathUtils.degToRad;(0,a.registerGeometry)("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(e){(this||t).geometry=new s.SphereGeometry(e.radius,e.segmentsWidth,e.segmentsHeight,o(e.phiStart),o(e.phiLength),o(e.thetaStart),o(e.thetaLength))}})},"./src/geometries/tetrahedron.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){(this||t).geometry=new s.TetrahedronGeometry(e.radius,e.detail)}})},"./src/geometries/torus.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=s.MathUtils.degToRad;(0,a.registerGeometry)("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(e){(this||t).geometry=new s.TorusGeometry(e.radius,e.radiusTubular*2,e.segmentsRadial,e.segmentsTubular,o(e.arc))}})},"./src/geometries/torusKnot.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");(0,a.registerGeometry)("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(e){(this||t).geometry=new s.TorusKnotGeometry(e.radius,e.radiusTubular*2,e.segmentsTubular,e.segmentsRadial,e.p,e.q)}})},"./src/geometries/triangle.js":(e,n,r)=>{r.r(n);var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/geometry.js");var o=new s.Quaternion;var l=new s.Vector3(0,0,1);var c=new s.Vector2;var u=new s.Vector2;var h=new s.Vector2;(0,a.registerGeometry)("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(e){var n;var r;var a;var d;var p;var f;var m;var g;var y;a=new s.Triangle;a.a.set(e.vertexA.x,e.vertexA.y,e.vertexA.z);a.b.set(e.vertexB.x,e.vertexB.y,e.vertexB.z);a.c.set(e.vertexC.x,e.vertexC.y,e.vertexC.z);r=a.getNormal(new s.Vector3);o.setFromUnitVectors(r,l);d=a.a.clone().applyQuaternion(o);p=a.b.clone().applyQuaternion(o);f=a.c.clone().applyQuaternion(o);c.set(Math.min(d.x,p.x,f.x),Math.min(d.y,p.y,f.y));u.set(Math.max(d.x,p.x,f.x),Math.max(d.y,p.y,f.y));h.set(0,0).subVectors(u,c);d=(new s.Vector2).subVectors(d,c).divide(h);p=(new s.Vector2).subVectors(p,c).divide(h);f=(new s.Vector2).subVectors(f,c).divide(h);n=(this||t).geometry=new s.BufferGeometry;m=[a.a.x,a.a.y,a.a.z,a.b.x,a.b.y,a.b.z,a.c.x,a.c.y,a.c.z];g=[r.x,r.y,r.z,r.x,r.y,r.z,r.x,r.y,r.z];y=[d.x,d.y,p.x,p.y,f.x,f.y];n.setAttribute("position",new s.Float32BufferAttribute(m,3));n.setAttribute("normal",new s.Float32BufferAttribute(g,3));n.setAttribute("uv",new s.Float32BufferAttribute(y,2))}})},"./src/lib/rStatsAframe.js":()=>{window.aframeStats=function(e){var t=null;var n=e;var r={te:{caption:"Entities"},lt:{caption:"Load Time"}};var s=[{caption:"A-Frame",values:["te","lt"]}];function _update(){t("te").set(getEntityCount());window.performance.getEntriesByName&&t("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function getEntityCount(){var e=n.querySelectorAll("*");Array.prototype.slice.call(e).filter((function(e){return e.isEntity}));return e.length}function _start(){}function _end(){}function _attach(e){t=e}return{update:_update,start:_start,end:_end,attach:_attach,values:r,groups:s,fractions:[]}}},"./src/lib/three.js":(e,t,n)=>{n.r(t);n.d(t,{default:()=>m});var r=n("./node_modules/three/build/three.module.js");var s=n("./node_modules/three/examples/jsm/loaders/DRACOLoader.js");var a=n("./node_modules/three/examples/jsm/loaders/GLTFLoader.js");var o=n("./node_modules/three/examples/jsm/loaders/KTX2Loader.js");var l=n("./node_modules/three/examples/jsm/math/OBB.js");var c=n("./node_modules/three/examples/jsm/loaders/OBJLoader.js");var u=n("./node_modules/three/examples/jsm/loaders/MTLLoader.js");var h=n("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");var d=n("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js");var p=n("./vendor/DeviceOrientationControls.js");var f=globalThis.THREE={...r};f.DRACOLoader=s.DRACOLoader;f.GLTFLoader=a.GLTFLoader;f.KTX2Loader=o.KTX2Loader;f.OBJLoader=c.OBJLoader;f.MTLLoader=u.MTLLoader;f.OBB=l.OBB;f.BufferGeometryUtils=h;f.LightProbeGenerator=d.LightProbeGenerator;f.DeviceOrientationControls=p.DeviceOrientationControls;f.Cache.enabled=true;const m=f},"./src/shaders/flat.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>l});var s=r("./src/core/shader.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./src/utils/index.js");var l=(0,s.registerShader)("flat",{schema:{color:{type:"color"},fog:{default:true},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},wireframe:{default:false},wireframeLinewidth:{default:2},toneMapped:{default:true}},init:function(e){(this||t).materialData={color:new a.Color};getMaterialData(e,(this||t).materialData);(this||t).material=new a.MeshBasicMaterial((this||t).materialData)},update:function(e){this.updateMaterial(e);o.material.updateMap(this||t,e)},
/**
           * Updating existing material.
           *
           * @param {object} data - Material component data.
           */
updateMaterial:function(e){var n;getMaterialData(e,(this||t).materialData);for(n in(this||t).materialData)(this||t).material[n]=(this||t).materialData[n]}});
/**
         * Builds and normalize material data, normalizing stuff along the way.
         *
         * @param {object} data - Material data.
         * @param {object} materialData - Object to reuse.
         * @returns {object} Updated material data.
         */function getMaterialData(e,t){t.color.set(e.color);t.fog=e.fog;t.wireframe=e.wireframe;t.toneMapped=e.toneMapped;t.wireframeLinewidth=e.wireframeLinewidth;return t}},"./src/shaders/index.js":(e,t,n)=>{n.r(t);n("./src/shaders/flat.js");n("./src/shaders/standard.js");n("./src/shaders/phong.js");n("./src/shaders/sdf.js");n("./src/shaders/msdf.js");n("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>u});var s=r("./src/core/shader.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./node_modules/three/build/three.module.js");var l=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join("\n");var c=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join("\n");var u=(0,s.registerShader)("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:true},opacity:{type:"number",is:"uniform",default:1}},vertexShader:l,fragmentShader:c,init:function(){(this||t).uniforms=this.initUniforms();a.UniformsUtils&&((this||t).uniforms=a.UniformsUtils.merge([o.UniformsLib.fog,(this||t).uniforms]));(this||t).material=new a.ShaderMaterial({uniforms:(this||t).uniforms,vertexShader:(this||t).vertexShader,fragmentShader:(this||t).fragmentShader,fog:true});return(this||t).material}})},"./src/shaders/phong.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>l});var s=r("./src/core/shader.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./src/utils/index.js");var l=(0,s.registerShader)("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:false},fog:{default:true},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:false},wireframe:{default:false},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:false},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(e){(this||t).materialData={color:new a.Color,specular:new a.Color,emissive:new a.Color};getMaterialData(e,(this||t).materialData);(this||t).material=new a.MeshPhongMaterial((this||t).materialData);var n=(this||t).el.sceneEl;Object.defineProperty((this||t).material,"envMap",{get:function(){return(this||t)._envMap||n.object3D.environment},set:function(e){(this||t)._envMap=e}})},update:function(e){this.updateMaterial(e);o.material.updateMap(this||t,e);o.material.updateDistortionMap("normal",this||t,e);o.material.updateDistortionMap("displacement",this||t,e);o.material.updateDistortionMap("ambientOcclusion",this||t,e);o.material.updateDistortionMap("bump",this||t,e);o.material.updateEnvMap(this||t,e)},
/**
           * Updating existing material.
           *
           * @param {object} data - Material component data.
           */
updateMaterial:function(e){var n;getMaterialData(e,(this||t).materialData);for(n in(this||t).materialData)(this||t).material[n]=(this||t).materialData[n]}});
/**
         * Builds and normalize material data, normalizing stuff along the way.
         *
         * @param {object} data - Material data.
         * @param {object} materialData - Object to use.
         * @returns {object} Updated materialData.
         */function getMaterialData(e,t){t.color.set(e.color);t.specular.set(e.specular);t.emissive.set(e.emissive);t.emissiveIntensity=e.emissiveIntensity;t.fog=e.fog;t.transparent=e.transparent;t.wireframe=e.wireframe;t.wireframeLinewidth=e.wireframeLinewidth;t.shininess=e.shininess;t.flatShading=e.flatShading;t.wireframe=e.wireframe;t.wireframeLinewidth=e.wireframeLinewidth;t.reflectivity=e.reflectivity;t.refractionRatio=e.refractionRatio;switch(e.combine){case"mix":t.combine=a.MixOperation;break;case"multiply":t.combine=a.MultiplyOperation;break;case"add":t.combine=a.AddOperation;break}e.normalMap&&(t.normalScale=e.normalScale);e.ambientOcclusionMap&&(t.aoMapIntensity=e.ambientOcclusionMapIntensity);e.bumpMap&&(t.bumpScale=e.bumpMapScale);if(e.displacementMap){t.displacementScale=e.displacementScale;t.displacementBias=e.displacementBias}return t}},"./src/shaders/sdf.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>u});var s=r("./src/core/shader.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./node_modules/three/build/three.module.js");var l=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join("\n");var c=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join("\n");var u=(0,s.registerShader)("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:l,fragmentShader:c,init:function(){(this||t).uniforms=this.initUniforms();a.UniformsUtils&&((this||t).uniforms=a.UniformsUtils.merge([o.UniformsLib.fog,(this||t).uniforms]));(this||t).material=new a.ShaderMaterial({uniforms:(this||t).uniforms,vertexShader:(this||t).vertexShader,fragmentShader:(this||t).fragmentShader,fog:true});return(this||t).material}})},"./src/shaders/shadow.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>o});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/shader.js");var o=(0,a.registerShader)("shadow",{schema:{opacity:{default:.5},transparent:{default:true},alphaToCoverage:{default:true}},init:function(e){(this||t).material=new s.ShadowMaterial},update:function(e){(this||t).material.opacity=e.opacity;(this||t).material.alphaToCoverage=e.alphaToCoverage;(this||t).material.transparent=e.transparent}})},"./src/shaders/standard.js":(e,n,r)=>{r.r(n);r.d(n,{Shader:()=>l});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/shader.js");var o=r("./src/utils/index.js");var l=(0,a.registerShader)("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:true},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},wireframe:{default:false},wireframeLinewidth:{default:2}},init:function(e){(this||t).materialData={color:new s.Color,emissive:new s.Color};getMaterialData(e,(this||t).materialData);(this||t).material=new s.MeshStandardMaterial((this||t).materialData)},update:function(e){this.updateMaterial(e);o.material.updateMap(this||t,e);o.material.updateDistortionMap("normal",this||t,e);o.material.updateDistortionMap("displacement",this||t,e);o.material.updateDistortionMap("ambientOcclusion",this||t,e);o.material.updateDistortionMap("metalness",this||t,e);o.material.updateDistortionMap("roughness",this||t,e);o.material.updateEnvMap(this||t,e)},
/**
           * Updating existing material.
           *
           * @param {object} data - Material component data.
           */
updateMaterial:function(e){var n;var r=(this||t).material;getMaterialData(e,(this||t).materialData);for(n in(this||t).materialData)r[n]=(this||t).materialData[n]}});
/**
         * Builds and normalize material data, normalizing stuff along the way.
         *
         * @param {object} data - Material data.
         * @param {object} materialData - Object to use.
         * @returns {object} Updated materialData.
         */function getMaterialData(e,t){t.color.set(e.color);t.emissive.set(e.emissive);t.emissiveIntensity=e.emissiveIntensity;t.fog=e.fog;t.metalness=e.metalness;t.roughness=e.roughness;t.wireframe=e.wireframe;t.wireframeLinewidth=e.wireframeLinewidth;e.normalMap&&(t.normalScale=e.normalScale);e.ambientOcclusionMap&&(t.aoMapIntensity=e.ambientOcclusionMapIntensity);if(e.displacementMap){t.displacementScale=e.displacementScale;t.displacementBias=e.displacementBias}return t}},"./src/systems/camera.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>l});var s=r("./src/constants/index.js");var a=r("./src/core/system.js");var o="data-aframe-default-camera";var l=(0,a.registerSystem)("camera",{init:function(){(this||t).activeCameraEl=null;(this||t).render=(this||t).render.bind(this||t);(this||t).unwrapRender=(this||t).unwrapRender.bind(this||t);(this||t).wrapRender=(this||t).wrapRender.bind(this||t);(this||t).initialCameraFound=false;(this||t).numUserCameras=0;(this||t).numUserCamerasChecked=0;this.setupInitialCamera()},setupInitialCamera:function(){var e;var n;var r=(this||t).sceneEl;var s=this||t;if(!r.camera||r.camera.el.getAttribute("camera").spectator){e=r.querySelectorAll("a-camera, :not(a-mixin)[camera]");if(e.length){(this||t).numUserCameras=e.length;for(n=0;n<e.length;n++){e[n].addEventListener("object3dset",(function(e){e.detail.type==="camera"&&s.checkUserCamera(this||t)}));e[n].isANode?e[n].load():e[n].addEventListener("nodeready",(function(){this.load()}))}}else this.createDefaultCamera()}else r.emit("cameraready",{cameraEl:r.camera.el})},checkUserCamera:function(e){var n;var r=(this||t).el.sceneEl;(this||t).numUserCamerasChecked++;if(!(this||t).initialCameraFound){n=e.getAttribute("camera");if(n.active&&!n.spectator){(this||t).initialCameraFound=true;r.camera=e.getObject3D("camera");r.emit("cameraready",{cameraEl:e})}else(this||t).numUserCamerasChecked===(this||t).numUserCameras&&this.createDefaultCamera()}},createDefaultCamera:function(){var e;var n=(this||t).sceneEl;e=document.createElement("a-entity");e.setAttribute("camera",{active:true});e.setAttribute("position",{x:0,y:s.DEFAULT_CAMERA_HEIGHT,z:0});e.setAttribute("wasd-controls","");e.setAttribute("look-controls","");e.setAttribute(s.AFRAME_INJECTED,"");e.addEventListener("object3dset",(function(t){if(t.detail.type==="camera"){n.camera=t.detail.object;n.emit("cameraready",{cameraEl:e})}}));n.appendChild(e)},disableActiveCamera:function(){var e;var n;e=(this||t).sceneEl.querySelectorAll(":not(a-mixin)[camera]");n=e[e.length-1];n.setAttribute("camera","active",true)},
/**
           * Set active camera to be used by renderer.
           * Removes the default camera (if present).
           * Disables all other cameras in the scene.
           *
           * @param {Element} newCameraEl - Entity with camera component.
           */
setActiveCamera:function(e){var n;var r;var s;var a;var l=(this||t).activeCameraEl;var c=(this||t).sceneEl;a=e.getObject3D("camera");if(a&&e!==(this||t).activeCameraEl){var u=c.querySelector("["+o+"]");var h=u&&u.querySelector(":not(a-mixin)[camera]");e!==h&&removeDefaultCamera(c);(this||t).activeCameraEl=e;(this||t).activeCameraEl.play();c.camera=a;l&&l.setAttribute("camera","active",false);r=c.querySelectorAll(":not(a-mixin)[camera]");for(s=0;s<r.length;s++){n=r[s];if(n.isEntity&&e!==n){n.setAttribute("camera","active",false);n.pause()}}c.emit("camera-set-active",{cameraEl:e})}},
/**
           * Set spectator camera to render the scene on a 2D display.
           *
           * @param {Element} newCameraEl - Entity with camera component.
           */
setSpectatorCamera:function(e){var n;var r=(this||t).spectatorCameraEl;var s=(this||t).sceneEl;var a;n=e.getObject3D("camera");if(n&&e!==(this||t).spectatorCameraEl){r&&r.setAttribute("camera","spectator",false);a=(this||t).spectatorCameraEl=e;s.addEventListener("enter-vr",(this||t).wrapRender);s.addEventListener("exit-vr",(this||t).unwrapRender);a.setAttribute("camera","active",false);a.play();s.emit("camera-set-spectator",{cameraEl:e})}},disableSpectatorCamera:function(){(this||t).spectatorCameraEl=void 0},wrapRender:function(){if((this||t).spectatorCameraEl&&!(this||t).originalRender){(this||t).originalRender=(this||t).sceneEl.renderer.render;(this||t).sceneEl.renderer.render=(this||t).render}},unwrapRender:function(){if((this||t).originalRender){(this||t).sceneEl.renderer.render=(this||t).originalRender;(this||t).originalRender=void 0}},render:function(e,n){var r;var s=(this||t).sceneEl;var a;r=s.renderer.xr.enabled;(this||t).originalRender.call(s.renderer,e,n);if((this||t).spectatorCameraEl&&!s.isMobile&&r){a=(this||t).spectatorCameraEl.components.camera.camera;s.renderer.xr.enabled=false;(this||t).originalRender.call(s.renderer,e,a);s.renderer.xr.enabled=r}}});
/**
         * Remove injected default camera from scene, if present.
         *
         * @param {Element} sceneEl
         */function removeDefaultCamera(e){var t;var n=e.camera;if(n){t=e.querySelector("["+o+"]");t&&e.removeChild(t)}}},"./src/systems/geometry.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>o});var s=r("./src/core/geometry.js");var a=r("./src/core/system.js");var o=(0,a.registerSystem)("geometry",{init:function(){(this||t).cache={};(this||t).cacheCount={}},clearCache:function(){(this||t).cache={};(this||t).cacheCount={}},
/**
           * Attempt to retrieve from cache.
           *
           * @returns {object|null} A geometry if it exists, else null.
           */
getOrCreateGeometry:function(e){var n=(this||t).cache;var r;var s;if(e.skipCache)return createGeometry(e);s=this.hash(e);r=n[s];incrementCacheCount((this||t).cacheCount,s);if(r)return r;r=createGeometry(e);n[s]=r;return r},unuseGeometry:function(e){var n=(this||t).cache;var r=(this||t).cacheCount;var s;var a;if(!e.skipCache){a=this.hash(e);if(n[a]){decrementCacheCount(r,a);if(!(r[a]>0)){s=n[a];s.dispose();delete n[a];delete r[a]}}}},hash:function(e){return JSON.stringify(e)}});
/**
         * Create geometry using component data.
         *
         * @param {object} data - Component data.
         * @returns {object} Geometry.
         */function createGeometry(e){var t=e.primitive;var n=s.geometries[t]&&s.geometries[t].Geometry;var r=new n;if(!n)throw new Error("Unknown geometry `"+t+"`");r.init(e);return r.geometry}function decrementCacheCount(e,t){e[t]--}function incrementCacheCount(e,t){e[t]=e[t]===void 0?1:e[t]+1}},"./src/systems/gltf-model.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>l});var s=r("./node_modules/three/examples/jsm/loaders/DRACOLoader.js");var a=r("./node_modules/three/examples/jsm/loaders/KTX2Loader.js");var o=r("./src/core/system.js");function fetchScript(e){return new Promise((function(t,n){var r=document.createElement("script");document.body.appendChild(r);r.onload=t;r.onerror=n;r.async=true;r.src=e}))}
/**
         * glTF model system.
         *
         * Configures glTF loading options. Models using glTF compression require that a Draco decoder be
         * provided externally.
         *
         * @param {string} dracoDecoderPath - Base path from which to load Draco decoder library.
         * @param {string} basisTranscoderPath - Base path from which to load Basis transcoder library.
         * @param {string} meshoptDecoderPath - Full path from which to load Meshopt decoder.
         */var l=(0,o.registerSystem)("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.7/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var e=(this||t).data.dracoDecoderPath;var n=(this||t).data.basisTranscoderPath;var r=(this||t).data.meshoptDecoderPath;if(!(this||t).dracoLoader&&e){(this||t).dracoLoader=new s.DRACOLoader;(this||t).dracoLoader.setDecoderPath(e)}if(!(this||t).ktx2Loader&&n){(this||t).ktx2Loader=new a.KTX2Loader;(this||t).ktx2Loader.setTranscoderPath(n).detectSupport((this||t).el.renderer)}!(this||t).meshoptDecoder&&r&&((this||t).meshoptDecoder=fetchScript(r).then((function(){return window.MeshoptDecoder.ready})).then((function(){return window.MeshoptDecoder})))},getDRACOLoader:function(){return(this||t).dracoLoader},getKTX2Loader:function(){return(this||t).ktx2Loader},getMeshoptDecoder:function(){return(this||t).meshoptDecoder}})},"./src/systems/index.js":(e,t,n)=>{n.r(t);n("./src/systems/camera.js");n("./src/systems/geometry.js");n("./src/systems/gltf-model.js");n("./src/systems/light.js");n("./src/systems/material.js");n("./src/systems/obb-collider.js");n("./src/systems/renderer.js");n("./src/systems/shadow.js");n("./src/systems/tracked-controls.js");n("./src/systems/webxr.js")},"./src/systems/light.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>l});var s=r("./src/core/system.js");var a=r("./src/constants/index.js");var o="data-aframe-default-light";
/**
         * Light system.
         *
         * Prescribes default lighting if not specified (one ambient, one directional).
         * Removes default lighting from the scene when a new light is added.
         *
         * @param {boolean} defaultLights - Whether default lighting are defined.
         * @param {boolean} userDefinedLights - Whether user lighting is defined.
         */var l=(0,s.registerSystem)("light",{schema:{defaultLightsEnabled:{default:true}},init:function(){(this||t).defaultLights=false;(this||t).userDefinedLights=false;(this||t).sceneEl.addEventListener("loaded",(this||t).setupDefaultLights.bind(this||t))},
/**
           * Notify scene that light has been added and to remove the default.
           *
           * @param {object} el - element holding the light component.
           */
registerLight:function(e){if(!e.hasAttribute(o)){this.removeDefaultLights();(this||t).userDefinedLights=true}},removeDefaultLights:function(){var e;var n=(this||t).sceneEl;if((this||t).defaultLights){e=document.querySelectorAll("["+o+"]");for(var r=0;r<e.length;r++)n.removeChild(e[r]);(this||t).defaultLights=false}},setupDefaultLights:function(){var e=(this||t).sceneEl;var n;var r;if(!(this||t).userDefinedLights&&!(this||t).defaultLights&&(this||t).data.defaultLightsEnabled){n=document.createElement("a-entity");n.setAttribute("light",{color:"#BBB",type:"ambient"});n.setAttribute(o,"");n.setAttribute(a.AFRAME_INJECTED,"");e.appendChild(n);r=document.createElement("a-entity");r.setAttribute("light",{color:"#FFF",intensity:1.884,castShadow:true});r.setAttribute("position",{x:-.5,y:1,z:1});r.setAttribute(o,"");r.setAttribute(a.AFRAME_INJECTED,"");e.appendChild(r);(this||t).defaultLights=true}}})},"./src/systems/material.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>p});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/system.js");var o=r("./src/utils/index.js");var l=r("./src/utils/material.js");var c=o.debug;var u=c("components:texture:error");var h=c("components:texture:warn");var d=new s.ImageLoader;var p=(0,a.registerSystem)("material",{init:function(){(this||t).materials={};(this||t).sourceCache={}},clearTextureSourceCache:function(){(this||t).sourceCache={}},
/**
           * Loads and creates a texture for a given `src`.
           *
           * @param {string|Element} src - URL or element
           * @param {object} data - Relevant texture properties
           * @param {function} cb - Callback to pass texture to
           */
loadTexture:function(e,t,n){this.loadTextureSource(e,(function sourceLoaded(e){var r=(0,l.createCompatibleTexture)(e);(0,l.setTextureProperties)(r,t);n(r)}))},
/**
           * Determine whether `src` is an image or video. Then try to load the asset, then call back.
           *
           * @param {string|Element} src - URL or element.
           * @param {function} cb - Callback to pass texture source to.
           */
loadTextureSource:function(e,n){var r=this||t;var a=(this||t).sourceCache;var l=this.hash(e);a[l]?a[l].then(n):e.tagName!=="CANVAS"?sourceLoaded(new Promise(doSourceLoad)):sourceLoaded(new s.Source(e));function doSourceLoad(t,n){o.srcLoader.validateSrc(e,loadImageCb,loadVideoCb);function loadImageCb(e){r.loadImage(e,t)}function loadVideoCb(e){r.loadVideo(e,t)}}function sourceLoaded(e){a[l]=Promise.resolve(e);a[l].then(n)}},
/**
           * Load the six individual sides and construct a cube texture, then call back.
           *
           * @param {Array<string|Element>} srcs - Array of six texture URLs or elements.
           * @param {function} cb - Callback to pass cube texture to.
           */
loadCubeMapTexture:function(e,n){var r=this||t;var a=0;var o=new s.CubeTexture;o.colorSpace=s.SRGBColorSpace;function loadSide(t){r.loadTextureSource(e[t],(function(e){o.images[t]=e.data;a++;if(a===6){o.needsUpdate=true;n(o)}}))}if(e.length===6)for(var l=0;l<e.length;l++)loadSide(l);else h("Cube map texture requires exactly 6 sources, got only %s sources",e.length)},
/**
           * High-level function for loading image textures (THREE.Texture).
           *
           * @param {string|Element} src - Texture source.
           * @param {function} cb - Callback to pass texture to.
           */
loadImage:function(e,t){t(typeof e==="string"?loadImageUrl(e):new s.Source(e))},
/**
           * Load video texture (THREE.VideoTexture).
           * Which is just an image texture that RAFs + needsUpdate.
           * Note that creating a video texture is synchronous unlike loading an image texture.
           * Made asynchronous to be consistent with image textures.
           *
           * @param {string|Element} src - Texture source.
           * @param {function} cb - Callback to pass texture to.
           */
loadVideo:function(e,t){var n;if(typeof e!=="string"){n=e;fixVideoAttributes(n)}n=n||createVideoEl(e);t(new s.Source(n))},hash:function(e){return e.tagName&&(e.id||e.src)||e},
/**
           * Keep track of material in case an update trigger is needed (e.g., fog).
           *
           * @param {object} material
           */
registerMaterial:function(e){(this||t).materials[e.uuid]=e},
/**
           * Stop tracking material, and dispose of any textures not being used by
           * another material component.
           *
           * @param {object} material
           */
unregisterMaterial:function(e){delete(this||t).materials[e.uuid]}});
/**
         * Load image from a given URL.
         *
         * @private
         * @param {string} src - An url to an image file.
         * @returns {Promise} Resolves once texture is loaded.
         */function loadImageUrl(e){return new Promise(doLoadImageUrl);function doLoadImageUrl(t,n){d.load(e,resolveSource,(function(){}),(function(e){u("`$s` could not be fetched (Error code: %s; Response: %s)",e.status,e.statusText)}));function resolveSource(e){t(new s.Source(e))}}}
/**
         * Create video element to be used as a texture.
         *
         * @param {string} src - Url to a video file.
         * @returns {Element} Video element.
         */function createVideoEl(e){var t=document.createElement("video");t.setAttribute("playsinline","");t.setAttribute("webkit-playsinline","");t.autoplay=true;t.loop=true;t.crossOrigin="anonymous";t.addEventListener("error",(function(){h("`%s` is not a valid video",e)}),true);t.src=e;return t}
/**
         * Fixes a video element's attributes to prevent developers from accidentally passing the
         * wrong attribute values to commonly misused video attributes.
         *
         * <video> does not treat `autoplay`, `controls`, `crossorigin`, `loop`, and `preload` as
         * as booleans. Existence of those attributes will mean truthy.
         *
         * For example, translates <video loop="false"> to <video>.
         *
         * @see https://developer.mozilla.org/docs/Web/HTML/Element/video#Attributes
         * @param {Element} videoEl - Video element.
         * @returns {Element} Video element with the correct properties updated.
         */function fixVideoAttributes(e){e.autoplay=e.hasAttribute("autoplay")&&e.getAttribute("autoplay")!=="false";e.controls=e.hasAttribute("controls")&&e.getAttribute("controls")!=="false";e.getAttribute("loop")==="false"&&e.removeAttribute("loop");e.getAttribute("preload")==="false"&&(e.preload="none");e.crossOrigin=e.crossOrigin||"anonymous";e.setAttribute("playsinline","");e.setAttribute("webkit-playsinline","");return e}},"./src/systems/obb-collider.js":(e,n,r)=>{r.r(n);var s=r("./src/core/system.js");(0,s.registerSystem)("obb-collider",{schema:{showColliders:{default:false}},init:function(){(this||t).collisions=[];(this||t).colliderEls=[]},addCollider:function(e){(this||t).colliderEls.push(e);(this||t).data.showColliders?e.components["obb-collider"].showCollider():e.components["obb-collider"].hideCollider();(this||t).tick=(this||t).detectCollisions},removeCollider:function(e){var n=(this||t).colliderEls;var r=n.indexOf(e);e.components["obb-collider"].hideCollider();r>-1&&n.splice(r,1);n.length===0&&((this||t).tick=void 0)},registerCollision:function(e,n){var r=(this||t).collisions;var s=false;var a=e.obb;var o=n.obb;var l=e.renderColliderMesh;var c=n.renderColliderMesh;l&&l.material.color.set(16711680);c&&c.material.color.set(16711680);for(var u=0;u<r.length;u++)if(r[u].componentA.obb===a&&r[u].componentB.obb===o||r[u].componentA.obb===o&&r[u].componentB.obb===a){s=true;r[u].detected=true;break}if(!s){r.push({componentA:e,componentB:n,detected:true});e.el.emit("obbcollisionstarted",{trackedObject3D:e.trackedObject3D,withEl:n.el});n.el.emit("obbcollisionstarted",{trackedObject3D:n.trackedObject3D,withEl:e.el})}},resetCollisions:function(){var e=(this||t).collisions;for(var n=0;n<e.length;n++)e[n].detected=false},clearCollisions:function(){var e=(this||t).collisions;var n=[];var r;var s;var a;var o;for(var l=0;l<e.length;l++)if(e[l].detected)n.push(e[l]);else{r=e[l].componentA;s=e[l].componentB;a=r.renderColliderMesh;o=s.renderColliderMesh;a&&a.material.color.set(65280);r.el.emit("obbcollisionended",{trackedObject3D:(this||t).trackedObject3D,withEl:s.el});o&&o.material.color.set(65280);s.el.emit("obbcollisionended",{trackedObject3D:(this||t).trackedObject3D,withEl:r.el})}(this||t).collisions=n},detectCollisions:function(){var e;var n;var r;var s;var a=(this||t).colliderEls;if(!(a.length<2)){this.resetCollisions();for(var o=0;o<a.length;o++){r=a[o].components["obb-collider"];e=a[o].components["obb-collider"].obb;if(e.halfSize.x!==0&&e.halfSize.y!==0&&e.halfSize.z!==0)for(var l=o+1;l<a.length;l++){s=a[l].components["obb-collider"];n=s.obb;n.halfSize.x!==0&&n.halfSize.y!==0&&n.halfSize.z!==0&&(e.intersectsOBB(n)&&this.registerCollision(r,s))}}this.clearCollisions()}}})},"./src/systems/renderer.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>h,sortBackToFront:()=>sortBackToFront,sortFrontToBack:()=>sortFrontToBack,sortRenderOrderOnly:()=>sortRenderOrderOnly});var s=r("./node_modules/three/build/three.module.js");var a=r("./node_modules/three/build/three.core.js");var o=r("./src/core/system.js");var l=r("./src/utils/index.js");var c=l.debug;var u=c("components:renderer:warn");var h=(0,o.registerSystem)("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:l.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:false},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon","AgX","neutral"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon","AgX","neutral"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:false},colorManagement:{default:true},alpha:{default:true},stencil:{default:false},foveationLevel:{default:1}},init:function(){var e=(this||t).data;var n=(this||t).el;var r=(this||t).data.toneMapping.charAt(0).toUpperCase()+(this||t).data.toneMapping.slice(1);var o=n.renderer;o.toneMapping=s[r+"ToneMapping"];a.Texture.DEFAULT_ANISOTROPY=e.anisotropy;a.ColorManagement.enabled=e.colorManagement;o.outputColorSpace=e.colorManagement?a.SRGBColorSpace:a.LinearSRGBColorSpace;n.hasAttribute("antialias")&&u('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.');n.hasAttribute("logarithmicDepthBuffer")&&u('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.');o.sortObjects=true;o.setOpaqueSort(sortFrontToBack)},update:function(){var e=(this||t).data;var n=(this||t).el;var r=n.renderer;var a=(this||t).data.toneMapping.charAt(0).toUpperCase()+(this||t).data.toneMapping.slice(1);r.toneMapping=s[a+"ToneMapping"];r.toneMappingExposure=e.exposure;r.xr.setFoveation(e.foveationLevel);e.sortObjects&&u('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.');e.sortTransparentObjects?r.setTransparentSort(sortBackToFront):r.setTransparentSort(sortRenderOrderOnly)},applyColorCorrection:function(e){if((this||t).data.colorManagement&&e&&e.isTexture&&e.colorSpace!==a.SRGBColorSpace){e.colorSpace=a.SRGBColorSpace;e.needsUpdate=true}},setWebXRFrameRate:function(e){var n=(this||t).data;var r=e.supportedFrameRates;if(r&&e.updateTargetFrameRate){var s;s=r.includes(90)?n.highRefreshRate?90:72:n.highRefreshRate?72:60;e.updateTargetFrameRate(s).catch((function(e){console.warn("failed to set target frame rate of "+s+". Error info: "+e)}))}}});function sortFrontToBack(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z-t.z}function sortRenderOrderOnly(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder-t.renderOrder}function sortBackToFront(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:t.z-e.z}},"./src/systems/shadow.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>l});var s=r("./node_modules/three/build/three.core.js");var a=r("./src/core/system.js");var o={basic:s.BasicShadowMap,pcf:s.PCFShadowMap,pcfsoft:s.PCFSoftShadowMap};var l=(0,a.registerSystem)("shadow",{schema:{enabled:{default:true},autoUpdate:{default:true},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var e=(this||t).sceneEl;var n=(this||t).data;(this||t).shadowMapEnabled=false;e.renderer.shadowMap.type=o[n.type];e.renderer.shadowMap.autoUpdate=n.autoUpdate},update:function(e){e.enabled!==(this||t).data.enabled&&this.setShadowMapEnabled((this||t).shadowMapEnabled)},
/**
           * Enables/disables the renderer shadow map.
           * @param {boolean} enabled
           */
setShadowMapEnabled:function(e){var n=(this||t).sceneEl;var r=(this||t).sceneEl.renderer;(this||t).shadowMapEnabled=e;var s=(this||t).data.enabled&&(this||t).shadowMapEnabled;if(r&&s!==r.shadowMap.enabled){r.shadowMap.enabled=s;updateAllMaterials(n)}}});function updateAllMaterials(e){e.hasLoaded&&e.object3D.traverse((function(e){if(e.material){var t=Array.isArray(e.material)?e.material:[e.material];for(var n=0;n<t.length;n++)t[n].needsUpdate=true}}))}},"./src/systems/tracked-controls.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>a});var s=r("./src/core/system.js");var a=(0,s.registerSystem)("tracked-controls",{init:function(){(this||t).controllers=[];(this||t).onInputSourcesChange=(this||t).onInputSourcesChange.bind(this||t);(this||t).onEnterVR=(this||t).onEnterVR.bind(this||t);(this||t).el.addEventListener("enter-vr",(this||t).onEnterVR);(this||t).onExitVR=(this||t).onExitVR.bind(this||t);(this||t).el.addEventListener("exit-vr",(this||t).onExitVR)},onEnterVR:function(){var e=(this||t).el.xrSession;e&&(this||t).el.xrSession.addEventListener("inputsourceschange",(this||t).onInputSourcesChange)},onExitVR:function(){(this||t).referenceSpace=void 0;(this||t).controllers=[];(this||t).el.emit("controllersupdated",void 0,false)},onInputSourcesChange:function(){var e=this||t;var n=(this||t).el.xrSession;var r=(this||t).el.sceneEl.systems.webxr.sessionReferenceSpaceType;n.requestReferenceSpace(r).then((function(t){e.referenceSpace=t})).catch((function(t){e.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(r,'tracked-controls uses reference space "'+r+'".');throw t}));(this||t).controllers=n.inputSources;(this||t).el.emit("controllersupdated",void 0,false)}})},"./src/systems/webxr.js":(e,n,r)=>{r.r(n);r.d(n,{System:()=>l});var s=r("./src/core/system.js");var a=r("./src/utils/index.js");var o=a.debug("systems:webxr:warn");var l=(0,s.registerSystem)("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var e=(this||t).data;(this||t).sessionConfiguration={requiredFeatures:e.requiredFeatures,optionalFeatures:e.optionalFeatures};(this||t).sessionReferenceSpaceType=e.referenceSpaceType;if(e.overlayElement){e.overlayElement.classList.remove("a-dom-overlay");if(!e.optionalFeatures.includes("dom-overlay")){e.optionalFeatures.push("dom-overlay");(this||t).el.setAttribute("webxr",e)}this.warnIfFeatureNotRequested("dom-overlay");(this||t).sessionConfiguration.domOverlay={root:e.overlayElement};e.overlayElement.classList.add("a-dom-overlay")}},wasFeatureRequested:function(e){return e==="viewer"||e==="local"||!(!(this||t).sessionConfiguration.requiredFeatures.includes(e)&&!(this||t).sessionConfiguration.optionalFeatures.includes(e))},warnIfFeatureNotRequested:function(e,t){if(!this.wasFeatureRequested(e)){var n='Please add the feature "'+e+"\" to a-scene's webxr system options in requiredFeatures/optionalFeatures.";o((t?t+" ":"")+n)}}})},"./src/utils/coordinates.js":(e,t,n)=>{n.r(t);n.d(t,{equals:()=>equals,isCoordinate:()=>isCoordinate,isCoordinates:()=>isCoordinates,parse:()=>parse,regex:()=>l,stringify:()=>stringify,toVector3:()=>toVector3});var r=n("./node_modules/three/build/three.core.js");var s=n("./src/utils/debug.js");var a=(0,s.default)("utils:coordinates:warn");var o=["x","y","z","w"];var l=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;var c=/\s+/g;
/**
         * Parses coordinates from an "x y z" string.
         * Example: "3 10 -5" to {x: 3, y: 10, z: -5}.
         *
         * @param {string} value - An "x y z" string.
         * @param {string} defaultVec - fallback value.
         * @param {object} target - Optional target object for coordinates.
         * @returns {object} An object with keys [x, y, z].
         */function parse(e,t,n){var r;var s;var a;var l;var u=n&&typeof n==="object"?n:{};var h;var d;var p;var f;if(e&&e instanceof Object){h=e.x===void 0?t&&t.x:e.x;d=e.y===void 0?t&&t.y:e.y;p=e.z===void 0?t&&t.z:e.z;f=e.w===void 0?t&&t.w:e.w;h!==void 0&&h!==null&&(u.x=parseIfString(h));d!==void 0&&d!==null&&(u.y=parseIfString(d));p!==void 0&&p!==null&&(u.z=parseIfString(p));f!==void 0&&f!==null&&(u.w=parseIfString(f));return u}if(e===null||e===void 0)return typeof t==="object"?Object.assign(u,t):t;r=e.trim().split(c);for(l=0;l<o.length;l++){a=o[l];if(r[l])u[a]=parseFloat(r[l],10);else{s=t&&t[a];if(s===void 0)continue;u[a]=parseIfString(s)}}return u}
/**
         * Stringify coordinates from an object with keys [x y z].
         * Example: {x: 3, y: 10, z: -5} to "3 10 -5".
         *
         * @param {object|string} data - An object with keys [x y z].
         * @returns {string} An "x y z" string.
         */function stringify(e){var t;if(typeof e!=="object")return e;t=e.x+" "+e.y;e.z!=null&&(t+=" "+e.z);e.w!=null&&(t+=" "+e.w);return t}
/**
         * Compares the values of two coordinates to check equality.
         *
         * @param {object|string} a - An object with keys [x y z].
         * @param {object|string} b - An object with keys [x y z].
         * @returns {boolean} True if both coordinates are equal, false otherwise
         */function equals(e,t){return typeof e!=="object"||typeof t!=="object"?e===t:e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}
/**
         * @param {string} value
         * @returns {boolean}
         */function isCoordinates(e){return l.test(e)}function isCoordinate(e){a("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`");return isCoordinates(e)}function parseIfString(e){return e!==null&&e!==void 0&&e.constructor===String?parseFloat(e,10):e}function toVector3(e){return new r.Vector3(e.x,e.y,e.z)}},"./src/utils/debug.js":(e,n,r)=>{r.r(n);r.d(n,{default:()=>c});var s=r("./node_modules/debug/src/browser.js");var a=r.n(s);var o={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};a().formatArgs=formatArgs;function formatArgs(e){e[0]=((this||t).useColors?"%c":"")+(this||t).namespace+((this||t).useColors?" %c":" ")+e[0]+((this||t).useColors?"%c ":" ");if((this||t).useColors){(this||t).color=getDebugNamespaceColor((this||t).namespace);var n="color: "+(this||t).color;e.splice(1,0,n,"color: inherit");var r=0;var s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){if(e!=="%%"){r++;e==="%c"&&(s=r)}}));e.splice(s,0,n)}}
/**
         * Returns the type of the namespace (e.g., `error`, `warn`).
         *
         * @param {string} namespace
         *   The debug logger's namespace (e.g., `components:geometry:warn`).
         * @returns {string} The type of the namespace (e.g., `warn`).
         * @api private
         */function getDebugNamespaceType(e){var t=e.split(":");return t[t.length-1]}
/**
         * Returns the color of the namespace (e.g., `orange`).
         *
         * @param {string} namespace
         *   The debug logger's namespace (e.g., `components:geometry:warn`).
         * @returns {string} The color of the namespace (e.g., `orange`).
         * @api private
         */function getDebugNamespaceColor(e){var t=getDebugNamespaceType(e);var n=o.colors&&o.colors[t];return n||null}
/**
         * Returns `localStorage` if possible.
         *
         * This is necessary because Safari throws when a user disables
         * cookies or `localStorage` and you attempt to access it.
         *
         * @returns {localStorage}
         * @api private
         */function storage(){try{return window.localStorage}catch(e){}}var l=storage();l&&(parseInt(l.logs,10)||l.logs==="true")?a().enable("*"):a().enable("*:error,*:info,*:warn");const c=a()},"./src/utils/device.js":(e,t,n)=>{n.r(t);n.d(t,{checkARSupport:()=>checkARSupport,checkHeadsetConnected:()=>checkHeadsetConnected,checkVRSupport:()=>checkVRSupport,isAppleVisionPro:()=>isAppleVisionPro,isBrowserEnvironment:()=>h,isFirefoxReality:()=>isFirefoxReality,isIOS:()=>isIOS,isIpad:()=>isIpad,isLandscape:()=>isLandscape,isMobile:()=>u,isMobileDeviceRequestingDesktopSite:()=>isMobileDeviceRequestingDesktopSite,isMobileVR:()=>isMobileVR,isNodeEnvironment:()=>d,isOculusBrowser:()=>isOculusBrowser,isR7:()=>isR7,isTablet:()=>isTablet,isWebXRAvailable:()=>c});var s=n("./src/utils/debug.js");var a=(0,s.default)("device:error");var o=false;var l=false;var c=navigator.xr!==void 0;if(c){var updateEnterInterfaces=function(){var e=document.querySelector("a-scene");e?e.hasLoaded?e.components["xr-mode-ui"].updateEnterInterfaces():e.addEventListener("loaded",updateEnterInterfaces):window.addEventListener("DOMContentLoaded",updateEnterInterfaces)};var errorHandler=function(e){a("WebXR session support error: "+e.message)};if(navigator.xr.isSessionSupported){navigator.xr.isSessionSupported("immersive-vr").then((function(e){o=e;updateEnterInterfaces()})).catch(errorHandler);navigator.xr.isSessionSupported("immersive-ar").then((function(e){l=e;updateEnterInterfaces()})).catch((function(){}))}else if(navigator.xr.supportsSession){navigator.xr.supportsSession("immersive-vr").then((function(){o=true;updateEnterInterfaces()})).catch(errorHandler);navigator.xr.supportsSession("immersive-ar").then((function(){l=true;updateEnterInterfaces()})).catch((function(){}))}else a("WebXR has neither isSessionSupported or supportsSession?!")}function checkHeadsetConnected(){return o||l}function checkARSupport(){return l}function checkVRSupport(){return o}
/**
         * Checks if browser is mobile and not stand-alone dedicated vr device.
         * @returns {boolean} True if mobile browser detected.
         */var u=function(){var e=false;(function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=true);(isIOS()||isTablet()||isR7())&&(e=true);isMobileVR()&&(e=false)})(window.navigator.userAgent||window.navigator.vendor||window.opera);return function(){return e}}();
/**
         *  Detect tablet devices.
         *  @param {string} mockUserAgent - Allow passing a mock user agent for testing.
         */function isTablet(e){var t=e||window.navigator.userAgent;var n=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(t);return n||isIpad()}
/**
         *  Detect ipad devices.
         *  @param {string} mockUserAgent - Allow passing a mock user agent for testing.
         *  @param {string} mockDevicePlatform - Allow passing a mock device platform for testing.
         *  @param {string} mockDeviceTouchPoints - Allow passing a mock device touch points for testing.
        */function isIpad(e,t,n){var r=e||window.navigator.userAgent;var s=t||window.navigator.platform;var a=n||window.navigator.maxTouchPoints||0;return(s==="iPad"||s==="MacIntel")&&a>0&&/Macintosh|Intel|iPad|ipad/i.test(r)&&!window.MSStream}function isAppleVisionPro(){var e=navigator.userAgent.includes("Macintosh");var t=navigator.maxTouchPoints===5;return e&&t&&c}function isIOS(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}function isMobileDeviceRequestingDesktopSite(){return!u()&&!isMobileVR()&&window.orientation!==void 0}function isOculusBrowser(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}function isFirefoxReality(){return/(Mobile VR)/i.test(window.navigator.userAgent)}function isMobileVR(){return isOculusBrowser()||isFirefoxReality()||isAppleVisionPro()}function isR7(){return/R7 Build/.test(window.navigator.userAgent)}
/**
         * Checks mobile device orientation.
         * @returns {boolean} True if landscape orientation.
         */function isLandscape(){var e=window.orientation;isR7()&&(e+=90);return e===90||e===-90}var h=typeof r==="undefined";var d=!h},"./src/utils/entity.js":(e,t,n)=>{n.r(t);n.d(t,{getComponentProperty:()=>getComponentProperty,getComponentPropertyPath:()=>getComponentPropertyPath,setComponentProperty:()=>setComponentProperty});var r=n("./src/utils/split.js");
/**
         * Split a delimited component property string (e.g., `material.color`) to an object
         * containing `component` name and `property` name. If there is no delimiter, just return the
         * string back.
         *
         * Uses the caching split implementation `AFRAME.utils.split`
         *
         * @param {string} str - e.g., `material.opacity`.
         * @param {string} delimiter - e.g., `.`.
         * @returns {string[]} e.g., `['material', 'opacity']`.
         */function getComponentPropertyPath(e,t){t=t||".";var n=(0,r.split)(e,t);return n.length===1?n[0]:n}function getComponentProperty(e,t,n){var r;n=n||".";if(t.indexOf(n)!==-1){r=getComponentPropertyPath(t,n);return r.constructor===String?e.getAttribute(r):e.getAttribute(r[0])[r[1]]}return e.getAttribute(t)}function setComponentProperty(e,t,n,r){var s;r=r||".";if(t.indexOf(r)===-1)e.setAttribute(t,n);else{s=getComponentPropertyPath(t,r);s.constructor===String?e.setAttribute(s,n):e.setAttribute(s[0],s[1],n)}}},"./src/utils/forceCanvasResizeSafariMobile.js":(e,t,n)=>{n.r(t);n.d(t,{default:()=>forceCanvasResizeSafariMobile});function forceCanvasResizeSafariMobile(e){var t=e.style.width;var n=e.style.height;e.style.width=parseInt(t,10)+1+"px";e.style.height=parseInt(n,10)+1+"px";setTimeout((function(){e.style.width=t;e.style.height=n}),200)}},"./src/utils/index.js":(e,n,r)=>{r.r(n);r.d(n,{bind:()=>bind,checkHeadsetConnected:()=>checkHeadsetConnected,clone:()=>clone,coordinates:()=>u,debounce:()=>debounce,debug:()=>s.default,deepEqual:()=>M,device:()=>l,diff:()=>w,entity:()=>h,extend:()=>x,extendDeep:()=>_,findAllScenes:()=>findAllScenes,forceCanvasResizeSafariMobile:()=>d.default,getElData:()=>getElData,getUrlParameter:()=>getUrlParameter,isIOS:()=>isIOS,isIframed:()=>isIframed,isMobile:()=>isMobile,material:()=>p,objectPool:()=>c,shouldCaptureKeyEvent:()=>shouldCaptureKeyEvent,split:()=>f.split,splitString:()=>splitString,srcLoader:()=>y,styleParser:()=>m,throttle:()=>throttle,throttleLeadingAndTrailing:()=>throttleLeadingAndTrailing,throttleTick:()=>throttleTick,trackedControls:()=>g});var s=r("./src/utils/debug.js");var a=r("./node_modules/deep-assign/index.js");var o=r.n(a);var l=r("./src/utils/device.js");var c=r("./src/utils/object-pool.js");var u=r("./src/utils/coordinates.js");var h=r("./src/utils/entity.js");var d=r("./src/utils/forceCanvasResizeSafariMobile.js");var p=r("./src/utils/material.js");var f=r("./src/utils/split.js");var m=r("./src/utils/styleParser.js");var g=r("./src/utils/tracked-controls.js");var y=r("./src/utils/src-loader.js");var b=(0,s.default)("utils:warn");
/** @deprecated */function bind(e){return e.bind.apply(e,Array.prototype.slice.call(arguments,1))}function checkHeadsetConnected(){b("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`");return l.checkHeadsetConnected(arguments)}function isIOS(){b("`utils.isIOS` has moved to `utils.device.isIOS`");return l.isIOS(arguments)}function isMobile(){b("`utils.isMobile has moved to `utils.device.isMobile`");return l.isMobile(arguments)}
/**
         * Returns throttle function that gets called at most once every interval.
         *
         * @param {function} functionToThrottle
         * @param {number} minimumInterval - Minimal interval between calls (milliseconds).
         * @param {object} optionalContext - If given, bind function to throttle to this context.
         * @returns {function} Throttled function.
         */function throttle(e,t,n){var r;n&&(e=e.bind(n));return function(){var n=Date.now();var s=typeof r==="undefined"?t:n-r;if(typeof r==="undefined"||s>=t){r=n;e.apply(null,arguments)}}}
/**
         * Returns throttle function that gets called at most once every interval.
         * If there are multiple calls in the last interval we call the function one additional
         * time.
         * It behaves like throttle except for the very last call that gets deferred until the end of the interval.
         * This is useful when an event is used to trigger synchronization of state, and there is a need to converge
         * to the correct final state following a burst of events.
         *
         * Example use cases:
         * - synchronizing state based on the componentchanged event
         * - following a mouse pointer using the mousemove event
         * - integrating with THREE.TransformControls, via the objectChange event.
         *
         * @param {function} functionToThrottle
         * @param {number} minimumInterval - Minimal interval between calls (milliseconds).
         * @param {object} optionalContext - If given, bind function to throttle to this context.
         * @returns {function} Throttled function.
         */function throttleLeadingAndTrailing(e,n,r){var s;var a;r&&(e=e.bind(r));var o;var timerExpired=function(){s=Date.now();e.apply(this||t,o);a=void 0};return function(){var t=Date.now();var r=typeof s==="undefined"?n:t-s;if(r>=n){clearTimeout(a);a=void 0;s=t;e.apply(null,arguments)}else{a=a||setTimeout(timerExpired,n-r);o=arguments}}}
/**
         * Returns throttle function that gets called at most once every interval.
         * Uses the time/timeDelta timestamps provided by the global render loop for better perf.
         *
         * @param {function} functionToThrottle
         * @param {number} minimumInterval - Minimal interval between calls (milliseconds).
         * @param {object} optionalContext - If given, bind function to throttle to this context.
         * @returns {function} Throttled function.
         */function throttleTick(e,t,n){var r;n&&(e=e.bind(n));return function(n,s){var a=typeof r==="undefined"?s:n-r;if(typeof r==="undefined"||a>=t){r=n;e(n,a)}}}
/**
         * Returns debounce function that gets called only once after a set of repeated calls.
         *
         * @param {function} func - function to debounce
         * @param {number} wait - Time to wait for repeated function calls (milliseconds).
         * @param {boolean} immediate - Calls the function immediately regardless of if it should be waiting.
         * @returns {function} Debounced function.
         */function debounce(e,n,r){var s;return function(){var a=this||t;var o=arguments;var later=function(){s=null;r||e.apply(a,o)};var l=r&&!s;clearTimeout(s);s=setTimeout(later,n);l&&e.apply(a,o)}}
/**
         * Mix the properties of source object(s) into a destination object.
         *
         * @param  {object} dest - The object to which properties will be copied.
         * @param  {...object} source - The object(s) from which properties will be copied.
         */var x=Object.assign;var _=o();function clone(e){return JSON.parse(JSON.stringify(e))}
/**
         * Checks if two values are equal.
         * Includes objects and arrays and nested objects and arrays.
         * Try to keep this function performant as it will be called often to see if a component
         * should be updated.
         *
         * @param {object} a - First object.
         * @param {object} b - Second object.
         * @returns {boolean} Whether two objects are deeply equal.
         */var M=function(){var e=c.createPool((function(){return[]}));return function(t,n){var r;var s;var a;var o;var l;var c;if(t===void 0||n===void 0||t===null||n===null||!(t&&n&&t.constructor===Object&&n.constructor===Object||t.constructor===Array&&n.constructor===Array))return t===n;s=e.use();a=e.use();s.length=0;a.length=0;for(r in t)s.push(r);for(r in n)a.push(r);if(s.length!==a.length){e.recycle(s);e.recycle(a);return false}for(o=0;o<s.length;++o){l=t[s[o]];c=n[s[o]];if(typeof l==="object"||typeof c==="object"||Array.isArray(l)&&Array.isArray(c)){if(l===c)continue;if(!M(l,c)){e.recycle(s);e.recycle(a);return false}}else if(l!==c){e.recycle(s);e.recycle(a);return false}}e.recycle(s);e.recycle(a);return true}}();
/**
         * Computes the difference between two objects.
         *
         * @param {object} a - First object to compare (e.g., oldData).
         * @param {object} b - Second object to compare (e.g., newData).
         * @returns {object}
         *   Difference object where set of keys note which values were not equal, and values are
         *   `b`'s values.
         */var w=function(){var e=[];return function(t,n,r){var s;var a;var o;var l;var c;var u;var h;l=r||{};e.length=0;for(c in t)e.push(c);if(!n)return l;for(o in n)e.indexOf(o)===-1&&e.push(o);for(u=0;u<e.length;u++){c=e[u];s=t[c];a=n[c];h=s&&a&&s.constructor===Object&&a.constructor===Object;(h&&!M(s,a)||!h&&s!==a)&&(l[c]=a)}return l}}();
/**
         * Returns whether we should capture this keyboard event for keyboard shortcuts.
         * @param {Event} event Event object.
         * @returns {boolean} Whether the key event should be captured.
         */function shouldCaptureKeyEvent(e){return!e.metaKey&&document.activeElement===document.body}
/**
         * Splits a string into an array based on a delimiter.
         *
         * @param   {string} [str='']        Source string
         * @param   {string} [delimiter=' '] Delimiter to use
         * @returns {string[]}               Array of delimited strings
         */function splitString(e,t){typeof t==="undefined"&&(t=" ");var n=new RegExp(t,"g");e=(e||"").replace(n,t);return e.split(t)}
/**
         * Extracts data from the element given an object that contains expected keys.
         *
         * @param {Element} el - Source element.
         * @param {object} [defaults={}] - Object of default key-value pairs.
         * @returns {object}
         */function getElData(e,t){t=t||{};var n={};Object.keys(t).forEach(copyAttribute);function copyAttribute(t){e.hasAttribute(t)&&(n[t]=e.getAttribute(t))}return n}
/**
         * Retrieves querystring value.
         * @param {string} name Name of querystring key.
         * @returns {string} Value
         */function getUrlParameter(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)");var n=t.exec(location.search);return n===null?"":decodeURIComponent(n[1].replace(/\+/g," "))}function isIframed(){return window.top!==window.self}function findAllScenes(e){var t=[];var n=e.getElementsByTagName("*");for(var r=0,s=n.length;r<s;r++)n[r].isScene&&t.push(n[r]);return t}},"./src/utils/ios-orientationchange-blank-bug.js":(e,t,n)=>{n.r(t);var r=n("./src/utils/device.js");(0,r.isIOS)()&&window.addEventListener("orientationchange",(function(){document.documentElement.style.height="initial";setTimeout((function(){document.documentElement.style.height="100%";setTimeout((function(){window.scrollTo(0,1)}),500)}),500)}))},"./src/utils/material.js":(e,t,n)=>{n.r(t);n.d(t,{createCompatibleTexture:()=>createCompatibleTexture,handleTextureEvents:()=>handleTextureEvents,isCompatibleTexture:()=>isCompatibleTexture,setTextureProperties:()=>setTextureProperties,updateDistortionMap:()=>updateDistortionMap,updateEnvMap:()=>updateEnvMap,updateMap:()=>updateMap,updateMapMaterialFromData:()=>updateMapMaterialFromData});var r=n("./node_modules/three/build/three.core.js");var s=n("./src/utils/src-loader.js");var a=n("./src/utils/debug.js");var o=(0,a.default)("utils:material:warn");var l=new Set(["emissiveMap","envMap","map","specularMap"]);
/**
         * Set texture properties such as repeat and offset.
         *
         * @param {THREE.Texture} texture - a Texture instance.
         * @param {object} data - With keys like `repeat`.
         */function setTextureProperties(e,t){var n=t.offset||{x:0,y:0};var s=t.repeat||{x:1,y:1};var a=t.npot||false;var o=t.anisotropy||r.Texture.DEFAULT_ANISOTROPY;var l=e.wrapS;var c=e.wrapT;var u=e.magFilter;var h=e.minFilter;if(a){l=r.ClampToEdgeWrapping;c=r.ClampToEdgeWrapping;u=r.LinearFilter;h=r.LinearFilter}if(s.x!==1||s.y!==1){l=r.RepeatWrapping;c=r.RepeatWrapping}e.offset.set(n.x,n.y);e.repeat.set(s.x,s.y);if(e.wrapS!==l||e.wrapT!==c||e.magFilter!==u||e.minFilter!==h||e.anisotropy!==o){e.wrapS=l;e.wrapT=c;e.magFilter=u;e.minFilter=h;e.anisotropy=o;e.needsUpdate=true}}
/**
         * Update `material` texture property (usually but not always `map`)
         * from `data` property (usually but not always `src`).
         *
         * @param {string} materialName
         * @param {string} dataName
         * @param {object} shader - A-Frame shader instance.
         * @param {object} data
         */function updateMapMaterialFromData(e,t,n,s){var a=n.el;var o=n.material;var c=a.sceneEl.systems.renderer;var u=s[t];n.materialSrcs||(n.materialSrcs={});if(u)if(u===n.materialSrcs[e]&&o[e])setTextureProperties(o[e],s);else{n.materialSrcs[e]=u;u instanceof r.Texture?setMap(u):a.sceneEl.systems.material.loadTextureSource(u,updateTexture)}else{delete n.materialSrcs[e];setMap(null)}function updateTexture(t){if(n.materialSrcs[e]===u){var r=o[e];!r||t!==null&&isCompatibleTexture(r,t)||(r=null);!r&&t&&(r=createCompatibleTexture(t));if(r){if(r.source!==t){r.source=t;r.needsUpdate=true}l.has(e)&&c.applyColorCorrection(r);setTextureProperties(r,s)}setMap(r)}}function setMap(t){if(o[e]!==t){o[e]&&o[e].dispose();o[e]=t;o.needsUpdate=true;handleTextureEvents(a,t)}}}
/**
         * Update `material.map` given `data.src`. For standard and flat shaders.
         *
         * @param {object} shader - A-Frame shader instance.
         * @param {object} data
         */function updateMap(e,t){return updateMapMaterialFromData("map","src",e,t)}
/**
         * Updates the material's maps which give the illusion of extra geometry.
         *
         * @param {string} longType - The friendly name of the map from the component e.g. ambientOcclusionMap becomes aoMap in THREE.js
         * @param {object} shader - A-Frame shader instance
         * @param {object} data
         */function updateDistortionMap(e,t,n){var r=e;e==="ambientOcclusion"&&(r="ao");var s={};s.src=n[e+"Map"];s.offset=n[e+"TextureOffset"];s.repeat=n[e+"TextureRepeat"];s.wrap=n[e+"TextureWrap"];return updateMapMaterialFromData(r+"Map","src",t,s)}var c={};
/**
         * Updates the material's environment map providing reflections or refractions.
         *
         * @param {object} shader - A-Frame shader instance
         * @param {object} data
         */function updateEnvMap(e,t){var n=e.material;var a=e.el;var l="envMap";var u=t.envMap;var h=t.sphericalEnvMap;var d=t.refract;if(h){u=h;o("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")}e.materialSrcs||(e.materialSrcs={});if(u){e.materialSrcs[l]=u;c[u]?c[u].then(checkSetMap):c[u]=new Promise((function(e){s.validateEnvMapSrc(u,(function loadCubeMap(t){a.sceneEl.systems.material.loadCubeMapTexture(t,(function(t){t.mapping=d?r.CubeRefractionMapping:r.CubeReflectionMapping;checkSetMap(t);e(t)}))}),(function loadEquirectMap(t){a.sceneEl.systems.material.loadTexture(t,{src:t},(function(t){t.mapping=d?r.EquirectangularRefractionMapping:r.EquirectangularReflectionMapping;checkSetMap(t);e(t)}))}))}))}else{delete e.materialSrcs[l];n.envMap=null;n.needsUpdate=true}function checkSetMap(t){if(e.materialSrcs[l]===u){n.envMap=t;n.needsUpdate=true;handleTextureEvents(a,t)}}}
/**
         * Emit event on entities on texture-related events.
         *
         * @param {Element} el - Entity.
         * @param {object} texture - three.js Texture.
         */function handleTextureEvents(e,t){if(t){e.emit("materialtextureloaded",{src:t.image,texture:t});if(t.image&&t.image.tagName==="VIDEO"){t.image.addEventListener("loadeddata",emitVideoTextureLoadedDataAll);t.image.addEventListener("ended",emitVideoTextureEndedAll);t.addEventListener("dispose",(function cleanupListeners(){t.image.removeEventListener("loadeddata",emitVideoTextureLoadedDataAll);t.image.removeEventListener("ended",emitVideoTextureEndedAll)}))}}function emitVideoTextureLoadedDataAll(){e.emit("materialvideoloadeddata",{src:t.image,texture:t})}function emitVideoTextureEndedAll(){e.emit("materialvideoended",{src:t.image,texture:t})}}
/**
         * Checks if a given texture type is compatible with a given source.
         *
         * @param {THREE.Texture} texture - The texture to check compatibility with
         * @param {THREE.Source} source - The source to check compatibility with
         * @returns {boolean} True if the texture is compatible with the source, false otherwise
         */function isCompatibleTexture(e,t){return e.source===t&&(t.data instanceof HTMLCanvasElement?e.isCanvasTexture:t.data instanceof HTMLVideoElement?e.isVideoTexture:e.isTexture&&!e.isCanvasTexture&&!e.isVideoTexture)}function createCompatibleTexture(e){var t;t=e.data instanceof HTMLCanvasElement?new r.CanvasTexture:e.data instanceof HTMLVideoElement?new r.VideoTexture(e.data):new r.Texture;t.source=e;t.needsUpdate=true;return t}},"./src/utils/math.js":(e,t,n)=>{n.r(t);n.d(t,{distanceOfPointFromPlane:()=>distanceOfPointFromPlane,nearestPointInPlane:()=>nearestPointInPlane});
/**
         * Find the distance from a plane defined by a point on the plane and the normal of the plane to any point.
         * @param {THREE.Vector3} positionOnPlane any point on the plane.
         * @param {THREE.Vector3} planeNormal the normal of the plane
         * @param {THREE.Vector3} pointToTest point to test
         * @returns {number}
         */function distanceOfPointFromPlane(e,t,n){var r=t.dot(e);return(r-t.dot(n))/t.length()}
/**
         * Find the point on a plane that lies closest to
         * @param {THREE.Vector3} positionOnPlane any point on the plane.
         * @param {THREE.Vector3} planeNormal the normal of the plane
         * @param {THREE.Vector3} pointToTest point to test
         * @param {THREE.Vector3} resultPoint where to store the result.
         * @returns {THREE.Vector3}
         */function nearestPointInPlane(e,t,n,r){var s=distanceOfPointFromPlane(e,t,n);r.copy(t);r.multiplyScalar(s);r.add(n);return r}},"./src/utils/object-pool.js":(e,t,n)=>{n.r(t);n.d(t,{clearObject:()=>clearObject,createPool:()=>createPool,removeUnusedKeys:()=>removeUnusedKeys});var r=Object.freeze(Object.create(null));function defaultObjectFactory(){return{}}function createPool(e){var t=[];var n=null;e=e||defaultObjectFactory;function use(){var e;n!==null&&n!==t.length||grow(t.length||5);e=t[n];t[n++]=r;clearObject(e);return e}function recycle(e){e instanceof Object&&(n!==null&&n!==-1?t[--n]=e:t[t.length]=e)}function grow(r){var s;var a;r=r===void 0?t.length:r;r>0&&n==null&&(n=0);if(r>0){s=t.length;t.length+=Number(r);for(a=s;a<t.length;a++)t[a]=e()}return t.length}function size(){return t.length}return{grow:grow,pool:t,recycle:recycle,size:size,use:use}}function clearObject(e){var t;if(e&&e.constructor===Object)for(t in e)e[t]=void 0}function removeUnusedKeys(e,t){var n;if(e&&e.constructor===Object)for(n in e)n in t||delete e[n]}},"./src/utils/split.js":(e,t,n)=>{n.r(t);n.d(t,{split:()=>r});var r=function(){var e={};return function(t,n){n in e||(e[n]={});if(t in e[n])return e[n][t];e[n][t]=t.split(n);return e[n][t]}}()},"./src/utils/src-loader.js":(e,t,n)=>{n.r(t);n.d(t,{parseUrl:()=>parseUrl,validateCubemapSrc:()=>validateCubemapSrc,validateEnvMapSrc:()=>validateEnvMapSrc,validateSrc:()=>validateSrc});var r=n("./src/utils/debug.js");var s=(0,r.default)("utils:src-loader:warn");
/**
         * Validate a texture, either as a selector or as a URL.
         * Detects whether `src` is pointing to an image or video and invokes the appropriate
         * callback.
         *
         * `src` will be passed into the callback
         *
         * @param {string|Element} src - URL or media element.
         * @param {function} isImageCb - callback if texture is an image.
         * @param {function} isVideoCb - callback if texture is a video.
         */function validateSrc(e,t,n){checkIsImage(e,(function isAnImageUrl(r){r?t(e):n(e)}))}
/**
         * Validates either six images as a cubemap or one image as an Equirectangular image.
         *
         * @param {string} src - A selector, image URL or comma-separated image URLs. Image URLS
                  must be wrapped by `url()`.
         * @param {function} isCubemapCb - callback if src is a cubemap.
         * @param {function} isEquirectCb - callback if src is a singular equirectangular image.
         */function validateEnvMapSrc(e,t,n){var r;var a="";var o;var l;var c=[];if(typeof e==="string"){for(o=0;o<5;o++)a+="(url\\((?:[^\\)]+)\\),\\s*)";a+="(url\\((?:[^\\)]+)\\)\\s*)";l=e.match(new RegExp(a));function isImageCb(e){c.push(e);c.length===6&&t(c)}if(l){for(o=1;o<7;o++)validateSrc(parseUrl(l[o]),isImageCb);return}if(!e.startsWith("#")){var u=parseUrl(e);validateSrc(u||e,n);return}}r=e.tagName?e:validateAndGetQuerySelector(e);if(r){if(r.tagName==="A-CUBEMAP"&&r.srcs)return t(r.srcs);if(r.tagName==="IMG")return n(r);s('Selector "%s" does not point to <a-cubemap> or <img>',e)}}
/**
         * Validates six images as a cubemap, either as selector or comma-separated
         * URLs.
         *
         * @param {string} src - A selector or comma-separated image URLs. Image URLs
                  must be wrapped by `url()`.
         * @param {function} cb - callback if src is a cubemap.
         */function validateCubemapSrc(e,t){return validateEnvMapSrc(e,t,(function isEquirectCb(){s("Expected cubemap but got image")}))}
/**
         * Parses src from `url(src)`.
         * @param  {string} src - String to parse.
         * @returns {string} The parsed src, if parseable.
         */function parseUrl(e){var t=e.match(/url\((.+)\)/);if(t)return t[1]}
/**
         * Call back whether `src` is an image.
         *
         * @param {string|Element} src - URL or element that will be tested.
         * @param {function} onResult - Callback with whether `src` is an image.
         */function checkIsImage(e,t){var n;if(e.tagName)t(e.tagName==="IMG");else{n=new XMLHttpRequest;n.open("HEAD",e);n.addEventListener("load",(function(r){var s;if(n.status>=200&&n.status<300){s=n.getResponseHeader("Content-Type");s==null?checkIsImageFallback(e,t):s.startsWith("image")?t(true):t(false)}else checkIsImageFallback(e,t);n.abort()}));n.send()}}function checkIsImageFallback(e,t){var n=new Image;n.addEventListener("load",onLoad);function onLoad(){t(true)}n.addEventListener("error",onError);function onError(){t(false)}n.src=e}
/**
         * Query and validate a query selector,
         *
         * @param {string} selector - DOM selector.
         * @returns {object|null|undefined} Selected DOM element if exists.
         *          null if query yields no results.
         *          undefined if `selector` is not a valid selector.
         */function validateAndGetQuerySelector(e){try{var t=document.querySelector(e);t||s('No element was found matching the selector: "%s"',e);return t}catch(t){s('"%s" is not a valid selector',e);return}}},"./src/utils/styleParser.js":(e,t,n)=>{n.r(t);n.d(t,{parse:()=>parse,stringify:()=>stringify,toCamelCase:()=>toCamelCase});var r=/-([a-z])/g;
/**
         * Deserialize style-like string into an object of properties.
         *
         * @param {string} value - HTML attribute value.
         * @param {object} obj - Reused object for object pooling.
         * @returns {object} Property data.
         */function parse(e,t){var n;if(typeof e!=="string")return e;n=styleParse(e,t);return n[""]?e:n}
/**
         * Serialize an object of properties into a style-like string.
         *
         * @param {object} data - Property data.
         * @returns {string}
         */function stringify(e){return typeof e==="string"?e:styleStringify(e)}
/**
         * Converts string from hyphen to camelCase.
         *
         * @param {string} str - String to camelCase.
         * @returns {string} CamelCased string.
         */function toCamelCase(e){return e.replace(r,upperCase)}var s=function(){var e=[];var t=/url\([^)]+$/;return function getKeyValueChunks(n){var r="";var s;var a=0;var o=";";e.length=0;while(a<n.length){s=n.indexOf(o,a);s===-1&&(s=n.length);r+=n.substring(a,s);if(t.test(r)){r+=";";a=s+1}else{e.push(r.trim());r="";a=s+1}}return e}}();
/**
         * Convert a style attribute string to an object.
         *
         * @param {object} str - Attribute string.
         * @param {object} obj - Object to reuse as a base, else a new one will be allocated.
         */function styleParse(e,t){var n;var r;var a;var o;var l;var c;t=t||{};n=s(e);for(r=0;r<n.length;r++){a=n[r];if(a){o=a.indexOf(":");l=a.substr(0,o).trim();c=a.substr(o+1).trim();t[toCamelCase(l)]=c}}return t}function styleStringify(e){var t;var n=0;var r=0;var s="";for(t in e)n++;for(t in e){s+=t+": "+e[t];r<n-1&&(s+="; ");r++}return s}function upperCase(e){return e[1].toUpperCase()}},"./src/utils/tracked-controls.js":(e,t,n)=>{n.r(t);n.d(t,{checkControllerPresentAndSetup:()=>checkControllerPresentAndSetup,emitIfAxesChanged:()=>emitIfAxesChanged,findMatchingControllerWebXR:()=>findMatchingControllerWebXR,isControllerPresentWebXR:()=>isControllerPresentWebXR,onButtonEvent:()=>onButtonEvent});var r=["x","y","z","w"];
/**
         * Called on controller component `.play` handlers.
         * Check if controller matches parameters and inject tracked-controls component.
         * Handle event listeners.
         * Generate controllerconnected or controllerdisconnected events.
         *
         * @param {object} component - Tracked controls component.
         * @param {object} idPrefix - Prefix to match in gamepad id if any.
         * @param {object} queryObject - Map of values to match.
         */function checkControllerPresentAndSetup(e,t,n){var r=e.el;var s;var a=isControllerPresentWebXR;var o;s=a(e,t,n);o=!!s;if(o===e.controllerPresent)return o;e.controllerPresent=o;if(o){e.addEventListeners();e.injectTrackedControls(s);r.emit("controllerconnected",{name:e.name,component:e})}else{e.removeEventListeners();r.emit("controllerdisconnected",{name:e.name,component:e})}}
/**
         *
         * @param {object} component - Tracked controls component.
         * @returns {boolean} True if a controller is present.
         */function isControllerPresentWebXR(e,t,n){var r;var s=e.el.sceneEl;var a=s&&s.systems["tracked-controls"];if(!a)return false;r=a.controllers;return!(!r||!r.length)&&findMatchingControllerWebXR(r,t,n.hand,n.index,n.iterateControllerProfiles,n.handTracking)}function findMatchingControllerWebXR(e,t,n,r,s,a){var o;var l;var c;var u=false;var h;var d;for(o=0;o<e.length;o++){c=e[o];d=c.profiles;if(a)u=c.hand;else if(s)for(l=0;l<d.length;l++){u=d[l].startsWith(t);if(u)break}else u=d.length>0&&d[0].startsWith(t);if(u){h=c.handedness==="right"||c.handedness==="left";if(h){if(c.handedness===n)return e[o]}else if(o===r)return e[o]}}}
/**
         * Emit specific `moved` event(s) if axes changed based on original axismove event.
         *
         * @param {object} component - Controller component in use.
         * @param {object} axesMapping - For example `{thumbstick: [0, 1]}`.
         * @param {object} evt - Event to process.
         */function emitIfAxesChanged(e,t,n){var s;var a;var o;var l;var c;for(a in t){s=t[a];o=false;for(c=0;c<s.length;c++)n.detail.changed[s[c]]&&(o=true);if(o){l={};for(c=0;c<s.length;c++)l[r[c]]=n.detail.axis[s[c]];e.el.emit(a+"moved",l)}}}
/**
         * Handle a button event and reemits the events.
         *
         * @param {string} id - id of the button.
         * @param {string} evtName - name of the reemitted event
         * @param {object} component - reference to the component
         * @param {string} hand - handedness of the controller: left or right.
         */function onButtonEvent(e,t,n,r){var s=r?n.mapping[r]:n.mapping;var a=s.buttons[e];n.el.emit(a+t);n.updateModel&&n.updateModel(a,t)}},"./vendor/DeviceOrientationControls.js":(e,n,r)=>{r.r(n);r.d(n,{DeviceOrientationControls:()=>DeviceOrientationControls});var DeviceOrientationControls=function(e){var n=this||t;(this||t).object=e;(this||t).object.rotation.reorder("YXZ");(this||t).enabled=true;(this||t).deviceOrientation={};(this||t).screenOrientation=0;(this||t).alphaOffset=0;var onDeviceOrientationChangeEvent=function(e){n.deviceOrientation=e};var onScreenOrientationChangeEvent=function(){n.screenOrientation=window.orientation||0};var r=function(){var e=new THREE.Vector3(0,0,1);var t=new THREE.Euler;var n=new THREE.Quaternion;var r=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(s,a,o,l,c){t.set(o,a,-l,"YXZ");s.setFromEuler(t);s.multiply(r);s.multiply(n.setFromAxisAngle(e,-c))}}();(this||t).connect=function(){onScreenOrientationChangeEvent();window.addEventListener("orientationchange",onScreenOrientationChangeEvent,false);window.addEventListener("deviceorientation",onDeviceOrientationChangeEvent,false);n.enabled=true};(this||t).disconnect=function(){window.removeEventListener("orientationchange",onScreenOrientationChangeEvent,false);window.removeEventListener("deviceorientation",onDeviceOrientationChangeEvent,false);n.enabled=false};(this||t).update=function(){if(n.enabled!==false){var e=n.deviceOrientation;if(e){var t=e.alpha?THREE.MathUtils.degToRad(e.alpha)+n.alphaOffset:0;var s=e.beta?THREE.MathUtils.degToRad(e.beta):0;var a=e.gamma?THREE.MathUtils.degToRad(e.gamma):0;var o=n.screenOrientation?THREE.MathUtils.degToRad(n.screenOrientation):0;r(n.object.quaternion,t,s,a,o)}}};(this||t).dispose=function(){n.disconnect()};this.connect()}},"./vendor/rStats.extras.js":e=>{window.glStats=function(){var e=null;var n=0,r=0,s=0,a=0,o=0,l=0,c=0;function _h(e,n){return function(){n.apply(this||t,arguments);e.apply(this||t,arguments)}}WebGLRenderingContext.prototype.drawArrays=_h(WebGLRenderingContext.prototype.drawArrays,(function(){n++;arguments[0]==(this||t).POINTS?l+=arguments[2]:o+=arguments[2]}));WebGLRenderingContext.prototype.drawElements=_h(WebGLRenderingContext.prototype.drawElements,(function(){r++;a+=arguments[1]/3;o+=arguments[1]}));WebGLRenderingContext.prototype.useProgram=_h(WebGLRenderingContext.prototype.useProgram,(function(){s++}));WebGLRenderingContext.prototype.bindTexture=_h(WebGLRenderingContext.prototype.bindTexture,(function(){c++}));var u={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}};var h=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}];var d=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function _update(){e("allcalls").set(n+r);e("drawElements").set(r);e("drawArrays").set(n);e("bindTexture").set(c);e("useProgram").set(s);e("glfaces").set(a);e("glvertices").set(o);e("glpoints").set(l)}function _start(){n=0;r=0;s=0;a=0;o=0;l=0;c=0}function _end(){}function _attach(t){e=t}return{update:_update,start:_start,end:_end,attach:_attach,values:u,groups:h,fractions:d}};window.threeStats=function(e){var t=null;var n={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}};var r=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}];var s=[];function _update(){t("renderer.info.memory.geometries").set(e.info.memory.geometries);t("renderer.info.programs").set(e.info.programs?.length??NaN);t("renderer.info.memory.textures").set(e.info.memory.textures);t("renderer.info.render.calls").set(e.info.render.calls);t("renderer.info.render.triangles").set(e.info.render.triangles);t("renderer.info.render.points").set(e.info.render.points)}function _start(){}function _end(){}function _attach(e){t=e}return{update:_update,start:_start,end:_end,attach:_attach,values:n,groups:r,fractions:s}};window.BrowserStats=function(){var e=null;var t=0,n=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0});performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var r={memory:{caption:"Used Memory",average:true,avgMs:1e3,over:22},total:{caption:"Total Memory"}};var s=[{caption:"Browser",values:["memory","total"]}];var a=[{base:"total",steps:["memory"]}];var o=Math.log(1024);function _size(e){var t=100;var n=Math.floor(Math.log(e)/o);return Math.round(e*t/Math.pow(1024,n))/t}function _update(){t=_size(performance.memory.usedJSHeapSize);n=_size(performance.memory.totalJSHeapSize);e("memory").set(t);e("total").set(n)}function _start(){t=0}function _end(){}function _attach(t){e=t}return{update:_update,start:_start,end:_end,attach:_attach,values:r,groups:s,fractions:a}};true;e.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":e=>{(function(){"performance"in window==false&&(window.performance={});var e=window.performance;if("now"in e==false){var t=Date.now();e.timing&&e.timing.navigationStart&&(t=e.timing.navigationStart);e.now=function now(){return Date.now()-t}}e.mark||(e.mark=function(){});e.measure||(e.measure=function(){})})();window.rStats=function rStats(e){function iterateKeys(e,t){var n=Object.keys(e);for(var r=0,s=n.length;r<s;r++)t(n[r])}function importCSS(e){var t=document.createElement("link");t.href=e;t.rel="stylesheet";t.type="text/css";document.getElementsByTagName("head")[0].appendChild(t)}var n=e||{};var r=n.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"];var s="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300";var a=(n.CSSPath?n.CSSPath:"")+"rStats.css";var o=n.css||[s,a];o.forEach((function(e){importCSS(e)}));n.values||(n.values={});var l,c,u=10,h=200;var d={};function Graph(e,t,n){var r=n||{};var s=document.createElement("canvas"),a=s.getContext("2d"),o=0,l=0;var c=r.color?r.color:"#666666";var d=document.createElement("canvas"),p=d.getContext("2d");d.width=1;d.height=2*u;p.fillStyle="#444444";p.fillRect(0,0,1,2*u);p.fillStyle=c;p.fillRect(0,u,1,u);p.fillStyle="#ffffff";p.globalAlpha=.5;p.fillRect(0,u,1,1);p.globalAlpha=1;var f=document.createElement("canvas"),m=f.getContext("2d");f.width=1;f.height=2*u;m.fillStyle="#444444";m.fillRect(0,0,1,2*u);m.fillStyle="#b70000";m.fillRect(0,u,1,u);m.globalAlpha=.5;m.fillStyle="#ffffff";m.fillRect(0,u,1,1);m.globalAlpha=1;function _init(){s.width=h;s.height=u;s.style.width=s.width+"px";s.style.height=s.height+"px";s.className="rs-canvas";e.appendChild(s);a.fillStyle="#444444";a.fillRect(0,0,s.width,s.height)}function _draw(e,t){l+=.1*(e-l);o*=.99;l>o&&(o=l);a.drawImage(s,1,0,s.width-1,s.height,0,0,s.width-1,s.height);t?a.drawImage(f,s.width-1,s.height-l*s.height/o-u):a.drawImage(d,s.width-1,s.height-l*s.height/o-u)}_init();return{draw:_draw}}function StackGraph(e,t){var n=document.createElement("canvas"),s=n.getContext("2d");function _init(){n.width=h;n.height=u*t;n.style.width=n.width+"px";n.style.height=n.height+"px";n.className="rs-canvas";e.appendChild(n);s.fillStyle="#444444";s.fillRect(0,0,n.width,n.height)}function _draw(e){s.drawImage(n,1,0,n.width-1,n.height,0,0,n.width-1,n.height);var t=0;iterateKeys(e,(function(a){var o=e[a]*n.height;s.fillStyle=r[a];s.fillRect(n.width-1,t,1,o);t+=o}))}_init();return{draw:_draw}}function PerfCounter(e,t){var r,s=e,a=0,o=0,l=0,u=0,h=performance.now(),d=0,p=document.createElement("div"),f=document.createElement("span"),m=document.createElement("div"),g=document.createTextNode(""),y=n?n.values[s.toLowerCase()]:null,b=new Graph(p,s,y),x=false;f.className="rs-counter-id";f.textContent=y&&y.caption?y.caption:s;m.className="rs-counter-value";m.appendChild(g);p.appendChild(f);p.appendChild(m);t?t.div.appendChild(p):c.appendChild(p);r=performance.now();function _average(e){if(y&&y.average){u+=e;d++;var t=performance.now();if(t-h>=(y.avgMs||1e3)){l=u/d;u=0;h=t;d=0}}}function _start(){r=performance.now();n.userTimingAPI&&performance.mark(s+"-start");x=true}function _end(){a=performance.now()-r;if(n.userTimingAPI){performance.mark(s+"-end");x&&performance.measure(s,s+"-start",s+"-end")}_average(a)}function _tick(){_end();_start()}function _draw(){var e=y&&y.average?l:a;g.nodeValue=Math.round(e*100)/100;var t=y&&(y.below&&a<y.below||y.over&&a>y.over);b.draw(a,t);p.className=t?"rs-counter-base alarm":"rs-counter-base"}function _frame(){var e=performance.now();var t=e-r;o++;if(t>1e3){a=y&&y.interpolate===false?o:o*1e3/t;o=0;r=e;_average(a)}}function _set(e){a=e;_average(a)}return{set:_set,start:_start,tick:_tick,end:_end,frame:_frame,value:function(){return a},draw:_draw}}function _perf(e){var t=e.toLowerCase();t===void 0&&(t="default");if(d[t])return d[t];var r=null;n&&n.groups&&iterateKeys(n.groups,(function(e){var s=n.groups[parseInt(e,10)];r||s.values.indexOf(t.toLowerCase())===-1||(r=s)}));var s=new PerfCounter(t,r);d[t]=s;return s}function _init(){if(n.plugins){n.values||(n.values={});n.groups||(n.groups=[]);n.fractions||(n.fractions=[]);for(var e=0;e<n.plugins.length;e++){n.plugins[e].attach(_perf);iterateKeys(n.plugins[e].values,(function(t){n.values[t]=n.plugins[e].values[t]}));n.groups=n.groups.concat(n.plugins[e].groups);n.fractions=n.fractions.concat(n.plugins[e].fractions)}}else n.plugins={};l=document.createElement("div");l.className="rs-base";c=document.createElement("div");c.className="rs-container";c.style.height="auto";l.appendChild(c);document.body.appendChild(l);if(n){n.groups&&iterateKeys(n.groups,(function(e){var r=n.groups[parseInt(e,10)];var s=document.createElement("div");s.className="rs-group";r.div=s;var a=document.createElement("h1");a.textContent=r.caption;a.addEventListener("click",function(e){(this||t).classList.toggle("hidden");e.preventDefault()}.bind(s));c.appendChild(a);c.appendChild(s)}));n.fractions&&iterateKeys(n.fractions,(function(e){var t=n.fractions[parseInt(e,10)];var s=document.createElement("div");s.className="rs-fraction";var a=document.createElement("div");a.className="rs-legend";var o=0;iterateKeys(n.fractions[e].steps,(function(t){var s=document.createElement("p");s.textContent=n.fractions[e].steps[t];s.style.color=r[o];a.appendChild(s);o++}));s.appendChild(a);s.style.height=o*u+"px";t.div=s;var l=new StackGraph(s,o);t.graph=l;c.appendChild(s)}))}}function _update(){iterateKeys(n.plugins,(function(e){n.plugins[e].update()}));iterateKeys(d,(function(e){d[e].draw()}));n&&n.fractions&&iterateKeys(n.fractions,(function(e){var t=n.fractions[parseInt(e,10)];var r=[];var s=d[t.base.toLowerCase()];if(s){s=s.value();iterateKeys(n.fractions[e].steps,(function(t){var a=n.fractions[e].steps[parseInt(t,10)].toLowerCase();var o=d[a];o&&r.push(o.value()/s)}))}t.graph.draw(r)}))}_init();return function(e){return e?_perf(e):{element:l,update:_update}}};true;e.exports=window.rStats},"./vendor/wakelock/util.js":e=>{var t={};t.base64=function(e,t){return"data:"+e+";base64,"+t};t.isMobile=function(){var e=false;(function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=true)})(navigator.userAgent||navigator.vendor||window.opera);return e};t.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)};t.isIFrame=function(){try{return window.self!==window.top}catch(e){return true}};t.appendQueryParameter=function(e,t,n){var r=e.indexOf("?")<0?"?":"&";e+=r+t+"="+n;return e};t.getQueryParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return n===null?"":decodeURIComponent(n[1].replace(/\+/g," "))};t.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90};e.exports=t},"./vendor/wakelock/wakelock.js":(e,n,r)=>{var s=r("./vendor/wakelock/util.js");function AndroidWakeLock(){var e=document.createElement("video");e.addEventListener("ended",(function(){e.play()}));(this||t).request=function(){if(e.paused){e.src=s.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw==");e.play()}};(this||t).release=function(){e.pause();e.src=""}}function iOSWakeLock(){var e=null;(this||t).request=function(){e||(e=setInterval((function(){window.location.href="/";setTimeout(window.stop,0)}),15e3))};(this||t).release=function(){if(e){clearInterval(e);e=null}}}function getWakeLock(){var e=navigator.userAgent||navigator.vendor||window.opera;return e.match(/iPhone/i)||e.match(/iPod/i)?iOSWakeLock:AndroidWakeLock}e.exports=getWakeLock()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(e,t,n)=>{n.r(t);n.d(t,{default:()=>M});var r=n("./node_modules/css-loader/dist/runtime/sourceMaps.js");var s=n.n(r);var a=n("./node_modules/css-loader/dist/runtime/api.js");var o=n.n(a);var l=n("./node_modules/css-loader/dist/runtime/getUrl.js");var c=n.n(l);var u=new URL(n("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),n.b);var h=new URL(n("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),n.b);var d=new URL(n("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),n.b);var p=new URL(n("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),n.b);var f=new URL(n("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),n.b);var m=o()(s());var g=c()(u);var y=c()(h);var b=c()(d);var x=c()(p);var _=c()(f);m.push([e.id,`/* .a-fullscreen means not embedded. */\nhtml.a-fullscreen {\n  bottom: 0;\n  left: 0;\n  position: fixed;\n  right: 0;\n  top: 0;\n}\n\nhtml.a-fullscreen body {\n  height: 100%;\n  margin: 0;\n  overflow: hidden;\n  padding: 0;\n  width: 100%;\n}\n\n/* Class is removed when doing <a-scene embedded>. */\nhtml.a-fullscreen .a-canvas {\n  width: 100% !important;\n  height: 100% !important;\n  top: 0 !important;\n  left: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  position: fixed !important;\n}\n\nhtml:not(.a-fullscreen) .a-enter-vr,\nhtml:not(.a-fullscreen) .a-enter-ar {\n  right: 5px;\n  bottom: 5px;\n}\n\nhtml:not(.a-fullscreen) .a-enter-ar {\n  right: 60px;\n}\n\n/* In chrome mobile the user agent stylesheet set it to white  */\n:-webkit-full-screen {\n  background-color: transparent;\n}\n\n.a-hidden {\n  display: none !important;\n}\n\n.a-canvas {\n  height: 100%;\n  left: 0;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n\n.a-canvas.a-grab-cursor:hover {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\ncanvas.a-canvas.a-mouse-cursor-hover:hover {\n  cursor: pointer;\n}\n\n.a-inspector-loader {\n  background-color: #ed3160;\n  position: fixed;\n  left: 3px;\n  top: 3px;\n  padding: 6px 10px;\n  color: #fff;\n  text-decoration: none;\n  font-size: 12px;\n  font-family: Roboto,sans-serif;\n  text-align: center;\n  z-index: 99999;\n  width: 204px;\n}\n\n/* Inspector loader animation */\n@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }\n@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }\n@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }\n@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }\n@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }\n@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }\n\n.a-inspector-loader .dots span {\n  animation: dots-1 2s infinite steps(1);\n  -webkit-animation: dots-1 2s infinite steps(1);\n}\n\n.a-inspector-loader .dots span:first-child + span {\n  animation-name: dots-2;\n  -webkit-animation-name: dots-2;\n}\n\n.a-inspector-loader .dots span:first-child + span + span {\n  animation-name: dots-3;\n  -webkit-animation-name: dots-3;\n}\n\na-scene {\n  display: block;\n  position: relative;\n  height: 100%;\n  width: 100%;\n}\n\na-assets,\na-scene video,\na-scene img,\na-scene audio {\n  display: none;\n}\n\n.a-enter-vr-modal,\n.a-orientation-modal {\n  font-family: Consolas, Andale Mono, Courier New, monospace;\n}\n\n.a-enter-vr-modal a {\n  border-bottom: 1px solid #fff;\n  padding: 2px 0;\n  text-decoration: none;\n  transition: .1s color ease-in;\n}\n\n.a-enter-vr-modal a:hover {\n  background-color: #fff;\n  color: #111;\n  padding: 2px 4px;\n  position: relative;\n  left: -4px;\n}\n\n.a-enter-vr,\n.a-enter-ar {\n  font-family: sans-serif, monospace;\n  font-size: 13px;\n  width: 100%;\n  font-weight: 200;\n  line-height: 16px;\n  position: absolute;\n  right: 20px;\n  bottom: 20px;\n}\n\n.a-enter-ar.xr {\n  right: 90px;\n}\n\n.a-enter-vr-button,\n.a-enter-vr-modal,\n.a-enter-vr-modal a {\n  color: #fff;\n  user-select: none;\n  outline: none;\n}\n\n.a-enter-vr-button {\n  background: rgba(0, 0, 0, 0.35) url(${g}) 50% 50% no-repeat;\n}\n\n.a-enter-ar-button {\n  background: rgba(0, 0, 0, 0.20) url(${y}) 50% 50% no-repeat;\n}\n\n.a-enter-vr.fullscreen .a-enter-vr-button {\n  background-image: url(${b});\n}\n\n.a-enter-vr-button,\n.a-enter-ar-button {\n  background-size: 90% 90%;\n  border: 0;\n  bottom: 0;\n  cursor: pointer;\n  min-width: 58px;\n  min-height: 34px;\n  /* 1.74418604651 */\n  /*\n    In order to keep the aspect ratio when resizing\n    padding-top percentages are relative to the containing block's width.\n    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio\n  */\n  padding-right: 0;\n  padding-top: 0;\n  position: absolute;\n  right: 0;\n  transition: background-color .05s ease;\n  -webkit-transition: background-color .05s ease;\n  z-index: 9999;\n  border-radius: 8px;\n  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */\n}\n\n.a-enter-ar-button {\n  background-size: 100% 90%;\n  border-radius: 7px;\n}\n\n.a-enter-ar-button:active,\n.a-enter-ar-button:hover,\n.a-enter-vr-button:active,\n.a-enter-vr-button:hover {\n  background-color: #ef2d5e;\n}\n\n.a-enter-vr-button.resethover {\n  background-color: rgba(0, 0, 0, 0.35);\n}\n\n.a-enter-vr-modal {\n  background-color: #666;\n  border-radius: 0;\n  display: none;\n  min-height: 32px;\n  margin-right: 70px;\n  padding: 9px;\n  width: 280px;\n  right: 2%;\n  position: absolute;\n}\n\n.a-enter-vr-modal:after {\n  border-bottom: 10px solid transparent;\n  border-left: 10px solid #666;\n  border-top: 10px solid transparent;\n  display: inline-block;\n  content: '';\n  position: absolute;\n  right: -5px;\n  top: 5px;\n  width: 0;\n  height: 0;\n}\n\n.a-enter-vr-modal p,\n.a-enter-vr-modal a {\n  display: inline;\n}\n\n.a-enter-vr-modal p {\n  margin: 0;\n}\n\n.a-enter-vr-modal p:after {\n  content: ' ';\n}\n\n.a-orientation-modal {\n  background: rgba(244, 244, 244, 1) url(${x}) center no-repeat;\n  background-size: 50% 50%;\n  bottom: 0;\n  font-size: 14px;\n  font-weight: 600;\n  left: 0;\n  line-height: 20px;\n  right: 0;\n  position: fixed;\n  top: 0;\n  z-index: 9999999;\n}\n\n.a-orientation-modal:after {\n  color: #666;\n  content: "Insert phone into Cardboard holder.";\n  display: block;\n  position: absolute;\n  text-align: center;\n  top: 70%;\n  transform: translateY(-70%);\n  width: 100%;\n}\n\n.a-orientation-modal button {\n  background: url(${_}) no-repeat;\n  border: none;\n  height: 50px;\n  text-indent: -9999px;\n  width: 50px;\n}\n\n.a-loader-title {\n  background-color: rgba(0, 0, 0, 0.6);\n  font-family: sans-serif, monospace;\n  text-align: center;\n  font-size: 20px;\n  height: 50px;\n  font-weight: 300;\n  line-height: 50px;\n  position: absolute;\n  right: 0px;\n  left: 0px;\n  top: 0px;\n  color: white;\n}\n\n.a-modal {\n  position: absolute;\n  background: rgba(0, 0, 0, 0.60);\n  background-size: 50% 50%;\n  bottom: 0;\n  font-size: 14px;\n  font-weight: 600;\n  left: 0;\n  line-height: 20px;\n  right: 0;\n  position: fixed;\n  top: 0;\n  z-index: 9999999;\n}\n\n.a-dialog {\n  position: relative;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 199995;\n  width: 300px;\n  height: 200px;\n  background-size: contain;\n  background-color: white;\n  font-family: sans-serif, monospace;\n  font-size: 20px;\n  border-radius: 3px;\n  padding: 6px;\n}\n\n.a-dialog-text-container {\n  width: 100%;\n  height: 70%;\n  align-self: flex-start;\n  display: flex;\n  justify-content: center;\n  align-content: center;\n  flex-direction: column;\n}\n\n.a-dialog-text {\n  display: inline-block;\n  font-weight: normal;\n  font-size: 14pt;\n  margin: 8px;\n}\n\n.a-dialog-buttons-container {\n  display: inline-flex;\n  align-self: flex-end;\n  width: 100%;\n  height: 30%;\n}\n\n.a-dialog-button {\n  cursor: pointer;\n  align-self: center;\n  opacity: 0.9;\n  height: 80%;\n  width: 50%;\n  font-size: 12pt;\n  margin: 4px;\n  border-radius: 2px;\n  text-align:center;\n  border: none;\n  display: inline-block;\n  -webkit-transition: all 0.25s ease-in-out;\n  transition: all 0.25s ease-in-out;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);\n  user-select: none;\n}\n\n.a-dialog-permission-button:hover {\n  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);\n}\n\n.a-dialog-allow-button {\n  background-color: #00ceff;\n}\n\n.a-dialog-deny-button {\n  background-color: #ff005b;\n}\n\n.a-dialog-ok-button {\n  background-color: #00ceff;\n  width: 100%;\n}\n\n.a-dom-overlay:not(.a-no-style) {\n  overflow: hidden;\n  position: absolute;\n  pointer-events: none;\n  box-sizing: border-box;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  top: 0;\n  padding: 1em;\n}\n\n.a-dom-overlay:not(.a-no-style)>* {\n  pointer-events: auto;\n}\n`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:["/* .a-fullscreen means not embedded. */\nhtml.a-fullscreen {\n  bottom: 0;\n  left: 0;\n  position: fixed;\n  right: 0;\n  top: 0;\n}\n\nhtml.a-fullscreen body {\n  height: 100%;\n  margin: 0;\n  overflow: hidden;\n  padding: 0;\n  width: 100%;\n}\n\n/* Class is removed when doing <a-scene embedded>. */\nhtml.a-fullscreen .a-canvas {\n  width: 100% !important;\n  height: 100% !important;\n  top: 0 !important;\n  left: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  position: fixed !important;\n}\n\nhtml:not(.a-fullscreen) .a-enter-vr,\nhtml:not(.a-fullscreen) .a-enter-ar {\n  right: 5px;\n  bottom: 5px;\n}\n\nhtml:not(.a-fullscreen) .a-enter-ar {\n  right: 60px;\n}\n\n/* In chrome mobile the user agent stylesheet set it to white  */\n:-webkit-full-screen {\n  background-color: transparent;\n}\n\n.a-hidden {\n  display: none !important;\n}\n\n.a-canvas {\n  height: 100%;\n  left: 0;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n\n.a-canvas.a-grab-cursor:hover {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\ncanvas.a-canvas.a-mouse-cursor-hover:hover {\n  cursor: pointer;\n}\n\n.a-inspector-loader {\n  background-color: #ed3160;\n  position: fixed;\n  left: 3px;\n  top: 3px;\n  padding: 6px 10px;\n  color: #fff;\n  text-decoration: none;\n  font-size: 12px;\n  font-family: Roboto,sans-serif;\n  text-align: center;\n  z-index: 99999;\n  width: 204px;\n}\n\n/* Inspector loader animation */\n@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }\n@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }\n@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }\n@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }\n@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }\n@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }\n\n.a-inspector-loader .dots span {\n  animation: dots-1 2s infinite steps(1);\n  -webkit-animation: dots-1 2s infinite steps(1);\n}\n\n.a-inspector-loader .dots span:first-child + span {\n  animation-name: dots-2;\n  -webkit-animation-name: dots-2;\n}\n\n.a-inspector-loader .dots span:first-child + span + span {\n  animation-name: dots-3;\n  -webkit-animation-name: dots-3;\n}\n\na-scene {\n  display: block;\n  position: relative;\n  height: 100%;\n  width: 100%;\n}\n\na-assets,\na-scene video,\na-scene img,\na-scene audio {\n  display: none;\n}\n\n.a-enter-vr-modal,\n.a-orientation-modal {\n  font-family: Consolas, Andale Mono, Courier New, monospace;\n}\n\n.a-enter-vr-modal a {\n  border-bottom: 1px solid #fff;\n  padding: 2px 0;\n  text-decoration: none;\n  transition: .1s color ease-in;\n}\n\n.a-enter-vr-modal a:hover {\n  background-color: #fff;\n  color: #111;\n  padding: 2px 4px;\n  position: relative;\n  left: -4px;\n}\n\n.a-enter-vr,\n.a-enter-ar {\n  font-family: sans-serif, monospace;\n  font-size: 13px;\n  width: 100%;\n  font-weight: 200;\n  line-height: 16px;\n  position: absolute;\n  right: 20px;\n  bottom: 20px;\n}\n\n.a-enter-ar.xr {\n  right: 90px;\n}\n\n.a-enter-vr-button,\n.a-enter-vr-modal,\n.a-enter-vr-modal a {\n  color: #fff;\n  user-select: none;\n  outline: none;\n}\n\n.a-enter-vr-button {\n  background: rgba(0, 0, 0, 0.35) url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat;\n}\n\n.a-enter-ar-button {\n  background: rgba(0, 0, 0, 0.20) url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E\") 50% 50% no-repeat;\n}\n\n.a-enter-vr.fullscreen .a-enter-vr-button {\n  background-image: url(\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E\");\n}\n\n.a-enter-vr-button,\n.a-enter-ar-button {\n  background-size: 90% 90%;\n  border: 0;\n  bottom: 0;\n  cursor: pointer;\n  min-width: 58px;\n  min-height: 34px;\n  /* 1.74418604651 */\n  /*\n    In order to keep the aspect ratio when resizing\n    padding-top percentages are relative to the containing block's width.\n    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio\n  */\n  padding-right: 0;\n  padding-top: 0;\n  position: absolute;\n  right: 0;\n  transition: background-color .05s ease;\n  -webkit-transition: background-color .05s ease;\n  z-index: 9999;\n  border-radius: 8px;\n  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */\n}\n\n.a-enter-ar-button {\n  background-size: 100% 90%;\n  border-radius: 7px;\n}\n\n.a-enter-ar-button:active,\n.a-enter-ar-button:hover,\n.a-enter-vr-button:active,\n.a-enter-vr-button:hover {\n  background-color: #ef2d5e;\n}\n\n.a-enter-vr-button.resethover {\n  background-color: rgba(0, 0, 0, 0.35);\n}\n\n.a-enter-vr-modal {\n  background-color: #666;\n  border-radius: 0;\n  display: none;\n  min-height: 32px;\n  margin-right: 70px;\n  padding: 9px;\n  width: 280px;\n  right: 2%;\n  position: absolute;\n}\n\n.a-enter-vr-modal:after {\n  border-bottom: 10px solid transparent;\n  border-left: 10px solid #666;\n  border-top: 10px solid transparent;\n  display: inline-block;\n  content: '';\n  position: absolute;\n  right: -5px;\n  top: 5px;\n  width: 0;\n  height: 0;\n}\n\n.a-enter-vr-modal p,\n.a-enter-vr-modal a {\n  display: inline;\n}\n\n.a-enter-vr-modal p {\n  margin: 0;\n}\n\n.a-enter-vr-modal p:after {\n  content: ' ';\n}\n\n.a-orientation-modal {\n  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;\n  background-size: 50% 50%;\n  bottom: 0;\n  font-size: 14px;\n  font-weight: 600;\n  left: 0;\n  line-height: 20px;\n  right: 0;\n  position: fixed;\n  top: 0;\n  z-index: 9999999;\n}\n\n.a-orientation-modal:after {\n  color: #666;\n  content: \"Insert phone into Cardboard holder.\";\n  display: block;\n  position: absolute;\n  text-align: center;\n  top: 70%;\n  transform: translateY(-70%);\n  width: 100%;\n}\n\n.a-orientation-modal button {\n  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;\n  border: none;\n  height: 50px;\n  text-indent: -9999px;\n  width: 50px;\n}\n\n.a-loader-title {\n  background-color: rgba(0, 0, 0, 0.6);\n  font-family: sans-serif, monospace;\n  text-align: center;\n  font-size: 20px;\n  height: 50px;\n  font-weight: 300;\n  line-height: 50px;\n  position: absolute;\n  right: 0px;\n  left: 0px;\n  top: 0px;\n  color: white;\n}\n\n.a-modal {\n  position: absolute;\n  background: rgba(0, 0, 0, 0.60);\n  background-size: 50% 50%;\n  bottom: 0;\n  font-size: 14px;\n  font-weight: 600;\n  left: 0;\n  line-height: 20px;\n  right: 0;\n  position: fixed;\n  top: 0;\n  z-index: 9999999;\n}\n\n.a-dialog {\n  position: relative;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 199995;\n  width: 300px;\n  height: 200px;\n  background-size: contain;\n  background-color: white;\n  font-family: sans-serif, monospace;\n  font-size: 20px;\n  border-radius: 3px;\n  padding: 6px;\n}\n\n.a-dialog-text-container {\n  width: 100%;\n  height: 70%;\n  align-self: flex-start;\n  display: flex;\n  justify-content: center;\n  align-content: center;\n  flex-direction: column;\n}\n\n.a-dialog-text {\n  display: inline-block;\n  font-weight: normal;\n  font-size: 14pt;\n  margin: 8px;\n}\n\n.a-dialog-buttons-container {\n  display: inline-flex;\n  align-self: flex-end;\n  width: 100%;\n  height: 30%;\n}\n\n.a-dialog-button {\n  cursor: pointer;\n  align-self: center;\n  opacity: 0.9;\n  height: 80%;\n  width: 50%;\n  font-size: 12pt;\n  margin: 4px;\n  border-radius: 2px;\n  text-align:center;\n  border: none;\n  display: inline-block;\n  -webkit-transition: all 0.25s ease-in-out;\n  transition: all 0.25s ease-in-out;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);\n  user-select: none;\n}\n\n.a-dialog-permission-button:hover {\n  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);\n}\n\n.a-dialog-allow-button {\n  background-color: #00ceff;\n}\n\n.a-dialog-deny-button {\n  background-color: #ff005b;\n}\n\n.a-dialog-ok-button {\n  background-color: #00ceff;\n  width: 100%;\n}\n\n.a-dom-overlay:not(.a-no-style) {\n  overflow: hidden;\n  position: absolute;\n  pointer-events: none;\n  box-sizing: border-box;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  top: 0;\n  padding: 1em;\n}\n\n.a-dom-overlay:not(.a-no-style)>* {\n  pointer-events: auto;\n}\n"],sourceRoot:""}]);const M=m},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(e,t,n)=>{n.r(t);n.d(t,{default:()=>c});var r=n("./node_modules/css-loader/dist/runtime/sourceMaps.js");var s=n.n(r);var a=n("./node_modules/css-loader/dist/runtime/api.js");var o=n.n(a);var l=o()(s());l.push([e.id,".rs-base {\n  background-color: #333;\n  color: #fafafa;\n  border-radius: 0;\n  font: 10px monospace;\n  left: 5px;\n  line-height: 1em;\n  opacity: 0.85;\n  overflow: hidden;\n  padding: 10px;\n  position: fixed;\n  top: 5px;\n  width: 300px;\n  z-index: 10000;\n}\n\n.rs-base div.hidden {\n  display: none;\n}\n\n.rs-base h1 {\n  color: #fff;\n  cursor: pointer;\n  font-size: 1.4em;\n  font-weight: 300;\n  margin: 0 0 5px;\n  padding: 0;\n}\n\n.rs-group {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-direction: column-reverse;\n  flex-direction: column-reverse;\n  margin-bottom: 5px;\n}\n\n.rs-group:last-child {\n  margin-bottom: 0;\n}\n\n.rs-counter-base {\n  align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  height: 10px;\n  -webkit-justify-content: space-between;\n  justify-content: space-between;\n  margin: 2px 0;\n}\n\n.rs-counter-base.alarm {\n  color: #b70000;\n  text-shadow: 0 0 0 #b70000,\n               0 0 1px #fff,\n               0 0 1px #fff,\n               0 0 2px #fff,\n               0 0 2px #fff,\n               0 0 3px #fff,\n               0 0 3px #fff,\n               0 0 4px #fff,\n               0 0 4px #fff;\n}\n\n.rs-counter-id {\n  font-weight: 300;\n  -webkit-box-ordinal-group: 0;\n  -webkit-order: 0;\n  order: 0;\n  width: 54px;\n}\n\n.rs-counter-value {\n  font-weight: 300;\n  -webkit-box-ordinal-group: 1;\n  -webkit-order: 1;\n  order: 1;\n  text-align: right;\n  width: 35px;\n}\n\n.rs-canvas {\n  -webkit-box-ordinal-group: 2;\n  -webkit-order: 2;\n  order: 2;\n}\n\n@media (min-width: 480px) {\n  .rs-base {\n    left: 20px;\n    top: 20px;\n  }\n}\n","",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[".rs-base {\n  background-color: #333;\n  color: #fafafa;\n  border-radius: 0;\n  font: 10px monospace;\n  left: 5px;\n  line-height: 1em;\n  opacity: 0.85;\n  overflow: hidden;\n  padding: 10px;\n  position: fixed;\n  top: 5px;\n  width: 300px;\n  z-index: 10000;\n}\n\n.rs-base div.hidden {\n  display: none;\n}\n\n.rs-base h1 {\n  color: #fff;\n  cursor: pointer;\n  font-size: 1.4em;\n  font-weight: 300;\n  margin: 0 0 5px;\n  padding: 0;\n}\n\n.rs-group {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-direction: column-reverse;\n  flex-direction: column-reverse;\n  margin-bottom: 5px;\n}\n\n.rs-group:last-child {\n  margin-bottom: 0;\n}\n\n.rs-counter-base {\n  align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  height: 10px;\n  -webkit-justify-content: space-between;\n  justify-content: space-between;\n  margin: 2px 0;\n}\n\n.rs-counter-base.alarm {\n  color: #b70000;\n  text-shadow: 0 0 0 #b70000,\n               0 0 1px #fff,\n               0 0 1px #fff,\n               0 0 2px #fff,\n               0 0 2px #fff,\n               0 0 3px #fff,\n               0 0 3px #fff,\n               0 0 4px #fff,\n               0 0 4px #fff;\n}\n\n.rs-counter-id {\n  font-weight: 300;\n  -webkit-box-ordinal-group: 0;\n  -webkit-order: 0;\n  order: 0;\n  width: 54px;\n}\n\n.rs-counter-value {\n  font-weight: 300;\n  -webkit-box-ordinal-group: 1;\n  -webkit-order: 1;\n  order: 1;\n  text-align: right;\n  width: 35px;\n}\n\n.rs-canvas {\n  -webkit-box-ordinal-group: 2;\n  -webkit-order: 2;\n  order: 2;\n}\n\n@media (min-width: 480px) {\n  .rs-base {\n    left: 20px;\n    top: 20px;\n  }\n}\n"],sourceRoot:""}]);const c=l},"./src/style/aframe.css":(e,t,n)=>{n.r(t);n.d(t,{default:()=>b});var r=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var s=n.n(r);var a=n("./node_modules/style-loader/dist/runtime/styleDomAPI.js");var o=n.n(a);var l=n("./node_modules/style-loader/dist/runtime/insertBySelector.js");var c=n.n(l);var u=n("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var h=n.n(u);var d=n("./node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=n.n(d);var f=n("./node_modules/style-loader/dist/runtime/styleTagTransform.js");var m=n.n(f);var g=n("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css");var y={};y.styleTagTransform=m();y.setAttributes=h();y.insert=c().bind(null,"head");y.domAPI=o();y.insertStyleElement=p();s()(g.default,y);const b=g.default&&g.default.locals?g.default.locals:void 0},"./src/style/rStats.css":(e,t,n)=>{n.r(t);n.d(t,{default:()=>b});var r=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var s=n.n(r);var a=n("./node_modules/style-loader/dist/runtime/styleDomAPI.js");var o=n.n(a);var l=n("./node_modules/style-loader/dist/runtime/insertBySelector.js");var c=n.n(l);var u=n("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var h=n.n(u);var d=n("./node_modules/style-loader/dist/runtime/insertStyleElement.js");var p=n.n(d);var f=n("./node_modules/style-loader/dist/runtime/styleTagTransform.js");var m=n.n(f);var g=n("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css");var y={};y.styleTagTransform=m();y.setAttributes=h();y.insert=c().bind(null,"head");y.domAPI=o();y.insertStyleElement=p();s()(g.default,y);const b=g.default&&g.default.locals?g.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":e=>{var t=[];function getIndexByIdentifier(e){var n=-1;for(var r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function modulesToDom(e,n){var r={};var s=[];for(var a=0;a<e.length;a++){var o=e[a];var l=n.base?o[0]+n.base:o[0];var c=r[l]||0;var u="".concat(l," ").concat(c);r[l]=c+1;var h=getIndexByIdentifier(u);var d={css:o[1],media:o[2],sourceMap:o[3],supports:o[4],layer:o[5]};if(h!==-1){t[h].references++;t[h].updater(d)}else{var p=addElementStyle(d,n);n.byIndex=a;t.splice(a,0,{identifier:u,updater:p,references:1})}s.push(u)}return s}function addElementStyle(e,t){var n=t.domAPI(t);n.update(e);var r=function updater(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()};return r}e.exports=function(e,n){n=n||{};e=e||[];var r=modulesToDom(e,n);return function update(e){e=e||[];for(var s=0;s<r.length;s++){var a=r[s];var o=getIndexByIdentifier(a);t[o].references--}var l=modulesToDom(e,n);for(var c=0;c<r.length;c++){var u=r[c];var h=getIndexByIdentifier(u);if(t[h].references===0){t[h].updater();t.splice(h,1)}}r=l}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":e=>{var t={};function getTarget(e){if(typeof t[e]==="undefined"){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}function insertBySelector(e,t){var n=getTarget(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(t)}e.exports=insertBySelector},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":e=>{function insertStyleElement(e){var t=document.createElement("style");e.setAttributes(t,e.attributes);e.insert(t,e.options);return t}e.exports=insertStyleElement},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(e,t,n)=>{function setAttributesWithoutAttributes(e){var t=n.nc;t&&e.setAttribute("nonce",t)}e.exports=setAttributesWithoutAttributes},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":e=>{function apply(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {"));n.media&&(r+="@media ".concat(n.media," {"));var s=typeof n.layer!=="undefined";s&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {"));r+=n.css;s&&(r+="}");n.media&&(r+="}");n.supports&&(r+="}");var a=n.sourceMap;a&&typeof btoa!=="undefined"&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */"));t.styleTagTransform(r,e,t.options)}function removeStyleElement(e){if(e.parentNode===null)return false;e.parentNode.removeChild(e)}function domAPI(e){if(typeof document==="undefined")return{update:function update(){},remove:function remove(){}};var t=e.insertStyleElement(e);return{update:function update(n){apply(t,e,n)},remove:function remove(){removeStyleElement(t)}}}e.exports=domAPI},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":e=>{function styleTagTransform(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}e.exports=styleTagTransform},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":e=>{e.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":e=>{e.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":e=>{e.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":e=>{e.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":e=>{e.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.core.js":(e,n,r)=>{r.r(n);r.d(n,{ACESFilmicToneMapping:()=>de,AddEquation:()=>I,AddOperation:()=>oe,AdditiveAnimationBlendMode:()=>Yt,AdditiveBlending:()=>M,AgXToneMapping:()=>fe,AlphaFormat:()=>Xe,AlwaysCompare:()=>Fn,AlwaysDepth:()=>Z,AlwaysStencilFunc:()=>Sn,AmbientLight:()=>AmbientLight,AnimationAction:()=>AnimationAction,AnimationClip:()=>AnimationClip,AnimationLoader:()=>AnimationLoader,AnimationMixer:()=>AnimationMixer,AnimationObjectGroup:()=>AnimationObjectGroup,AnimationUtils:()=>Ia,ArcCurve:()=>ArcCurve,ArrayCamera:()=>ArrayCamera,ArrowHelper:()=>ArrowHelper,AttachedBindMode:()=>Ae,Audio:()=>Audio,AudioAnalyser:()=>AudioAnalyser,AudioContext:()=>AudioContext,AudioListener:()=>AudioListener,AudioLoader:()=>AudioLoader,AxesHelper:()=>AxesHelper,BackSide:()=>y,BasicDepthPacking:()=>en,BasicShadowMap:()=>d,BatchedMesh:()=>BatchedMesh,Bone:()=>Bone,BooleanKeyframeTrack:()=>BooleanKeyframeTrack,Box2:()=>Box2,Box3:()=>Box3,Box3Helper:()=>Box3Helper,BoxGeometry:()=>BoxGeometry,BoxHelper:()=>BoxHelper,BufferAttribute:()=>BufferAttribute,BufferGeometry:()=>BufferGeometry,BufferGeometryLoader:()=>BufferGeometryLoader,ByteType:()=>ke,Cache:()=>Ra,Camera:()=>Camera,CameraHelper:()=>CameraHelper,CanvasTexture:()=>CanvasTexture,CapsuleGeometry:()=>CapsuleGeometry,CatmullRomCurve3:()=>CatmullRomCurve3,CineonToneMapping:()=>he,CircleGeometry:()=>CircleGeometry,ClampToEdgeWrapping:()=>Me,Clock:()=>Clock,Color:()=>Color,ColorKeyframeTrack:()=>ColorKeyframeTrack,ColorManagement:()=>ar,CompressedArrayTexture:()=>CompressedArrayTexture,CompressedCubeTexture:()=>CompressedCubeTexture,CompressedTexture:()=>CompressedTexture,CompressedTextureLoader:()=>CompressedTextureLoader,ConeGeometry:()=>ConeGeometry,ConstantAlphaFactor:()=>X,ConstantColorFactor:()=>q,Controls:()=>Controls,CubeCamera:()=>CubeCamera,CubeReflectionMapping:()=>ye,CubeRefractionMapping:()=>Ce,CubeTexture:()=>CubeTexture,CubeTextureLoader:()=>CubeTextureLoader,CubeUVReflectionMapping:()=>xe,CubicBezierCurve:()=>CubicBezierCurve,CubicBezierCurve3:()=>CubicBezierCurve3,CubicInterpolant:()=>CubicInterpolant,CullFaceBack:()=>c,CullFaceFront:()=>u,CullFaceFrontBack:()=>h,CullFaceNone:()=>l,Curve:()=>Curve,CurvePath:()=>CurvePath,CustomBlending:()=>T,CustomToneMapping:()=>pe,CylinderGeometry:()=>CylinderGeometry,Cylindrical:()=>Cylindrical,Data3DTexture:()=>Data3DTexture,DataArrayTexture:()=>DataArrayTexture,DataTexture:()=>DataTexture,DataTextureLoader:()=>DataTextureLoader,DataUtils:()=>Bi,DecrementStencilOp:()=>An,DecrementWrapStencilOp:()=>vn,DefaultLoadingManager:()=>La,DepthFormat:()=>et,DepthStencilFormat:()=>tt,DepthTexture:()=>DepthTexture,DetachedBindMode:()=>ge,DirectionalLight:()=>DirectionalLight,DirectionalLightHelper:()=>DirectionalLightHelper,DiscreteInterpolant:()=>DiscreteInterpolant,DodecahedronGeometry:()=>DodecahedronGeometry,DoubleSide:()=>b,DstAlphaFactor:()=>V,DstColorFactor:()=>H,DynamicCopyUsage:()=>jn,DynamicDrawUsage:()=>On,DynamicReadUsage:()=>Gn,EdgesGeometry:()=>EdgesGeometry,EllipseCurve:()=>EllipseCurve,EqualCompare:()=>In,EqualDepth:()=>te,EqualStencilFunc:()=>bn,EquirectangularReflectionMapping:()=>Ee,EquirectangularRefractionMapping:()=>be,Euler:()=>Euler,EventDispatcher:()=>EventDispatcher,ExtrudeGeometry:()=>ExtrudeGeometry,FileLoader:()=>FileLoader,Float16BufferAttribute:()=>Float16BufferAttribute,Float32BufferAttribute:()=>Float32BufferAttribute,FloatType:()=>je,Fog:()=>Fog,FogExp2:()=>FogExp2,FramebufferTexture:()=>FramebufferTexture,FrontSide:()=>g,Frustum:()=>Frustum,GLBufferAttribute:()=>GLBufferAttribute,GLSL1:()=>zn,GLSL3:()=>Wn,GreaterCompare:()=>Ln,GreaterDepth:()=>re,GreaterEqualCompare:()=>Pn,GreaterEqualDepth:()=>ne,GreaterEqualStencilFunc:()=>wn,GreaterStencilFunc:()=>_n,GridHelper:()=>GridHelper,Group:()=>Group,HalfFloatType:()=>He,HemisphereLight:()=>HemisphereLight,HemisphereLightHelper:()=>HemisphereLightHelper,IcosahedronGeometry:()=>IcosahedronGeometry,ImageBitmapLoader:()=>ImageBitmapLoader,ImageLoader:()=>ImageLoader,ImageUtils:()=>ImageUtils,IncrementStencilOp:()=>mn,IncrementWrapStencilOp:()=>gn,InstancedBufferAttribute:()=>InstancedBufferAttribute,InstancedBufferGeometry:()=>InstancedBufferGeometry,InstancedInterleavedBuffer:()=>InstancedInterleavedBuffer,InstancedMesh:()=>InstancedMesh,Int16BufferAttribute:()=>Int16BufferAttribute,Int32BufferAttribute:()=>Int32BufferAttribute,Int8BufferAttribute:()=>Int8BufferAttribute,IntType:()=>Ve,InterleavedBuffer:()=>InterleavedBuffer,InterleavedBufferAttribute:()=>InterleavedBufferAttribute,Interpolant:()=>Interpolant,InterpolateDiscrete:()=>jt,InterpolateLinear:()=>Ht,InterpolateSmooth:()=>zt,InvertStencilOp:()=>yn,KeepStencilOp:()=>pn,KeyframeTrack:()=>KeyframeTrack,LOD:()=>LOD,LatheGeometry:()=>LatheGeometry,Layers:()=>Layers,LessCompare:()=>Bn,LessDepth:()=>$,LessEqualCompare:()=>Rn,LessEqualDepth:()=>ee,LessEqualStencilFunc:()=>xn,LessStencilFunc:()=>En,Light:()=>Light,LightProbe:()=>LightProbe,Line:()=>Line,Line3:()=>Line3,LineBasicMaterial:()=>LineBasicMaterial,LineCurve:()=>LineCurve,LineCurve3:()=>LineCurve3,LineDashedMaterial:()=>LineDashedMaterial,LineLoop:()=>LineLoop,LineSegments:()=>LineSegments,LinearFilter:()=>Le,LinearInterpolant:()=>LinearInterpolant,LinearMipMapLinearFilter:()=>Ue,LinearMipMapNearestFilter:()=>Pe,LinearMipmapLinearFilter:()=>Fe,LinearMipmapNearestFilter:()=>De,LinearSRGBColorSpace:()=>cn,LinearToneMapping:()=>ce,LinearTransfer:()=>un,Loader:()=>Loader,LoaderUtils:()=>LoaderUtils,LoadingManager:()=>LoadingManager,LoopOnce:()=>Gt,LoopPingPong:()=>Qt,LoopRepeat:()=>Vt,LuminanceAlphaFormat:()=>$e,LuminanceFormat:()=>Ze,MOUSE:()=>a,Material:()=>Material,MaterialLoader:()=>MaterialLoader,MathUtils:()=>er,Matrix2:()=>Matrix2,Matrix3:()=>Matrix3,Matrix4:()=>Matrix4,MaxEquation:()=>P,Mesh:()=>Mesh,MeshBasicMaterial:()=>MeshBasicMaterial,MeshDepthMaterial:()=>MeshDepthMaterial,MeshDistanceMaterial:()=>MeshDistanceMaterial,MeshLambertMaterial:()=>MeshLambertMaterial,MeshMatcapMaterial:()=>MeshMatcapMaterial,MeshNormalMaterial:()=>MeshNormalMaterial,MeshPhongMaterial:()=>MeshPhongMaterial,MeshPhysicalMaterial:()=>MeshPhysicalMaterial,MeshStandardMaterial:()=>MeshStandardMaterial,MeshToonMaterial:()=>MeshToonMaterial,MinEquation:()=>D,MirroredRepeatWrapping:()=>we,MixOperation:()=>ae,MultiplyBlending:()=>S,MultiplyOperation:()=>se,NearestFilter:()=>Se,NearestMipMapLinearFilter:()=>Re,NearestMipMapNearestFilter:()=>Be,NearestMipmapLinearFilter:()=>Ie,NearestMipmapNearestFilter:()=>Te,NeutralToneMapping:()=>me,NeverCompare:()=>Tn,NeverDepth:()=>J,NeverStencilFunc:()=>Cn,NoBlending:()=>x,NoColorSpace:()=>on,NoToneMapping:()=>le,NormalAnimationBlendMode:()=>Xt,NormalBlending:()=>_,NotEqualCompare:()=>Dn,NotEqualDepth:()=>ie,NotEqualStencilFunc:()=>Mn,NumberKeyframeTrack:()=>NumberKeyframeTrack,Object3D:()=>Object3D,ObjectLoader:()=>ObjectLoader,ObjectSpaceNormalMap:()=>an,OctahedronGeometry:()=>OctahedronGeometry,OneFactor:()=>U,OneMinusConstantAlphaFactor:()=>Y,OneMinusConstantColorFactor:()=>K,OneMinusDstAlphaFactor:()=>j,OneMinusDstColorFactor:()=>z,OneMinusSrcAlphaFactor:()=>G,OneMinusSrcColorFactor:()=>k,OrthographicCamera:()=>OrthographicCamera,PCFShadowMap:()=>p,PCFSoftShadowMap:()=>f,Path:()=>Path,PerspectiveCamera:()=>PerspectiveCamera,Plane:()=>Plane,PlaneGeometry:()=>PlaneGeometry,PlaneHelper:()=>PlaneHelper,PointLight:()=>PointLight,PointLightHelper:()=>PointLightHelper,Points:()=>Points,PointsMaterial:()=>PointsMaterial,PolarGridHelper:()=>PolarGridHelper,PolyhedronGeometry:()=>PolyhedronGeometry,PositionalAudio:()=>PositionalAudio,PropertyBinding:()=>PropertyBinding,PropertyMixer:()=>PropertyMixer,QuadraticBezierCurve:()=>QuadraticBezierCurve,QuadraticBezierCurve3:()=>QuadraticBezierCurve3,Quaternion:()=>Quaternion,QuaternionKeyframeTrack:()=>QuaternionKeyframeTrack,QuaternionLinearInterpolant:()=>QuaternionLinearInterpolant,RAD2DEG:()=>$n,RED_GREEN_RGTC2_Format:()=>kt,RED_RGTC1_Format:()=>Ut,REVISION:()=>s,RGBADepthPacking:()=>tn,RGBAFormat:()=>Je,RGBAIntegerFormat:()=>ot,RGBA_ASTC_10x10_Format:()=>It,RGBA_ASTC_10x5_Format:()=>St,RGBA_ASTC_10x6_Format:()=>Tt,RGBA_ASTC_10x8_Format:()=>Bt,RGBA_ASTC_12x10_Format:()=>Rt,RGBA_ASTC_12x12_Format:()=>Lt,RGBA_ASTC_4x4_Format:()=>yt,RGBA_ASTC_5x4_Format:()=>Ct,RGBA_ASTC_5x5_Format:()=>Et,RGBA_ASTC_6x5_Format:()=>bt,RGBA_ASTC_6x6_Format:()=>xt,RGBA_ASTC_8x5_Format:()=>_t,RGBA_ASTC_8x6_Format:()=>Mt,RGBA_ASTC_8x8_Format:()=>wt,RGBA_BPTC_Format:()=>Dt,RGBA_ETC2_EAC_Format:()=>vt,RGBA_PVRTC_2BPPV1_Format:()=>mt,RGBA_PVRTC_4BPPV1_Format:()=>ft,RGBA_S3TC_DXT1_Format:()=>ct,RGBA_S3TC_DXT3_Format:()=>ut,RGBA_S3TC_DXT5_Format:()=>ht,RGBDepthPacking:()=>nn,RGBFormat:()=>Ye,RGBIntegerFormat:()=>at,RGB_BPTC_SIGNED_Format:()=>Pt,RGB_BPTC_UNSIGNED_Format:()=>Ft,RGB_ETC1_Format:()=>At,RGB_ETC2_Format:()=>gt,RGB_PVRTC_2BPPV1_Format:()=>pt,RGB_PVRTC_4BPPV1_Format:()=>dt,RGB_S3TC_DXT1_Format:()=>lt,RGDepthPacking:()=>rn,RGFormat:()=>it,RGIntegerFormat:()=>st,RawShaderMaterial:()=>RawShaderMaterial,Ray:()=>Ray,Raycaster:()=>Raycaster,RectAreaLight:()=>RectAreaLight,RedFormat:()=>nt,RedIntegerFormat:()=>rt,ReinhardToneMapping:()=>ue,RenderTarget:()=>RenderTarget,RenderTarget3D:()=>RenderTarget3D,RenderTargetArray:()=>RenderTargetArray,RepeatWrapping:()=>_e,ReplaceStencilOp:()=>fn,ReverseSubtractEquation:()=>L,RingGeometry:()=>RingGeometry,SIGNED_RED_GREEN_RGTC2_Format:()=>Nt,SIGNED_RED_RGTC1_Format:()=>Ot,SRGBColorSpace:()=>ln,SRGBTransfer:()=>hn,Scene:()=>Scene,ShaderMaterial:()=>ShaderMaterial,ShadowMaterial:()=>ShadowMaterial,Shape:()=>Shape,ShapeGeometry:()=>ShapeGeometry,ShapePath:()=>ShapePath,ShapeUtils:()=>ShapeUtils,ShortType:()=>Ne,Skeleton:()=>Skeleton,SkeletonHelper:()=>SkeletonHelper,SkinnedMesh:()=>SkinnedMesh,Source:()=>Source,Sphere:()=>Sphere,SphereGeometry:()=>SphereGeometry,Spherical:()=>Spherical,SphericalHarmonics3:()=>SphericalHarmonics3,SplineCurve:()=>SplineCurve,SpotLight:()=>SpotLight,SpotLightHelper:()=>SpotLightHelper,Sprite:()=>Sprite,SpriteMaterial:()=>SpriteMaterial,SrcAlphaFactor:()=>N,SrcAlphaSaturateFactor:()=>W,SrcColorFactor:()=>O,StaticCopyUsage:()=>Qn,StaticDrawUsage:()=>Un,StaticReadUsage:()=>Nn,StereoCamera:()=>StereoCamera,StreamCopyUsage:()=>Hn,StreamDrawUsage:()=>kn,StreamReadUsage:()=>Vn,StringKeyframeTrack:()=>StringKeyframeTrack,SubtractEquation:()=>R,SubtractiveBlending:()=>w,TOUCH:()=>o,TangentSpaceNormalMap:()=>sn,TetrahedronGeometry:()=>TetrahedronGeometry,Texture:()=>Texture,TextureLoader:()=>TextureLoader,TextureUtils:()=>Po,TimestampQuery:()=>Xn,TorusGeometry:()=>TorusGeometry,TorusKnotGeometry:()=>TorusKnotGeometry,Triangle:()=>Triangle,TriangleFanDrawMode:()=>$t,TriangleStripDrawMode:()=>Zt,TrianglesDrawMode:()=>Jt,TubeGeometry:()=>TubeGeometry,UVMapping:()=>ve,Uint16BufferAttribute:()=>Uint16BufferAttribute,Uint32BufferAttribute:()=>Uint32BufferAttribute,Uint8BufferAttribute:()=>Uint8BufferAttribute,Uint8ClampedBufferAttribute:()=>Uint8ClampedBufferAttribute,Uniform:()=>Uniform,UniformsGroup:()=>UniformsGroup,UniformsUtils:()=>es,UnsignedByteType:()=>Oe,UnsignedInt248Type:()=>qe,UnsignedInt5999Type:()=>Ke,UnsignedIntType:()=>Qe,UnsignedShort4444Type:()=>ze,UnsignedShort5551Type:()=>We,UnsignedShortType:()=>Ge,VSMShadowMap:()=>m,Vector2:()=>Vector2,Vector3:()=>Vector3,Vector4:()=>Vector4,VectorKeyframeTrack:()=>VectorKeyframeTrack,VideoFrameTexture:()=>VideoFrameTexture,VideoTexture:()=>VideoTexture,WebGL3DRenderTarget:()=>WebGL3DRenderTarget,WebGLArrayRenderTarget:()=>WebGLArrayRenderTarget,WebGLCoordinateSystem:()=>qn,WebGLCubeRenderTarget:()=>WebGLCubeRenderTarget,WebGLRenderTarget:()=>WebGLRenderTarget,WebGPUCoordinateSystem:()=>Kn,WebXRController:()=>WebXRController,WireframeGeometry:()=>WireframeGeometry,WrapAroundEnding:()=>Kt,ZeroCurvatureEnding:()=>Wt,ZeroFactor:()=>F,ZeroSlopeEnding:()=>qt,ZeroStencilOp:()=>dn,arrayNeedsUint32:()=>arrayNeedsUint32,cloneUniforms:()=>cloneUniforms,createCanvasElement:()=>createCanvasElement,createElementNS:()=>createElementNS,getByteLength:()=>getByteLength,getUnlitUniformColorSpace:()=>getUnlitUniformColorSpace,mergeUniforms:()=>mergeUniforms,probeAsync:()=>probeAsync,toNormalizedProjectionMatrix:()=>toNormalizedProjectionMatrix,toReversedProjectionMatrix:()=>toReversedProjectionMatrix,warnOnce:()=>warnOnce});
/**
         * @license
         * Copyright 2010-2025 Three.js Authors
         * SPDX-License-Identifier: MIT
         */const s="173";const a={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};const o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};const l=0;const c=1;const u=2;const h=3;const d=0;const p=1;const f=2;const m=3;const g=0;const y=1;const b=2;const x=0;const _=1;const M=2;const w=3;const S=4;const T=5;const I=100;const R=101;const L=102;const D=103;const P=104;const F=200;const U=201;const O=202;const k=203;const N=204;const G=205;const V=206;const j=207;const H=208;const z=209;const W=210;const q=211;const K=212;const X=213;const Y=214;const J=0;const Z=1;const $=2;const ee=3;const te=4;const ne=5;const re=6;const ie=7;const se=0;const ae=1;const oe=2;const le=0;const ce=1;const ue=2;const he=3;const de=4;const pe=5;const fe=6;const me=7;const Ae="attached";const ge="detached";const ve=300;const ye=301;const Ce=302;const Ee=303;const be=304;const xe=306;const _e=1e3;const Me=1001;const we=1002;const Se=1003;const Te=1004;const Be=1004;const Ie=1005;const Re=1005;const Le=1006;const De=1007;const Pe=1007;const Fe=1008;const Ue=1008;const Oe=1009;const ke=1010;const Ne=1011;const Ge=1012;const Ve=1013;const Qe=1014;const je=1015;const He=1016;const ze=1017;const We=1018;const qe=1020;const Ke=35902;const Xe=1021;const Ye=1022;const Je=1023;const Ze=1024;const $e=1025;const et=1026;const tt=1027;const nt=1028;const rt=1029;const it=1030;const st=1031;const at=1032;const ot=1033;const lt=33776;const ct=33777;const ut=33778;const ht=33779;const dt=35840;const pt=35841;const ft=35842;const mt=35843;const At=36196;const gt=37492;const vt=37496;const yt=37808;const Ct=37809;const Et=37810;const bt=37811;const xt=37812;const _t=37813;const Mt=37814;const wt=37815;const St=37816;const Tt=37817;const Bt=37818;const It=37819;const Rt=37820;const Lt=37821;const Dt=36492;const Pt=36494;const Ft=36495;const Ut=36283;const Ot=36284;const kt=36285;const Nt=36286;const Gt=2200;const Vt=2201;const Qt=2202;const jt=2300;const Ht=2301;const zt=2302;const Wt=2400;const qt=2401;const Kt=2402;const Xt=2500;const Yt=2501;const Jt=0;const Zt=1;const $t=2;const en=3200;const tn=3201;const nn=3202;const rn=3203;const sn=0;const an=1;const on="";const ln="srgb";const cn="srgb-linear";const un="linear";const hn="srgb";const dn=0;const pn=7680;const fn=7681;const mn=7682;const An=7683;const gn=34055;const vn=34056;const yn=5386;const Cn=512;const En=513;const bn=514;const xn=515;const _n=516;const Mn=517;const wn=518;const Sn=519;const Tn=512;const Bn=513;const In=514;const Rn=515;const Ln=516;const Dn=517;const Pn=518;const Fn=519;const Un=35044;const On=35048;const kn=35040;const Nn=35045;const Gn=35049;const Vn=35041;const Qn=35046;const jn=35050;const Hn=35042;const zn="100";const Wn="300 es";const qn=2e3;const Kn=2001;const Xn={COMPUTE:"compute",RENDER:"render"};class EventDispatcher{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]);n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n!==void 0&&(n[e]!==void 0&&n[e].indexOf(t)!==-1)}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const e=r.indexOf(t);e!==-1&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}}const Yn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Jn=1234567;const Zn=Math.PI/180;const $n=180/Math.PI;function generateUUID(){const e=Math.random()*4294967295|0;const t=Math.random()*4294967295|0;const n=Math.random()*4294967295|0;const r=Math.random()*4294967295|0;const s=Yn[e&255]+Yn[e>>8&255]+Yn[e>>16&255]+Yn[e>>24&255]+"-"+Yn[t&255]+Yn[t>>8&255]+"-"+Yn[t>>16&15|64]+Yn[t>>24&255]+"-"+Yn[n&63|128]+Yn[n>>8&255]+"-"+Yn[n>>16&255]+Yn[n>>24&255]+Yn[r&255]+Yn[r>>8&255]+Yn[r>>16&255]+Yn[r>>24&255];return s.toLowerCase()}function clamp(e,t,n){return Math.max(t,Math.min(n,e))}function euclideanModulo(e,t){return(e%t+t)%t}function mapLinear(e,t,n,r,s){return r+(e-t)*(s-r)/(n-t)}function inverseLerp(e,t,n){return e!==t?(n-e)/(t-e):0}function lerp(e,t,n){return(1-n)*e+n*t}function damp(e,t,n,r){return lerp(e,t,1-Math.exp(-n*r))}function pingpong(e,t=1){return t-Math.abs(euclideanModulo(e,t*2)-t)}function smoothstep(e,t,n){if(e<=t)return 0;if(e>=n)return 1;e=(e-t)/(n-t);return e*e*(3-2*e)}function smootherstep(e,t,n){if(e<=t)return 0;if(e>=n)return 1;e=(e-t)/(n-t);return e*e*e*(e*(e*6-15)+10)}function randInt(e,t){return e+Math.floor(Math.random()*(t-e+1))}function randFloat(e,t){return e+Math.random()*(t-e)}function randFloatSpread(e){return e*(.5-Math.random())}function seededRandom(e){e!==void 0&&(Jn=e);let t=Jn+=1831565813;t=Math.imul(t^t>>>15,t|1);t^=t+Math.imul(t^t>>>7,t|61);return((t^t>>>14)>>>0)/4294967296}function degToRad(e){return e*Zn}function radToDeg(e){return e*$n}function isPowerOfTwo(e){return(e&e-1)===0&&e!==0}function ceilPowerOfTwo(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function floorPowerOfTwo(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function setQuaternionFromProperEuler(e,t,n,r,s){const a=Math.cos;const o=Math.sin;const l=a(n/2);const c=o(n/2);const u=a((t+r)/2);const h=o((t+r)/2);const d=a((t-r)/2);const p=o((t-r)/2);const f=a((r-t)/2);const m=o((r-t)/2);switch(s){case"XYX":e.set(l*h,c*d,c*p,l*u);break;case"YZY":e.set(c*p,l*h,c*d,l*u);break;case"ZXZ":e.set(c*d,c*p,l*h,l*u);break;case"XZX":e.set(l*h,c*m,c*f,l*u);break;case"YXY":e.set(c*f,l*h,c*m,l*u);break;case"ZYZ":e.set(c*m,c*f,l*h,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function denormalize(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function normalize(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}const er={DEG2RAD:Zn,RAD2DEG:$n,generateUUID:generateUUID,clamp:clamp,euclideanModulo:euclideanModulo,mapLinear:mapLinear,inverseLerp:inverseLerp,lerp:lerp,damp:damp,pingpong:pingpong,smoothstep:smoothstep,smootherstep:smootherstep,randInt:randInt,randFloat:randFloat,randFloatSpread:randFloatSpread,seededRandom:seededRandom,degToRad:degToRad,radToDeg:radToDeg,isPowerOfTwo:isPowerOfTwo,ceilPowerOfTwo:ceilPowerOfTwo,floorPowerOfTwo:floorPowerOfTwo,setQuaternionFromProperEuler:setQuaternionFromProperEuler,normalize:normalize,denormalize:denormalize};class Vector2{constructor(e=0,t=0){Vector2.prototype.isVector2=true;this.x=e;this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){this.x=e;this.y=t;return this}setScalar(e){this.x=e;this.y=e;return this}setX(e){this.x=e;return this}setY(e){this.y=e;return this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){this.x=e.x;this.y=e.y;return this}add(e){this.x+=e.x;this.y+=e.y;return this}addScalar(e){this.x+=e;this.y+=e;return this}addVectors(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this}addScaledVector(e,t){this.x+=e.x*t;this.y+=e.y*t;return this}sub(e){this.x-=e.x;this.y-=e.y;return this}subScalar(e){this.x-=e;this.y-=e;return this}subVectors(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this}multiply(e){this.x*=e.x;this.y*=e.y;return this}multiplyScalar(e){this.x*=e;this.y*=e;return this}divide(e){this.x/=e.x;this.y/=e.y;return this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y;const r=e.elements;this.x=r[0]*t+r[3]*n+r[6];this.y=r[1]*t+r[4]*n+r[7];return this}min(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);return this}max(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);return this}clamp(e,t){this.x=clamp(this.x,e.x,t.x);this.y=clamp(this.y,e.y,t.y);return this}clampScalar(e,t){this.x=clamp(this.x,e,t);this.y=clamp(this.y,e,t);return this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(clamp(n,e,t))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);return this}negate(){this.x=-this.x;this.y=-this.y;return this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){const e=Math.atan2(-this.y,-this.x)+Math.PI;return e}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(clamp(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this}lerpVectors(e,t,n){this.x=e.x+(t.x-e.x)*n;this.y=e.y+(t.y-e.y)*n;return this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){this.x=e[t];this.y=e[t+1];return this}toArray(e=[],t=0){e[t]=this.x;e[t+1]=this.y;return e}fromBufferAttribute(e,t){this.x=e.getX(t);this.y=e.getY(t);return this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t);const s=this.x-e.x;const a=this.y-e.y;this.x=s*n-a*r+e.x;this.y=s*r+a*n+e.y;return this}random(){this.x=Math.random();this.y=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y}}class Matrix3{constructor(e,t,n,r,s,a,o,l,c){Matrix3.prototype.isMatrix3=true;this.elements=[1,0,0,0,1,0,0,0,1];e!==void 0&&this.set(e,t,n,r,s,a,o,l,c)}set(e,t,n,r,s,a,o,l,c){const u=this.elements;u[0]=e;u[1]=r;u[2]=o;u[3]=t;u[4]=s;u[5]=l;u[6]=n;u[7]=a;u[8]=c;return this}identity(){this.set(1,0,0,0,1,0,0,0,1);return this}copy(e){const t=this.elements;const n=e.elements;t[0]=n[0];t[1]=n[1];t[2]=n[2];t[3]=n[3];t[4]=n[4];t[5]=n[5];t[6]=n[6];t[7]=n[7];t[8]=n[8];return this}extractBasis(e,t,n){e.setFromMatrix3Column(this,0);t.setFromMatrix3Column(this,1);n.setFromMatrix3Column(this,2);return this}setFromMatrix4(e){const t=e.elements;this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]);return this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements;const r=t.elements;const s=this.elements;const a=n[0],o=n[3],l=n[6];const c=n[1],u=n[4],h=n[7];const d=n[2],p=n[5],f=n[8];const m=r[0],g=r[3],y=r[6];const b=r[1],x=r[4],_=r[7];const M=r[2],w=r[5],S=r[8];s[0]=a*m+o*b+l*M;s[3]=a*g+o*x+l*w;s[6]=a*y+o*_+l*S;s[1]=c*m+u*b+h*M;s[4]=c*g+u*x+h*w;s[7]=c*y+u*_+h*S;s[2]=d*m+p*b+f*M;s[5]=d*g+p*x+f*w;s[8]=d*y+p*_+f*S;return this}multiplyScalar(e){const t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this}determinant(){const e=this.elements;const t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8];return t*a*u-t*o*c-n*s*u+n*o*l+r*s*c-r*a*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=u*a-o*c,d=o*l-u*s,p=c*s-a*l,f=t*h+n*d+r*p;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/f;e[0]=h*m;e[1]=(r*c-u*n)*m;e[2]=(o*n-r*a)*m;e[3]=d*m;e[4]=(u*t-r*l)*m;e[5]=(r*s-o*t)*m;e[6]=p*m;e[7]=(n*l-c*t)*m;e[8]=(a*t-n*s)*m;return this}transpose(){let e;const t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this}setUvTransform(e,t,n,r,s,a,o){const l=Math.cos(s);const c=Math.sin(s);this.set(n*l,n*c,-n*(l*a+c*o)+a+e,-r*c,r*l,-r*(-c*a+l*o)+o+t,0,0,1);return this}scale(e,t){this.premultiply(tr.makeScale(e,t));return this}rotate(e){this.premultiply(tr.makeRotation(-e));return this}translate(e,t){this.premultiply(tr.makeTranslation(e,t));return this}makeTranslation(e,t){e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1);return this}makeRotation(e){const t=Math.cos(e);const n=Math.sin(e);this.set(t,-n,0,n,t,0,0,0,1);return this}makeScale(e,t){this.set(e,0,0,0,t,0,0,0,1);return this}equals(e){const t=this.elements;const n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return false;return true}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;e[t]=n[0];e[t+1]=n[1];e[t+2]=n[2];e[t+3]=n[3];e[t+4]=n[4];e[t+5]=n[5];e[t+6]=n[6];e[t+7]=n[7];e[t+8]=n[8];return e}clone(){return(new this.constructor).fromArray(this.elements)}}const tr=new Matrix3;function arrayNeedsUint32(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return true;return false}const nr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function getTypedArray(e,t){return new nr[e](t)}function createElementNS(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function createCanvasElement(){const e=createElementNS("canvas");e.style.display="block";return e}const rr={};function warnOnce(e){if(!(e in rr)){rr[e]=true;console.warn(e)}}function probeAsync(e,t,n){return new Promise((function(r,s){function probe(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:s();break;case e.TIMEOUT_EXPIRED:setTimeout(probe,n);break;default:r()}}setTimeout(probe,n)}))}function toNormalizedProjectionMatrix(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3];t[6]=.5*t[6]+.5*t[7];t[10]=.5*t[10]+.5*t[11];t[14]=.5*t[14]+.5*t[15]}function toReversedProjectionMatrix(e){const t=e.elements;const n=t[11]===-1;if(n){t[10]=-t[10]-1;t[14]=-t[14]}else{t[10]=-t[10];t[14]=1-t[14]}}const ir=(new Matrix3).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322);const sr=(new Matrix3).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function createColorManagement(){const e={enabled:true,workingColorSpace:cn,spaces:{},convert:function(e,n,r){if((this||t).enabled===false||n===r||!n||!r)return e;if((this||t).spaces[n].transfer===hn){e.r=SRGBToLinear(e.r);e.g=SRGBToLinear(e.g);e.b=SRGBToLinear(e.b)}if((this||t).spaces[n].primaries!==(this||t).spaces[r].primaries){e.applyMatrix3((this||t).spaces[n].toXYZ);e.applyMatrix3((this||t).spaces[r].fromXYZ)}if((this||t).spaces[r].transfer===hn){e.r=LinearToSRGB(e.r);e.g=LinearToSRGB(e.g);e.b=LinearToSRGB(e.b)}return e},fromWorkingColorSpace:function(e,n){return this.convert(e,(this||t).workingColorSpace,n)},toWorkingColorSpace:function(e,n){return this.convert(e,n,(this||t).workingColorSpace)},getPrimaries:function(e){return(this||t).spaces[e].primaries},getTransfer:function(e){return e===on?un:(this||t).spaces[e].transfer},getLuminanceCoefficients:function(e,n=(this||t).workingColorSpace){return e.fromArray((this||t).spaces[n].luminanceCoefficients)},define:function(e){Object.assign((this||t).spaces,e)},_getMatrix:function(e,n,r){return e.copy((this||t).spaces[n].toXYZ).multiply((this||t).spaces[r].fromXYZ)},_getDrawingBufferColorSpace:function(e){return(this||t).spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=(this||t).workingColorSpace){return(this||t).spaces[e].workingColorSpaceConfig.unpackColorSpace}};const n=[.64,.33,.3,.6,.15,.06];const r=[.2126,.7152,.0722];const s=[.3127,.329];e.define({[cn]:{primaries:n,whitePoint:s,transfer:un,toXYZ:ir,fromXYZ:sr,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:ln},outputColorSpaceConfig:{drawingBufferColorSpace:ln}},[ln]:{primaries:n,whitePoint:s,transfer:hn,toXYZ:ir,fromXYZ:sr,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:ln}}});return e}const ar=createColorManagement();function SRGBToLinear(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function LinearToSRGB(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}let or;class ImageUtils{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if(typeof HTMLCanvasElement==="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{or===void 0&&(or=createElementNS("canvas"));or.width=e.width;or.height=e.height;const n=or.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height);t=or}return t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement!=="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&e instanceof ImageBitmap){const t=createElementNS("canvas");t.width=e.width;t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height);const s=r.data;for(let e=0;e<s.length;e++)s[e]=SRGBToLinear(s[e]/255)*255;n.putImageData(r,0,0);return t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(SRGBToLinear(t[e]/255)*255):t[e]=SRGBToLinear(t[e]);return{data:t,width:e.width,height:e.height}}console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.");return e}}let lr=0;class Source{constructor(e=null){this.isSource=true;Object.defineProperty(this,"id",{value:lr++});this.uuid=generateUUID();this.data=e;this.dataReady=true;this.version=0}set needsUpdate(e){e===true&&this.version++}toJSON(e){const t=e===void 0||typeof e==="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""};const r=this.data;if(r!==null){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(serializeImage(r[t].image)):e.push(serializeImage(r[t]))}else e=serializeImage(r);n.url=e}t||(e.images[this.uuid]=n);return n}}function serializeImage(e){if(typeof HTMLImageElement!=="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&e instanceof ImageBitmap)return ImageUtils.getDataURL(e);if(e.data)return{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name};console.warn("THREE.Texture: Unable to serialize Texture.");return{}}let cr=0;class Texture extends EventDispatcher{constructor(e=Texture.DEFAULT_IMAGE,t=Texture.DEFAULT_MAPPING,n=Me,r=Me,s=Le,a=Fe,o=Je,l=Oe,c=Texture.DEFAULT_ANISOTROPY,u=on){super();this.isTexture=true;Object.defineProperty(this,"id",{value:cr++});this.uuid=generateUUID();this.name="";this.source=new Source(e);this.mipmaps=[];this.mapping=t;this.channel=0;this.wrapS=n;this.wrapT=r;this.magFilter=s;this.minFilter=a;this.anisotropy=c;this.format=o;this.internalFormat=null;this.type=l;this.offset=new Vector2(0,0);this.repeat=new Vector2(1,1);this.center=new Vector2(0,0);this.rotation=0;this.matrixAutoUpdate=true;this.matrix=new Matrix3;this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.colorSpace=u;this.userData={};this.version=0;this.onUpdate=null;this.renderTarget=null;this.isRenderTargetTexture=false;this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name;this.source=e.source;this.mipmaps=e.mipmaps.slice(0);this.mapping=e.mapping;this.channel=e.channel;this.wrapS=e.wrapS;this.wrapT=e.wrapT;this.magFilter=e.magFilter;this.minFilter=e.minFilter;this.anisotropy=e.anisotropy;this.format=e.format;this.internalFormat=e.internalFormat;this.type=e.type;this.offset.copy(e.offset);this.repeat.copy(e.repeat);this.center.copy(e.center);this.rotation=e.rotation;this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrix.copy(e.matrix);this.generateMipmaps=e.generateMipmaps;this.premultiplyAlpha=e.premultiplyAlpha;this.flipY=e.flipY;this.unpackAlignment=e.unpackAlignment;this.colorSpace=e.colorSpace;this.renderTarget=e.renderTarget;this.isRenderTargetTexture=e.isRenderTargetTexture;this.userData=JSON.parse(JSON.stringify(e.userData));this.needsUpdate=true;return this}toJSON(e){const t=e===void 0||typeof e==="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};Object.keys(this.userData).length>0&&(n.userData=this.userData);t||(e.textures[this.uuid]=n);return n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ve)return e;e.applyMatrix3(this.matrix);if(e.x<0||e.x>1)switch(this.wrapS){case _e:e.x=e.x-Math.floor(e.x);break;case Me:e.x=e.x<0?0:1;break;case we:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case _e:e.y=e.y-Math.floor(e.y);break;case Me:e.y=e.y<0?0:1;break;case we:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}this.flipY&&(e.y=1-e.y);return e}set needsUpdate(e){if(e===true){this.version++;this.source.needsUpdate=true}}set needsPMREMUpdate(e){e===true&&this.pmremVersion++}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=ve;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(e=0,t=0,n=0,r=1){Vector4.prototype.isVector4=true;this.x=e;this.y=t;this.z=n;this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){this.x=e;this.y=t;this.z=n;this.w=r;return this}setScalar(e){this.x=e;this.y=e;this.z=e;this.w=e;return this}setX(e){this.x=e;return this}setY(e){this.y=e;return this}setZ(e){this.z=e;return this}setW(e){this.w=e;return this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w!==void 0?e.w:1;return this}add(e){this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this}addScalar(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this}addVectors(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;this.w=e.w+t.w;return this}addScaledVector(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;this.w+=e.w*t;return this}sub(e){this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this}subScalar(e){this.x-=e;this.y-=e;this.z-=e;this.w-=e;return this}subVectors(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;this.w=e.w-t.w;return this}multiply(e){this.x*=e.x;this.y*=e.y;this.z*=e.z;this.w*=e.w;return this}multiplyScalar(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w;const a=e.elements;this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s;this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s;this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s;this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s;return this}divide(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;this.w/=e.w;return this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);if(t<1e-4){this.x=1;this.y=0;this.z=0}else{this.x=e.x/t;this.y=e.y/t;this.z=e.z/t}return this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const a=.01,o=.1,l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],p=l[5],f=l[9],m=l[2],g=l[6],y=l[10];if(Math.abs(u-d)<a&&Math.abs(h-m)<a&&Math.abs(f-g)<a){if(Math.abs(u+d)<o&&Math.abs(h+m)<o&&Math.abs(f+g)<o&&Math.abs(c+p+y-3)<o){this.set(1,0,0,0);return this}t=Math.PI;const e=(c+1)/2;const l=(p+1)/2;const b=(y+1)/2;const x=(u+d)/4;const _=(h+m)/4;const M=(f+g)/4;if(e>l&&e>b)if(e<a){n=0;r=.707106781;s=.707106781}else{n=Math.sqrt(e);r=x/n;s=_/n}else if(l>b)if(l<a){n=.707106781;r=0;s=.707106781}else{r=Math.sqrt(l);n=x/r;s=M/r}else if(b<a){n=.707106781;r=.707106781;s=0}else{s=Math.sqrt(b);n=_/s;r=M/s}this.set(n,r,s,t);return this}let b=Math.sqrt((g-f)*(g-f)+(h-m)*(h-m)+(d-u)*(d-u));Math.abs(b)<.001&&(b=1);this.x=(g-f)/b;this.y=(h-m)/b;this.z=(d-u)/b;this.w=Math.acos((c+p+y-1)/2);return this}setFromMatrixPosition(e){const t=e.elements;this.x=t[12];this.y=t[13];this.z=t[14];this.w=t[15];return this}min(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);this.w=Math.min(this.w,e.w);return this}max(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);this.w=Math.max(this.w,e.w);return this}clamp(e,t){this.x=clamp(this.x,e.x,t.x);this.y=clamp(this.y,e.y,t.y);this.z=clamp(this.z,e.z,t.z);this.w=clamp(this.w,e.w,t.w);return this}clampScalar(e,t){this.x=clamp(this.x,e,t);this.y=clamp(this.y,e,t);this.z=clamp(this.z,e,t);this.w=clamp(this.w,e,t);return this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(clamp(n,e,t))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);this.w=Math.trunc(this.w);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;this.w+=(e.w-this.w)*t;return this}lerpVectors(e,t,n){this.x=e.x+(t.x-e.x)*n;this.y=e.y+(t.y-e.y)*n;this.z=e.z+(t.z-e.z)*n;this.w=e.w+(t.w-e.w)*n;return this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){this.x=e[t];this.y=e[t+1];this.z=e[t+2];this.w=e[t+3];return this}toArray(e=[],t=0){e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;e[t+3]=this.w;return e}fromBufferAttribute(e,t){this.x=e.getX(t);this.y=e.getY(t);this.z=e.getZ(t);this.w=e.getW(t);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();this.w=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z;yield this.w}}class RenderTarget extends EventDispatcher{constructor(e=1,t=1,n={}){super();this.isRenderTarget=true;this.width=e;this.height=t;this.depth=1;this.scissor=new Vector4(0,0,e,t);this.scissorTest=false;this.viewport=new Vector4(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:false,internalFormat:null,minFilter:Le,depthBuffer:true,stencilBuffer:false,resolveDepthBuffer:true,resolveStencilBuffer:true,depthTexture:null,samples:0,count:1},n);const s=new Texture(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=false;s.generateMipmaps=n.generateMipmaps;s.internalFormat=n.internalFormat;this.textures=[];const a=n.count;for(let e=0;e<a;e++){this.textures[e]=s.clone();this.textures[e].isRenderTargetTexture=true;this.textures[e].renderTarget=this}this.depthBuffer=n.depthBuffer;this.stencilBuffer=n.stencilBuffer;this.resolveDepthBuffer=n.resolveDepthBuffer;this.resolveStencilBuffer=n.resolveStencilBuffer;this._depthTexture=null;this.depthTexture=n.depthTexture;this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null);e!==null&&(e.renderTarget=this);this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e;this.height=t;this.depth=n;for(let r=0,s=this.textures.length;r<s;r++){this.textures[r].image.width=e;this.textures[r].image.height=t;this.textures[r].image.depth=n}this.dispose()}this.viewport.set(0,0,e,t);this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width;this.height=e.height;this.depth=e.depth;this.scissor.copy(e.scissor);this.scissorTest=e.scissorTest;this.viewport.copy(e.viewport);this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone();this.textures[t].isRenderTargetTexture=true;this.textures[t].renderTarget=this}const t=Object.assign({},e.texture.image);this.texture.source=new Source(t);this.depthBuffer=e.depthBuffer;this.stencilBuffer=e.stencilBuffer;this.resolveDepthBuffer=e.resolveDepthBuffer;this.resolveStencilBuffer=e.resolveStencilBuffer;e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone());this.samples=e.samples;return this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(e=1,t=1,n={}){super(e,t,n);this.isWebGLRenderTarget=true}}class DataArrayTexture extends Texture{constructor(e=null,t=1,n=1,r=1){super(null);this.isDataArrayTexture=true;this.image={data:e,width:t,height:n,depth:r};this.magFilter=Se;this.minFilter=Se;this.wrapR=Me;this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1;this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(e=1,t=1,n=1,r={}){super(e,t,r);this.isWebGLArrayRenderTarget=true;this.depth=n;this.texture=new DataArrayTexture(null,e,t,n);this.texture.isRenderTargetTexture=true}}class Data3DTexture extends Texture{constructor(e=null,t=1,n=1,r=1){super(null);this.isData3DTexture=true;this.image={data:e,width:t,height:n,depth:r};this.magFilter=Se;this.minFilter=Se;this.wrapR=Me;this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(e=1,t=1,n=1,r={}){super(e,t,r);this.isWebGL3DRenderTarget=true;this.depth=n;this.texture=new Data3DTexture(null,e,t,n);this.texture.isRenderTargetTexture=true}}class Quaternion{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=true;this._x=e;this._y=t;this._z=n;this._w=r}static slerpFlat(e,t,n,r,s,a,o){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[a+0],p=s[a+1],f=s[a+2],m=s[a+3];if(o!==0)if(o!==1){if(h!==m||l!==d||c!==p||u!==f){let e=1-o;const t=l*d+c*p+u*f+h*m,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const s=Math.sqrt(r),a=Math.atan2(s,t*n);e=Math.sin(e*a)/s;o=Math.sin(o*a)/s}const s=o*n;l=l*e+d*s;c=c*e+p*s;u=u*e+f*s;h=h*e+m*s;if(e===1-o){const e=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=e;c*=e;u*=e;h*=e}}e[t]=l;e[t+1]=c;e[t+2]=u;e[t+3]=h}else{e[t+0]=d;e[t+1]=p;e[t+2]=f;e[t+3]=m}else{e[t+0]=l;e[t+1]=c;e[t+2]=u;e[t+3]=h}}static multiplyQuaternionsFlat(e,t,n,r,s,a){const o=n[r];const l=n[r+1];const c=n[r+2];const u=n[r+3];const h=s[a];const d=s[a+1];const p=s[a+2];const f=s[a+3];e[t]=o*f+u*h+l*p-c*d;e[t+1]=l*f+u*d+c*h-o*p;e[t+2]=c*f+u*p+o*d-l*h;e[t+3]=u*f-o*h-l*d-c*p;return e}get x(){return this._x}set x(e){this._x=e;this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e;this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e;this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e;this._onChangeCallback()}set(e,t,n,r){this._x=e;this._y=t;this._z=n;this._w=r;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){this._x=e.x;this._y=e.y;this._z=e.z;this._w=e.w;this._onChangeCallback();return this}setFromEuler(e,t=true){const n=e._x,r=e._y,s=e._z,a=e._order;const o=Math.cos;const l=Math.sin;const c=o(n/2);const u=o(r/2);const h=o(s/2);const d=l(n/2);const p=l(r/2);const f=l(s/2);switch(a){case"XYZ":this._x=d*u*h+c*p*f;this._y=c*p*h-d*u*f;this._z=c*u*f+d*p*h;this._w=c*u*h-d*p*f;break;case"YXZ":this._x=d*u*h+c*p*f;this._y=c*p*h-d*u*f;this._z=c*u*f-d*p*h;this._w=c*u*h+d*p*f;break;case"ZXY":this._x=d*u*h-c*p*f;this._y=c*p*h+d*u*f;this._z=c*u*f+d*p*h;this._w=c*u*h-d*p*f;break;case"ZYX":this._x=d*u*h-c*p*f;this._y=c*p*h+d*u*f;this._z=c*u*f-d*p*h;this._w=c*u*h+d*p*f;break;case"YZX":this._x=d*u*h+c*p*f;this._y=c*p*h+d*u*f;this._z=c*u*f-d*p*h;this._w=c*u*h-d*p*f;break;case"XZY":this._x=d*u*h-c*p*f;this._y=c*p*h-d*u*f;this._z=c*u*f+d*p*h;this._w=c*u*h+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}t===true&&this._onChangeCallback();return this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);this._x=e.x*r;this._y=e.y*r;this._z=e.z*r;this._w=Math.cos(n);this._onChangeCallback();return this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=n+o+h;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e;this._x=(u-l)*e;this._y=(s-c)*e;this._z=(a-r)*e}else if(n>o&&n>h){const e=2*Math.sqrt(1+n-o-h);this._w=(u-l)/e;this._x=.25*e;this._y=(r+a)/e;this._z=(s+c)/e}else if(o>h){const e=2*Math.sqrt(1+o-n-h);this._w=(s-c)/e;this._x=(r+a)/e;this._y=.25*e;this._z=(l+u)/e}else{const e=2*Math.sqrt(1+h-n-o);this._w=(a-r)/e;this._x=(s+c)/e;this._y=(l+u)/e;this._z=.25*e}this._onChangeCallback();return this}setFromUnitVectors(e,t){let n=e.dot(t)+1;if(n<Number.EPSILON){n=0;if(Math.abs(e.x)>Math.abs(e.z)){this._x=-e.y;this._y=e.x;this._z=0;this._w=n}else{this._x=0;this._y=-e.z;this._z=e.y;this._w=n}}else{this._x=e.y*t.z-e.z*t.y;this._y=e.z*t.x-e.x*t.z;this._z=e.x*t.y-e.y*t.x;this._w=n}return this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(clamp(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);this.slerp(e,r);return this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){this._x*=-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();if(e===0){this._x=0;this._y=0;this._z=0;this._w=1}else{e=1/e;this._x=this._x*e;this._y=this._y*e;this._z=this._z*e;this._w=this._w*e}this._onChangeCallback();return this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w;const o=t._x,l=t._y,c=t._z,u=t._w;this._x=n*u+a*o+r*c-s*l;this._y=r*u+a*l+s*o-n*c;this._z=s*u+a*c+n*l-r*o;this._w=a*u-n*o-r*l-s*c;this._onChangeCallback();return this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+n*e._x+r*e._y+s*e._z;if(o<0){this._w=-e._w;this._x=-e._x;this._y=-e._y;this._z=-e._z;o=-o}else this.copy(e);if(o>=1){this._w=a;this._x=n;this._y=r;this._z=s;return this}const l=1-o*o;if(l<=Number.EPSILON){const e=1-t;this._w=e*a+t*this._w;this._x=e*n+t*this._x;this._y=e*r+t*this._y;this._z=e*s+t*this._z;this.normalize();return this}const c=Math.sqrt(l);const u=Math.atan2(c,o);const h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;this._w=a*h+this._w*d;this._x=n*h+this._x*d;this._y=r*h+this._y*d;this._z=s*h+this._z*d;this._onChangeCallback();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random();const t=2*Math.PI*Math.random();const n=Math.random();const r=Math.sqrt(1-n);const s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){this._x=e[t];this._y=e[t+1];this._z=e[t+2];this._w=e[t+3];this._onChangeCallback();return this}toArray(e=[],t=0){e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._w;return e}fromBufferAttribute(e,t){this._x=e.getX(t);this._y=e.getY(t);this._z=e.getZ(t);this._w=e.getW(t);this._onChangeCallback();return this}toJSON(){return this.toArray()}_onChange(e){this._onChangeCallback=e;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._w}}class Vector3{constructor(e=0,t=0,n=0){Vector3.prototype.isVector3=true;this.x=e;this.y=t;this.z=n}set(e,t,n){n===void 0&&(n=this.z);this.x=e;this.y=t;this.z=n;return this}setScalar(e){this.x=e;this.y=e;this.z=e;return this}setX(e){this.x=e;return this}setY(e){this.y=e;return this}setZ(e){this.z=e;return this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){this.x=e.x;this.y=e.y;this.z=e.z;return this}add(e){this.x+=e.x;this.y+=e.y;this.z+=e.z;return this}addScalar(e){this.x+=e;this.y+=e;this.z+=e;return this}addVectors(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this}addScaledVector(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;return this}sub(e){this.x-=e.x;this.y-=e.y;this.z-=e.z;return this}subScalar(e){this.x-=e;this.y-=e;this.z-=e;return this}subVectors(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this}multiply(e){this.x*=e.x;this.y*=e.y;this.z*=e.z;return this}multiplyScalar(e){this.x*=e;this.y*=e;this.z*=e;return this}multiplyVectors(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this}applyEuler(e){return this.applyQuaternion(hr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(hr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z;const s=e.elements;this.x=s[0]*t+s[3]*n+s[6]*r;this.y=s[1]*t+s[4]*n+s[7]*r;this.z=s[2]*t+s[5]*n+s[8]*r;return this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z;const s=e.elements;const a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a;this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a;this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a;return this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z;const s=e.x,a=e.y,o=e.z,l=e.w;const c=2*(a*r-o*n);const u=2*(o*t-s*r);const h=2*(s*n-a*t);this.x=t+l*c+a*h-o*u;this.y=n+l*u+o*c-s*h;this.z=r+l*h+s*u-a*c;return this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z;const s=e.elements;this.x=s[0]*t+s[4]*n+s[8]*r;this.y=s[1]*t+s[5]*n+s[9]*r;this.z=s[2]*t+s[6]*n+s[10]*r;return this.normalize()}divide(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);return this}max(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);return this}clamp(e,t){this.x=clamp(this.x,e.x,t.x);this.y=clamp(this.y,e.y,t.y);this.z=clamp(this.z,e.z,t.z);return this}clampScalar(e,t){this.x=clamp(this.x,e,t);this.y=clamp(this.y,e,t);this.z=clamp(this.z,e,t);return this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(clamp(n,e,t))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this}lerpVectors(e,t,n){this.x=e.x+(t.x-e.x)*n;this.y=e.y+(t.y-e.y)*n;this.z=e.z+(t.z-e.z)*n;return this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z;const a=t.x,o=t.y,l=t.z;this.x=r*l-s*o;this.y=s*a-n*l;this.z=n*o-r*a;return this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){ur.copy(this).projectOnVector(e);return this.sub(ur)}reflect(e){return this.sub(ur.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(clamp(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;this.x=r*Math.sin(n);this.y=Math.cos(t)*e;this.z=r*Math.cos(n);return this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){this.x=e*Math.sin(t);this.y=n;this.z=e*Math.cos(t);return this}setFromMatrixPosition(e){const t=e.elements;this.x=t[12];this.y=t[13];this.z=t[14];return this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length();const n=this.setFromMatrixColumn(e,1).length();const r=this.setFromMatrixColumn(e,2).length();this.x=t;this.y=n;this.z=r;return this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){this.x=e._x;this.y=e._y;this.z=e._z;return this}setFromColor(e){this.x=e.r;this.y=e.g;this.z=e.b;return this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){this.x=e[t];this.y=e[t+1];this.z=e[t+2];return this}toArray(e=[],t=0){e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;return e}fromBufferAttribute(e,t){this.x=e.getX(t);this.y=e.getY(t);this.z=e.getZ(t);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this}randomDirection(){const e=Math.random()*Math.PI*2;const t=Math.random()*2-1;const n=Math.sqrt(1-t*t);this.x=n*Math.cos(e);this.y=t;this.z=n*Math.sin(e);return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z}}const ur=new Vector3;const hr=new Quaternion;class Box3{constructor(e=new Vector3(Infinity,Infinity,Infinity),t=new Vector3(-Infinity,-Infinity,-Infinity)){this.isBox3=true;this.min=e;this.max=t}set(e,t){this.min.copy(e);this.max.copy(t);return this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(pr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(pr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=pr.copy(t).multiplyScalar(.5);this.min.copy(e).sub(n);this.max.copy(e).add(n);return this}setFromObject(e,t=false){this.makeEmpty();return this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.min.copy(e.min);this.max.copy(e.max);return this}makeEmpty(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){this.min.min(e);this.max.max(e);return this}expandByVector(e){this.min.sub(e);this.max.add(e);return this}expandByScalar(e){this.min.addScalar(-e);this.max.addScalar(e);return this}expandByObject(e,t=false){e.updateWorldMatrix(false,false);const n=e.geometry;if(n!==void 0){const r=n.getAttribute("position");if(t===true&&r!==void 0&&e.isInstancedMesh!==true)for(let t=0,n=r.count;t<n;t++){e.isMesh===true?e.getVertexPosition(t,pr):pr.fromBufferAttribute(r,t);pr.applyMatrix4(e.matrixWorld);this.expandByPoint(pr)}else{if(e.boundingBox!==void 0){e.boundingBox===null&&e.computeBoundingBox();fr.copy(e.boundingBox)}else{n.boundingBox===null&&n.computeBoundingBox();fr.copy(n.boundingBox)}fr.applyMatrix4(e.matrixWorld);this.union(fr)}}const r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject(r[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){this.clampPoint(e.center,pr);return pr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;if(e.normal.x>0){t=e.normal.x*this.min.x;n=e.normal.x*this.max.x}else{t=e.normal.x*this.max.x;n=e.normal.x*this.min.x}if(e.normal.y>0){t+=e.normal.y*this.min.y;n+=e.normal.y*this.max.y}else{t+=e.normal.y*this.max.y;n+=e.normal.y*this.min.y}if(e.normal.z>0){t+=e.normal.z*this.min.z;n+=e.normal.z*this.max.z}else{t+=e.normal.z*this.max.z;n+=e.normal.z*this.min.z}return t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return false;this.getCenter(Er);br.subVectors(this.max,Er);mr.subVectors(e.a,Er);Ar.subVectors(e.b,Er);gr.subVectors(e.c,Er);vr.subVectors(Ar,mr);yr.subVectors(gr,Ar);Cr.subVectors(mr,gr);let t=[0,-vr.z,vr.y,0,-yr.z,yr.y,0,-Cr.z,Cr.y,vr.z,0,-vr.x,yr.z,0,-yr.x,Cr.z,0,-Cr.x,-vr.y,vr.x,0,-yr.y,yr.x,0,-Cr.y,Cr.x,0];if(!satForAxes(t,mr,Ar,gr,br))return false;t=[1,0,0,0,1,0,0,0,1];if(!satForAxes(t,mr,Ar,gr,br))return false;xr.crossVectors(vr,yr);t=[xr.x,xr.y,xr.z];return satForAxes(t,mr,Ar,gr,br)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,pr).distanceTo(e)}getBoundingSphere(e){if(this.isEmpty())e.makeEmpty();else{this.getCenter(e.center);e.radius=this.getSize(pr).length()*.5}return e}intersect(e){this.min.max(e.min);this.max.min(e.max);this.isEmpty()&&this.makeEmpty();return this}union(e){this.min.min(e.min);this.max.max(e.max);return this}applyMatrix4(e){if(this.isEmpty())return this;dr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e);dr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e);dr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e);dr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e);dr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e);dr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e);dr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e);dr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e);this.setFromPoints(dr);return this}translate(e){this.min.add(e);this.max.add(e);return this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dr=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3];const pr=new Vector3;const fr=new Box3;const mr=new Vector3;const Ar=new Vector3;const gr=new Vector3;const vr=new Vector3;const yr=new Vector3;const Cr=new Vector3;const Er=new Vector3;const br=new Vector3;const xr=new Vector3;const _r=new Vector3;function satForAxes(e,t,n,r,s){for(let a=0,o=e.length-3;a<=o;a+=3){_r.fromArray(e,a);const o=s.x*Math.abs(_r.x)+s.y*Math.abs(_r.y)+s.z*Math.abs(_r.z);const l=t.dot(_r);const c=n.dot(_r);const u=r.dot(_r);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return false}return true}const Mr=new Box3;const wr=new Vector3;const Sr=new Vector3;class Sphere{constructor(e=new Vector3,t=-1){this.isSphere=true;this.center=e;this.radius=t}set(e,t){this.center.copy(e);this.radius=t;return this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):Mr.setFromPoints(e).getCenter(n);let r=0;for(let t=0,s=e.length;t<s;t++)r=Math.max(r,n.distanceToSquared(e[t]));this.radius=Math.sqrt(r);return this}copy(e){this.center.copy(e.center);this.radius=e.radius;return this}isEmpty(){return this.radius<0}makeEmpty(){this.center.set(0,0,0);this.radius=-1;return this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);t.copy(e);if(n>this.radius*this.radius){t.sub(this.center).normalize();t.multiplyScalar(this.radius).add(this.center)}return t}getBoundingBox(e){if(this.isEmpty()){e.makeEmpty();return e}e.set(this.center,this.center);e.expandByScalar(this.radius);return e}applyMatrix4(e){this.center.applyMatrix4(e);this.radius=this.radius*e.getMaxScaleOnAxis();return this}translate(e){this.center.add(e);return this}expandByPoint(e){if(this.isEmpty()){this.center.copy(e);this.radius=0;return this}wr.subVectors(e,this.center);const t=wr.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t);const n=.5*(e-this.radius);this.center.addScaledVector(wr,n/e);this.radius+=n}return this}union(e){if(e.isEmpty())return this;if(this.isEmpty()){this.copy(e);return this}if(this.center.equals(e.center)===true)this.radius=Math.max(this.radius,e.radius);else{Sr.subVectors(e.center,this.center).setLength(e.radius);this.expandByPoint(wr.copy(e.center).add(Sr));this.expandByPoint(wr.copy(e.center).sub(Sr))}return this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Tr=new Vector3;const Br=new Vector3;const Ir=new Vector3;const Rr=new Vector3;const Lr=new Vector3;const Dr=new Vector3;const Pr=new Vector3;class Ray{constructor(e=new Vector3,t=new Vector3(0,0,-1)){this.origin=e;this.direction=t}set(e,t){this.origin.copy(e);this.direction.copy(t);return this}copy(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){this.direction.copy(e).sub(this.origin).normalize();return this}recast(e){this.origin.copy(this.at(e,Tr));return this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Tr.subVectors(e,this.origin).dot(this.direction);if(t<0)return this.origin.distanceToSquared(e);Tr.copy(this.origin).addScaledVector(this.direction,t);return Tr.distanceToSquared(e)}distanceSqToSegment(e,t,n,r){Br.copy(e).add(t).multiplyScalar(.5);Ir.copy(t).sub(e).normalize();Rr.copy(this.origin).sub(Br);const s=e.distanceTo(t)*.5;const a=-this.direction.dot(Ir);const o=Rr.dot(this.direction);const l=-Rr.dot(Ir);const c=Rr.lengthSq();const u=Math.abs(1-a*a);let h,d,p,f;if(u>0){h=a*l-o;d=a*o-l;f=s*u;if(h>=0)if(d>=-f)if(d<=f){const e=1/u;h*=e;d*=e;p=h*(h+a*d+2*o)+d*(a*h+d+2*l)+c}else{d=s;h=Math.max(0,-(a*d+o));p=-h*h+d*(d+2*l)+c}else{d=-s;h=Math.max(0,-(a*d+o));p=-h*h+d*(d+2*l)+c}else if(d<=-f){h=Math.max(0,-(-a*s+o));d=h>0?-s:Math.min(Math.max(-s,-l),s);p=-h*h+d*(d+2*l)+c}else if(d<=f){h=0;d=Math.min(Math.max(-s,-l),s);p=d*(d+2*l)+c}else{h=Math.max(0,-(a*s+o));d=h>0?s:Math.min(Math.max(-s,-l),s);p=-h*h+d*(d+2*l)+c}}else{d=a>0?-s:s;h=Math.max(0,-(a*d+o));p=-h*h+d*(d+2*l)+c}n&&n.copy(this.origin).addScaledVector(this.direction,h);r&&r.copy(Br).addScaledVector(Ir,d);return p}intersectSphere(e,t){Tr.subVectors(e.center,this.origin);const n=Tr.dot(this.direction);const r=Tr.dot(Tr)-n*n;const s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r);const o=n-a;const l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(t===0)return true;const n=e.normal.dot(this.direction);return n*t<0}intersectBox(e,t){let n,r,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z;const d=this.origin;if(c>=0){n=(e.min.x-d.x)*c;r=(e.max.x-d.x)*c}else{n=(e.max.x-d.x)*c;r=(e.min.x-d.x)*c}if(u>=0){s=(e.min.y-d.y)*u;a=(e.max.y-d.y)*u}else{s=(e.max.y-d.y)*u;a=(e.min.y-d.y)*u}if(n>a||s>r)return null;(s>n||isNaN(n))&&(n=s);(a<r||isNaN(r))&&(r=a);if(h>=0){o=(e.min.z-d.z)*h;l=(e.max.z-d.z)*h}else{o=(e.max.z-d.z)*h;l=(e.min.z-d.z)*h}if(n>l||o>r)return null;(o>n||n!==n)&&(n=o);(l<r||r!==r)&&(r=l);return r<0?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Tr)!==null}intersectTriangle(e,t,n,r,s){Lr.subVectors(t,e);Dr.subVectors(n,e);Pr.crossVectors(Lr,Dr);let a=this.direction.dot(Pr);let o;if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1;a=-a}Rr.subVectors(this.origin,e);const l=o*this.direction.dot(Dr.crossVectors(Rr,Dr));if(l<0)return null;const c=o*this.direction.dot(Lr.cross(Rr));if(c<0)return null;if(l+c>a)return null;const u=-o*Rr.dot(Pr);return u<0?null:this.at(u/a,s)}applyMatrix4(e){this.origin.applyMatrix4(e);this.direction.transformDirection(e);return this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Matrix4{constructor(e,t,n,r,s,a,o,l,c,u,h,d,p,f,m,g){Matrix4.prototype.isMatrix4=true;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];e!==void 0&&this.set(e,t,n,r,s,a,o,l,c,u,h,d,p,f,m,g)}set(e,t,n,r,s,a,o,l,c,u,h,d,p,f,m,g){const y=this.elements;y[0]=e;y[4]=t;y[8]=n;y[12]=r;y[1]=s;y[5]=a;y[9]=o;y[13]=l;y[2]=c;y[6]=u;y[10]=h;y[14]=d;y[3]=p;y[7]=f;y[11]=m;y[15]=g;return this}identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this}clone(){return(new Matrix4).fromArray(this.elements)}copy(e){const t=this.elements;const n=e.elements;t[0]=n[0];t[1]=n[1];t[2]=n[2];t[3]=n[3];t[4]=n[4];t[5]=n[5];t[6]=n[6];t[7]=n[7];t[8]=n[8];t[9]=n[9];t[10]=n[10];t[11]=n[11];t[12]=n[12];t[13]=n[13];t[14]=n[14];t[15]=n[15];return this}copyPosition(e){const t=this.elements,n=e.elements;t[12]=n[12];t[13]=n[13];t[14]=n[14];return this}setFromMatrix3(e){const t=e.elements;this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1);return this}extractBasis(e,t,n){e.setFromMatrixColumn(this,0);t.setFromMatrixColumn(this,1);n.setFromMatrixColumn(this,2);return this}makeBasis(e,t,n){this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1);return this}extractRotation(e){const t=this.elements;const n=e.elements;const r=1/Fr.setFromMatrixColumn(e,0).length();const s=1/Fr.setFromMatrixColumn(e,1).length();const a=1/Fr.setFromMatrixColumn(e,2).length();t[0]=n[0]*r;t[1]=n[1]*r;t[2]=n[2]*r;t[3]=0;t[4]=n[4]*s;t[5]=n[5]*s;t[6]=n[6]*s;t[7]=0;t[8]=n[8]*a;t[9]=n[9]*a;t[10]=n[10]*a;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this}makeRotationFromEuler(e){const t=this.elements;const n=e.x,r=e.y,s=e.z;const a=Math.cos(n),o=Math.sin(n);const l=Math.cos(r),c=Math.sin(r);const u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const e=a*u,n=a*h,r=o*u,s=o*h;t[0]=l*u;t[4]=-l*h;t[8]=c;t[1]=n+r*c;t[5]=e-s*c;t[9]=-o*l;t[2]=s-e*c;t[6]=r+n*c;t[10]=a*l}else if(e.order==="YXZ"){const e=l*u,n=l*h,r=c*u,s=c*h;t[0]=e+s*o;t[4]=r*o-n;t[8]=a*c;t[1]=a*h;t[5]=a*u;t[9]=-o;t[2]=n*o-r;t[6]=s+e*o;t[10]=a*l}else if(e.order==="ZXY"){const e=l*u,n=l*h,r=c*u,s=c*h;t[0]=e-s*o;t[4]=-a*h;t[8]=r+n*o;t[1]=n+r*o;t[5]=a*u;t[9]=s-e*o;t[2]=-a*c;t[6]=o;t[10]=a*l}else if(e.order==="ZYX"){const e=a*u,n=a*h,r=o*u,s=o*h;t[0]=l*u;t[4]=r*c-n;t[8]=e*c+s;t[1]=l*h;t[5]=s*c+e;t[9]=n*c-r;t[2]=-c;t[6]=o*l;t[10]=a*l}else if(e.order==="YZX"){const e=a*l,n=a*c,r=o*l,s=o*c;t[0]=l*u;t[4]=s-e*h;t[8]=r*h+n;t[1]=h;t[5]=a*u;t[9]=-o*u;t[2]=-c*u;t[6]=n*h+r;t[10]=e-s*h}else if(e.order==="XZY"){const e=a*l,n=a*c,r=o*l,s=o*c;t[0]=l*u;t[4]=-h;t[8]=c*u;t[1]=e*h+s;t[5]=a*u;t[9]=n*h-r;t[2]=r*h-n;t[6]=o*u;t[10]=s*h+e}t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this}makeRotationFromQuaternion(e){return this.compose(Or,e,kr)}lookAt(e,t,n){const r=this.elements;Vr.subVectors(e,t);Vr.lengthSq()===0&&(Vr.z=1);Vr.normalize();Nr.crossVectors(n,Vr);if(Nr.lengthSq()===0){Math.abs(n.z)===1?Vr.x+=1e-4:Vr.z+=1e-4;Vr.normalize();Nr.crossVectors(n,Vr)}Nr.normalize();Gr.crossVectors(Vr,Nr);r[0]=Nr.x;r[4]=Gr.x;r[8]=Vr.x;r[1]=Nr.y;r[5]=Gr.y;r[9]=Vr.y;r[2]=Nr.z;r[6]=Gr.z;r[10]=Vr.z;return this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements;const r=t.elements;const s=this.elements;const a=n[0],o=n[4],l=n[8],c=n[12];const u=n[1],h=n[5],d=n[9],p=n[13];const f=n[2],m=n[6],g=n[10],y=n[14];const b=n[3],x=n[7],_=n[11],M=n[15];const w=r[0],S=r[4],T=r[8],I=r[12];const R=r[1],L=r[5],D=r[9],P=r[13];const F=r[2],U=r[6],O=r[10],k=r[14];const N=r[3],G=r[7],V=r[11],j=r[15];s[0]=a*w+o*R+l*F+c*N;s[4]=a*S+o*L+l*U+c*G;s[8]=a*T+o*D+l*O+c*V;s[12]=a*I+o*P+l*k+c*j;s[1]=u*w+h*R+d*F+p*N;s[5]=u*S+h*L+d*U+p*G;s[9]=u*T+h*D+d*O+p*V;s[13]=u*I+h*P+d*k+p*j;s[2]=f*w+m*R+g*F+y*N;s[6]=f*S+m*L+g*U+y*G;s[10]=f*T+m*D+g*O+y*V;s[14]=f*I+m*P+g*k+y*j;s[3]=b*w+x*R+_*F+M*N;s[7]=b*S+x*L+_*U+M*G;s[11]=b*T+x*D+_*O+M*V;s[15]=b*I+x*P+_*k+M*j;return this}multiplyScalar(e){const t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this}determinant(){const e=this.elements;const t=e[0],n=e[4],r=e[8],s=e[12];const a=e[1],o=e[5],l=e[9],c=e[13];const u=e[2],h=e[6],d=e[10],p=e[14];const f=e[3],m=e[7],g=e[11],y=e[15];return f*(+s*l*h-r*c*h-s*o*d+n*c*d+r*o*p-n*l*p)+m*(+t*l*p-t*c*d+s*a*d-r*a*p+r*c*u-s*l*u)+g*(+t*c*h-t*o*p-s*a*h+n*a*p+s*o*u-n*c*u)+y*(-r*o*u-t*l*h+t*o*d+r*a*h-n*a*d+n*l*u)}transpose(){const e=this.elements;let t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this}setPosition(e,t,n){const r=this.elements;if(e.isVector3){r[12]=e.x;r[13]=e.y;r[14]=e.z}else{r[12]=e;r[13]=t;r[14]=n}return this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],b=h*g*c-m*d*c+m*l*p-o*g*p-h*l*y+o*d*y,x=f*d*c-u*g*c-f*l*p+a*g*p+u*l*y-a*d*y,_=u*m*c-f*h*c+f*o*p-a*m*p-u*o*y+a*h*y,M=f*h*l-u*m*l-f*o*d+a*m*d+u*o*g-a*h*g;const w=t*b+n*x+r*_+s*M;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/w;e[0]=b*S;e[1]=(m*d*s-h*g*s-m*r*p+n*g*p+h*r*y-n*d*y)*S;e[2]=(o*g*s-m*l*s+m*r*c-n*g*c-o*r*y+n*l*y)*S;e[3]=(h*l*s-o*d*s-h*r*c+n*d*c+o*r*p-n*l*p)*S;e[4]=x*S;e[5]=(u*g*s-f*d*s+f*r*p-t*g*p-u*r*y+t*d*y)*S;e[6]=(f*l*s-a*g*s-f*r*c+t*g*c+a*r*y-t*l*y)*S;e[7]=(a*d*s-u*l*s+u*r*c-t*d*c-a*r*p+t*l*p)*S;e[8]=_*S;e[9]=(f*h*s-u*m*s-f*n*p+t*m*p+u*n*y-t*h*y)*S;e[10]=(a*m*s-f*o*s+f*n*c-t*m*c-a*n*y+t*o*y)*S;e[11]=(u*o*s-a*h*s-u*n*c+t*h*c+a*n*p-t*o*p)*S;e[12]=M*S;e[13]=(u*m*r-f*h*r+f*n*d-t*m*d-u*n*g+t*h*g)*S;e[14]=(f*o*r-a*m*r-f*n*l+t*m*l+a*n*g-t*o*g)*S;e[15]=(a*h*r-u*o*r+u*n*l-t*h*l-a*n*d+t*o*d)*S;return this}scale(e){const t=this.elements;const n=e.x,r=e.y,s=e.z;t[0]*=n;t[4]*=r;t[8]*=s;t[1]*=n;t[5]*=r;t[9]*=s;t[2]*=n;t[6]*=r;t[10]*=s;t[3]*=n;t[7]*=r;t[11]*=s;return this}getMaxScaleOnAxis(){const e=this.elements;const t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];const n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];const r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1);return this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1);return this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1);return this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1);return this}makeRotationAxis(e,t){const n=Math.cos(t);const r=Math.sin(t);const s=1-n;const a=e.x,o=e.y,l=e.z;const c=s*a,u=s*o;this.set(c*a+n,c*o-r*l,c*l+r*o,0,c*o+r*l,u*o+n,u*l-r*a,0,c*l-r*o,u*l+r*a,s*l*l+n,0,0,0,0,1);return this}makeScale(e,t,n){this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1);return this}makeShear(e,t,n,r,s,a){this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1);return this}compose(e,t,n){const r=this.elements;const s=t._x,a=t._y,o=t._z,l=t._w;const c=s+s,u=a+a,h=o+o;const d=s*c,p=s*u,f=s*h;const m=a*u,g=a*h,y=o*h;const b=l*c,x=l*u,_=l*h;const M=n.x,w=n.y,S=n.z;r[0]=(1-(m+y))*M;r[1]=(p+_)*M;r[2]=(f-x)*M;r[3]=0;r[4]=(p-_)*w;r[5]=(1-(d+y))*w;r[6]=(g+b)*w;r[7]=0;r[8]=(f+x)*S;r[9]=(g-b)*S;r[10]=(1-(d+m))*S;r[11]=0;r[12]=e.x;r[13]=e.y;r[14]=e.z;r[15]=1;return this}decompose(e,t,n){const r=this.elements;let s=Fr.set(r[0],r[1],r[2]).length();const a=Fr.set(r[4],r[5],r[6]).length();const o=Fr.set(r[8],r[9],r[10]).length();const l=this.determinant();l<0&&(s=-s);e.x=r[12];e.y=r[13];e.z=r[14];Ur.copy(this);const c=1/s;const u=1/a;const h=1/o;Ur.elements[0]*=c;Ur.elements[1]*=c;Ur.elements[2]*=c;Ur.elements[4]*=u;Ur.elements[5]*=u;Ur.elements[6]*=u;Ur.elements[8]*=h;Ur.elements[9]*=h;Ur.elements[10]*=h;t.setFromRotationMatrix(Ur);n.x=s;n.y=a;n.z=o;return this}makePerspective(e,t,n,r,s,a,o=qn){const l=this.elements;const c=2*s/(t-e);const u=2*s/(n-r);const h=(t+e)/(t-e);const d=(n+r)/(n-r);let p,f;if(o===qn){p=-(a+s)/(a-s);f=-2*a*s/(a-s)}else{if(o!==Kn)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-a/(a-s);f=-a*s/(a-s)}l[0]=c;l[4]=0;l[8]=h;l[12]=0;l[1]=0;l[5]=u;l[9]=d;l[13]=0;l[2]=0;l[6]=0;l[10]=p;l[14]=f;l[3]=0;l[7]=0;l[11]=-1;l[15]=0;return this}makeOrthographic(e,t,n,r,s,a,o=qn){const l=this.elements;const c=1/(t-e);const u=1/(n-r);const h=1/(a-s);const d=(t+e)*c;const p=(n+r)*u;let f,m;if(o===qn){f=(a+s)*h;m=-2*h}else{if(o!==Kn)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);f=s*h;m=-1*h}l[0]=2*c;l[4]=0;l[8]=0;l[12]=-d;l[1]=0;l[5]=2*u;l[9]=0;l[13]=-p;l[2]=0;l[6]=0;l[10]=m;l[14]=-f;l[3]=0;l[7]=0;l[11]=0;l[15]=1;return this}equals(e){const t=this.elements;const n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return false;return true}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;e[t]=n[0];e[t+1]=n[1];e[t+2]=n[2];e[t+3]=n[3];e[t+4]=n[4];e[t+5]=n[5];e[t+6]=n[6];e[t+7]=n[7];e[t+8]=n[8];e[t+9]=n[9];e[t+10]=n[10];e[t+11]=n[11];e[t+12]=n[12];e[t+13]=n[13];e[t+14]=n[14];e[t+15]=n[15];return e}}const Fr=new Vector3;const Ur=new Matrix4;const Or=new Vector3(0,0,0);const kr=new Vector3(1,1,1);const Nr=new Vector3;const Gr=new Vector3;const Vr=new Vector3;const Qr=new Matrix4;const jr=new Quaternion;class Euler{constructor(e=0,t=0,n=0,r=Euler.DEFAULT_ORDER){this.isEuler=true;this._x=e;this._y=t;this._z=n;this._order=r}get x(){return this._x}set x(e){this._x=e;this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e;this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e;this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e;this._onChangeCallback()}set(e,t,n,r=this._order){this._x=e;this._y=t;this._z=n;this._order=r;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this._onChangeCallback();return this}setFromRotationMatrix(e,t=this._order,n=true){const r=e.elements;const s=r[0],a=r[4],o=r[8];const l=r[1],c=r[5],u=r[9];const h=r[2],d=r[6],p=r[10];switch(t){case"XYZ":this._y=Math.asin(clamp(o,-1,1));if(Math.abs(o)<.9999999){this._x=Math.atan2(-u,p);this._z=Math.atan2(-a,s)}else{this._x=Math.atan2(d,c);this._z=0}break;case"YXZ":this._x=Math.asin(-clamp(u,-1,1));if(Math.abs(u)<.9999999){this._y=Math.atan2(o,p);this._z=Math.atan2(l,c)}else{this._y=Math.atan2(-h,s);this._z=0}break;case"ZXY":this._x=Math.asin(clamp(d,-1,1));if(Math.abs(d)<.9999999){this._y=Math.atan2(-h,p);this._z=Math.atan2(-a,c)}else{this._y=0;this._z=Math.atan2(l,s)}break;case"ZYX":this._y=Math.asin(-clamp(h,-1,1));if(Math.abs(h)<.9999999){this._x=Math.atan2(d,p);this._z=Math.atan2(l,s)}else{this._x=0;this._z=Math.atan2(-a,c)}break;case"YZX":this._z=Math.asin(clamp(l,-1,1));if(Math.abs(l)<.9999999){this._x=Math.atan2(-u,c);this._y=Math.atan2(-h,s)}else{this._x=0;this._y=Math.atan2(o,p)}break;case"XZY":this._z=Math.asin(-clamp(a,-1,1));if(Math.abs(a)<.9999999){this._x=Math.atan2(d,c);this._y=Math.atan2(o,s)}else{this._x=Math.atan2(-u,p);this._y=0}break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}this._order=t;n===true&&this._onChangeCallback();return this}setFromQuaternion(e,t,n){Qr.makeRotationFromQuaternion(e);return this.setFromRotationMatrix(Qr,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){jr.setFromEuler(this);return this.setFromQuaternion(jr,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){this._x=e[0];this._y=e[1];this._z=e[2];e[3]!==void 0&&(this._order=e[3]);this._onChangeCallback();return this}toArray(e=[],t=0){e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._order;return e}_onChange(e){this._onChangeCallback=e;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&1<<e)!==0}}let Hr=0;const zr=new Vector3;const Wr=new Quaternion;const qr=new Matrix4;const Kr=new Vector3;const Xr=new Vector3;const Yr=new Vector3;const Jr=new Quaternion;const Zr=new Vector3(1,0,0);const $r=new Vector3(0,1,0);const ei=new Vector3(0,0,1);const ti={type:"added"};const ni={type:"removed"};const ri={type:"childadded",child:null};const ii={type:"childremoved",child:null};class Object3D extends EventDispatcher{constructor(){super();this.isObject3D=true;Object.defineProperty(this,"id",{value:Hr++});this.uuid=generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=Object3D.DEFAULT_UP.clone();const e=new Vector3;const t=new Euler;const n=new Quaternion;const r=new Vector3(1,1,1);function onRotationChange(){n.setFromEuler(t,false)}function onQuaternionChange(){t.setFromQuaternion(n,void 0,false)}t._onChange(onRotationChange);n._onChange(onQuaternionChange);Object.defineProperties(this,{position:{configurable:true,enumerable:true,value:e},rotation:{configurable:true,enumerable:true,value:t},quaternion:{configurable:true,enumerable:true,value:n},scale:{configurable:true,enumerable:true,value:r},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}});this.matrix=new Matrix4;this.matrixWorld=new Matrix4;this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE;this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE;this.matrixWorldNeedsUpdate=false;this.layers=new Layers;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.renderOrder=0;this.animations=[];this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix();this.matrix.premultiply(e);this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){this.quaternion.premultiply(e);return this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,true)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){Wr.setFromAxisAngle(e,t);this.quaternion.multiply(Wr);return this}rotateOnWorldAxis(e,t){Wr.setFromAxisAngle(e,t);this.quaternion.premultiply(Wr);return this}rotateX(e){return this.rotateOnAxis(Zr,e)}rotateY(e){return this.rotateOnAxis($r,e)}rotateZ(e){return this.rotateOnAxis(ei,e)}translateOnAxis(e,t){zr.copy(e).applyQuaternion(this.quaternion);this.position.add(zr.multiplyScalar(t));return this}translateX(e){return this.translateOnAxis(Zr,e)}translateY(e){return this.translateOnAxis($r,e)}translateZ(e){return this.translateOnAxis(ei,e)}localToWorld(e){this.updateWorldMatrix(true,false);return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){this.updateWorldMatrix(true,false);return e.applyMatrix4(qr.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Kr.copy(e):Kr.set(e,t,n);const r=this.parent;this.updateWorldMatrix(true,false);Xr.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?qr.lookAt(Xr,Kr,this.up):qr.lookAt(Kr,Xr,this.up);this.quaternion.setFromRotationMatrix(qr);if(r){qr.extractRotation(r.matrixWorld);Wr.setFromRotationMatrix(qr);this.quaternion.premultiply(Wr.invert())}}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}if(e===this){console.error("THREE.Object3D.add: object can't be added as a child of itself.",e);return this}if(e&&e.isObject3D){e.removeFromParent();e.parent=this;this.children.push(e);e.dispatchEvent(ti);ri.child=e;this.dispatchEvent(ri);ri.child=null}else console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);if(t!==-1){e.parent=null;this.children.splice(t,1);e.dispatchEvent(ni);ii.child=e;this.dispatchEvent(ii);ii.child=null}return this}removeFromParent(){const e=this.parent;e!==null&&e.remove(this);return this}clear(){return this.remove(...this.children)}attach(e){this.updateWorldMatrix(true,false);qr.copy(this.matrixWorld).invert();if(e.parent!==null){e.parent.updateWorldMatrix(true,false);qr.multiply(e.parent.matrixWorld)}e.applyMatrix4(qr);e.removeFromParent();e.parent=this;this.children.push(e);e.updateWorldMatrix(false,true);e.dispatchEvent(ti);ri.child=e;this.dispatchEvent(ri);ri.child=null;return this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n];const s=r.getObjectByProperty(e,t);if(s!==void 0)return s}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){this.updateWorldMatrix(true,false);return e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){this.updateWorldMatrix(true,false);this.matrixWorld.decompose(Xr,e,Yr);return e}getWorldScale(e){this.updateWorldMatrix(true,false);this.matrixWorld.decompose(Xr,Jr,e);return e}getWorldDirection(e){this.updateWorldMatrix(true,false);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===false)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;if(t!==null){e(t);t.traverseAncestors(e)}}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){this.matrixWorldAutoUpdate===true&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix));this.matrixWorldNeedsUpdate=false;e=true}const t=this.children;for(let n=0,r=t.length;n<r;n++){const r=t[n];r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;e===true&&n!==null&&n.updateWorldMatrix(true,false);this.matrixAutoUpdate&&this.updateMatrix();this.matrixWorldAutoUpdate===true&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix));if(t===true){const e=this.children;for(let t=0,n=e.length;t<n;t++){const n=e[t];n.updateWorldMatrix(false,true)}}}toJSON(e){const t=e===void 0||typeof e==="string";const n={};if(t){e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}};n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"}}const r={};r.uuid=this.uuid;r.type=this.type;this.name!==""&&(r.name=this.name);this.castShadow===true&&(r.castShadow=true);this.receiveShadow===true&&(r.receiveShadow=true);this.visible===false&&(r.visible=false);this.frustumCulled===false&&(r.frustumCulled=false);this.renderOrder!==0&&(r.renderOrder=this.renderOrder);Object.keys(this.userData).length>0&&(r.userData=this.userData);r.layers=this.layers.mask;r.matrix=this.matrix.toArray();r.up=this.up.toArray();this.matrixAutoUpdate===false&&(r.matrixAutoUpdate=false);if(this.isInstancedMesh){r.type="InstancedMesh";r.count=this.count;r.instanceMatrix=this.instanceMatrix.toJSON();this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())}if(this.isBatchedMesh){r.type="BatchedMesh";r.perObjectFrustumCulled=this.perObjectFrustumCulled;r.sortObjects=this.sortObjects;r.drawRanges=this._drawRanges;r.reservedRanges=this._reservedRanges;r.visibility=this._visibility;r.active=this._active;r.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()})));r.maxInstanceCount=this._maxInstanceCount;r.maxVertexCount=this._maxVertexCount;r.maxIndexCount=this._maxIndexCount;r.geometryInitialized=this._geometryInitialized;r.geometryCount=this._geometryCount;r.matricesTexture=this._matricesTexture.toJSON(e);this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e));this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius});this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})}function serialize(t,n){t[n.uuid]===void 0&&(t[n.uuid]=n.toJSON(e));return n.uuid}if(this.isScene){this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid));this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==true&&(r.environment=this.environment.toJSON(e).uuid)}else if(this.isMesh||this.isLine||this.isPoints){r.geometry=serialize(e.geometries,this.geometry);const t=this.geometry.parameters;if(t!==void 0&&t.shapes!==void 0){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];serialize(e.shapes,r)}else serialize(e.shapes,n)}}if(this.isSkinnedMesh){r.bindMode=this.bindMode;r.bindMatrix=this.bindMatrix.toArray();if(this.skeleton!==void 0){serialize(e.skeletons,this.skeleton);r.skeleton=this.skeleton.uuid}}if(this.material!==void 0)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(serialize(e.materials,this.material[n]));r.material=t}else r.material=serialize(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(serialize(e.animations,n))}}if(t){const t=extractFromCache(e.geometries);const r=extractFromCache(e.materials);const s=extractFromCache(e.textures);const a=extractFromCache(e.images);const o=extractFromCache(e.shapes);const l=extractFromCache(e.skeletons);const c=extractFromCache(e.animations);const u=extractFromCache(e.nodes);t.length>0&&(n.geometries=t);r.length>0&&(n.materials=r);s.length>0&&(n.textures=s);a.length>0&&(n.images=a);o.length>0&&(n.shapes=o);l.length>0&&(n.skeletons=l);c.length>0&&(n.animations=c);u.length>0&&(n.nodes=u)}n.object=r;return n;function extractFromCache(e){const t=[];for(const n in e){const r=e[n];delete r.metadata;t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=true){this.name=e.name;this.up.copy(e.up);this.position.copy(e.position);this.rotation.order=e.rotation.order;this.quaternion.copy(e.quaternion);this.scale.copy(e.scale);this.matrix.copy(e.matrix);this.matrixWorld.copy(e.matrixWorld);this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate;this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate;this.layers.mask=e.layers.mask;this.visible=e.visible;this.castShadow=e.castShadow;this.receiveShadow=e.receiveShadow;this.frustumCulled=e.frustumCulled;this.renderOrder=e.renderOrder;this.animations=e.animations.slice();this.userData=JSON.parse(JSON.stringify(e.userData));if(t===true)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=true;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=true;const si=new Vector3;const ai=new Vector3;const oi=new Vector3;const li=new Vector3;const ci=new Vector3;const ui=new Vector3;const hi=new Vector3;const di=new Vector3;const pi=new Vector3;const fi=new Vector3;const mi=new Vector4;const Ai=new Vector4;const gi=new Vector4;class Triangle{constructor(e=new Vector3,t=new Vector3,n=new Vector3){this.a=e;this.b=t;this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t);si.subVectors(e,t);r.cross(si);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){si.subVectors(r,t);ai.subVectors(n,t);oi.subVectors(e,t);const a=si.dot(si);const o=si.dot(ai);const l=si.dot(oi);const c=ai.dot(ai);const u=ai.dot(oi);const h=a*c-o*o;if(h===0){s.set(0,0,0);return null}const d=1/h;const p=(c*l-o*u)*d;const f=(a*u-o*l)*d;return s.set(1-p-f,f,p)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,li)!==null&&(li.x>=0&&li.y>=0&&li.x+li.y<=1)}static getInterpolation(e,t,n,r,s,a,o,l){if(this.getBarycoord(e,t,n,r,li)===null){l.x=0;l.y=0;"z"in l&&(l.z=0);"w"in l&&(l.w=0);return null}l.setScalar(0);l.addScaledVector(s,li.x);l.addScaledVector(a,li.y);l.addScaledVector(o,li.z);return l}static getInterpolatedAttribute(e,t,n,r,s,a){mi.setScalar(0);Ai.setScalar(0);gi.setScalar(0);mi.fromBufferAttribute(e,t);Ai.fromBufferAttribute(e,n);gi.fromBufferAttribute(e,r);a.setScalar(0);a.addScaledVector(mi,s.x);a.addScaledVector(Ai,s.y);a.addScaledVector(gi,s.z);return a}static isFrontFacing(e,t,n,r){si.subVectors(n,t);ai.subVectors(e,t);return si.cross(ai).dot(r)<0}set(e,t,n){this.a.copy(e);this.b.copy(t);this.c.copy(n);return this}setFromPointsAndIndices(e,t,n,r){this.a.copy(e[t]);this.b.copy(e[n]);this.c.copy(e[r]);return this}setFromAttributeAndIndices(e,t,n,r){this.a.fromBufferAttribute(e,t);this.b.fromBufferAttribute(e,n);this.c.fromBufferAttribute(e,r);return this}clone(){return(new this.constructor).copy(this)}copy(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this}getArea(){si.subVectors(this.c,this.b);ai.subVectors(this.a,this.b);return si.cross(ai).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Triangle.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Triangle.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return Triangle.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Triangle.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Triangle.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,o;ci.subVectors(r,n);ui.subVectors(s,n);di.subVectors(e,n);const l=ci.dot(di);const c=ui.dot(di);if(l<=0&&c<=0)return t.copy(n);pi.subVectors(e,r);const u=ci.dot(pi);const h=ui.dot(pi);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0){a=l/(l-u);return t.copy(n).addScaledVector(ci,a)}fi.subVectors(e,s);const p=ci.dot(fi);const f=ui.dot(fi);if(f>=0&&p<=f)return t.copy(s);const m=p*c-l*f;if(m<=0&&c>=0&&f<=0){o=c/(c-f);return t.copy(n).addScaledVector(ui,o)}const g=u*f-p*h;if(g<=0&&h-u>=0&&p-f>=0){hi.subVectors(s,r);o=(h-u)/(h-u+(p-f));return t.copy(r).addScaledVector(hi,o)}const y=1/(g+m+d);a=m*y;o=d*y;return t.copy(n).addScaledVector(ci,a).addScaledVector(ui,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const vi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};const yi={h:0,s:0,l:0};const bi={h:0,s:0,l:0};function hue2rgb(e,t,n){n<0&&(n+=1);n>1&&(n-=1);return n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Color{constructor(e,t,n){this.isColor=true;this.r=1;this.g=1;this.b=1;return this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const t=e;t&&t.isColor?this.copy(t):typeof t==="number"?this.setHex(t):typeof t==="string"&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){this.r=e;this.g=e;this.b=e;return this}setHex(e,t=ln){e=Math.floor(e);this.r=(e>>16&255)/255;this.g=(e>>8&255)/255;this.b=(e&255)/255;ar.toWorkingColorSpace(this,t);return this}setRGB(e,t,n,r=ar.workingColorSpace){this.r=e;this.g=t;this.b=n;ar.toWorkingColorSpace(this,r);return this}setHSL(e,t,n,r=ar.workingColorSpace){e=euclideanModulo(e,1);t=clamp(t,0,1);n=clamp(n,0,1);if(t===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t;const s=2*n-r;this.r=hue2rgb(s,r,e+1/3);this.g=hue2rgb(s,r,e);this.b=hue2rgb(s,r,e-1/3)}ar.toWorkingColorSpace(this,r);return this}setStyle(e,t=ln){function handleAlpha(t){t!==void 0&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=n[1];const a=n[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){handleAlpha(r[4]);return this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t)}if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){handleAlpha(r[4]);return this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t)}break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){handleAlpha(r[4]);return this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=n[1];const s=r.length;if(s===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(s===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ln){const n=vi[e.toLowerCase()];n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e);return this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){this.r=e.r;this.g=e.g;this.b=e.b;return this}copySRGBToLinear(e){this.r=SRGBToLinear(e.r);this.g=SRGBToLinear(e.g);this.b=SRGBToLinear(e.b);return this}copyLinearToSRGB(e){this.r=LinearToSRGB(e.r);this.g=LinearToSRGB(e.g);this.b=LinearToSRGB(e.b);return this}convertSRGBToLinear(){this.copySRGBToLinear(this);return this}convertLinearToSRGB(){this.copyLinearToSRGB(this);return this}getHex(e=ln){ar.fromWorkingColorSpace(xi.copy(this),e);return Math.round(clamp(xi.r*255,0,255))*65536+Math.round(clamp(xi.g*255,0,255))*256+Math.round(clamp(xi.b*255,0,255))}getHexString(e=ln){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ar.workingColorSpace){ar.fromWorkingColorSpace(xi.copy(this),t);const n=xi.r,r=xi.g,s=xi.b;const a=Math.max(n,r,s);const o=Math.min(n,r,s);let l,c;const u=(o+a)/2;if(o===a){l=0;c=0}else{const e=a-o;c=u<=.5?e/(a+o):e/(2-a-o);switch(a){case n:l=(r-s)/e+(r<s?6:0);break;case r:l=(s-n)/e+2;break;case s:l=(n-r)/e+4;break}l/=6}e.h=l;e.s=c;e.l=u;return e}getRGB(e,t=ar.workingColorSpace){ar.fromWorkingColorSpace(xi.copy(this),t);e.r=xi.r;e.g=xi.g;e.b=xi.b;return e}getStyle(e=ln){ar.fromWorkingColorSpace(xi.copy(this),e);const t=xi.r,n=xi.g,r=xi.b;return e!==ln?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){this.getHSL(yi);return this.setHSL(yi.h+e,yi.s+t,yi.l+n)}add(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this}addColors(e,t){this.r=e.r+t.r;this.g=e.g+t.g;this.b=e.b+t.b;return this}addScalar(e){this.r+=e;this.g+=e;this.b+=e;return this}sub(e){this.r=Math.max(0,this.r-e.r);this.g=Math.max(0,this.g-e.g);this.b=Math.max(0,this.b-e.b);return this}multiply(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this}multiplyScalar(e){this.r*=e;this.g*=e;this.b*=e;return this}lerp(e,t){this.r+=(e.r-this.r)*t;this.g+=(e.g-this.g)*t;this.b+=(e.b-this.b)*t;return this}lerpColors(e,t,n){this.r=e.r+(t.r-e.r)*n;this.g=e.g+(t.g-e.g)*n;this.b=e.b+(t.b-e.b)*n;return this}lerpHSL(e,t){this.getHSL(yi);e.getHSL(bi);const n=lerp(yi.h,bi.h,t);const r=lerp(yi.s,bi.s,t);const s=lerp(yi.l,bi.l,t);this.setHSL(n,r,s);return this}setFromVector3(e){this.r=e.x;this.g=e.y;this.b=e.z;return this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b;const s=e.elements;this.r=s[0]*t+s[3]*n+s[6]*r;this.g=s[1]*t+s[4]*n+s[7]*r;this.b=s[2]*t+s[5]*n+s[8]*r;return this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){this.r=e[t];this.g=e[t+1];this.b=e[t+2];return this}toArray(e=[],t=0){e[t]=this.r;e[t+1]=this.g;e[t+2]=this.b;return e}fromBufferAttribute(e,t){this.r=e.getX(t);this.g=e.getY(t);this.b=e.getZ(t);return this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r;yield this.g;yield this.b}}const xi=new Color;Color.NAMES=vi;let _i=0;class Material extends EventDispatcher{constructor(){super();this.isMaterial=true;Object.defineProperty(this,"id",{value:_i++});this.uuid=generateUUID();this.name="";this.type="Material";this.blending=_;this.side=g;this.vertexColors=false;this.opacity=1;this.transparent=false;this.alphaHash=false;this.blendSrc=N;this.blendDst=G;this.blendEquation=I;this.blendSrcAlpha=null;this.blendDstAlpha=null;this.blendEquationAlpha=null;this.blendColor=new Color(0,0,0);this.blendAlpha=0;this.depthFunc=ee;this.depthTest=true;this.depthWrite=true;this.stencilWriteMask=255;this.stencilFunc=Sn;this.stencilRef=0;this.stencilFuncMask=255;this.stencilFail=pn;this.stencilZFail=pn;this.stencilZPass=pn;this.stencilWrite=false;this.clippingPlanes=null;this.clipIntersection=false;this.clipShadows=false;this.shadowSide=null;this.colorWrite=true;this.precision=null;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.dithering=false;this.alphaToCoverage=false;this.premultipliedAlpha=false;this.forceSinglePass=false;this.visible=true;this.toneMapped=true;this.userData={};this.version=0;this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++;this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];r!==void 0?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=e===void 0||typeof e==="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid;n.type=this.type;this.name!==""&&(n.name=this.name);this.color&&this.color.isColor&&(n.color=this.color.getHex());this.roughness!==void 0&&(n.roughness=this.roughness);this.metalness!==void 0&&(n.metalness=this.metalness);this.sheen!==void 0&&(n.sheen=this.sheen);this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex());this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness);this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex());this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex());this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity);this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex());this.shininess!==void 0&&(n.shininess=this.shininess);this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat);this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness);this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid);this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid);if(this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture){n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid;n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()}this.dispersion!==void 0&&(n.dispersion=this.dispersion);this.iridescence!==void 0&&(n.iridescence=this.iridescence);this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR);this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange);this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid);this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid);this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy);this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation);this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid);this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid);this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid);this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid);if(this.lightMap&&this.lightMap.isTexture){n.lightMap=this.lightMap.toJSON(e).uuid;n.lightMapIntensity=this.lightMapIntensity}if(this.aoMap&&this.aoMap.isTexture){n.aoMap=this.aoMap.toJSON(e).uuid;n.aoMapIntensity=this.aoMapIntensity}if(this.bumpMap&&this.bumpMap.isTexture){n.bumpMap=this.bumpMap.toJSON(e).uuid;n.bumpScale=this.bumpScale}if(this.normalMap&&this.normalMap.isTexture){n.normalMap=this.normalMap.toJSON(e).uuid;n.normalMapType=this.normalMapType;n.normalScale=this.normalScale.toArray()}if(this.displacementMap&&this.displacementMap.isTexture){n.displacementMap=this.displacementMap.toJSON(e).uuid;n.displacementScale=this.displacementScale;n.displacementBias=this.displacementBias}this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid);this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid);this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid);this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid);if(this.envMap&&this.envMap.isTexture){n.envMap=this.envMap.toJSON(e).uuid;this.combine!==void 0&&(n.combine=this.combine)}this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray());this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity);this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity);this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio);this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid);this.transmission!==void 0&&(n.transmission=this.transmission);this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid);this.thickness!==void 0&&(n.thickness=this.thickness);this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid);this.attenuationDistance!==void 0&&this.attenuationDistance!==Infinity&&(n.attenuationDistance=this.attenuationDistance);this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex());this.size!==void 0&&(n.size=this.size);this.shadowSide!==null&&(n.shadowSide=this.shadowSide);this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation);this.blending!==_&&(n.blending=this.blending);this.side!==g&&(n.side=this.side);this.vertexColors===true&&(n.vertexColors=true);this.opacity<1&&(n.opacity=this.opacity);this.transparent===true&&(n.transparent=true);this.blendSrc!==N&&(n.blendSrc=this.blendSrc);this.blendDst!==G&&(n.blendDst=this.blendDst);this.blendEquation!==I&&(n.blendEquation=this.blendEquation);this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha);this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha);this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha);this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex());this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha);this.depthFunc!==ee&&(n.depthFunc=this.depthFunc);this.depthTest===false&&(n.depthTest=this.depthTest);this.depthWrite===false&&(n.depthWrite=this.depthWrite);this.colorWrite===false&&(n.colorWrite=this.colorWrite);this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask);this.stencilFunc!==Sn&&(n.stencilFunc=this.stencilFunc);this.stencilRef!==0&&(n.stencilRef=this.stencilRef);this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask);this.stencilFail!==pn&&(n.stencilFail=this.stencilFail);this.stencilZFail!==pn&&(n.stencilZFail=this.stencilZFail);this.stencilZPass!==pn&&(n.stencilZPass=this.stencilZPass);this.stencilWrite===true&&(n.stencilWrite=this.stencilWrite);this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation);this.polygonOffset===true&&(n.polygonOffset=true);this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor);this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits);this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth);this.dashSize!==void 0&&(n.dashSize=this.dashSize);this.gapSize!==void 0&&(n.gapSize=this.gapSize);this.scale!==void 0&&(n.scale=this.scale);this.dithering===true&&(n.dithering=true);this.alphaTest>0&&(n.alphaTest=this.alphaTest);this.alphaHash===true&&(n.alphaHash=true);this.alphaToCoverage===true&&(n.alphaToCoverage=true);this.premultipliedAlpha===true&&(n.premultipliedAlpha=true);this.forceSinglePass===true&&(n.forceSinglePass=true);this.wireframe===true&&(n.wireframe=true);this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth);this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap);this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin);this.flatShading===true&&(n.flatShading=true);this.visible===false&&(n.visible=false);this.toneMapped===false&&(n.toneMapped=false);this.fog===false&&(n.fog=false);Object.keys(this.userData).length>0&&(n.userData=this.userData);function extractFromCache(e){const t=[];for(const n in e){const r=e[n];delete r.metadata;t.push(r)}return t}if(t){const t=extractFromCache(e.textures);const r=extractFromCache(e.images);t.length>0&&(n.textures=t);r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name;this.blending=e.blending;this.side=e.side;this.vertexColors=e.vertexColors;this.opacity=e.opacity;this.transparent=e.transparent;this.blendSrc=e.blendSrc;this.blendDst=e.blendDst;this.blendEquation=e.blendEquation;this.blendSrcAlpha=e.blendSrcAlpha;this.blendDstAlpha=e.blendDstAlpha;this.blendEquationAlpha=e.blendEquationAlpha;this.blendColor.copy(e.blendColor);this.blendAlpha=e.blendAlpha;this.depthFunc=e.depthFunc;this.depthTest=e.depthTest;this.depthWrite=e.depthWrite;this.stencilWriteMask=e.stencilWriteMask;this.stencilFunc=e.stencilFunc;this.stencilRef=e.stencilRef;this.stencilFuncMask=e.stencilFuncMask;this.stencilFail=e.stencilFail;this.stencilZFail=e.stencilZFail;this.stencilZPass=e.stencilZPass;this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}this.clippingPlanes=n;this.clipIntersection=e.clipIntersection;this.clipShadows=e.clipShadows;this.shadowSide=e.shadowSide;this.colorWrite=e.colorWrite;this.precision=e.precision;this.polygonOffset=e.polygonOffset;this.polygonOffsetFactor=e.polygonOffsetFactor;this.polygonOffsetUnits=e.polygonOffsetUnits;this.dithering=e.dithering;this.alphaTest=e.alphaTest;this.alphaHash=e.alphaHash;this.alphaToCoverage=e.alphaToCoverage;this.premultipliedAlpha=e.premultipliedAlpha;this.forceSinglePass=e.forceSinglePass;this.visible=e.visible;this.toneMapped=e.toneMapped;this.userData=JSON.parse(JSON.stringify(e.userData));return this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===true&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class MeshBasicMaterial extends Material{constructor(e){super();this.isMeshBasicMaterial=true;this.type="MeshBasicMaterial";this.color=new Color(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new Euler;this.combine=se;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapRotation.copy(e.envMapRotation);this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.fog=e.fog;return this}}const wi=_generateTables();function _generateTables(){const e=new ArrayBuffer(4);const t=new Float32Array(e);const n=new Uint32Array(e);const r=new Uint32Array(512);const s=new Uint32Array(512);for(let e=0;e<256;++e){const t=e-127;if(t<-27){r[e]=0;r[e|256]=32768;s[e]=24;s[e|256]=24}else if(t<-14){r[e]=1024>>-t-14;r[e|256]=1024>>-t-14|32768;s[e]=-t-1;s[e|256]=-t-1}else if(t<=15){r[e]=t+15<<10;r[e|256]=t+15<<10|32768;s[e]=13;s[e|256]=13}else if(t<128){r[e]=31744;r[e|256]=64512;s[e]=24;s[e|256]=24}else{r[e]=31744;r[e|256]=64512;s[e]=13;s[e|256]=13}}const a=new Uint32Array(2048);const o=new Uint32Array(64);const l=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13;let n=0;while((t&8388608)===0){t<<=1;n-=8388608}t&=-8388609;n+=947912704;a[e]=t|n}for(let e=1024;e<2048;++e)a[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)o[e]=e<<23;o[31]=1199570944;o[32]=2147483648;for(let e=33;e<63;++e)o[e]=2147483648+(e-32<<23);o[63]=3347054592;for(let e=1;e<64;++e)e!==32&&(l[e]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:s,mantissaTable:a,exponentTable:o,offsetTable:l}}function toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range.");e=clamp(e,-65504,65504);wi.floatView[0]=e;const t=wi.uint32View[0];const n=t>>23&511;return wi.baseTable[n]+((t&8388607)>>wi.shiftTable[n])}function fromHalfFloat(e){const t=e>>10;wi.uint32View[0]=wi.mantissaTable[wi.offsetTable[t]+(e&1023)]+wi.exponentTable[t];return wi.floatView[0]}const Bi={toHalfFloat:toHalfFloat,fromHalfFloat:fromHalfFloat};const Ri=new Vector3;const Li=new Vector2;let Di=0;class BufferAttribute{constructor(e,t,n=false){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=true;Object.defineProperty(this,"id",{value:Di++});this.name="";this.array=e;this.itemSize=t;this.count=e!==void 0?e.length/t:0;this.normalized=n;this.usage=Un;this.updateRanges=[];this.gpuType=je;this.version=0}onUploadCallback(){}set needsUpdate(e){e===true&&this.version++}setUsage(e){this.usage=e;return this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){this.name=e.name;this.array=new e.array.constructor(e.array);this.itemSize=e.itemSize;this.count=e.count;this.normalized=e.normalized;this.usage=e.usage;this.gpuType=e.gpuType;return this}copyAt(e,t,n){e*=this.itemSize;n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){this.array.set(e);return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++){Li.fromBufferAttribute(this,t);Li.applyMatrix3(e);this.setXY(t,Li.x,Li.y)}else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++){Ri.fromBufferAttribute(this,t);Ri.applyMatrix3(e);this.setXYZ(t,Ri.x,Ri.y,Ri.z)}return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++){Ri.fromBufferAttribute(this,t);Ri.applyMatrix4(e);this.setXYZ(t,Ri.x,Ri.y,Ri.z)}return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++){Ri.fromBufferAttribute(this,t);Ri.applyNormalMatrix(e);this.setXYZ(t,Ri.x,Ri.y,Ri.z)}return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++){Ri.fromBufferAttribute(this,t);Ri.transformDirection(e);this.setXYZ(t,Ri.x,Ri.y,Ri.z)}return this}set(e,t=0){this.array.set(e,t);return this}getComponent(e,t){let n=this.array[e*this.itemSize+t];this.normalized&&(n=denormalize(n,this.array));return n}setComponent(e,t,n){this.normalized&&(n=normalize(n,this.array));this.array[e*this.itemSize+t]=n;return this}getX(e){let t=this.array[e*this.itemSize];this.normalized&&(t=denormalize(t,this.array));return t}setX(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize]=t;return this}getY(e){let t=this.array[e*this.itemSize+1];this.normalized&&(t=denormalize(t,this.array));return t}setY(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize+1]=t;return this}getZ(e){let t=this.array[e*this.itemSize+2];this.normalized&&(t=denormalize(t,this.array));return t}setZ(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize+2]=t;return this}getW(e){let t=this.array[e*this.itemSize+3];this.normalized&&(t=denormalize(t,this.array));return t}setW(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize+3]=t;return this}setXY(e,t,n){e*=this.itemSize;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array)}this.array[e+0]=t;this.array[e+1]=n;return this}setXYZ(e,t,n,r){e*=this.itemSize;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array);r=normalize(r,this.array)}this.array[e+0]=t;this.array[e+1]=n;this.array[e+2]=r;return this}setXYZW(e,t,n,r,s){e*=this.itemSize;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array);r=normalize(r,this.array);s=normalize(s,this.array)}this.array[e+0]=t;this.array[e+1]=n;this.array[e+2]=r;this.array[e+3]=s;return this}onUpload(e){this.onUploadCallback=e;return this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};this.name!==""&&(e.name=this.name);this.usage!==Un&&(e.usage=this.usage);return e}}class Int8BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Uint8BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Int16BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Uint16BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Int32BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Uint32BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Float16BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint16Array(e),t,n);this.isFloat16BufferAttribute=true}getX(e){let t=fromHalfFloat(this.array[e*this.itemSize]);this.normalized&&(t=denormalize(t,this.array));return t}setX(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize]=toHalfFloat(t);return this}getY(e){let t=fromHalfFloat(this.array[e*this.itemSize+1]);this.normalized&&(t=denormalize(t,this.array));return t}setY(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize+1]=toHalfFloat(t);return this}getZ(e){let t=fromHalfFloat(this.array[e*this.itemSize+2]);this.normalized&&(t=denormalize(t,this.array));return t}setZ(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize+2]=toHalfFloat(t);return this}getW(e){let t=fromHalfFloat(this.array[e*this.itemSize+3]);this.normalized&&(t=denormalize(t,this.array));return t}setW(e,t){this.normalized&&(t=normalize(t,this.array));this.array[e*this.itemSize+3]=toHalfFloat(t);return this}setXY(e,t,n){e*=this.itemSize;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array)}this.array[e+0]=toHalfFloat(t);this.array[e+1]=toHalfFloat(n);return this}setXYZ(e,t,n,r){e*=this.itemSize;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array);r=normalize(r,this.array)}this.array[e+0]=toHalfFloat(t);this.array[e+1]=toHalfFloat(n);this.array[e+2]=toHalfFloat(r);return this}setXYZW(e,t,n,r,s){e*=this.itemSize;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array);r=normalize(r,this.array);s=normalize(s,this.array)}this.array[e+0]=toHalfFloat(t);this.array[e+1]=toHalfFloat(n);this.array[e+2]=toHalfFloat(r);this.array[e+3]=toHalfFloat(s);return this}}class Float32BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Fi=0;const Ui=new Matrix4;const Oi=new Object3D;const ki=new Vector3;const Ni=new Box3;const Gi=new Box3;const Vi=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super();this.isBufferGeometry=true;Object.defineProperty(this,"id",{value:Fi++});this.uuid=generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.indirect=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=false;this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.drawRange={start:0,count:Infinity};this.userData={}}getIndex(){return this.index}setIndex(e){Array.isArray(e)?this.index=new(arrayNeedsUint32(e)?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):this.index=e;return this}setIndirect(e){this.indirect=e;return this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){this.attributes[e]=t;return this}deleteAttribute(e){delete this.attributes[e];return this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e;this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;if(t!==void 0){t.applyMatrix4(e);t.needsUpdate=true}const n=this.attributes.normal;if(n!==void 0){const t=(new Matrix3).getNormalMatrix(e);n.applyNormalMatrix(t);n.needsUpdate=true}const r=this.attributes.tangent;if(r!==void 0){r.transformDirection(e);r.needsUpdate=true}this.boundingBox!==null&&this.computeBoundingBox();this.boundingSphere!==null&&this.computeBoundingSphere();return this}applyQuaternion(e){Ui.makeRotationFromQuaternion(e);this.applyMatrix4(Ui);return this}rotateX(e){Ui.makeRotationX(e);this.applyMatrix4(Ui);return this}rotateY(e){Ui.makeRotationY(e);this.applyMatrix4(Ui);return this}rotateZ(e){Ui.makeRotationZ(e);this.applyMatrix4(Ui);return this}translate(e,t,n){Ui.makeTranslation(e,t,n);this.applyMatrix4(Ui);return this}scale(e,t,n){Ui.makeScale(e,t,n);this.applyMatrix4(Ui);return this}lookAt(e){Oi.lookAt(e);Oi.updateMatrix();this.applyMatrix4(Oi.matrix);return this}center(){this.computeBoundingBox();this.boundingBox.getCenter(ki).negate();this.translate(ki.x,ki.y,ki.z);return this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new Float32BufferAttribute(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry.");t.needsUpdate=true}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const e=this.attributes.position;const t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this);this.boundingBox.set(new Vector3(-Infinity,-Infinity,-Infinity),new Vector3(Infinity,Infinity,Infinity))}else{if(e!==void 0){this.boundingBox.setFromBufferAttribute(e);if(t)for(let e=0,n=t.length;e<n;e++){const n=t[e];Ni.setFromBufferAttribute(n);if(this.morphTargetsRelative){Vi.addVectors(this.boundingBox.min,Ni.min);this.boundingBox.expandByPoint(Vi);Vi.addVectors(this.boundingBox.max,Ni.max);this.boundingBox.expandByPoint(Vi)}else{this.boundingBox.expandByPoint(Ni.min);this.boundingBox.expandByPoint(Ni.max)}}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const e=this.attributes.position;const t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this);this.boundingSphere.set(new Vector3,Infinity)}else if(e){const n=this.boundingSphere.center;Ni.setFromBufferAttribute(e);if(t)for(let e=0,n=t.length;e<n;e++){const n=t[e];Gi.setFromBufferAttribute(n);if(this.morphTargetsRelative){Vi.addVectors(Ni.min,Gi.min);Ni.expandByPoint(Vi);Vi.addVectors(Ni.max,Gi.max);Ni.expandByPoint(Vi)}else{Ni.expandByPoint(Gi.min);Ni.expandByPoint(Gi.max)}}Ni.getCenter(n);let r=0;for(let t=0,s=e.count;t<s;t++){Vi.fromBufferAttribute(e,t);r=Math.max(r,n.distanceToSquared(Vi))}if(t)for(let s=0,a=t.length;s<a;s++){const a=t[s];const o=this.morphTargetsRelative;for(let t=0,s=a.count;t<s;t++){Vi.fromBufferAttribute(a,t);if(o){ki.fromBufferAttribute(e,t);Vi.add(ki)}r=Math.max(r,n.distanceToSquared(Vi))}}this.boundingSphere.radius=Math.sqrt(r);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index;const t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position;const r=t.normal;const s=t.uv;this.hasAttribute("tangent")===false&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent");const o=[],l=[];for(let e=0;e<n.count;e++){o[e]=new Vector3;l[e]=new Vector3}const c=new Vector3,u=new Vector3,h=new Vector3,d=new Vector2,p=new Vector2,f=new Vector2,m=new Vector3,g=new Vector3;function handleTriangle(e,t,r){c.fromBufferAttribute(n,e);u.fromBufferAttribute(n,t);h.fromBufferAttribute(n,r);d.fromBufferAttribute(s,e);p.fromBufferAttribute(s,t);f.fromBufferAttribute(s,r);u.sub(c);h.sub(c);p.sub(d);f.sub(d);const a=1/(p.x*f.y-f.x*p.y);if(isFinite(a)){m.copy(u).multiplyScalar(f.y).addScaledVector(h,-p.y).multiplyScalar(a);g.copy(h).multiplyScalar(p.x).addScaledVector(u,-f.x).multiplyScalar(a);o[e].add(m);o[t].add(m);o[r].add(m);l[e].add(g);l[t].add(g);l[r].add(g)}}let y=this.groups;y.length===0&&(y=[{start:0,count:e.count}]);for(let t=0,n=y.length;t<n;++t){const n=y[t];const r=n.start;const s=n.count;for(let t=r,n=r+s;t<n;t+=3)handleTriangle(e.getX(t+0),e.getX(t+1),e.getX(t+2))}const b=new Vector3,x=new Vector3;const _=new Vector3,M=new Vector3;function handleVertex(e){_.fromBufferAttribute(r,e);M.copy(_);const t=o[e];b.copy(t);b.sub(_.multiplyScalar(_.dot(t))).normalize();x.crossVectors(M,t);const n=x.dot(l[e]);const s=n<0?-1:1;a.setXYZW(e,b.x,b.y,b.z,s)}for(let t=0,n=y.length;t<n;++t){const n=y[t];const r=n.start;const s=n.count;for(let t=r,n=r+s;t<n;t+=3){handleVertex(e.getX(t+0));handleVertex(e.getX(t+1));handleVertex(e.getX(t+2))}}}computeVertexNormals(){const e=this.index;const t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0){n=new BufferAttribute(new Float32Array(t.count*3),3);this.setAttribute("normal",n)}else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Vector3,s=new Vector3,a=new Vector3;const o=new Vector3,l=new Vector3,c=new Vector3;const u=new Vector3,h=new Vector3;if(e)for(let d=0,p=e.count;d<p;d+=3){const p=e.getX(d+0);const f=e.getX(d+1);const m=e.getX(d+2);r.fromBufferAttribute(t,p);s.fromBufferAttribute(t,f);a.fromBufferAttribute(t,m);u.subVectors(a,s);h.subVectors(r,s);u.cross(h);o.fromBufferAttribute(n,p);l.fromBufferAttribute(n,f);c.fromBufferAttribute(n,m);o.add(u);l.add(u);c.add(u);n.setXYZ(p,o.x,o.y,o.z);n.setXYZ(f,l.x,l.y,l.z);n.setXYZ(m,c.x,c.y,c.z)}else for(let e=0,o=t.count;e<o;e+=3){r.fromBufferAttribute(t,e+0);s.fromBufferAttribute(t,e+1);a.fromBufferAttribute(t,e+2);u.subVectors(a,s);h.subVectors(r,s);u.cross(h);n.setXYZ(e+0,u.x,u.y,u.z);n.setXYZ(e+1,u.x,u.y,u.z);n.setXYZ(e+2,u.x,u.y,u.z)}this.normalizeNormals();n.needsUpdate=true}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++){Vi.fromBufferAttribute(e,t);Vi.normalize();e.setXYZ(t,Vi.x,Vi.y,Vi.z)}}toNonIndexed(){function convertBufferAttribute(e,t){const n=e.array;const r=e.itemSize;const s=e.normalized;const a=new n.constructor(t.length*r);let o=0,l=0;for(let s=0,c=t.length;s<c;s++){o=e.isInterleavedBufferAttribute?t[s]*e.data.stride+e.offset:t[s]*r;for(let e=0;e<r;e++)a[l++]=n[o++]}return new BufferAttribute(a,r,s)}if(this.index===null){console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.");return this}const e=new BufferGeometry;const t=this.index.array;const n=this.attributes;for(const r in n){const s=n[r];const a=convertBufferAttribute(s,t);e.setAttribute(r,a)}const r=this.morphAttributes;for(const n in r){const s=[];const a=r[n];for(let e=0,n=a.length;e<n;e++){const n=a[e];const r=convertBufferAttribute(n,t);s.push(r)}e.morphAttributes[n]=s}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let t=0,n=s.length;t<n;t++){const n=s[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;this.name!==""&&(e.name=this.name);Object.keys(this.userData).length>0&&(e.userData=this.userData);if(this.parameters!==void 0){const t=this.parameters;for(const n in t)t[n]!==void 0&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t];e.data.attributes[t]=r.toJSON(e.data)}const r={};let s=false;for(const t in this.morphAttributes){const n=this.morphAttributes[t];const a=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];a.push(r.toJSON(e.data))}if(a.length>0){r[t]=a;s=true}}if(s){e.data.morphAttributes=r;e.data.morphTargetsRelative=this.morphTargetsRelative}const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius});return e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const s=e.morphAttributes;for(const e in s){const n=[];const r=s[e];for(let e=0,s=r.length;e<s;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let e=0,t=a.length;e<t;e++){const t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;l!==null&&(this.boundingSphere=l.clone());this.drawRange.start=e.drawRange.start;this.drawRange.count=e.drawRange.count;this.userData=e.userData;return this}dispose(){this.dispatchEvent({type:"dispose"})}}const Qi=new Matrix4;const ji=new Ray;const Hi=new Sphere;const zi=new Vector3;const qi=new Vector3;const Ki=new Vector3;const Xi=new Vector3;const Yi=new Vector3;const Ji=new Vector3;const Zi=new Vector3;const $i=new Vector3;class Mesh extends Object3D{constructor(e=new BufferGeometry,t=new MeshBasicMaterial){super();this.isMesh=true;this.type="Mesh";this.geometry=e;this.material=t;this.updateMorphTargets()}copy(e,t){super.copy(e,t);e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice());e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary));this.material=Array.isArray(e.material)?e.material.slice():e.material;this.geometry=e.geometry;return this}updateMorphTargets(){const e=this.geometry;const t=e.morphAttributes;const n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(e!==void 0){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[n]=t}}}}getVertexPosition(e,t){const n=this.geometry;const r=n.attributes.position;const s=n.morphAttributes.position;const a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){Ji.set(0,0,0);for(let n=0,r=s.length;n<r;n++){const r=o[n];const l=s[n];if(r!==0){Yi.fromBufferAttribute(l,e);a?Ji.addScaledVector(Yi,r):Ji.addScaledVector(Yi.sub(t),r)}}t.add(Ji)}return t}raycast(e,t){const n=this.geometry;const r=this.material;const s=this.matrixWorld;if(r!==void 0){n.boundingSphere===null&&n.computeBoundingSphere();Hi.copy(n.boundingSphere);Hi.applyMatrix4(s);ji.copy(e.ray).recast(e.near);if(Hi.containsPoint(ji.origin)===false){if(ji.intersectSphere(Hi,zi)===null)return;if(ji.origin.distanceToSquared(zi)>(e.far-e.near)**2)return}Qi.copy(s).invert();ji.copy(e.ray).applyMatrix4(Qi);n.boundingBox!==null&&ji.intersectsBox(n.boundingBox)===false||this._computeIntersections(e,t,ji)}}_computeIntersections(e,t,n){let r;const s=this.geometry;const a=this.material;const o=s.index;const l=s.attributes.position;const c=s.attributes.uv;const u=s.attributes.uv1;const h=s.attributes.normal;const d=s.groups;const p=s.drawRange;if(o!==null)if(Array.isArray(a))for(let s=0,l=d.length;s<l;s++){const l=d[s];const f=a[l.materialIndex];const m=Math.max(l.start,p.start);const g=Math.min(o.count,Math.min(l.start+l.count,p.start+p.count));for(let s=m,a=g;s<a;s+=3){const a=o.getX(s);const d=o.getX(s+1);const p=o.getX(s+2);r=checkGeometryIntersection(this,f,e,n,c,u,h,a,d,p);if(r){r.faceIndex=Math.floor(s/3);r.face.materialIndex=l.materialIndex;t.push(r)}}}else{const s=Math.max(0,p.start);const l=Math.min(o.count,p.start+p.count);for(let d=s,p=l;d<p;d+=3){const s=o.getX(d);const l=o.getX(d+1);const p=o.getX(d+2);r=checkGeometryIntersection(this,a,e,n,c,u,h,s,l,p);if(r){r.faceIndex=Math.floor(d/3);t.push(r)}}}else if(l!==void 0)if(Array.isArray(a))for(let s=0,o=d.length;s<o;s++){const o=d[s];const f=a[o.materialIndex];const m=Math.max(o.start,p.start);const g=Math.min(l.count,Math.min(o.start+o.count,p.start+p.count));for(let s=m,a=g;s<a;s+=3){const a=s;const l=s+1;const d=s+2;r=checkGeometryIntersection(this,f,e,n,c,u,h,a,l,d);if(r){r.faceIndex=Math.floor(s/3);r.face.materialIndex=o.materialIndex;t.push(r)}}}else{const s=Math.max(0,p.start);const o=Math.min(l.count,p.start+p.count);for(let l=s,d=o;l<d;l+=3){const s=l;const o=l+1;const d=l+2;r=checkGeometryIntersection(this,a,e,n,c,u,h,s,o,d);if(r){r.faceIndex=Math.floor(l/3);t.push(r)}}}}}function checkIntersection$1(e,t,n,r,s,a,o,l){let c;c=t.side===y?r.intersectTriangle(o,a,s,true,l):r.intersectTriangle(s,a,o,t.side===g,l);if(c===null)return null;$i.copy(l);$i.applyMatrix4(e.matrixWorld);const u=n.ray.origin.distanceTo($i);return u<n.near||u>n.far?null:{distance:u,point:$i.clone(),object:e}}function checkGeometryIntersection(e,t,n,r,s,a,o,l,c,u){e.getVertexPosition(l,qi);e.getVertexPosition(c,Ki);e.getVertexPosition(u,Xi);const h=checkIntersection$1(e,t,n,r,qi,Ki,Xi,Zi);if(h){const e=new Vector3;Triangle.getBarycoord(Zi,qi,Ki,Xi,e);s&&(h.uv=Triangle.getInterpolatedAttribute(s,l,c,u,e,new Vector2));a&&(h.uv1=Triangle.getInterpolatedAttribute(a,l,c,u,e,new Vector2));if(o){h.normal=Triangle.getInterpolatedAttribute(o,l,c,u,e,new Vector3);h.normal.dot(r.direction)>0&&h.normal.multiplyScalar(-1)}const t={a:l,b:c,c:u,normal:new Vector3,materialIndex:0};Triangle.getNormal(qi,Ki,Xi,t.normal);h.face=t;h.barycoord=e}return h}class BoxGeometry extends BufferGeometry{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super();this.type="BoxGeometry";this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r);s=Math.floor(s);a=Math.floor(a);const l=[];const c=[];const u=[];const h=[];let d=0;let p=0;buildPlane("z","y","x",-1,-1,n,t,e,a,s,0);buildPlane("z","y","x",1,-1,n,t,-e,a,s,1);buildPlane("x","z","y",1,1,e,n,t,r,a,2);buildPlane("x","z","y",1,-1,e,n,-t,r,a,3);buildPlane("x","y","z",1,-1,e,t,n,r,s,4);buildPlane("x","y","z",-1,-1,e,t,-n,r,s,5);this.setIndex(l);this.setAttribute("position",new Float32BufferAttribute(c,3));this.setAttribute("normal",new Float32BufferAttribute(u,3));this.setAttribute("uv",new Float32BufferAttribute(h,2));function buildPlane(e,t,n,r,s,a,f,m,g,y,b){const x=a/g;const _=f/y;const M=a/2;const w=f/2;const S=m/2;const T=g+1;const I=y+1;let R=0;let L=0;const D=new Vector3;for(let a=0;a<I;a++){const o=a*_-w;for(let l=0;l<T;l++){const d=l*x-M;D[e]=d*r;D[t]=o*s;D[n]=S;c.push(D.x,D.y,D.z);D[e]=0;D[t]=0;D[n]=m>0?1:-1;u.push(D.x,D.y,D.z);h.push(l/g);h.push(1-a/y);R+=1}}for(let e=0;e<y;e++)for(let t=0;t<g;t++){const n=d+t+T*e;const r=d+t+T*(e+1);const s=d+(t+1)+T*(e+1);const a=d+(t+1)+T*e;l.push(n,r,a);l.push(r,s,a);L+=6}o.addGroup(p,L,b);p+=L;d+=R}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new BoxGeometry(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cloneUniforms(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const s=e[n][r];if(s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion))if(s.isRenderTargetTexture){console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms().");t[n][r]=null}else t[n][r]=s.clone();else Array.isArray(s)?t[n][r]=s.slice():t[n][r]=s}}return t}function mergeUniforms(e){const t={};for(let n=0;n<e.length;n++){const r=cloneUniforms(e[n]);for(const e in r)t[e]=r[e]}return t}function cloneUniformsGroups(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}function getUnlitUniformColorSpace(e){const t=e.getRenderTarget();return t===null?e.outputColorSpace:t.isXRRenderTarget===true?t.texture.colorSpace:ar.workingColorSpace}const es={clone:cloneUniforms,merge:mergeUniforms};var ts="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";var ns="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class ShaderMaterial extends Material{constructor(e){super();this.isShaderMaterial=true;this.type="ShaderMaterial";this.defines={};this.uniforms={};this.uniformsGroups=[];this.vertexShader=ts;this.fragmentShader=ns;this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.clipping=false;this.forceSinglePass=true;this.extensions={clipCullDistance:false,multiDraw:false};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=false;this.glslVersion=null;e!==void 0&&this.setValues(e)}copy(e){super.copy(e);this.fragmentShader=e.fragmentShader;this.vertexShader=e.vertexShader;this.uniforms=cloneUniforms(e.uniforms);this.uniformsGroups=cloneUniformsGroups(e.uniformsGroups);this.defines=Object.assign({},e.defines);this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.fog=e.fog;this.lights=e.lights;this.clipping=e.clipping;this.extensions=Object.assign({},e.extensions);this.glslVersion=e.glslVersion;return this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion;t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n];const s=r.value;s&&s.isTexture?t.uniforms[n]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[n]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[n]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[n]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[n]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[n]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[n]={type:"m4",value:s.toArray()}:t.uniforms[n]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines);t.vertexShader=this.vertexShader;t.fragmentShader=this.fragmentShader;t.lights=this.lights;t.clipping=this.clipping;const n={};for(const e in this.extensions)this.extensions[e]===true&&(n[e]=true);Object.keys(n).length>0&&(t.extensions=n);return t}}class Camera extends Object3D{constructor(){super();this.isCamera=true;this.type="Camera";this.matrixWorldInverse=new Matrix4;this.projectionMatrix=new Matrix4;this.projectionMatrixInverse=new Matrix4;this.coordinateSystem=qn}copy(e,t){super.copy(e,t);this.matrixWorldInverse.copy(e.matrixWorldInverse);this.projectionMatrix.copy(e.projectionMatrix);this.projectionMatrixInverse.copy(e.projectionMatrixInverse);this.coordinateSystem=e.coordinateSystem;return this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e);this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t);this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const rs=new Vector3;const is=new Vector2;const ss=new Vector2;class PerspectiveCamera extends Camera{constructor(e=50,t=1,n=.1,r=2e3){super();this.isPerspectiveCamera=true;this.type="PerspectiveCamera";this.fov=e;this.zoom=1;this.near=n;this.far=r;this.focus=10;this.aspect=t;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}copy(e,t){super.copy(e,t);this.fov=e.fov;this.zoom=e.zoom;this.near=e.near;this.far=e.far;this.focus=e.focus;this.aspect=e.aspect;this.view=e.view===null?null:Object.assign({},e.view);this.filmGauge=e.filmGauge;this.filmOffset=e.filmOffset;return this}
/**
            * Sets the FOV by focal length in respect to the current .filmGauge.
            *
            * The default film gauge is 35, so that the focal length can be specified for
            * a 35mm (full frame) camera.
            *
            * @param {number} focalLength - Values for focal length and film gauge must have the same unit.
            */setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=$n*2*Math.atan(t);this.updateProjectionMatrix()}
/**
            * Calculates the focal length from the current .fov and .filmGauge.
            *
            * @returns {number}
            */getFocalLength(){const e=Math.tan(Zn*.5*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return $n*2*Math.atan(Math.tan(Zn*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}
/**
            * Computes the 2D bounds of the camera's viewable rectangle at a given distance along the viewing direction.
            * Sets minTarget and maxTarget to the coordinates of the lower-left and upper-right corners of the view rectangle.
            *
            * @param {number} distance
            * @param {Vector2} minTarget
            * @param {Vector2} maxTarget
            */getViewBounds(e,t,n){rs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse);t.set(rs.x,rs.y).multiplyScalar(-e/rs.z);rs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse);n.set(rs.x,rs.y).multiplyScalar(-e/rs.z)}
/**
            * Computes the width and height of the camera's viewable rectangle at a given distance along the viewing direction.
            *
            * @param {number} distance
            * @param {Vector2} target - Vector2 target used to store result where x is width and y is height.
            * @returns {Vector2}
            */getViewSize(e,t){this.getViewBounds(e,is,ss);return t.subVectors(ss,is)}
/**
            * Sets an offset in a larger frustum. This is useful for multi-window or
            * multi-monitor/multi-machine setups.
            *
            * For example, if you have 3x2 monitors and each monitor is 1920x1080 and
            * the monitors are in grid like this
            *
            *   +---+---+---+
            *   | A | B | C |
            *   +---+---+---+
            *   | D | E | F |
            *   +---+---+---+
            *
            * then for each monitor you would call it like this
            *
            *   const w = 1920;
            *   const h = 1080;
            *   const fullWidth = w * 3;
            *   const fullHeight = h * 2;
            *
            *   --A--
            *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );
            *   --B--
            *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );
            *   --C--
            *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );
            *   --D--
            *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );
            *   --E--
            *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );
            *   --F--
            *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );
            *
            *   Note there is no reason monitors have to be the same size or in a grid.
            *
            * @param {number} fullWidth
            * @param {number} fullHeight
            * @param {number} x
            * @param {number} y
            * @param {number} width
            * @param {number} height
            */setViewOffset(e,t,n,r,s,a){this.aspect=e/t;this.view===null&&(this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=true;this.view.fullWidth=e;this.view.fullHeight=t;this.view.offsetX=n;this.view.offsetY=r;this.view.width=s;this.view.height=a;this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=false);this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Zn*.5*this.fov)/this.zoom;let n=2*t;let r=this.aspect*n;let s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const e=a.fullWidth,o=a.fullHeight;s+=a.offsetX*r/e;t-=a.offsetY*n/o;r*=a.width/e;n*=a.height/o}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth());this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);t.object.fov=this.fov;t.object.zoom=this.zoom;t.object.near=this.near;t.object.far=this.far;t.object.focus=this.focus;t.object.aspect=this.aspect;this.view!==null&&(t.object.view=Object.assign({},this.view));t.object.filmGauge=this.filmGauge;t.object.filmOffset=this.filmOffset;return t}}const as=-90;const os=1;class CubeCamera extends Object3D{constructor(e,t,n){super();this.type="CubeCamera";this.renderTarget=n;this.coordinateSystem=null;this.activeMipmapLevel=0;const r=new PerspectiveCamera(as,os,e,t);r.layers=this.layers;this.add(r);const s=new PerspectiveCamera(as,os,e,t);s.layers=this.layers;this.add(s);const a=new PerspectiveCamera(as,os,e,t);a.layers=this.layers;this.add(a);const o=new PerspectiveCamera(as,os,e,t);o.layers=this.layers;this.add(o);const l=new PerspectiveCamera(as,os,e,t);l.layers=this.layers;this.add(l);const c=new PerspectiveCamera(as,os,e,t);c.layers=this.layers;this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem;const t=this.children.concat();const[n,r,s,a,o,l]=t;for(const e of t)this.remove(e);if(e===qn){n.up.set(0,1,0);n.lookAt(1,0,0);r.up.set(0,1,0);r.lookAt(-1,0,0);s.up.set(0,0,-1);s.lookAt(0,1,0);a.up.set(0,0,1);a.lookAt(0,-1,0);o.up.set(0,1,0);o.lookAt(0,0,1);l.up.set(0,1,0);l.lookAt(0,0,-1)}else{if(e!==Kn)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0);n.lookAt(-1,0,0);r.up.set(0,-1,0);r.lookAt(1,0,0);s.up.set(0,0,1);s.lookAt(0,1,0);a.up.set(0,0,-1);a.lookAt(0,-1,0);o.up.set(0,-1,0);o.lookAt(0,0,1);l.up.set(0,-1,0);l.lookAt(0,0,-1)}for(const e of t){this.add(e);e.updateMatrixWorld()}}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;if(this.coordinateSystem!==e.coordinateSystem){this.coordinateSystem=e.coordinateSystem;this.updateCoordinateSystem()}const[s,a,o,l,c,u]=this.children;const h=e.getRenderTarget();const d=e.getActiveCubeFace();const p=e.getActiveMipmapLevel();const f=e.xr.enabled;e.xr.enabled=false;const m=n.texture.generateMipmaps;n.texture.generateMipmaps=false;e.setRenderTarget(n,0,r);e.render(t,s);e.setRenderTarget(n,1,r);e.render(t,a);e.setRenderTarget(n,2,r);e.render(t,o);e.setRenderTarget(n,3,r);e.render(t,l);e.setRenderTarget(n,4,r);e.render(t,c);n.texture.generateMipmaps=m;e.setRenderTarget(n,5,r);e.render(t,u);e.setRenderTarget(h,d,p);e.xr.enabled=f;n.texture.needsPMREMUpdate=true}}class CubeTexture extends Texture{constructor(e,t,n,r,s,a,o,l,c,u){e=e!==void 0?e:[];t=t!==void 0?t:ye;super(e,t,n,r,s,a,o,l,c,u);this.isCubeTexture=true;this.flipY=false}get images(){return this.image}set images(e){this.image=e}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(e=1,t={}){super(e,e,t);this.isWebGLCubeRenderTarget=true;const n={width:e,height:e,depth:1};const r=[n,n,n,n,n,n];this.texture=new CubeTexture(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace);this.texture.isRenderTargetTexture=true;this.texture.generateMipmaps=t.generateMipmaps!==void 0&&t.generateMipmaps;this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Le}fromEquirectangularTexture(e,t){this.texture.type=t.type;this.texture.colorSpace=t.colorSpace;this.texture.generateMipmaps=t.generateMipmaps;this.texture.minFilter=t.minFilter;this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"};const r=new BoxGeometry(5,5,5);const s=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:y,blending:x});s.uniforms.tEquirect.value=t;const a=new Mesh(r,s);const o=t.minFilter;t.minFilter===Fe&&(t.minFilter=Le);const l=new CubeCamera(1,10,this);l.update(e,a);t.minFilter=o;a.geometry.dispose();a.material.dispose();return this}clear(e,t,n,r){const s=e.getRenderTarget();for(let s=0;s<6;s++){e.setRenderTarget(this,s);e.clear(t,n,r)}e.setRenderTarget(s)}}class Group extends Object3D{constructor(){super();this.isGroup=true;this.type="Group"}}const ls={type:"move"};class WebXRController{constructor(){this._targetRay=null;this._grip=null;this._hand=null}getHandSpace(){if(this._hand===null){this._hand=new Group;this._hand.matrixAutoUpdate=false;this._hand.visible=false;this._hand.joints={};this._hand.inputState={pinching:false}}return this._hand}getTargetRaySpace(){if(this._targetRay===null){this._targetRay=new Group;this._targetRay.matrixAutoUpdate=false;this._targetRay.visible=false;this._targetRay.hasLinearVelocity=false;this._targetRay.linearVelocity=new Vector3;this._targetRay.hasAngularVelocity=false;this._targetRay.angularVelocity=new Vector3}return this._targetRay}getGripSpace(){if(this._grip===null){this._grip=new Group;this._grip.matrixAutoUpdate=false;this._grip.visible=false;this._grip.hasLinearVelocity=false;this._grip.linearVelocity=new Vector3;this._grip.hasAngularVelocity=false;this._grip.angularVelocity=new Vector3}return this._grip}dispatchEvent(e){this._targetRay!==null&&this._targetRay.dispatchEvent(e);this._grip!==null&&this._grip.dispatchEvent(e);this._hand!==null&&this._hand.dispatchEvent(e);return this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}this.dispatchEvent({type:"connected",data:e});return this}disconnect(e){this.dispatchEvent({type:"disconnected",data:e});this._targetRay!==null&&(this._targetRay.visible=false);this._grip!==null&&(this._grip.visible=false);this._hand!==null&&(this._hand.visible=false);return this}update(e,t,n){let r=null;let s=null;let a=null;const o=this._targetRay;const l=this._grip;const c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=true;for(const r of e.hand.values()){const e=t.getJointPose(r,n);const s=this._getHandJoint(c,r);if(e!==null){s.matrix.fromArray(e.transform.matrix);s.matrix.decompose(s.position,s.rotation,s.scale);s.matrixWorldNeedsUpdate=true;s.jointRadius=e.radius}s.visible=e!==null}const r=c.joints["index-finger-tip"];const s=c.joints["thumb-tip"];const o=r.position.distanceTo(s.position);const l=.02;const u=.005;if(c.inputState.pinching&&o>l+u){c.inputState.pinching=false;this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})}else if(!c.inputState.pinching&&o<=l-u){c.inputState.pinching=true;this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this})}}else if(l!==null&&e.gripSpace){s=t.getPose(e.gripSpace,n);if(s!==null){l.matrix.fromArray(s.transform.matrix);l.matrix.decompose(l.position,l.rotation,l.scale);l.matrixWorldNeedsUpdate=true;if(s.linearVelocity){l.hasLinearVelocity=true;l.linearVelocity.copy(s.linearVelocity)}else l.hasLinearVelocity=false;if(s.angularVelocity){l.hasAngularVelocity=true;l.angularVelocity.copy(s.angularVelocity)}else l.hasAngularVelocity=false}}if(o!==null){r=t.getPose(e.targetRaySpace,n);r===null&&s!==null&&(r=s);if(r!==null){o.matrix.fromArray(r.transform.matrix);o.matrix.decompose(o.position,o.rotation,o.scale);o.matrixWorldNeedsUpdate=true;if(r.linearVelocity){o.hasLinearVelocity=true;o.linearVelocity.copy(r.linearVelocity)}else o.hasLinearVelocity=false;if(r.angularVelocity){o.hasAngularVelocity=true;o.angularVelocity.copy(r.angularVelocity)}else o.hasAngularVelocity=false;this.dispatchEvent(ls)}}}o!==null&&(o.visible=r!==null);l!==null&&(l.visible=s!==null);c!==null&&(c.visible=a!==null);return this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Group;n.matrixAutoUpdate=false;n.visible=false;e.joints[t.jointName]=n;e.add(n)}return e.joints[t.jointName]}}class FogExp2{constructor(e,t=25e-5){this.isFogExp2=true;this.name="";this.color=new Color(e);this.density=t}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(e,t=1,n=1e3){this.isFog=true;this.name="";this.color=new Color(e);this.near=t;this.far=n}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super();this.isScene=true;this.type="Scene";this.background=null;this.environment=null;this.fog=null;this.backgroundBlurriness=0;this.backgroundIntensity=1;this.backgroundRotation=new Euler;this.environmentIntensity=1;this.environmentRotation=new Euler;this.overrideMaterial=null;typeof __THREE_DEVTOOLS__!=="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){super.copy(e,t);e.background!==null&&(this.background=e.background.clone());e.environment!==null&&(this.environment=e.environment.clone());e.fog!==null&&(this.fog=e.fog.clone());this.backgroundBlurriness=e.backgroundBlurriness;this.backgroundIntensity=e.backgroundIntensity;this.backgroundRotation.copy(e.backgroundRotation);this.environmentIntensity=e.environmentIntensity;this.environmentRotation.copy(e.environmentRotation);e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone());this.matrixAutoUpdate=e.matrixAutoUpdate;return this}toJSON(e){const t=super.toJSON(e);this.fog!==null&&(t.object.fog=this.fog.toJSON());this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness);this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity);t.object.backgroundRotation=this.backgroundRotation.toArray();this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity);t.object.environmentRotation=this.environmentRotation.toArray();return t}}class InterleavedBuffer{constructor(e,t){this.isInterleavedBuffer=true;this.array=e;this.stride=t;this.count=e!==void 0?e.length/t:0;this.usage=Un;this.updateRanges=[];this.version=0;this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(e){e===true&&this.version++}setUsage(e){this.usage=e;return this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){this.array=new e.array.constructor(e.array);this.count=e.count;this.stride=e.stride;this.usage=e.usage;return this}copyAt(e,t,n){e*=this.stride;n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){this.array.set(e,t);return this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={});this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID());e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]);const n=new this.constructor(t,this.stride);n.setUsage(this.usage);return n}onUpload(e){this.onUploadCallback=e;return this}toJSON(e){e.arrayBuffers===void 0&&(e.arrayBuffers={});this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID());e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer)));return{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const cs=new Vector3;class InterleavedBufferAttribute{constructor(e,t,n,r=false){this.isInterleavedBufferAttribute=true;this.name="";this.data=e;this.itemSize=t;this.offset=n;this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++){cs.fromBufferAttribute(this,t);cs.applyMatrix4(e);this.setXYZ(t,cs.x,cs.y,cs.z)}return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++){cs.fromBufferAttribute(this,t);cs.applyNormalMatrix(e);this.setXYZ(t,cs.x,cs.y,cs.z)}return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++){cs.fromBufferAttribute(this,t);cs.transformDirection(e);this.setXYZ(t,cs.x,cs.y,cs.z)}return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];this.normalized&&(n=denormalize(n,this.array));return n}setComponent(e,t,n){this.normalized&&(n=normalize(n,this.array));this.data.array[e*this.data.stride+this.offset+t]=n;return this}setX(e,t){this.normalized&&(t=normalize(t,this.array));this.data.array[e*this.data.stride+this.offset]=t;return this}setY(e,t){this.normalized&&(t=normalize(t,this.array));this.data.array[e*this.data.stride+this.offset+1]=t;return this}setZ(e,t){this.normalized&&(t=normalize(t,this.array));this.data.array[e*this.data.stride+this.offset+2]=t;return this}setW(e,t){this.normalized&&(t=normalize(t,this.array));this.data.array[e*this.data.stride+this.offset+3]=t;return this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];this.normalized&&(t=denormalize(t,this.array));return t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];this.normalized&&(t=denormalize(t,this.array));return t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];this.normalized&&(t=denormalize(t,this.array));return t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];this.normalized&&(t=denormalize(t,this.array));return t}setXY(e,t,n){e=e*this.data.stride+this.offset;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array)}this.data.array[e+0]=t;this.data.array[e+1]=n;return this}setXYZ(e,t,n,r){e=e*this.data.stride+this.offset;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array);r=normalize(r,this.array)}this.data.array[e+0]=t;this.data.array[e+1]=n;this.data.array[e+2]=r;return this}setXYZW(e,t,n,r,s){e=e*this.data.stride+this.offset;if(this.normalized){t=normalize(t,this.array);n=normalize(n,this.array);r=normalize(r,this.array);s=normalize(s,this.array)}this.data.array[e+0]=t;this.data.array[e+1]=n;this.data.array[e+2]=r;this.data.array[e+3]=s;return this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new BufferAttribute(new this.array.constructor(e),this.itemSize,this.normalized)}e.interleavedBuffers===void 0&&(e.interleavedBuffers={});e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e));return new InterleavedBufferAttribute(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}e.interleavedBuffers===void 0&&(e.interleavedBuffers={});e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e));return{isInterleavedBufferAttribute:true,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(e){super();this.isSpriteMaterial=true;this.type="SpriteMaterial";this.color=new Color(16777215);this.map=null;this.alphaMap=null;this.rotation=0;this.sizeAttenuation=true;this.transparent=true;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.map=e.map;this.alphaMap=e.alphaMap;this.rotation=e.rotation;this.sizeAttenuation=e.sizeAttenuation;this.fog=e.fog;return this}}let us;const hs=new Vector3;const ds=new Vector3;const ps=new Vector3;const fs=new Vector2;const ms=new Vector2;const As=new Matrix4;const gs=new Vector3;const vs=new Vector3;const ys=new Vector3;const Cs=new Vector2;const Es=new Vector2;const bs=new Vector2;class Sprite extends Object3D{constructor(e=new SpriteMaterial){super();this.isSprite=true;this.type="Sprite";if(us===void 0){us=new BufferGeometry;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);const t=new InterleavedBuffer(e,5);us.setIndex([0,1,2,0,2,3]);us.setAttribute("position",new InterleavedBufferAttribute(t,3,0,false));us.setAttribute("uv",new InterleavedBufferAttribute(t,2,3,false))}this.geometry=us;this.material=e;this.center=new Vector2(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.');ds.setFromMatrixScale(this.matrixWorld);As.copy(e.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld);ps.setFromMatrixPosition(this.modelViewMatrix);e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===false&&ds.multiplyScalar(-ps.z);const n=this.material.rotation;let r,s;if(n!==0){s=Math.cos(n);r=Math.sin(n)}const a=this.center;transformVertex(gs.set(-.5,-.5,0),ps,a,ds,r,s);transformVertex(vs.set(.5,-.5,0),ps,a,ds,r,s);transformVertex(ys.set(.5,.5,0),ps,a,ds,r,s);Cs.set(0,0);Es.set(1,0);bs.set(1,1);let o=e.ray.intersectTriangle(gs,vs,ys,false,hs);if(o===null){transformVertex(vs.set(-.5,.5,0),ps,a,ds,r,s);Es.set(0,1);o=e.ray.intersectTriangle(gs,ys,vs,false,hs);if(o===null)return}const l=e.ray.origin.distanceTo(hs);l<e.near||l>e.far||t.push({distance:l,point:hs.clone(),uv:Triangle.getInterpolation(hs,gs,vs,ys,Cs,Es,bs,new Vector2),face:null,object:this})}copy(e,t){super.copy(e,t);e.center!==void 0&&this.center.copy(e.center);this.material=e.material;return this}}function transformVertex(e,t,n,r,s,a){fs.subVectors(e,n).addScalar(.5).multiply(r);if(s!==void 0){ms.x=a*fs.x-s*fs.y;ms.y=s*fs.x+a*fs.y}else ms.copy(fs);e.copy(t);e.x+=ms.x;e.y+=ms.y;e.applyMatrix4(As)}const xs=new Vector3;const _s=new Vector3;class LOD extends Object3D{constructor(){super();this._currentLevel=0;this.type="LOD";Object.defineProperties(this,{levels:{enumerable:true,value:[]},isLOD:{value:true}});this.autoUpdate=true}copy(e){super.copy(e,false);const t=e.levels;for(let e=0,n=t.length;e<n;e++){const n=t[e];this.addLevel(n.object.clone(),n.distance,n.hysteresis)}this.autoUpdate=e.autoUpdate;return this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length;s++)if(t<r[s].distance)break;r.splice(s,0,{distance:t,hysteresis:n,object:e});this.add(e);return this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);this.remove(e[0].object);return true}return false}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let r=t[n].distance;t[n].object.visible&&(r-=r*t[n].hysteresis);if(e<r)break}return t[n-1].object}return null}raycast(e,t){const n=this.levels;if(n.length>0){xs.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(xs);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){xs.setFromMatrixPosition(e.matrixWorld);_s.setFromMatrixPosition(this.matrixWorld);const n=xs.distanceTo(_s)/e.zoom;t[0].object.visible=true;let r,s;for(r=1,s=t.length;r<s;r++){let e=t[r].distance;t[r].object.visible&&(e-=e*t[r].hysteresis);if(!(n>=e))break;t[r-1].object.visible=false;t[r].object.visible=true}this._currentLevel=r-1;for(;r<s;r++)t[r].object.visible=false}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===false&&(t.object.autoUpdate=false);t.object.levels=[];const n=this.levels;for(let e=0,r=n.length;e<r;e++){const r=n[e];t.object.levels.push({object:r.object.uuid,distance:r.distance,hysteresis:r.hysteresis})}return t}}const Ms=new Vector3;const ws=new Vector4;const Ss=new Vector4;const Ts=new Vector3;const Bs=new Matrix4;const Is=new Vector3;const Rs=new Sphere;const Ls=new Matrix4;const Ds=new Ray;class SkinnedMesh extends Mesh{constructor(e,t){super(e,t);this.isSkinnedMesh=true;this.type="SkinnedMesh";this.bindMode=Ae;this.bindMatrix=new Matrix4;this.bindMatrixInverse=new Matrix4;this.boundingBox=null;this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3);this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let e=0;e<t.count;e++){this.getVertexPosition(e,Is);this.boundingBox.expandByPoint(Is)}}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere);this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let e=0;e<t.count;e++){this.getVertexPosition(e,Is);this.boundingSphere.expandByPoint(Is)}}copy(e,t){super.copy(e,t);this.bindMode=e.bindMode;this.bindMatrix.copy(e.bindMatrix);this.bindMatrixInverse.copy(e.bindMatrixInverse);this.skeleton=e.skeleton;e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone());e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone());return this}raycast(e,t){const n=this.material;const r=this.matrixWorld;if(n!==void 0){this.boundingSphere===null&&this.computeBoundingSphere();Rs.copy(this.boundingSphere);Rs.applyMatrix4(r);if(e.ray.intersectsSphere(Rs)!==false){Ls.copy(r).invert();Ds.copy(e.ray).applyMatrix4(Ls);this.boundingBox!==null&&Ds.intersectsBox(this.boundingBox)===false||this._computeIntersections(e,t,Ds)}}}getVertexPosition(e,t){super.getVertexPosition(e,t);this.applyBoneTransform(e,t);return t}bind(e,t){this.skeleton=e;if(t===void 0){this.updateMatrixWorld(true);this.skeleton.calculateInverses();t=this.matrixWorld}this.bindMatrix.copy(t);this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Vector4;const t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==Infinity?e.multiplyScalar(r):e.set(1,0,0,0);t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e);this.bindMode===Ae?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===ge?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton;const r=this.geometry;ws.fromBufferAttribute(r.attributes.skinIndex,e);Ss.fromBufferAttribute(r.attributes.skinWeight,e);Ms.copy(t).applyMatrix4(this.bindMatrix);t.set(0,0,0);for(let e=0;e<4;e++){const r=Ss.getComponent(e);if(r!==0){const s=ws.getComponent(e);Bs.multiplyMatrices(n.bones[s].matrixWorld,n.boneInverses[s]);t.addScaledVector(Ts.copy(Ms).applyMatrix4(Bs),r)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super();this.isBone=true;this.type="Bone"}}class DataTexture extends Texture{constructor(e=null,t=1,n=1,r,s,a,o,l,c=Se,u=Se,h,d){super(null,a,o,l,c,u,r,s,h,d);this.isDataTexture=true;this.image={data:e,width:t,height:n};this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1}}const Ps=new Matrix4;const Fs=new Matrix4;class Skeleton{constructor(e=[],t=[]){this.uuid=generateUUID();this.bones=e.slice(0);this.boneInverses=t;this.boneMatrices=null;this.boneTexture=null;this.init()}init(){const e=this.bones;const t=this.boneInverses;this.boneMatrices=new Float32Array(e.length*16);if(t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.");this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Matrix4;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert();this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];if(t){if(t.parent&&t.parent.isBone){t.matrix.copy(t.parent.matrixWorld).invert();t.matrix.multiply(t.matrixWorld)}else t.matrix.copy(t.matrixWorld);t.matrix.decompose(t.position,t.quaternion,t.scale)}}}update(){const e=this.bones;const t=this.boneInverses;const n=this.boneMatrices;const r=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const s=e[r]?e[r].matrixWorld:Fs;Ps.multiplyMatrices(s,t[r]);Ps.toArray(n,r*16)}r!==null&&(r.needsUpdate=true)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4;e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new DataTexture(t,e,e,Je,je);n.needsUpdate=true;this.boneMatrices=t;this.boneTexture=n;return this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){if(this.boneTexture!==null){this.boneTexture.dispose();this.boneTexture=null}}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let s=t[r];if(s===void 0){console.warn("THREE.Skeleton: No bone found with UUID:",r);s=new Bone}this.bones.push(s);this.boneInverses.push((new Matrix4).fromArray(e.boneInverses[n]))}this.init();return this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones;const n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const s=t[r];e.bones.push(s.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class InstancedBufferAttribute extends BufferAttribute{constructor(e,t,n,r=1){super(e,t,n);this.isInstancedBufferAttribute=true;this.meshPerAttribute=r}copy(e){super.copy(e);this.meshPerAttribute=e.meshPerAttribute;return this}toJSON(){const e=super.toJSON();e.meshPerAttribute=this.meshPerAttribute;e.isInstancedBufferAttribute=true;return e}}const Us=new Matrix4;const Os=new Matrix4;const ks=[];const Ns=new Box3;const Gs=new Matrix4;const Vs=new Mesh;const Qs=new Sphere;class InstancedMesh extends Mesh{constructor(e,t,n){super(e,t);this.isInstancedMesh=true;this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(n*16),16);this.instanceColor=null;this.morphTexture=null;this.count=n;this.boundingBox=null;this.boundingSphere=null;for(let e=0;e<n;e++)this.setMatrixAt(e,Gs)}computeBoundingBox(){const e=this.geometry;const t=this.count;this.boundingBox===null&&(this.boundingBox=new Box3);e.boundingBox===null&&e.computeBoundingBox();this.boundingBox.makeEmpty();for(let n=0;n<t;n++){this.getMatrixAt(n,Us);Ns.copy(e.boundingBox).applyMatrix4(Us);this.boundingBox.union(Ns)}}computeBoundingSphere(){const e=this.geometry;const t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere);e.boundingSphere===null&&e.computeBoundingSphere();this.boundingSphere.makeEmpty();for(let n=0;n<t;n++){this.getMatrixAt(n,Us);Qs.copy(e.boundingSphere).applyMatrix4(Us);this.boundingSphere.union(Qs)}}copy(e,t){super.copy(e,t);this.instanceMatrix.copy(e.instanceMatrix);e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone());e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone());this.count=e.count;e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone());e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone());return this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences;const r=this.morphTexture.source.data.data;const s=n.length+1;const a=e*s+1;for(let e=0;e<n.length;e++)n[e]=r[a+e]}raycast(e,t){const n=this.matrixWorld;const r=this.count;Vs.geometry=this.geometry;Vs.material=this.material;if(Vs.material!==void 0){this.boundingSphere===null&&this.computeBoundingSphere();Qs.copy(this.boundingSphere);Qs.applyMatrix4(n);if(e.ray.intersectsSphere(Qs)!==false)for(let s=0;s<r;s++){this.getMatrixAt(s,Us);Os.multiplyMatrices(n,Us);Vs.matrixWorld=Os;Vs.raycast(e,ks);for(let e=0,n=ks.length;e<n;e++){const n=ks[e];n.instanceId=s;n.object=this;t.push(n)}ks.length=0}}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3).fill(1),3));t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences;const r=n.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(r*this.count),r,this.count,nt,je));const s=this.morphTexture.source.data.data;let a=0;for(let e=0;e<n.length;e++)a+=n[e];const o=this.geometry.morphTargetsRelative?1:1-a;const l=r*e;s[l]=o;s.set(n,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"});if(this.morphTexture!==null){this.morphTexture.dispose();this.morphTexture=null}return this}}const js=new Vector3;const Hs=new Vector3;const zs=new Matrix3;class Plane{constructor(e=new Vector3(1,0,0),t=0){this.isPlane=true;this.normal=e;this.constant=t}set(e,t){this.normal.copy(e);this.constant=t;return this}setComponents(e,t,n,r){this.normal.set(e,t,n);this.constant=r;return this}setFromNormalAndCoplanarPoint(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this}setFromCoplanarPoints(e,t,n){const r=js.subVectors(n,t).cross(Hs.subVectors(e,t)).normalize();this.setFromNormalAndCoplanarPoint(r,e);return this}copy(e){this.normal.copy(e.normal);this.constant=e.constant;return this}normalize(){const e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this}negate(){this.constant*=-1;this.normal.negate();return this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(js);const r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start);const n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||zs.getNormalMatrix(e);const r=this.coplanarPoint(js).applyMatrix4(e);const s=this.normal.applyMatrix3(n).normalize();this.constant=-r.dot(s);return this}translate(e){this.constant-=e.dot(this.normal);return this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ws=new Sphere;const qs=new Vector3;class Frustum{constructor(e=new Plane,t=new Plane,n=new Plane,r=new Plane,s=new Plane,a=new Plane){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const o=this.planes;o[0].copy(e);o[1].copy(t);o[2].copy(n);o[3].copy(r);o[4].copy(s);o[5].copy(a);return this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=qn){const n=this.planes;const r=e.elements;const s=r[0],a=r[1],o=r[2],l=r[3];const c=r[4],u=r[5],h=r[6],d=r[7];const p=r[8],f=r[9],m=r[10],g=r[11];const y=r[12],b=r[13],x=r[14],_=r[15];n[0].setComponents(l-s,d-c,g-p,_-y).normalize();n[1].setComponents(l+s,d+c,g+p,_+y).normalize();n[2].setComponents(l+a,d+u,g+f,_+b).normalize();n[3].setComponents(l-a,d-u,g-f,_-b).normalize();n[4].setComponents(l-o,d-h,g-m,_-x).normalize();if(t===qn)n[5].setComponents(l+o,d+h,g+m,_+x).normalize();else{if(t!==Kn)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,h,m,x).normalize()}return this}intersectsObject(e){if(e.boundingSphere!==void 0){e.boundingSphere===null&&e.computeBoundingSphere();Ws.copy(e.boundingSphere).applyMatrix4(e.matrixWorld)}else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere();Ws.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ws)}intersectsSprite(e){Ws.center.set(0,0,0);Ws.radius=.7071067811865476;Ws.applyMatrix4(e.matrixWorld);return this.intersectsSphere(Ws)}intersectsSphere(e){const t=this.planes;const n=e.center;const r=-e.radius;for(let e=0;e<6;e++){const s=t[e].distanceToPoint(n);if(s<r)return false}return true}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];qs.x=r.normal.x>0?e.max.x:e.min.x;qs.y=r.normal.y>0?e.max.y:e.min.y;qs.z=r.normal.z>0?e.max.z:e.min.z;if(r.distanceToPoint(qs)<0)return false}return true}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return false;return true}clone(){return(new this.constructor).copy(this)}}function ascIdSort(e,t){return e-t}function sortOpaque(e,t){return e.z-t.z}function sortTransparent(e,t){return t.z-e.z}class MultiDrawRenderList{constructor(){this.index=0;this.pool=[];this.list=[]}push(e,t,n,r){const s=this.pool;const a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o);this.index++;o.start=e;o.count=t;o.z=n;o.index=r}reset(){this.list.length=0;this.index=0}}const Ks=new Matrix4;const Xs=new Color(1,1,1);const Ys=new Frustum;const Js=new Box3;const Zs=new Sphere;const $s=new Vector3;const ea=new Vector3;const ta=new Vector3;const na=new MultiDrawRenderList;const ra=new Mesh;const ia=[];function copyAttributeData(e,t,n=0){const r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const s=e.count;for(let a=0;a<s;a++)for(let s=0;s<r;s++)t.setComponent(a+n,s,e.getComponent(a,s))}else t.array.set(e.array,n*r);t.needsUpdate=true}function copyArrayContents(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)t[r]=e[r]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class BatchedMesh extends Mesh{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,t,n=t*2,r){super(new BufferGeometry,r);this.isBatchedMesh=true;this.perObjectFrustumCulled=true;this.sortObjects=true;this.boundingBox=null;this.boundingSphere=null;this.customSort=null;this._instanceInfo=[];this._geometryInfo=[];this._availableInstanceIds=[];this._availableGeometryIds=[];this._nextIndexStart=0;this._nextVertexStart=0;this._geometryCount=0;this._visibilityChanged=true;this._geometryInitialized=false;this._maxInstanceCount=e;this._maxVertexCount=t;this._maxIndexCount=n;this._multiDrawCounts=new Int32Array(e);this._multiDrawStarts=new Int32Array(e);this._multiDrawCount=0;this._multiDrawInstances=null;this._matricesTexture=null;this._indirectTexture=null;this._colorsTexture=null;this._initMatricesTexture();this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4;e=Math.max(e,4);const t=new Float32Array(e*e*4);const n=new DataTexture(t,e,e,Je,je);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e);const n=new DataTexture(t,e,e,rt,Qe);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1);const n=new DataTexture(t,e,e,Je,je);n.colorSpace=ar.workingColorSpace;this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry;const n=this._maxVertexCount;const r=this._maxIndexCount;if(this._geometryInitialized===false){for(const r in e.attributes){const s=e.getAttribute(r);const{array:a,itemSize:o,normalized:l}=s;const c=new a.constructor(n*o);const u=new BufferAttribute(c,o,l);t.setAttribute(r,u)}if(e.getIndex()!==null){const e=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new BufferAttribute(e,1))}this._geometryInitialized=true}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n);const s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===false)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===false)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){this.customSort=e;return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const e=this.boundingBox;const t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===false)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,Ks);this.getBoundingBoxAt(r,Js).applyMatrix4(Ks);e.union(Js)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const e=this.boundingSphere;const t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===false)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,Ks);this.getBoundingSphereAt(r,Zs).applyMatrix4(Ks);e.union(Zs)}}addInstance(e){const t=this._instanceInfo.length>=this.maxInstanceCount;if(t&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:true,active:true,geometryIndex:e};let r=null;if(this._availableInstanceIds.length>0){this._availableInstanceIds.sort(ascIdSort);r=this._availableInstanceIds.shift();this._instanceInfo[r]=n}else{r=this._instanceInfo.length;this._instanceInfo.push(n)}const s=this._matricesTexture;Ks.identity().toArray(s.image.data,r*16);s.needsUpdate=true;const a=this._colorsTexture;if(a){Xs.toArray(a.image.data,r*4);a.needsUpdate=true}this._visibilityChanged=true;return r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e);this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:true};const s=this._geometryInfo;r.vertexStart=this._nextVertexStart;r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();const o=a!==null;if(o){r.indexStart=this._nextIndexStart;r.reservedIndexCount=n===-1?a.count:n}if(r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;if(this._availableGeometryIds.length>0){this._availableGeometryIds.sort(ascIdSort);l=this._availableGeometryIds.shift();s[l]=r}else{l=this._geometryCount;this._geometryCount++;s.push(r)}this.setGeometryAt(l,e);this._nextIndexStart=r.indexStart+r.reservedIndexCount;this._nextVertexStart=r.vertexStart+r.reservedVertexCount;return l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry;const r=n.getIndex()!==null;const s=n.getIndex();const a=t.getIndex();const o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart;const c=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const e in n.attributes){const r=t.getAttribute(e);const s=n.getAttribute(e);copyAttributeData(r,s,l);const a=r.itemSize;for(let e=r.count,t=c;e<t;e++){const t=l+e;for(let e=0;e<a;e++)s.setComponent(t,e,0)}s.needsUpdate=true;s.addUpdateRange(l*a,c*a)}if(r){const e=o.indexStart;const n=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let t=0;t<a.count;t++)s.setX(e+t,l+a.getX(t));for(let t=a.count,r=n;t<r;t++)s.setX(e+t,l);s.needsUpdate=true;s.addUpdateRange(e,o.reservedIndexCount)}o.start=r?o.indexStart:o.vertexStart;o.count=r?o.indexCount:o.vertexCount;o.boundingBox=null;t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone());o.boundingSphere=null;t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone());this._visibilityChanged=true;return e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===false)return this;const n=this._instanceInfo;for(let t=0,r=n.length;t<r;t++)n[t].active&&n[t].geometryIndex===e&&this.deleteInstance(t);t[e].active=false;this._availableGeometryIds.push(e);this._visibilityChanged=true;return this}deleteInstance(e){this.validateInstanceId(e);this._instanceInfo[e].active=false;this._availableInstanceIds.push(e);this._visibilityChanged=true;return this}optimize(){let e=0;let t=0;const n=this._geometryInfo;const r=n.map(((e,t)=>t)).sort(((e,t)=>n[e].vertexStart-n[t].vertexStart));const s=this.geometry;for(let a=0,o=n.length;a<o;a++){const o=r[a];const l=n[o];if(l.active!==false){if(s.index!==null){if(l.indexStart!==t){const{indexStart:n,vertexStart:r,reservedIndexCount:a}=l;const o=s.index;const c=o.array;const u=e-r;for(let e=n;e<n+a;e++)c[e]=c[e]+u;o.array.copyWithin(t,n,n+a);o.addUpdateRange(t,a);l.indexStart=t}t+=l.reservedIndexCount}if(l.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=l;const r=s.attributes;for(const s in r){const a=r[s];const{array:o,itemSize:l}=a;o.copyWithin(e*l,t*l,(t+n)*l);a.addUpdateRange(e*l,n*l)}l.vertexStart=e}e+=l.reservedVertexCount;l.start=s.index?l.indexStart:l.vertexStart;this._nextIndexStart=s.index?l.indexStart+l.reservedIndexCount:0;this._nextVertexStart=l.vertexStart+l.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry;const r=this._geometryInfo[e];if(r.boundingBox===null){const e=new Box3;const t=n.index;const s=n.attributes.position;for(let n=r.start,a=r.start+r.count;n<a;n++){let r=n;t&&(r=t.getX(r));e.expandByPoint($s.fromBufferAttribute(s,r))}r.boundingBox=e}t.copy(r.boundingBox);return t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry;const r=this._geometryInfo[e];if(r.boundingSphere===null){const t=new Sphere;this.getBoundingBoxAt(e,Js);Js.getCenter(t.center);const s=n.index;const a=n.attributes.position;let o=0;for(let e=r.start,n=r.start+r.count;e<n;e++){let n=e;s&&(n=s.getX(n));$s.fromBufferAttribute(a,n);o=Math.max(o,t.center.distanceToSquared($s))}t.radius=Math.sqrt(o);r.boundingSphere=t}t.copy(r.boundingSphere);return t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture;const r=this._matricesTexture.image.data;t.toArray(r,e*16);n.needsUpdate=true;return this}getMatrixAt(e,t){this.validateInstanceId(e);return t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){this.validateInstanceId(e);this._colorsTexture===null&&this._initColorsTexture();t.toArray(this._colorsTexture.image.data,e*4);this._colorsTexture.needsUpdate=true;return this}getColorAt(e,t){this.validateInstanceId(e);return t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){this.validateInstanceId(e);if(this._instanceInfo[e].visible===t)return this;this._instanceInfo[e].visible=t;this._visibilityChanged=true;return this}getVisibleAt(e){this.validateInstanceId(e);return this._instanceInfo[e].visible}setGeometryIdAt(e,t){this.validateInstanceId(e);this.validateGeometryId(t);this._instanceInfo[e].geometryIndex=t;return this}getGeometryIdAt(e){this.validateInstanceId(e);return this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];t.vertexStart=n.vertexStart;t.vertexCount=n.vertexCount;t.reservedVertexCount=n.reservedVertexCount;t.indexStart=n.indexStart;t.indexCount=n.indexCount;t.reservedIndexCount=n.reservedIndexCount;t.start=n.start;t.count=n.count;return t}setInstanceCount(e){const t=this._availableInstanceIds;const n=this._instanceInfo;t.sort(ascIdSort);while(t[t.length-1]===n.length){n.pop();t.pop()}if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e);const s=new Int32Array(e);copyArrayContents(this._multiDrawCounts,r);copyArrayContents(this._multiDrawStarts,s);this._multiDrawCounts=r;this._multiDrawStarts=s;this._maxInstanceCount=e;const a=this._indirectTexture;const o=this._matricesTexture;const l=this._colorsTexture;a.dispose();this._initIndirectTexture();copyArrayContents(a.image.data,this._indirectTexture.image.data);o.dispose();this._initMatricesTexture();copyArrayContents(o.image.data,this._matricesTexture.image.data);if(l){l.dispose();this._initColorsTexture();copyArrayContents(l.image.data,this._colorsTexture.image.data)}}setGeometrySize(e,t){const n=[...this._geometryInfo].filter((e=>e.active));const r=Math.max(...n.map((e=>e.vertexStart+e.reservedVertexCount)));if(r>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index){const e=Math.max(...n.map((e=>e.indexStart+e.reservedIndexCount)));if(e>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`)}const s=this.geometry;s.dispose();this._maxVertexCount=e;this._maxIndexCount=t;if(this._geometryInitialized){this._geometryInitialized=false;this.geometry=new BufferGeometry;this._initializeGeometry(s)}const a=this.geometry;s.index&&copyArrayContents(s.index.array,a.index.array);for(const e in s.attributes)copyArrayContents(s.attributes[e].array,a.attributes[e].array)}raycast(e,t){const n=this._instanceInfo;const r=this._geometryInfo;const s=this.matrixWorld;const a=this.geometry;ra.material=this.material;ra.geometry.index=a.index;ra.geometry.attributes=a.attributes;ra.geometry.boundingBox===null&&(ra.geometry.boundingBox=new Box3);ra.geometry.boundingSphere===null&&(ra.geometry.boundingSphere=new Sphere);for(let a=0,o=n.length;a<o;a++){if(!n[a].visible||!n[a].active)continue;const o=n[a].geometryIndex;const l=r[o];ra.geometry.setDrawRange(l.start,l.count);this.getMatrixAt(a,ra.matrixWorld).premultiply(s);this.getBoundingBoxAt(o,ra.geometry.boundingBox);this.getBoundingSphereAt(o,ra.geometry.boundingSphere);ra.raycast(e,ia);for(let e=0,n=ia.length;e<n;e++){const n=ia[e];n.object=this;n.batchId=a;t.push(n)}ia.length=0}ra.material=null;ra.geometry.index=null;ra.geometry.attributes={};ra.geometry.setDrawRange(0,Infinity)}copy(e){super.copy(e);this.geometry=e.geometry.clone();this.perObjectFrustumCulled=e.perObjectFrustumCulled;this.sortObjects=e.sortObjects;this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null;this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null;this._geometryInfo=e._geometryInfo.map((e=>({...e,boundingBox:e.boundingBox!==null?e.boundingBox.clone():null,boundingSphere:e.boundingSphere!==null?e.boundingSphere.clone():null})));this._instanceInfo=e._instanceInfo.map((e=>({...e})));this._maxInstanceCount=e._maxInstanceCount;this._maxVertexCount=e._maxVertexCount;this._maxIndexCount=e._maxIndexCount;this._geometryInitialized=e._geometryInitialized;this._geometryCount=e._geometryCount;this._multiDrawCounts=e._multiDrawCounts.slice();this._multiDrawStarts=e._multiDrawStarts.slice();this._matricesTexture=e._matricesTexture.clone();this._matricesTexture.image.data=this._matricesTexture.image.data.slice();if(this._colorsTexture!==null){this._colorsTexture=e._colorsTexture.clone();this._colorsTexture.image.data=this._colorsTexture.image.data.slice()}return this}dispose(){this.geometry.dispose();this._matricesTexture.dispose();this._matricesTexture=null;this._indirectTexture.dispose();this._indirectTexture=null;if(this._colorsTexture!==null){this._colorsTexture.dispose();this._colorsTexture=null}return this}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex();const o=a===null?1:a.array.BYTES_PER_ELEMENT;const l=this._instanceInfo;const c=this._multiDrawStarts;const u=this._multiDrawCounts;const h=this._geometryInfo;const d=this.perObjectFrustumCulled;const p=this._indirectTexture;const f=p.image.data;if(d){Ks.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld);Ys.setFromProjectionMatrix(Ks,e.coordinateSystem)}let m=0;if(this.sortObjects){Ks.copy(this.matrixWorld).invert();$s.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Ks);ea.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Ks);for(let e=0,t=l.length;e<t;e++)if(l[e].visible&&l[e].active){const t=l[e].geometryIndex;this.getMatrixAt(e,Ks);this.getBoundingSphereAt(t,Zs).applyMatrix4(Ks);let n=false;d&&(n=!Ys.intersectsSphere(Zs));if(!n){const n=h[t];const r=ta.subVectors(Zs.center,$s).dot(ea);na.push(n.start,n.count,r,e)}}const e=na.list;const t=this.customSort;t===null?e.sort(s.transparent?sortTransparent:sortOpaque):t.call(this,e,n);for(let t=0,n=e.length;t<n;t++){const n=e[t];c[m]=n.start*o;u[m]=n.count;f[m]=n.index;m++}na.reset()}else for(let e=0,t=l.length;e<t;e++)if(l[e].visible&&l[e].active){const t=l[e].geometryIndex;let n=false;if(d){this.getMatrixAt(e,Ks);this.getBoundingSphereAt(t,Zs).applyMatrix4(Ks);n=!Ys.intersectsSphere(Zs)}if(!n){const n=h[t];c[m]=n.start*o;u[m]=n.count;f[m]=e;m++}}p.needsUpdate=true;this._multiDrawCount=m;this._visibilityChanged=false}onBeforeShadow(e,t,n,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class LineBasicMaterial extends Material{constructor(e){super();this.isLineBasicMaterial=true;this.type="LineBasicMaterial";this.color=new Color(16777215);this.map=null;this.linewidth=1;this.linecap="round";this.linejoin="round";this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.map=e.map;this.linewidth=e.linewidth;this.linecap=e.linecap;this.linejoin=e.linejoin;this.fog=e.fog;return this}}const sa=new Vector3;const aa=new Vector3;const oa=new Matrix4;const la=new Ray;const ca=new Sphere;const ua=new Vector3;const ha=new Vector3;class Line extends Object3D{constructor(e=new BufferGeometry,t=new LineBasicMaterial){super();this.isLine=true;this.type="Line";this.geometry=e;this.material=t;this.updateMorphTargets()}copy(e,t){super.copy(e,t);this.material=Array.isArray(e.material)?e.material.slice():e.material;this.geometry=e.geometry;return this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position;const n=[0];for(let e=1,r=t.count;e<r;e++){sa.fromBufferAttribute(t,e-1);aa.fromBufferAttribute(t,e);n[e]=n[e-1];n[e]+=sa.distanceTo(aa)}e.setAttribute("lineDistance",new Float32BufferAttribute(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry;const r=this.matrixWorld;const s=e.params.Line.threshold;const a=n.drawRange;n.boundingSphere===null&&n.computeBoundingSphere();ca.copy(n.boundingSphere);ca.applyMatrix4(r);ca.radius+=s;if(e.ray.intersectsSphere(ca)===false)return;oa.copy(r).invert();la.copy(e.ray).applyMatrix4(oa);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3);const l=o*o;const c=this.isLineSegments?2:1;const u=n.index;const h=n.attributes;const d=h.position;if(u!==null){const n=Math.max(0,a.start);const r=Math.min(u.count,a.start+a.count);for(let s=n,a=r-1;s<a;s+=c){const n=u.getX(s);const r=u.getX(s+1);const a=checkIntersection(this,e,la,l,n,r,s);a&&t.push(a)}if(this.isLineLoop){const s=u.getX(r-1);const a=u.getX(n);const o=checkIntersection(this,e,la,l,s,a,r-1);o&&t.push(o)}}else{const n=Math.max(0,a.start);const r=Math.min(d.count,a.start+a.count);for(let s=n,a=r-1;s<a;s+=c){const n=checkIntersection(this,e,la,l,s,s+1,s);n&&t.push(n)}if(this.isLineLoop){const s=checkIntersection(this,e,la,l,r-1,n,r-1);s&&t.push(s)}}}updateMorphTargets(){const e=this.geometry;const t=e.morphAttributes;const n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(e!==void 0){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[n]=t}}}}}function checkIntersection(e,t,n,r,s,a,o){const l=e.geometry.attributes.position;sa.fromBufferAttribute(l,s);aa.fromBufferAttribute(l,a);const c=n.distanceSqToSegment(sa,aa,ua,ha);if(c>r)return;ua.applyMatrix4(e.matrixWorld);const u=t.ray.origin.distanceTo(ua);return u<t.near||u>t.far?void 0:{distance:u,point:ha.clone().applyMatrix4(e.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:e}}const da=new Vector3;const pa=new Vector3;class LineSegments extends Line{constructor(e,t){super(e,t);this.isLineSegments=true;this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position;const n=[];for(let e=0,r=t.count;e<r;e+=2){da.fromBufferAttribute(t,e);pa.fromBufferAttribute(t,e+1);n[e]=e===0?0:n[e-1];n[e+1]=n[e]+da.distanceTo(pa)}e.setAttribute("lineDistance",new Float32BufferAttribute(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(e,t){super(e,t);this.isLineLoop=true;this.type="LineLoop"}}class PointsMaterial extends Material{constructor(e){super();this.isPointsMaterial=true;this.type="PointsMaterial";this.color=new Color(16777215);this.map=null;this.alphaMap=null;this.size=1;this.sizeAttenuation=true;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.map=e.map;this.alphaMap=e.alphaMap;this.size=e.size;this.sizeAttenuation=e.sizeAttenuation;this.fog=e.fog;return this}}const fa=new Matrix4;const ma=new Ray;const Aa=new Sphere;const ga=new Vector3;class Points extends Object3D{constructor(e=new BufferGeometry,t=new PointsMaterial){super();this.isPoints=true;this.type="Points";this.geometry=e;this.material=t;this.updateMorphTargets()}copy(e,t){super.copy(e,t);this.material=Array.isArray(e.material)?e.material.slice():e.material;this.geometry=e.geometry;return this}raycast(e,t){const n=this.geometry;const r=this.matrixWorld;const s=e.params.Points.threshold;const a=n.drawRange;n.boundingSphere===null&&n.computeBoundingSphere();Aa.copy(n.boundingSphere);Aa.applyMatrix4(r);Aa.radius+=s;if(e.ray.intersectsSphere(Aa)===false)return;fa.copy(r).invert();ma.copy(e.ray).applyMatrix4(fa);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3);const l=o*o;const c=n.index;const u=n.attributes;const h=u.position;if(c!==null){const n=Math.max(0,a.start);const s=Math.min(c.count,a.start+a.count);for(let a=n,o=s;a<o;a++){const n=c.getX(a);ga.fromBufferAttribute(h,n);testPoint(ga,n,l,r,e,t,this)}}else{const n=Math.max(0,a.start);const s=Math.min(h.count,a.start+a.count);for(let a=n,o=s;a<o;a++){ga.fromBufferAttribute(h,a);testPoint(ga,a,l,r,e,t,this)}}}updateMorphTargets(){const e=this.geometry;const t=e.morphAttributes;const n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(e!==void 0){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[n]=t}}}}}function testPoint(e,t,n,r,s,a,o){const l=ma.distanceSqToPoint(e);if(l<n){const n=new Vector3;ma.closestPointToPoint(e,n);n.applyMatrix4(r);const c=s.ray.origin.distanceTo(n);if(c<s.near||c>s.far)return;a.push({distance:c,distanceToRay:Math.sqrt(l),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:o})}}class VideoTexture extends Texture{constructor(e,t,n,r,s,a,o,l,c){super(e,t,n,r,s,a,o,l,c);this.isVideoTexture=true;this.minFilter=a!==void 0?a:Le;this.magFilter=s!==void 0?s:Le;this.generateMipmaps=false;const u=this;function updateVideo(){u.needsUpdate=true;e.requestVideoFrameCallback(updateVideo)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(updateVideo)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;const t="requestVideoFrameCallback"in e;t===false&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=true)}}class VideoFrameTexture extends VideoTexture{constructor(e,t,n,r,s,a,o,l){super({},e,t,n,r,s,a,o,l);this.isVideoFrameTexture=true}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e;this.needsUpdate=true}}class FramebufferTexture extends Texture{constructor(e,t){super({width:e,height:t});this.isFramebufferTexture=true;this.magFilter=Se;this.minFilter=Se;this.generateMipmaps=false;this.needsUpdate=true}}class CompressedTexture extends Texture{constructor(e,t,n,r,s,a,o,l,c,u,h,d){super(null,a,o,l,c,u,r,s,h,d);this.isCompressedTexture=true;this.image={width:t,height:n};this.mipmaps=e;this.flipY=false;this.generateMipmaps=false}}class CompressedArrayTexture extends CompressedTexture{constructor(e,t,n,r,s,a){super(e,t,n,s,a);this.isCompressedArrayTexture=true;this.image.depth=r;this.wrapR=Me;this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class CompressedCubeTexture extends CompressedTexture{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ye);this.isCompressedCubeTexture=true;this.isCubeTexture=true;this.image=e}}class CanvasTexture extends Texture{constructor(e,t,n,r,s,a,o,l,c){super(e,t,n,r,s,a,o,l,c);this.isCanvasTexture=true;this.needsUpdate=true}}class DepthTexture extends Texture{constructor(e,t,n,r,s,a,o,l,c,u=et){if(u!==et&&u!==tt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===et&&(n=Qe);n===void 0&&u===tt&&(n=qe);super(null,r,s,a,o,l,u,n,c);this.isDepthTexture=true;this.image={width:e,height:t};this.magFilter=o!==void 0?o:Se;this.minFilter=l!==void 0?l:Se;this.flipY=false;this.generateMipmaps=false;this.compareFunction=null}copy(e){super.copy(e);this.compareFunction=e.compareFunction;return this}toJSON(e){const t=super.toJSON(e);this.compareFunction!==null&&(t.compareFunction=this.compareFunction);return t}}class Curve{constructor(){this.type="Curve";this.arcLengthDivisions=200}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.");return null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=false;const t=[];let n,r=this.getPoint(0);let s=0;t.push(0);for(let a=1;a<=e;a++){n=this.getPoint(a/e);s+=n.distanceTo(r);t.push(s);r=n}this.cacheArcLengths=t;return t}updateArcLengths(){this.needsUpdate=true;this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const s=n.length;let a;a=t||e*n[s-1];let o,l=0,c=s-1;while(l<=c){r=Math.floor(l+(c-l)/2);o=n[r]-a;if(o<0)l=r+1;else{if(!(o>0)){c=r;break}c=r-1}}r=c;if(n[r]===a)return r/(s-1);const u=n[r];const h=n[r+1];const d=h-u;const p=(a-u)/d;const f=(r+p)/(s-1);return f}getTangent(e,t){const n=1e-4;let r=e-n;let s=e+n;r<0&&(r=0);s>1&&(s=1);const a=this.getPoint(r);const o=this.getPoint(s);const l=t||(a.isVector2?new Vector2:new Vector3);l.copy(o).sub(a).normalize();return l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Vector3;const r=[];const s=[];const a=[];const o=new Vector3;const l=new Matrix4;for(let t=0;t<=e;t++){const n=t/e;r[t]=this.getTangentAt(n,new Vector3)}s[0]=new Vector3;a[0]=new Vector3;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x);const h=Math.abs(r[0].y);const d=Math.abs(r[0].z);if(u<=c){c=u;n.set(1,0,0)}if(h<=c){c=h;n.set(0,1,0)}d<=c&&n.set(0,0,1);o.crossVectors(r[0],n).normalize();s[0].crossVectors(r[0],o);a[0].crossVectors(r[0],s[0]);for(let t=1;t<=e;t++){s[t]=s[t-1].clone();a[t]=a[t-1].clone();o.crossVectors(r[t-1],r[t]);if(o.length()>Number.EPSILON){o.normalize();const e=Math.acos(clamp(r[t-1].dot(r[t]),-1,1));s[t].applyMatrix4(l.makeRotationAxis(o,e))}a[t].crossVectors(r[t],s[t])}if(t===true){let t=Math.acos(clamp(s[0].dot(s[e]),-1,1));t/=e;r[0].dot(o.crossVectors(s[0],s[e]))>0&&(t=-t);for(let n=1;n<=e;n++){s[n].applyMatrix4(l.makeRotationAxis(r[n],t*n));a[n].crossVectors(r[n],s[n])}}return{tangents:r,normals:s,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){this.arcLengthDivisions=e.arcLengthDivisions;return this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};e.arcLengthDivisions=this.arcLengthDivisions;e.type=this.type;return e}fromJSON(e){this.arcLengthDivisions=e.arcLengthDivisions;return this}}class EllipseCurve extends Curve{constructor(e=0,t=0,n=1,r=1,s=0,a=Math.PI*2,o=false,l=0){super();this.isEllipseCurve=true;this.type="EllipseCurve";this.aX=e;this.aY=t;this.xRadius=n;this.yRadius=r;this.aStartAngle=s;this.aEndAngle=a;this.aClockwise=o;this.aRotation=l}getPoint(e,t=new Vector2){const n=t;const r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;while(s<0)s+=r;while(s>r)s-=r;s<Number.EPSILON&&(s=a?0:r);this.aClockwise!==true||a||(s===r?s=-r:s-=r);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o);let c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const e=Math.cos(this.aRotation);const t=Math.sin(this.aRotation);const n=l-this.aX;const r=c-this.aY;l=n*e-r*t+this.aX;c=n*t+r*e+this.aY}return n.set(l,c)}copy(e){super.copy(e);this.aX=e.aX;this.aY=e.aY;this.xRadius=e.xRadius;this.yRadius=e.yRadius;this.aStartAngle=e.aStartAngle;this.aEndAngle=e.aEndAngle;this.aClockwise=e.aClockwise;this.aRotation=e.aRotation;return this}toJSON(){const e=super.toJSON();e.aX=this.aX;e.aY=this.aY;e.xRadius=this.xRadius;e.yRadius=this.yRadius;e.aStartAngle=this.aStartAngle;e.aEndAngle=this.aEndAngle;e.aClockwise=this.aClockwise;e.aRotation=this.aRotation;return e}fromJSON(e){super.fromJSON(e);this.aX=e.aX;this.aY=e.aY;this.xRadius=e.xRadius;this.yRadius=e.yRadius;this.aStartAngle=e.aStartAngle;this.aEndAngle=e.aEndAngle;this.aClockwise=e.aClockwise;this.aRotation=e.aRotation;return this}}class ArcCurve extends EllipseCurve{constructor(e,t,n,r,s,a){super(e,t,n,n,r,s,a);this.isArcCurve=true;this.type="ArcCurve"}}function CubicPoly(){let e=0,t=0,n=0,r=0;function init(s,a,o,l){e=s;t=o;n=-3*s+3*a-2*o-l;r=2*s-2*a+o+l}return{initCatmullRom:function(e,t,n,r,s){init(t,n,s*(n-e),s*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,s,a,o){let l=(t-e)/s-(n-e)/(s+a)+(n-t)/a;let c=(n-t)/a-(r-t)/(a+o)+(r-n)/o;l*=a;c*=a;init(t,n,l,c)},calc:function(s){const a=s*s;const o=a*s;return e+t*s+n*a+r*o}}}const va=new Vector3;const ya=new CubicPoly;const Ca=new CubicPoly;const Ea=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(e=[],t=false,n="centripetal",r=.5){super();this.isCatmullRomCurve3=true;this.type="CatmullRomCurve3";this.points=e;this.closed=t;this.curveType=n;this.tension=r}getPoint(e,t=new Vector3){const n=t;const r=this.points;const s=r.length;const a=(s-(this.closed?0:1))*e;let o=Math.floor(a);let l=a-o;if(this.closed)o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s;else if(l===0&&o===s-1){o=s-2;l=1}let c,u;if(this.closed||o>0)c=r[(o-1)%s];else{va.subVectors(r[0],r[1]).add(r[0]);c=va}const h=r[o%s];const d=r[(o+1)%s];if(this.closed||o+2<s)u=r[(o+2)%s];else{va.subVectors(r[s-1],r[s-2]).add(r[s-1]);u=va}if(this.curveType==="centripetal"||this.curveType==="chordal"){const e=this.curveType==="chordal"?.5:.25;let t=Math.pow(c.distanceToSquared(h),e);let n=Math.pow(h.distanceToSquared(d),e);let r=Math.pow(d.distanceToSquared(u),e);n<1e-4&&(n=1);t<1e-4&&(t=n);r<1e-4&&(r=n);ya.initNonuniformCatmullRom(c.x,h.x,d.x,u.x,t,n,r);Ca.initNonuniformCatmullRom(c.y,h.y,d.y,u.y,t,n,r);Ea.initNonuniformCatmullRom(c.z,h.z,d.z,u.z,t,n,r)}else if(this.curveType==="catmullrom"){ya.initCatmullRom(c.x,h.x,d.x,u.x,this.tension);Ca.initCatmullRom(c.y,h.y,d.y,u.y,this.tension);Ea.initCatmullRom(c.z,h.z,d.z,u.z,this.tension)}n.set(ya.calc(l),Ca.calc(l),Ea.calc(l));return n}copy(e){super.copy(e);this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}this.closed=e.closed;this.curveType=e.curveType;this.tension=e.tension;return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}e.closed=this.closed;e.curveType=this.curveType;e.tension=this.tension;return e}fromJSON(e){super.fromJSON(e);this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Vector3).fromArray(n))}this.closed=e.closed;this.curveType=e.curveType;this.tension=e.tension;return this}}function CatmullRom(e,t,n,r,s){const a=.5*(r-t);const o=.5*(s-n);const l=e*e;const c=e*l;return(2*n-2*r+a+o)*c+(-3*n+3*r-2*a-o)*l+a*e+n}function QuadraticBezierP0(e,t){const n=1-e;return n*n*t}function QuadraticBezierP1(e,t){return 2*(1-e)*e*t}function QuadraticBezierP2(e,t){return e*e*t}function QuadraticBezier(e,t,n,r){return QuadraticBezierP0(e,t)+QuadraticBezierP1(e,n)+QuadraticBezierP2(e,r)}function CubicBezierP0(e,t){const n=1-e;return n*n*n*t}function CubicBezierP1(e,t){const n=1-e;return 3*n*n*e*t}function CubicBezierP2(e,t){return 3*(1-e)*e*e*t}function CubicBezierP3(e,t){return e*e*e*t}function CubicBezier(e,t,n,r,s){return CubicBezierP0(e,t)+CubicBezierP1(e,n)+CubicBezierP2(e,r)+CubicBezierP3(e,s)}class CubicBezierCurve extends Curve{constructor(e=new Vector2,t=new Vector2,n=new Vector2,r=new Vector2){super();this.isCubicBezierCurve=true;this.type="CubicBezierCurve";this.v0=e;this.v1=t;this.v2=n;this.v3=r}getPoint(e,t=new Vector2){const n=t;const r=this.v0,s=this.v1,a=this.v2,o=this.v3;n.set(CubicBezier(e,r.x,s.x,a.x,o.x),CubicBezier(e,r.y,s.y,a.y,o.y));return n}copy(e){super.copy(e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);this.v3.copy(e.v3);return this}toJSON(){const e=super.toJSON();e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();e.v3=this.v3.toArray();return e}fromJSON(e){super.fromJSON(e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);this.v3.fromArray(e.v3);return this}}class CubicBezierCurve3 extends Curve{constructor(e=new Vector3,t=new Vector3,n=new Vector3,r=new Vector3){super();this.isCubicBezierCurve3=true;this.type="CubicBezierCurve3";this.v0=e;this.v1=t;this.v2=n;this.v3=r}getPoint(e,t=new Vector3){const n=t;const r=this.v0,s=this.v1,a=this.v2,o=this.v3;n.set(CubicBezier(e,r.x,s.x,a.x,o.x),CubicBezier(e,r.y,s.y,a.y,o.y),CubicBezier(e,r.z,s.z,a.z,o.z));return n}copy(e){super.copy(e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);this.v3.copy(e.v3);return this}toJSON(){const e=super.toJSON();e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();e.v3=this.v3.toArray();return e}fromJSON(e){super.fromJSON(e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);this.v3.fromArray(e.v3);return this}}class LineCurve extends Curve{constructor(e=new Vector2,t=new Vector2){super();this.isLineCurve=true;this.type="LineCurve";this.v1=e;this.v2=t}getPoint(e,t=new Vector2){const n=t;if(e===1)n.copy(this.v2);else{n.copy(this.v2).sub(this.v1);n.multiplyScalar(e).add(this.v1)}return n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Vector2){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){super.copy(e);this.v1.copy(e.v1);this.v2.copy(e.v2);return this}toJSON(){const e=super.toJSON();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e}fromJSON(e){super.fromJSON(e);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this}}class LineCurve3 extends Curve{constructor(e=new Vector3,t=new Vector3){super();this.isLineCurve3=true;this.type="LineCurve3";this.v1=e;this.v2=t}getPoint(e,t=new Vector3){const n=t;if(e===1)n.copy(this.v2);else{n.copy(this.v2).sub(this.v1);n.multiplyScalar(e).add(this.v1)}return n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Vector3){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){super.copy(e);this.v1.copy(e.v1);this.v2.copy(e.v2);return this}toJSON(){const e=super.toJSON();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e}fromJSON(e){super.fromJSON(e);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this}}class QuadraticBezierCurve extends Curve{constructor(e=new Vector2,t=new Vector2,n=new Vector2){super();this.isQuadraticBezierCurve=true;this.type="QuadraticBezierCurve";this.v0=e;this.v1=t;this.v2=n}getPoint(e,t=new Vector2){const n=t;const r=this.v0,s=this.v1,a=this.v2;n.set(QuadraticBezier(e,r.x,s.x,a.x),QuadraticBezier(e,r.y,s.y,a.y));return n}copy(e){super.copy(e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);return this}toJSON(){const e=super.toJSON();e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e}fromJSON(e){super.fromJSON(e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this}}class QuadraticBezierCurve3 extends Curve{constructor(e=new Vector3,t=new Vector3,n=new Vector3){super();this.isQuadraticBezierCurve3=true;this.type="QuadraticBezierCurve3";this.v0=e;this.v1=t;this.v2=n}getPoint(e,t=new Vector3){const n=t;const r=this.v0,s=this.v1,a=this.v2;n.set(QuadraticBezier(e,r.x,s.x,a.x),QuadraticBezier(e,r.y,s.y,a.y),QuadraticBezier(e,r.z,s.z,a.z));return n}copy(e){super.copy(e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);return this}toJSON(){const e=super.toJSON();e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e}fromJSON(e){super.fromJSON(e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this}}class SplineCurve extends Curve{constructor(e=[]){super();this.isSplineCurve=true;this.type="SplineCurve";this.points=e}getPoint(e,t=new Vector2){const n=t;const r=this.points;const s=(r.length-1)*e;const a=Math.floor(s);const o=s-a;const l=r[a===0?a:a-1];const c=r[a];const u=r[a>r.length-2?r.length-1:a+1];const h=r[a>r.length-3?r.length-1:a+2];n.set(CatmullRom(o,l.x,c.x,u.x,h.x),CatmullRom(o,l.y,c.y,u.y,h.y));return n}copy(e){super.copy(e);this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e);this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Vector2).fromArray(n))}return this}}var ba=Object.freeze({__proto__:null,ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve});class CurvePath extends Curve{constructor(){super();this.type="CurvePath";this.curves=[];this.autoClose=false}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0);const t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===true?"LineCurve":"LineCurve3";this.curves.push(new ba[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength();const r=this.getCurveLengths();let s=0;while(s<r.length){if(r[s]>=n){const e=r[s]-n;const a=this.curves[s];const o=a.getLength();const l=o===0?0:1-e/o;return a.getPointAt(l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=true;this.cacheLengths=null;this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++){t+=this.curves[n].getLength();e.push(t)}this.cacheLengths=e;return e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));this.autoClose&&t.push(t[0]);return t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r];const o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e;const l=a.getPoints(o);for(let e=0;e<l.length;e++){const r=l[e];if(!n||!n.equals(r)){t.push(r);n=r}}}this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]);return t}copy(e){super.copy(e);this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}this.autoClose=e.autoClose;return this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose;e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e);this.autoClose=e.autoClose;this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new ba[n.type]).fromJSON(n))}return this}}class Path extends CurvePath{constructor(e){super();this.type="Path";this.currentPoint=new Vector2;e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){this.currentPoint.set(e,t);return this}lineTo(e,t){const n=new LineCurve(this.currentPoint.clone(),new Vector2(e,t));this.curves.push(n);this.currentPoint.set(e,t);return this}quadraticCurveTo(e,t,n,r){const s=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(n,r));this.curves.push(s);this.currentPoint.set(n,r);return this}bezierCurveTo(e,t,n,r,s,a){const o=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(n,r),new Vector2(s,a));this.curves.push(o);this.currentPoint.set(s,a);return this}splineThru(e){const t=[this.currentPoint.clone()].concat(e);const n=new SplineCurve(t);this.curves.push(n);this.currentPoint.copy(e[e.length-1]);return this}arc(e,t,n,r,s,a){const o=this.currentPoint.x;const l=this.currentPoint.y;this.absarc(e+o,t+l,n,r,s,a);return this}absarc(e,t,n,r,s,a){this.absellipse(e,t,n,n,r,s,a);return this}ellipse(e,t,n,r,s,a,o,l){const c=this.currentPoint.x;const u=this.currentPoint.y;this.absellipse(e+c,t+u,n,r,s,a,o,l);return this}absellipse(e,t,n,r,s,a,o,l){const c=new EllipseCurve(e,t,n,r,s,a,o,l);if(this.curves.length>0){const e=c.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(c);const u=c.getPoint(1);this.currentPoint.copy(u);return this}copy(e){super.copy(e);this.currentPoint.copy(e.currentPoint);return this}toJSON(){const e=super.toJSON();e.currentPoint=this.currentPoint.toArray();return e}fromJSON(e){super.fromJSON(e);this.currentPoint.fromArray(e.currentPoint);return this}}class LatheGeometry extends BufferGeometry{constructor(e=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],t=12,n=0,r=Math.PI*2){super();this.type="LatheGeometry";this.parameters={points:e,segments:t,phiStart:n,phiLength:r};t=Math.floor(t);r=clamp(r,0,Math.PI*2);const s=[];const a=[];const o=[];const l=[];const c=[];const u=1/t;const h=new Vector3;const d=new Vector2;const p=new Vector3;const f=new Vector3;const m=new Vector3;let g=0;let y=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:g=e[t+1].x-e[t].x;y=e[t+1].y-e[t].y;p.x=y*1;p.y=-g;p.z=y*0;m.copy(p);p.normalize();l.push(p.x,p.y,p.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[t+1].x-e[t].x;y=e[t+1].y-e[t].y;p.x=y*1;p.y=-g;p.z=y*0;f.copy(p);p.x+=m.x;p.y+=m.y;p.z+=m.z;p.normalize();l.push(p.x,p.y,p.z);m.copy(f)}for(let s=0;s<=t;s++){const p=n+s*u*r;const f=Math.sin(p);const m=Math.cos(p);for(let n=0;n<=e.length-1;n++){h.x=e[n].x*f;h.y=e[n].y;h.z=e[n].x*m;a.push(h.x,h.y,h.z);d.x=s/t;d.y=n/(e.length-1);o.push(d.x,d.y);const r=l[3*n+0]*f;const u=l[3*n+1];const p=l[3*n+0]*m;c.push(r,u,p)}}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){const r=t+n*e.length;const a=r;const o=r+e.length;const l=r+e.length+1;const c=r+1;s.push(a,o,c);s.push(l,c,o)}this.setIndex(s);this.setAttribute("position",new Float32BufferAttribute(a,3));this.setAttribute("uv",new Float32BufferAttribute(o,2));this.setAttribute("normal",new Float32BufferAttribute(c,3))}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new LatheGeometry(e.points,e.segments,e.phiStart,e.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(e=1,t=1,n=4,r=8){const s=new Path;s.absarc(0,-t/2,e,Math.PI*1.5,0);s.absarc(0,t/2,e,0,Math.PI*.5);super(s.getPoints(n),r);this.type="CapsuleGeometry";this.parameters={radius:e,length:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new CapsuleGeometry(e.radius,e.length,e.capSegments,e.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(e=1,t=32,n=0,r=Math.PI*2){super();this.type="CircleGeometry";this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r};t=Math.max(3,t);const s=[];const a=[];const o=[];const l=[];const c=new Vector3;const u=new Vector2;a.push(0,0,0);o.push(0,0,1);l.push(.5,.5);for(let s=0,h=3;s<=t;s++,h+=3){const d=n+s/t*r;c.x=e*Math.cos(d);c.y=e*Math.sin(d);a.push(c.x,c.y,c.z);o.push(0,0,1);u.x=(a[h]/e+1)/2;u.y=(a[h+1]/e+1)/2;l.push(u.x,u.y)}for(let e=1;e<=t;e++)s.push(e,e+1,0);this.setIndex(s);this.setAttribute("position",new Float32BufferAttribute(a,3));this.setAttribute("normal",new Float32BufferAttribute(o,3));this.setAttribute("uv",new Float32BufferAttribute(l,2))}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new CircleGeometry(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(e=1,t=1,n=1,r=32,s=1,a=false,o=0,l=Math.PI*2){super();this.type="CylinderGeometry";this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;r=Math.floor(r);s=Math.floor(s);const u=[];const h=[];const d=[];const p=[];let f=0;const m=[];const g=n/2;let y=0;generateTorso();if(a===false){e>0&&generateCap(true);t>0&&generateCap(false)}this.setIndex(u);this.setAttribute("position",new Float32BufferAttribute(h,3));this.setAttribute("normal",new Float32BufferAttribute(d,3));this.setAttribute("uv",new Float32BufferAttribute(p,2));function generateTorso(){const a=new Vector3;const b=new Vector3;let x=0;const _=(t-e)/n;for(let c=0;c<=s;c++){const u=[];const y=c/s;const x=y*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r;const s=t*l+o;const c=Math.sin(s);const m=Math.cos(s);b.x=x*c;b.y=-y*n+g;b.z=x*m;h.push(b.x,b.y,b.z);a.set(c,_,m).normalize();d.push(a.x,a.y,a.z);p.push(t,1-y);u.push(f++)}m.push(u)}for(let n=0;n<r;n++)for(let r=0;r<s;r++){const a=m[r][n];const o=m[r+1][n];const l=m[r+1][n+1];const c=m[r][n+1];if(e>0||r!==0){u.push(a,o,c);x+=3}if(t>0||r!==s-1){u.push(o,l,c);x+=3}}c.addGroup(y,x,0);y+=x}function generateCap(n){const s=f;const a=new Vector2;const m=new Vector3;let b=0;const x=n===true?e:t;const _=n===true?1:-1;for(let e=1;e<=r;e++){h.push(0,g*_,0);d.push(0,_,0);p.push(.5,.5);f++}const M=f;for(let e=0;e<=r;e++){const t=e/r;const n=t*l+o;const s=Math.cos(n);const c=Math.sin(n);m.x=x*c;m.y=g*_;m.z=x*s;h.push(m.x,m.y,m.z);d.push(0,_,0);a.x=s*.5+.5;a.y=c*.5*_+.5;p.push(a.x,a.y);f++}for(let e=0;e<r;e++){const t=s+e;const r=M+e;n===true?u.push(r,r+1,t):u.push(r+1,r,t);b+=3}c.addGroup(y,b,n===true?1:2);y+=b}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(e=1,t=1,n=32,r=1,s=false,a=0,o=Math.PI*2){super(0,e,t,n,r,s,a,o);this.type="ConeGeometry";this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new ConeGeometry(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(e=[],t=[],n=1,r=0){super();this.type="PolyhedronGeometry";this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[];const a=[];subdivide(r);applyRadius(n);generateUVs();this.setAttribute("position",new Float32BufferAttribute(s,3));this.setAttribute("normal",new Float32BufferAttribute(s.slice(),3));this.setAttribute("uv",new Float32BufferAttribute(a,2));r===0?this.computeVertexNormals():this.normalizeNormals();function subdivide(e){const n=new Vector3;const r=new Vector3;const s=new Vector3;for(let a=0;a<t.length;a+=3){getVertexByIndex(t[a+0],n);getVertexByIndex(t[a+1],r);getVertexByIndex(t[a+2],s);subdivideFace(n,r,s,e)}}function subdivideFace(e,t,n,r){const s=r+1;const a=[];for(let r=0;r<=s;r++){a[r]=[];const o=e.clone().lerp(n,r/s);const l=t.clone().lerp(n,r/s);const c=s-r;for(let e=0;e<=c;e++)a[r][e]=e===0&&r===s?o:o.clone().lerp(l,e/c)}for(let e=0;e<s;e++)for(let t=0;t<2*(s-e)-1;t++){const n=Math.floor(t/2);if(t%2===0){pushVertex(a[e][n+1]);pushVertex(a[e+1][n]);pushVertex(a[e][n])}else{pushVertex(a[e][n+1]);pushVertex(a[e+1][n+1]);pushVertex(a[e+1][n])}}}function applyRadius(e){const t=new Vector3;for(let n=0;n<s.length;n+=3){t.x=s[n+0];t.y=s[n+1];t.z=s[n+2];t.normalize().multiplyScalar(e);s[n+0]=t.x;s[n+1]=t.y;s[n+2]=t.z}}function generateUVs(){const e=new Vector3;for(let t=0;t<s.length;t+=3){e.x=s[t+0];e.y=s[t+1];e.z=s[t+2];const n=azimuth(e)/2/Math.PI+.5;const r=inclination(e)/Math.PI+.5;a.push(n,1-r)}correctUVs();correctSeam()}function correctSeam(){for(let e=0;e<a.length;e+=6){const t=a[e+0];const n=a[e+2];const r=a[e+4];const s=Math.max(t,n,r);const o=Math.min(t,n,r);if(s>.9&&o<.1){t<.2&&(a[e+0]+=1);n<.2&&(a[e+2]+=1);r<.2&&(a[e+4]+=1)}}}function pushVertex(e){s.push(e.x,e.y,e.z)}function getVertexByIndex(t,n){const r=t*3;n.x=e[r+0];n.y=e[r+1];n.z=e[r+2]}function correctUVs(){const e=new Vector3;const t=new Vector3;const n=new Vector3;const r=new Vector3;const o=new Vector2;const l=new Vector2;const c=new Vector2;for(let u=0,h=0;u<s.length;u+=9,h+=6){e.set(s[u+0],s[u+1],s[u+2]);t.set(s[u+3],s[u+4],s[u+5]);n.set(s[u+6],s[u+7],s[u+8]);o.set(a[h+0],a[h+1]);l.set(a[h+2],a[h+3]);c.set(a[h+4],a[h+5]);r.copy(e).add(t).add(n).divideScalar(3);const d=azimuth(r);correctUV(o,h+0,e,d);correctUV(l,h+2,t,d);correctUV(c,h+4,n,d)}}function correctUV(e,t,n,r){r<0&&e.x===1&&(a[t]=e.x-1);n.x===0&&n.z===0&&(a[t]=r/2/Math.PI+.5)}function azimuth(e){return Math.atan2(e.z,-e.x)}function inclination(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new PolyhedronGeometry(e.vertices,e.indices,e.radius,e.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;const r=1/n;const s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];const a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t);this.type="DodecahedronGeometry";this.parameters={radius:e,detail:t}}static fromJSON(e){return new DodecahedronGeometry(e.radius,e.detail)}}const xa=new Vector3;const _a=new Vector3;const Ma=new Vector3;const wa=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(e=null,t=1){super();this.type="EdgesGeometry";this.parameters={geometry:e,thresholdAngle:t};if(e!==null){const n=4;const r=Math.pow(10,n);const s=Math.cos(Zn*t);const a=e.getIndex();const o=e.getAttribute("position");const l=a?a.count:o.count;const c=[0,0,0];const u=["a","b","c"];const h=new Array(3);const d={};const p=[];for(let e=0;e<l;e+=3){if(a){c[0]=a.getX(e);c[1]=a.getX(e+1);c[2]=a.getX(e+2)}else{c[0]=e;c[1]=e+1;c[2]=e+2}const{a:t,b:n,c:l}=wa;t.fromBufferAttribute(o,c[0]);n.fromBufferAttribute(o,c[1]);l.fromBufferAttribute(o,c[2]);wa.getNormal(Ma);h[0]=`${Math.round(t.x*r)},${Math.round(t.y*r)},${Math.round(t.z*r)}`;h[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`;h[2]=`${Math.round(l.x*r)},${Math.round(l.y*r)},${Math.round(l.z*r)}`;if(h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let e=0;e<3;e++){const t=(e+1)%3;const n=h[e];const r=h[t];const a=wa[u[e]];const o=wa[u[t]];const l=`${n}_${r}`;const f=`${r}_${n}`;if(f in d&&d[f]){if(Ma.dot(d[f].normal)<=s){p.push(a.x,a.y,a.z);p.push(o.x,o.y,o.z)}d[f]=null}else l in d||(d[l]={index0:c[e],index1:c[t],normal:Ma.clone()})}}for(const e in d)if(d[e]){const{index0:t,index1:n}=d[e];xa.fromBufferAttribute(o,t);_a.fromBufferAttribute(o,n);p.push(xa.x,xa.y,xa.z);p.push(_a.x,_a.y,_a.z)}this.setAttribute("position",new Float32BufferAttribute(p,3))}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}}class Shape extends Path{constructor(e){super(e);this.uuid=generateUUID();this.type="Shape";this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e);this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid;e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e);this.uuid=e.uuid;this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new Path).fromJSON(n))}return this}}const Sa={triangulate:function(e,t,n=2){const r=t&&t.length;const s=r?t[0]*n:e.length;let a=linkedList(e,0,s,n,true);const o=[];if(!a||a.next===a.prev)return o;let l,c,u,h,d,p,f;r&&(a=eliminateHoles(e,t,a,n));if(e.length>80*n){l=u=e[0];c=h=e[1];for(let t=n;t<s;t+=n){d=e[t];p=e[t+1];d<l&&(l=d);p<c&&(c=p);d>u&&(u=d);p>h&&(h=p)}f=Math.max(u-l,h-c);f=f!==0?32767/f:0}earcutLinked(a,o,n,l,c,f,0);return o}};function linkedList(e,t,n,r,s){let a,o;if(s===signedArea(e,t,n,r)>0)for(a=t;a<n;a+=r)o=insertNode(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=insertNode(a,e[a],e[a+1],o);if(o&&equals(o,o.next)){removeNode(o);o=o.next}return o}function filterPoints(e,t){if(!e)return e;t||(t=e);let n,r=e;do{n=false;if(r.steiner||!equals(r,r.next)&&area(r.prev,r,r.next)!==0)r=r.next;else{removeNode(r);r=t=r.prev;if(r===r.next)break;n=true}}while(n||r!==t);return t}function earcutLinked(e,t,n,r,s,a,o){if(!e)return;!o&&a&&indexCurve(e,r,s,a);let l,c,u=e;while(e.prev!==e.next){l=e.prev;c=e.next;if(a?isEarHashed(e,r,s,a):isEar(e)){t.push(l.i/n|0);t.push(e.i/n|0);t.push(c.i/n|0);removeNode(e);e=c.next;u=c.next}else{e=c;if(e===u){if(o)if(o===1){e=cureLocalIntersections(filterPoints(e),t,n);earcutLinked(e,t,n,r,s,a,2)}else o===2&&splitEarcut(e,t,n,r,s,a);else earcutLinked(filterPoints(e),t,n,r,s,a,1);break}}}}function isEar(e){const t=e.prev,n=e,r=e.next;if(area(t,n,r)>=0)return false;const s=t.x,a=n.x,o=r.x,l=t.y,c=n.y,u=r.y;const h=s<a?s<o?s:o:a<o?a:o,d=l<c?l<u?l:u:c<u?c:u,p=s>a?s>o?s:o:a>o?a:o,f=l>c?l>u?l:u:c>u?c:u;let m=r.next;while(m!==t){if(m.x>=h&&m.x<=p&&m.y>=d&&m.y<=f&&pointInTriangle(s,l,a,c,o,u,m.x,m.y)&&area(m.prev,m,m.next)>=0)return false;m=m.next}return true}function isEarHashed(e,t,n,r){const s=e.prev,a=e,o=e.next;if(area(s,a,o)>=0)return false;const l=s.x,c=a.x,u=o.x,h=s.y,d=a.y,p=o.y;const f=l<c?l<u?l:u:c<u?c:u,m=h<d?h<p?h:p:d<p?d:p,g=l>c?l>u?l:u:c>u?c:u,y=h>d?h>p?h:p:d>p?d:p;const b=zOrder(f,m,t,n,r),x=zOrder(g,y,t,n,r);let _=e.prevZ,M=e.nextZ;while(_&&_.z>=b&&M&&M.z<=x){if(_.x>=f&&_.x<=g&&_.y>=m&&_.y<=y&&_!==s&&_!==o&&pointInTriangle(l,h,c,d,u,p,_.x,_.y)&&area(_.prev,_,_.next)>=0)return false;_=_.prevZ;if(M.x>=f&&M.x<=g&&M.y>=m&&M.y<=y&&M!==s&&M!==o&&pointInTriangle(l,h,c,d,u,p,M.x,M.y)&&area(M.prev,M,M.next)>=0)return false;M=M.nextZ}while(_&&_.z>=b){if(_.x>=f&&_.x<=g&&_.y>=m&&_.y<=y&&_!==s&&_!==o&&pointInTriangle(l,h,c,d,u,p,_.x,_.y)&&area(_.prev,_,_.next)>=0)return false;_=_.prevZ}while(M&&M.z<=x){if(M.x>=f&&M.x<=g&&M.y>=m&&M.y<=y&&M!==s&&M!==o&&pointInTriangle(l,h,c,d,u,p,M.x,M.y)&&area(M.prev,M,M.next)>=0)return false;M=M.nextZ}return true}function cureLocalIntersections(e,t,n){let r=e;do{const s=r.prev,a=r.next.next;if(!equals(s,a)&&intersects(s,r,r.next,a)&&locallyInside(s,a)&&locallyInside(a,s)){t.push(s.i/n|0);t.push(r.i/n|0);t.push(a.i/n|0);removeNode(r);removeNode(r.next);r=e=a}r=r.next}while(r!==e);return filterPoints(r)}function splitEarcut(e,t,n,r,s,a){let o=e;do{let e=o.next.next;while(e!==o.prev){if(o.i!==e.i&&isValidDiagonal(o,e)){let l=splitPolygon(o,e);o=filterPoints(o,o.next);l=filterPoints(l,l.next);earcutLinked(o,t,n,r,s,a,0);earcutLinked(l,t,n,r,s,a,0);return}e=e.next}o=o.next}while(o!==e)}function eliminateHoles(e,t,n,r){const s=[];let a,o,l,c,u;for(a=0,o=t.length;a<o;a++){l=t[a]*r;c=a<o-1?t[a+1]*r:e.length;u=linkedList(e,l,c,r,false);u===u.next&&(u.steiner=true);s.push(getLeftmost(u))}s.sort(compareX);for(a=0;a<s.length;a++)n=eliminateHole(s[a],n);return n}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){const n=findHoleBridge(e,t);if(!n)return t;const r=splitPolygon(n,e);filterPoints(r,r.next);return filterPoints(n,n.next)}function findHoleBridge(e,t){let n,r=t,s=-Infinity;const a=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){const e=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=a&&e>s){s=e;n=r.x<r.next.x?r:r.next;if(e===a)return n}}r=r.next}while(r!==t);if(!n)return null;const l=n,c=n.x,u=n.y;let h,d=Infinity;r=n;do{if(a>=r.x&&r.x>=c&&a!==r.x&&pointInTriangle(o<u?a:s,o,c,u,o<u?s:a,o,r.x,r.y)){h=Math.abs(o-r.y)/(a-r.x);if(locallyInside(r,e)&&(h<d||h===d&&(r.x>n.x||r.x===n.x&&sectorContainsSector(n,r)))){n=r;d=h}}r=r.next}while(r!==l);return n}function sectorContainsSector(e,t){return area(e.prev,e,t.prev)<0&&area(t.next,e,e.next)<0}function indexCurve(e,t,n,r){let s=e;do{s.z===0&&(s.z=zOrder(s.x,s.y,t,n,r));s.prevZ=s.prev;s.nextZ=s.next;s=s.next}while(s!==e);s.prevZ.nextZ=null;s.prevZ=null;sortLinked(s)}function sortLinked(e){let t,n,r,s,a,o,l,c,u=1;do{n=e;e=null;a=null;o=0;while(n){o++;r=n;l=0;for(t=0;t<u;t++){l++;r=r.nextZ;if(!r)break}c=u;while(l>0||c>0&&r){if(l!==0&&(c===0||!r||n.z<=r.z)){s=n;n=n.nextZ;l--}else{s=r;r=r.nextZ;c--}a?a.nextZ=s:e=s;s.prevZ=a;a=s}n=r}a.nextZ=null;u*=2}while(o>1);return e}function zOrder(e,t,n,r,s){e=(e-n)*s|0;t=(t-r)*s|0;e=16711935&(e|e<<8);e=252645135&(e|e<<4);e=858993459&(e|e<<2);e=1431655765&(e|e<<1);t=16711935&(t|t<<8);t=252645135&(t|t<<4);t=858993459&(t|t<<2);t=1431655765&(t|t<<1);return e|t<<1}function getLeftmost(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t);t=t.next}while(t!==e);return n}function pointInTriangle(e,t,n,r,s,a,o,l){return(s-o)*(t-l)>=(e-o)*(a-l)&&(e-o)*(r-l)>=(n-o)*(t-l)&&(n-o)*(a-l)>=(s-o)*(r-l)}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!intersectsPolygon(e,t)&&(locallyInside(e,t)&&locallyInside(t,e)&&middleInside(e,t)&&(area(e.prev,e,t.prev)||area(e,t.prev,t))||equals(e,t)&&area(e.prev,e,e.next)>0&&area(t.prev,t,t.next)>0)}function area(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function equals(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,n,r){const s=sign(area(e,t,n));const a=sign(area(e,t,r));const o=sign(area(n,r,e));const l=sign(area(n,r,t));return s!==a&&o!==l||(!(s!==0||!onSegment(e,n,t))||(!(a!==0||!onSegment(e,r,t))||(!(o!==0||!onSegment(n,e,r))||!(l!==0||!onSegment(n,t,r)))))}function onSegment(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function sign(e){return e>0?1:e<0?-1:0}function intersectsPolygon(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&intersects(n,n.next,e,t))return true;n=n.next}while(n!==e);return false}function locallyInside(e,t){return area(e.prev,e,e.next)<0?area(e,t,e.next)>=0&&area(e,e.prev,t)>=0:area(e,t,e.prev)<0||area(e,e.next,t)<0}function middleInside(e,t){let n=e,r=false;const s=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&s<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r);n=n.next}while(n!==e);return r}function splitPolygon(e,t){const n=new Node(e.i,e.x,e.y),r=new Node(t.i,t.x,t.y),s=e.next,a=t.prev;e.next=t;t.prev=e;n.next=s;s.prev=n;r.next=n;n.prev=r;a.next=r;r.prev=a;return r}function insertNode(e,t,n,r){const s=new Node(e,t,n);if(r){s.next=r.next;s.prev=r;r.next.prev=s;r.next=s}else{s.prev=s;s.next=s}return s}function removeNode(e){e.next.prev=e.prev;e.prev.next=e.next;e.prevZ&&(e.prevZ.nextZ=e.nextZ);e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,n,r){(this||t).i=e;(this||t).x=n;(this||t).y=r;(this||t).prev=null;(this||t).next=null;(this||t).z=0;(this||t).prevZ=null;(this||t).nextZ=null;(this||t).steiner=false}function signedArea(e,t,n,r){let s=0;for(let a=t,o=n-r;a<n;a+=r){s+=(e[o]-e[a])*(e[a+1]+e[o+1]);o=a}return s}class ShapeUtils{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return ShapeUtils.area(e)<0}static triangulateShape(e,t){const n=[];const r=[];const s=[];removeDupEndPts(e);addContour(n,e);let a=e.length;t.forEach(removeDupEndPts);for(let e=0;e<t.length;e++){r.push(a);a+=t[e].length;addContour(n,t[e])}const o=Sa.triangulate(n,r);for(let e=0;e<o.length;e+=3)s.push(o.slice(e,e+3));return s}}function removeDupEndPts(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function addContour(e,t){for(let n=0;n<t.length;n++){e.push(t[n].x);e.push(t[n].y)}}class ExtrudeGeometry extends BufferGeometry{constructor(e=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry";this.parameters={shapes:e,options:t};e=Array.isArray(e)?e:[e];const n=this;const r=[];const s=[];for(let t=0,n=e.length;t<n;t++){const n=e[t];addShape(n)}this.setAttribute("position",new Float32BufferAttribute(r,3));this.setAttribute("uv",new Float32BufferAttribute(s,2));this.computeVertexNormals();function addShape(e){const a=[];const o=t.curveSegments!==void 0?t.curveSegments:12;const l=t.steps!==void 0?t.steps:1;const c=t.depth!==void 0?t.depth:1;let u=t.bevelEnabled===void 0||t.bevelEnabled;let h=t.bevelThickness!==void 0?t.bevelThickness:.2;let d=t.bevelSize!==void 0?t.bevelSize:h-.1;let p=t.bevelOffset!==void 0?t.bevelOffset:0;let f=t.bevelSegments!==void 0?t.bevelSegments:3;const m=t.extrudePath;const g=t.UVGenerator!==void 0?t.UVGenerator:Ta;let y,b=false;let x,_,M,w;if(m){y=m.getSpacedPoints(l);b=true;u=false;x=m.computeFrenetFrames(l,false);_=new Vector3;M=new Vector3;w=new Vector3}if(!u){f=0;h=0;d=0;p=0}const S=e.extractPoints(o);let T=S.shape;const I=S.holes;const R=!ShapeUtils.isClockWise(T);if(R){T=T.reverse();for(let e=0,t=I.length;e<t;e++){const t=I[e];ShapeUtils.isClockWise(t)&&(I[e]=t.reverse())}}const L=ShapeUtils.triangulateShape(T,I);const D=T;for(let e=0,t=I.length;e<t;e++){const t=I[e];T=T.concat(t)}function scalePt2(e,t,n){t||console.error("THREE.ExtrudeGeometry: vec does not exist");return e.clone().addScaledVector(t,n)}const P=T.length,F=L.length;function getBevelVec(e,t,n){let r,s,a;const o=e.x-t.x,l=e.y-t.y;const c=n.x-e.x,u=n.y-e.y;const h=o*o+l*l;const d=o*u-l*c;if(Math.abs(d)>Number.EPSILON){const d=Math.sqrt(h);const p=Math.sqrt(c*c+u*u);const f=t.x-l/d;const m=t.y+o/d;const g=n.x-u/p;const y=n.y+c/p;const b=((g-f)*u-(y-m)*c)/(o*u-l*c);r=f+o*b-e.x;s=m+l*b-e.y;const x=r*r+s*s;if(x<=2)return new Vector2(r,s);a=Math.sqrt(x/2)}else{let e=false;o>Number.EPSILON?c>Number.EPSILON&&(e=true):o<-Number.EPSILON?c<-Number.EPSILON&&(e=true):Math.sign(l)===Math.sign(u)&&(e=true);if(e){r=-l;s=o;a=Math.sqrt(h)}else{r=o;s=l;a=Math.sqrt(h/2)}}return new Vector2(r/a,s/a)}const U=[];for(let e=0,t=D.length,n=t-1,r=e+1;e<t;e++,n++,r++){n===t&&(n=0);r===t&&(r=0);U[e]=getBevelVec(D[e],D[n],D[r])}const O=[];let k,N=U.concat();for(let e=0,t=I.length;e<t;e++){const t=I[e];k=[];for(let e=0,n=t.length,r=n-1,s=e+1;e<n;e++,r++,s++){r===n&&(r=0);s===n&&(s=0);k[e]=getBevelVec(t[e],t[r],t[s])}O.push(k);N=N.concat(k)}for(let e=0;e<f;e++){const t=e/f;const n=h*Math.cos(t*Math.PI/2);const r=d*Math.sin(t*Math.PI/2)+p;for(let e=0,t=D.length;e<t;e++){const t=scalePt2(D[e],U[e],r);v(t.x,t.y,-n)}for(let e=0,t=I.length;e<t;e++){const t=I[e];k=O[e];for(let e=0,s=t.length;e<s;e++){const s=scalePt2(t[e],k[e],r);v(s.x,s.y,-n)}}}const G=d+p;for(let e=0;e<P;e++){const t=u?scalePt2(T[e],N[e],G):T[e];if(b){M.copy(x.normals[0]).multiplyScalar(t.x);_.copy(x.binormals[0]).multiplyScalar(t.y);w.copy(y[0]).add(M).add(_);v(w.x,w.y,w.z)}else v(t.x,t.y,0)}for(let e=1;e<=l;e++)for(let t=0;t<P;t++){const n=u?scalePt2(T[t],N[t],G):T[t];if(b){M.copy(x.normals[e]).multiplyScalar(n.x);_.copy(x.binormals[e]).multiplyScalar(n.y);w.copy(y[e]).add(M).add(_);v(w.x,w.y,w.z)}else v(n.x,n.y,c/l*e)}for(let e=f-1;e>=0;e--){const t=e/f;const n=h*Math.cos(t*Math.PI/2);const r=d*Math.sin(t*Math.PI/2)+p;for(let e=0,t=D.length;e<t;e++){const t=scalePt2(D[e],U[e],r);v(t.x,t.y,c+n)}for(let e=0,t=I.length;e<t;e++){const t=I[e];k=O[e];for(let e=0,s=t.length;e<s;e++){const s=scalePt2(t[e],k[e],r);b?v(s.x,s.y+y[l-1].y,y[l-1].x+n):v(s.x,s.y,c+n)}}}buildLidFaces();buildSideFaces();function buildLidFaces(){const e=r.length/3;if(u){let e=0;let t=P*e;for(let e=0;e<F;e++){const n=L[e];f3(n[2]+t,n[1]+t,n[0]+t)}e=l+f*2;t=P*e;for(let e=0;e<F;e++){const n=L[e];f3(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<F;e++){const t=L[e];f3(t[2],t[1],t[0])}for(let e=0;e<F;e++){const t=L[e];f3(t[0]+P*l,t[1]+P*l,t[2]+P*l)}}n.addGroup(e,r.length/3-e,0)}function buildSideFaces(){const e=r.length/3;let t=0;sidewalls(D,t);t+=D.length;for(let e=0,n=I.length;e<n;e++){const n=I[e];sidewalls(n,t);t+=n.length}n.addGroup(e,r.length/3-e,1)}function sidewalls(e,t){let n=e.length;while(--n>=0){const r=n;let s=n-1;s<0&&(s=e.length-1);for(let e=0,n=l+f*2;e<n;e++){const n=P*e;const a=P*(e+1);const o=t+r+n,l=t+s+n,c=t+s+a,u=t+r+a;f4(o,l,c,u)}}}function v(e,t,n){a.push(e);a.push(t);a.push(n)}function f3(e,t,s){addVertex(e);addVertex(t);addVertex(s);const a=r.length/3;const o=g.generateTopUV(n,r,a-3,a-2,a-1);addUV(o[0]);addUV(o[1]);addUV(o[2])}function f4(e,t,s,a){addVertex(e);addVertex(t);addVertex(a);addVertex(t);addVertex(s);addVertex(a);const o=r.length/3;const l=g.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);addUV(l[0]);addUV(l[1]);addUV(l[3]);addUV(l[1]);addUV(l[2]);addUV(l[3])}function addVertex(e){r.push(a[e*3+0]);r.push(a[e*3+1]);r.push(a[e*3+2])}function addUV(e){s.push(e.x);s.push(e.y)}}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}toJSON(){const e=super.toJSON();const t=this.parameters.shapes;const n=this.parameters.options;return toJSON$1(t,n,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const s=t[e.shapes[r]];n.push(s)}const r=e.options.extrudePath;r!==void 0&&(e.options.extrudePath=(new ba[r.type]).fromJSON(r));return new ExtrudeGeometry(n,e.options)}}const Ta={generateTopUV:function(e,t,n,r,s){const a=t[n*3];const o=t[n*3+1];const l=t[r*3];const c=t[r*3+1];const u=t[s*3];const h=t[s*3+1];return[new Vector2(a,o),new Vector2(l,c),new Vector2(u,h)]},generateSideWallUV:function(e,t,n,r,s,a){const o=t[n*3];const l=t[n*3+1];const c=t[n*3+2];const u=t[r*3];const h=t[r*3+1];const d=t[r*3+2];const p=t[s*3];const f=t[s*3+1];const m=t[s*3+2];const g=t[a*3];const y=t[a*3+1];const b=t[a*3+2];return Math.abs(l-h)<Math.abs(o-u)?[new Vector2(o,1-c),new Vector2(u,1-d),new Vector2(p,1-m),new Vector2(g,1-b)]:[new Vector2(l,1-c),new Vector2(h,1-d),new Vector2(f,1-m),new Vector2(y,1-b)]}};function toJSON$1(e,t,n){n.shapes=[];if(Array.isArray(e))for(let t=0,r=e.length;t<r;t++){const r=e[t];n.shapes.push(r.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t);t.extrudePath!==void 0&&(n.options.extrudePath=t.extrudePath.toJSON());return n}class IcosahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;const r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];const s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t);this.type="IcosahedronGeometry";this.parameters={radius:e,detail:t}}static fromJSON(e){return new IcosahedronGeometry(e.radius,e.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];const r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t);this.type="OctahedronGeometry";this.parameters={radius:e,detail:t}}static fromJSON(e){return new OctahedronGeometry(e.radius,e.detail)}}class PlaneGeometry extends BufferGeometry{constructor(e=1,t=1,n=1,r=1){super();this.type="PlaneGeometry";this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2;const a=t/2;const o=Math.floor(n);const l=Math.floor(r);const c=o+1;const u=l+1;const h=e/o;const d=t/l;const p=[];const f=[];const m=[];const g=[];for(let e=0;e<u;e++){const t=e*d-a;for(let n=0;n<c;n++){const r=n*h-s;f.push(r,-t,0);m.push(0,0,1);g.push(n/o);g.push(1-e/l)}}for(let e=0;e<l;e++)for(let t=0;t<o;t++){const n=t+c*e;const r=t+c*(e+1);const s=t+1+c*(e+1);const a=t+1+c*e;p.push(n,r,a);p.push(r,s,a)}this.setIndex(p);this.setAttribute("position",new Float32BufferAttribute(f,3));this.setAttribute("normal",new Float32BufferAttribute(m,3));this.setAttribute("uv",new Float32BufferAttribute(g,2))}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new PlaneGeometry(e.width,e.height,e.widthSegments,e.heightSegments)}}class RingGeometry extends BufferGeometry{constructor(e=.5,t=1,n=32,r=1,s=0,a=Math.PI*2){super();this.type="RingGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:a};n=Math.max(3,n);r=Math.max(1,r);const o=[];const l=[];const c=[];const u=[];let h=e;const d=(t-e)/r;const p=new Vector3;const f=new Vector2;for(let e=0;e<=r;e++){for(let e=0;e<=n;e++){const r=s+e/n*a;p.x=h*Math.cos(r);p.y=h*Math.sin(r);l.push(p.x,p.y,p.z);c.push(0,0,1);f.x=(p.x/t+1)/2;f.y=(p.y/t+1)/2;u.push(f.x,f.y)}h+=d}for(let e=0;e<r;e++){const t=e*(n+1);for(let e=0;e<n;e++){const r=e+t;const s=r;const a=r+n+1;const l=r+n+2;const c=r+1;o.push(s,a,c);o.push(a,l,c)}}this.setIndex(o);this.setAttribute("position",new Float32BufferAttribute(l,3));this.setAttribute("normal",new Float32BufferAttribute(c,3));this.setAttribute("uv",new Float32BufferAttribute(u,2))}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new RingGeometry(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(e=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),t=12){super();this.type="ShapeGeometry";this.parameters={shapes:e,curveSegments:t};const n=[];const r=[];const s=[];const a=[];let o=0;let l=0;if(Array.isArray(e)===false)addShape(e);else for(let t=0;t<e.length;t++){addShape(e[t]);this.addGroup(o,l,t);o+=l;l=0}this.setIndex(n);this.setAttribute("position",new Float32BufferAttribute(r,3));this.setAttribute("normal",new Float32BufferAttribute(s,3));this.setAttribute("uv",new Float32BufferAttribute(a,2));function addShape(e){const o=r.length/3;const c=e.extractPoints(t);let u=c.shape;const h=c.holes;ShapeUtils.isClockWise(u)===false&&(u=u.reverse());for(let e=0,t=h.length;e<t;e++){const t=h[e];ShapeUtils.isClockWise(t)===true&&(h[e]=t.reverse())}const d=ShapeUtils.triangulateShape(u,h);for(let e=0,t=h.length;e<t;e++){const t=h[e];u=u.concat(t)}for(let e=0,t=u.length;e<t;e++){const t=u[e];r.push(t.x,t.y,0);s.push(0,0,1);a.push(t.x,t.y)}for(let e=0,t=d.length;e<t;e++){const t=d[e];const r=t[0]+o;const s=t[1]+o;const a=t[2]+o;n.push(r,s,a);l+=3}}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}toJSON(){const e=super.toJSON();const t=this.parameters.shapes;return toJSON(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const s=t[e.shapes[r]];n.push(s)}return new ShapeGeometry(n,e.curveSegments)}}function toJSON(e,t){t.shapes=[];if(Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}class SphereGeometry extends BufferGeometry{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super();this.type="SphereGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o};t=Math.max(3,Math.floor(t));n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const u=[];const h=new Vector3;const d=new Vector3;const p=[];const f=[];const m=[];const g=[];for(let p=0;p<=n;p++){const y=[];const b=p/n;let x=0;p===0&&a===0?x=.5/t:p===n&&l===Math.PI&&(x=-.5/t);for(let n=0;n<=t;n++){const l=n/t;h.x=-e*Math.cos(r+l*s)*Math.sin(a+b*o);h.y=e*Math.cos(a+b*o);h.z=e*Math.sin(r+l*s)*Math.sin(a+b*o);f.push(h.x,h.y,h.z);d.copy(h).normalize();m.push(d.x,d.y,d.z);g.push(l+x,1-b);y.push(c++)}u.push(y)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=u[e][r+1];const s=u[e][r];const o=u[e+1][r];const c=u[e+1][r+1];(e!==0||a>0)&&p.push(t,s,c);(e!==n-1||l<Math.PI)&&p.push(s,o,c)}this.setIndex(p);this.setAttribute("position",new Float32BufferAttribute(f,3));this.setAttribute("normal",new Float32BufferAttribute(m,3));this.setAttribute("uv",new Float32BufferAttribute(g,2))}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new SphereGeometry(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];const r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t);this.type="TetrahedronGeometry";this.parameters={radius:e,detail:t}}static fromJSON(e){return new TetrahedronGeometry(e.radius,e.detail)}}class TorusGeometry extends BufferGeometry{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super();this.type="TorusGeometry";this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s};n=Math.floor(n);r=Math.floor(r);const a=[];const o=[];const l=[];const c=[];const u=new Vector3;const h=new Vector3;const d=new Vector3;for(let a=0;a<=n;a++)for(let p=0;p<=r;p++){const f=p/r*s;const m=a/n*Math.PI*2;h.x=(e+t*Math.cos(m))*Math.cos(f);h.y=(e+t*Math.cos(m))*Math.sin(f);h.z=t*Math.sin(m);o.push(h.x,h.y,h.z);u.x=e*Math.cos(f);u.y=e*Math.sin(f);d.subVectors(h,u).normalize();l.push(d.x,d.y,d.z);c.push(p/r);c.push(a/n)}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){const n=(r+1)*e+t-1;const s=(r+1)*(e-1)+t-1;const o=(r+1)*(e-1)+t;const l=(r+1)*e+t;a.push(n,s,l);a.push(s,o,l)}this.setIndex(a);this.setAttribute("position",new Float32BufferAttribute(o,3));this.setAttribute("normal",new Float32BufferAttribute(l,3));this.setAttribute("uv",new Float32BufferAttribute(c,2))}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new TorusGeometry(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(e=1,t=.4,n=64,r=8,s=2,a=3){super();this.type="TorusKnotGeometry";this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:a};n=Math.floor(n);r=Math.floor(r);const o=[];const l=[];const c=[];const u=[];const h=new Vector3;const d=new Vector3;const p=new Vector3;const f=new Vector3;const m=new Vector3;const g=new Vector3;const y=new Vector3;for(let o=0;o<=n;++o){const b=o/n*s*Math.PI*2;calculatePositionOnCurve(b,s,a,e,p);calculatePositionOnCurve(b+.01,s,a,e,f);g.subVectors(f,p);y.addVectors(f,p);m.crossVectors(g,y);y.crossVectors(m,g);m.normalize();y.normalize();for(let e=0;e<=r;++e){const s=e/r*Math.PI*2;const a=-t*Math.cos(s);const f=t*Math.sin(s);h.x=p.x+(a*y.x+f*m.x);h.y=p.y+(a*y.y+f*m.y);h.z=p.z+(a*y.z+f*m.z);l.push(h.x,h.y,h.z);d.subVectors(h,p).normalize();c.push(d.x,d.y,d.z);u.push(o/n);u.push(e/r)}}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1);const s=(r+1)*e+(t-1);const a=(r+1)*e+t;const l=(r+1)*(e-1)+t;o.push(n,s,l);o.push(s,a,l)}this.setIndex(o);this.setAttribute("position",new Float32BufferAttribute(l,3));this.setAttribute("normal",new Float32BufferAttribute(c,3));this.setAttribute("uv",new Float32BufferAttribute(u,2));function calculatePositionOnCurve(e,t,n,r,s){const a=Math.cos(e);const o=Math.sin(e);const l=n/t*e;const c=Math.cos(l);s.x=r*(2+c)*.5*a;s.y=r*(2+c)*o*.5;s.z=r*Math.sin(l)*.5}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}static fromJSON(e){return new TorusKnotGeometry(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class TubeGeometry extends BufferGeometry{constructor(e=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),t=64,n=1,r=8,s=false){super();this.type="TubeGeometry";this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;const o=new Vector3;const l=new Vector3;const c=new Vector2;let u=new Vector3;const h=[];const d=[];const p=[];const f=[];generateBufferData();this.setIndex(f);this.setAttribute("position",new Float32BufferAttribute(h,3));this.setAttribute("normal",new Float32BufferAttribute(d,3));this.setAttribute("uv",new Float32BufferAttribute(p,2));function generateBufferData(){for(let e=0;e<t;e++)generateSegment(e);generateSegment(s===false?t:0);generateUVs();generateIndices()}function generateSegment(s){u=e.getPointAt(s/t,u);const c=a.normals[s];const p=a.binormals[s];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2;const s=Math.sin(t);const a=-Math.cos(t);l.x=a*c.x+s*p.x;l.y=a*c.y+s*p.y;l.z=a*c.z+s*p.z;l.normalize();d.push(l.x,l.y,l.z);o.x=u.x+n*l.x;o.y=u.y+n*l.y;o.z=u.z+n*l.z;h.push(o.x,o.y,o.z)}}function generateIndices(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1);const s=(r+1)*e+(t-1);const a=(r+1)*e+t;const o=(r+1)*(e-1)+t;f.push(n,s,o);f.push(s,a,o)}}function generateUVs(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++){c.x=e/t;c.y=n/r;p.push(c.x,c.y)}}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}toJSON(){const e=super.toJSON();e.path=this.parameters.path.toJSON();return e}static fromJSON(e){return new TubeGeometry((new ba[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class WireframeGeometry extends BufferGeometry{constructor(e=null){super();this.type="WireframeGeometry";this.parameters={geometry:e};if(e!==null){const t=[];const n=new Set;const r=new Vector3;const s=new Vector3;if(e.index!==null){const a=e.attributes.position;const o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,c=l.length;e<c;++e){const c=l[e];const u=c.start;const h=c.count;for(let e=u,l=u+h;e<l;e+=3)for(let l=0;l<3;l++){const c=o.getX(e+l);const u=o.getX(e+(l+1)%3);r.fromBufferAttribute(a,c);s.fromBufferAttribute(a,u);if(isUniqueEdge(r,s,n)===true){t.push(r.x,r.y,r.z);t.push(s.x,s.y,s.z)}}}}else{const a=e.attributes.position;for(let e=0,o=a.count/3;e<o;e++)for(let o=0;o<3;o++){const l=3*e+o;const c=3*e+(o+1)%3;r.fromBufferAttribute(a,l);s.fromBufferAttribute(a,c);if(isUniqueEdge(r,s,n)===true){t.push(r.x,r.y,r.z);t.push(s.x,s.y,s.z)}}}this.setAttribute("position",new Float32BufferAttribute(t,3))}}copy(e){super.copy(e);this.parameters=Object.assign({},e.parameters);return this}}function isUniqueEdge(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;const s=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;if(n.has(r)===true||n.has(s)===true)return false;n.add(r);n.add(s);return true}var Ba=Object.freeze({__proto__:null,BoxGeometry:BoxGeometry,CapsuleGeometry:CapsuleGeometry,CircleGeometry:CircleGeometry,ConeGeometry:ConeGeometry,CylinderGeometry:CylinderGeometry,DodecahedronGeometry:DodecahedronGeometry,EdgesGeometry:EdgesGeometry,ExtrudeGeometry:ExtrudeGeometry,IcosahedronGeometry:IcosahedronGeometry,LatheGeometry:LatheGeometry,OctahedronGeometry:OctahedronGeometry,PlaneGeometry:PlaneGeometry,PolyhedronGeometry:PolyhedronGeometry,RingGeometry:RingGeometry,ShapeGeometry:ShapeGeometry,SphereGeometry:SphereGeometry,TetrahedronGeometry:TetrahedronGeometry,TorusGeometry:TorusGeometry,TorusKnotGeometry:TorusKnotGeometry,TubeGeometry:TubeGeometry,WireframeGeometry:WireframeGeometry});class ShadowMaterial extends Material{constructor(e){super();this.isShadowMaterial=true;this.type="ShadowMaterial";this.color=new Color(0);this.transparent=true;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.fog=e.fog;return this}}class RawShaderMaterial extends ShaderMaterial{constructor(e){super(e);this.isRawShaderMaterial=true;this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(e){super();this.isMeshStandardMaterial=true;this.type="MeshStandardMaterial";this.defines={STANDARD:""};this.color=new Color(16777215);this.roughness=1;this.metalness=0;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=sn;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.roughnessMap=null;this.metalnessMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new Euler;this.envMapIntensity=1;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.flatShading=false;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.defines={STANDARD:""};this.color.copy(e.color);this.roughness=e.roughness;this.metalness=e.metalness;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.roughnessMap=e.roughnessMap;this.metalnessMap=e.metalnessMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapRotation.copy(e.envMapRotation);this.envMapIntensity=e.envMapIntensity;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.flatShading=e.flatShading;this.fog=e.fog;return this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(e){super();this.isMeshPhysicalMaterial=true;this.defines={STANDARD:"",PHYSICAL:""};this.type="MeshPhysicalMaterial";this.anisotropyRotation=0;this.anisotropyMap=null;this.clearcoatMap=null;this.clearcoatRoughness=0;this.clearcoatRoughnessMap=null;this.clearcoatNormalScale=new Vector2(1,1);this.clearcoatNormalMap=null;this.ior=1.5;Object.defineProperty(this,"reflectivity",{get:function(){return clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}});this.iridescenceMap=null;this.iridescenceIOR=1.3;this.iridescenceThicknessRange=[100,400];this.iridescenceThicknessMap=null;this.sheenColor=new Color(0);this.sheenColorMap=null;this.sheenRoughness=1;this.sheenRoughnessMap=null;this.transmissionMap=null;this.thickness=0;this.thicknessMap=null;this.attenuationDistance=Infinity;this.attenuationColor=new Color(1,1,1);this.specularIntensity=1;this.specularIntensityMap=null;this.specularColor=new Color(1,1,1);this.specularColorMap=null;this._anisotropy=0;this._clearcoat=0;this._dispersion=0;this._iridescence=0;this._sheen=0;this._transmission=0;this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++;this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++;this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++;this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++;this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++;this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++;this._transmission=e}copy(e){super.copy(e);this.defines={STANDARD:"",PHYSICAL:""};this.anisotropy=e.anisotropy;this.anisotropyRotation=e.anisotropyRotation;this.anisotropyMap=e.anisotropyMap;this.clearcoat=e.clearcoat;this.clearcoatMap=e.clearcoatMap;this.clearcoatRoughness=e.clearcoatRoughness;this.clearcoatRoughnessMap=e.clearcoatRoughnessMap;this.clearcoatNormalMap=e.clearcoatNormalMap;this.clearcoatNormalScale.copy(e.clearcoatNormalScale);this.dispersion=e.dispersion;this.ior=e.ior;this.iridescence=e.iridescence;this.iridescenceMap=e.iridescenceMap;this.iridescenceIOR=e.iridescenceIOR;this.iridescenceThicknessRange=[...e.iridescenceThicknessRange];this.iridescenceThicknessMap=e.iridescenceThicknessMap;this.sheen=e.sheen;this.sheenColor.copy(e.sheenColor);this.sheenColorMap=e.sheenColorMap;this.sheenRoughness=e.sheenRoughness;this.sheenRoughnessMap=e.sheenRoughnessMap;this.transmission=e.transmission;this.transmissionMap=e.transmissionMap;this.thickness=e.thickness;this.thicknessMap=e.thicknessMap;this.attenuationDistance=e.attenuationDistance;this.attenuationColor.copy(e.attenuationColor);this.specularIntensity=e.specularIntensity;this.specularIntensityMap=e.specularIntensityMap;this.specularColor.copy(e.specularColor);this.specularColorMap=e.specularColorMap;return this}}class MeshPhongMaterial extends Material{constructor(e){super();this.isMeshPhongMaterial=true;this.type="MeshPhongMaterial";this.color=new Color(16777215);this.specular=new Color(1118481);this.shininess=30;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=sn;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new Euler;this.combine=se;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.flatShading=false;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.specular.copy(e.specular);this.shininess=e.shininess;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapRotation.copy(e.envMapRotation);this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.flatShading=e.flatShading;this.fog=e.fog;return this}}class MeshToonMaterial extends Material{constructor(e){super();this.isMeshToonMaterial=true;this.defines={TOON:""};this.type="MeshToonMaterial";this.color=new Color(16777215);this.map=null;this.gradientMap=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=sn;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.map=e.map;this.gradientMap=e.gradientMap;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.alphaMap=e.alphaMap;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.fog=e.fog;return this}}class MeshNormalMaterial extends Material{constructor(e){super();this.isMeshNormalMaterial=true;this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=sn;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.flatShading=false;this.setValues(e)}copy(e){super.copy(e);this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.flatShading=e.flatShading;return this}}class MeshLambertMaterial extends Material{constructor(e){super();this.isMeshLambertMaterial=true;this.type="MeshLambertMaterial";this.color=new Color(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=sn;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.envMapRotation=new Euler;this.combine=se;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.flatShading=false;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapRotation.copy(e.envMapRotation);this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.flatShading=e.flatShading;this.fog=e.fog;return this}}class MeshDepthMaterial extends Material{constructor(e){super();this.isMeshDepthMaterial=true;this.type="MeshDepthMaterial";this.depthPacking=en;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.setValues(e)}copy(e){super.copy(e);this.depthPacking=e.depthPacking;this.map=e.map;this.alphaMap=e.alphaMap;this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;return this}}class MeshDistanceMaterial extends Material{constructor(e){super();this.isMeshDistanceMaterial=true;this.type="MeshDistanceMaterial";this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.setValues(e)}copy(e){super.copy(e);this.map=e.map;this.alphaMap=e.alphaMap;this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;return this}}class MeshMatcapMaterial extends Material{constructor(e){super();this.isMeshMatcapMaterial=true;this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new Color(16777215);this.matcap=null;this.map=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=sn;this.normalScale=new Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.flatShading=false;this.fog=true;this.setValues(e)}copy(e){super.copy(e);this.defines={MATCAP:""};this.color.copy(e.color);this.matcap=e.matcap;this.map=e.map;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.alphaMap=e.alphaMap;this.flatShading=e.flatShading;this.fog=e.fog;return this}}class LineDashedMaterial extends LineBasicMaterial{constructor(e){super();this.isLineDashedMaterial=true;this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(e)}copy(e){super.copy(e);this.scale=e.scale;this.dashSize=e.dashSize;this.gapSize=e.gapSize;return this}}function convertArray(e,t,n){return!e||!n&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT==="number"?new t(e):Array.prototype.slice.call(e)}function isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function getKeyframeOrder(e){function compareTime(t,n){return e[t]-e[n]}const t=e.length;const n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;n.sort(compareTime);return n}function sortedArray(e,t,n){const r=e.length;const s=new e.constructor(r);for(let a=0,o=0;o!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)s[o++]=e[r+n]}return s}function flattenJSON(e,t,n,r){let s=1,a=e[0];while(a!==void 0&&a[r]===void 0)a=e[s++];if(a===void 0)return;let o=a[r];if(o!==void 0)if(Array.isArray(o))do{o=a[r];if(o!==void 0){t.push(a.time);n.push.apply(n,o)}a=e[s++]}while(a!==void 0);else if(o.toArray!==void 0)do{o=a[r];if(o!==void 0){t.push(a.time);o.toArray(n,n.length)}a=e[s++]}while(a!==void 0);else do{o=a[r];if(o!==void 0){t.push(a.time);n.push(o)}a=e[s++]}while(a!==void 0)}function subclip(e,t,n,r,s=30){const a=e.clone();a.name=t;const o=[];for(let e=0;e<a.tracks.length;++e){const t=a.tracks[e];const l=t.getValueSize();const c=[];const u=[];for(let e=0;e<t.times.length;++e){const a=t.times[e]*s;if(!(a<n||a>=r)){c.push(t.times[e]);for(let n=0;n<l;++n)u.push(t.values[e*l+n])}}if(c.length!==0){t.times=convertArray(c,t.times.constructor);t.values=convertArray(u,t.values.constructor);o.push(t)}}a.tracks=o;let l=Infinity;for(let e=0;e<a.tracks.length;++e)l>a.tracks[e].times[0]&&(l=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*l);a.resetDuration();return a}function makeClipAdditive(e,t=0,n=e,r=30){r<=0&&(r=30);const s=n.tracks.length;const a=t/r;for(let t=0;t<s;++t){const r=n.tracks[t];const s=r.ValueTypeName;if(s==="bool"||s==="string")continue;const o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===s}));if(o===void 0)continue;let l=0;const c=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);let u=0;const h=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);const d=r.times.length-1;let p;if(a<=r.times[0]){const e=l;const t=c-l;p=r.values.slice(e,t)}else if(a>=r.times[d]){const e=d*c+l;const t=e+c-l;p=r.values.slice(e,t)}else{const e=r.createInterpolant();const t=l;const n=c-l;e.evaluate(a);p=e.resultBuffer.slice(t,n)}if(s==="quaternion"){const e=(new Quaternion).fromArray(p).normalize().conjugate();e.toArray(p)}const f=o.times.length;for(let e=0;e<f;++e){const t=e*h+u;if(s==="quaternion")Quaternion.multiplyQuaternionsFlat(o.values,t,p,0,o.values,t);else{const e=h-u*2;for(let n=0;n<e;++n)o.values[t+n]-=p[n]}}}e.blendMode=Yt;return e}const Ia={convertArray:convertArray,isTypedArray:isTypedArray,getKeyframeOrder:getKeyframeOrder,sortedArray:sortedArray,flattenJSON:flattenJSON,subclip:subclip,makeClipAdditive:makeClipAdditive};class Interpolant{constructor(e,t,n,r){this.parameterPositions=e;this._cachedIndex=0;this.resultBuffer=r!==void 0?r:new t.constructor(n);this.sampleValues=t;this.valueSize=n;this.settings=null;this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break r;n=t.length;this._cachedIndex=n;return this.copySampleValue_(n-1)}if(n===a)break;s=r;r=t[++n];if(e<r)break t}a=t.length;break n}if(e>=s)break e;{const o=t[1];if(e<o){n=2;s=o}for(let a=n-2;;){if(s===void 0){this._cachedIndex=0;return this.copySampleValue_(0)}if(n===a)break;r=s;s=t[--n-1];if(e>=s)break t}a=n;n=0}}while(n<a){const r=n+a>>>1;e<t[r]?a=r:n=r+1}r=t[n];s=t[n-1];if(s===void 0){this._cachedIndex=0;return this.copySampleValue_(0)}if(r===void 0){n=t.length;this._cachedIndex=n;return this.copySampleValue_(n-1)}}this._cachedIndex=n;this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let e=0;e!==r;++e)t[e]=n[s+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(e,t,n,r){super(e,t,n,r);this._weightPrev=-0;this._offsetPrev=-0;this._weightNext=-0;this._offsetNext=-0;this.DefaultSettings_={endingStart:Wt,endingEnd:Wt}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],l=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case qt:s=e;o=2*t-n;break;case Kt:s=r.length-2;o=t+r[s]-r[s+1];break;default:s=e;o=n}if(l===void 0)switch(this.getSettings_().endingEnd){case qt:a=e;l=2*n-t;break;case Kt:a=1;l=n+r[1]-r[0];break;default:a=e-1;l=t}const c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-o);this._weightNext=c/(l-n);this._offsetPrev=s*u;this._offsetNext=a*u}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(n-t)/(r-t),m=f*f,g=m*f;const y=-d*g+2*d*m-d*f;const b=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*f+1;const x=(-1-p)*g+(1.5+p)*m+.5*f;const _=p*g-p*m;for(let e=0;e!==o;++e)s[e]=y*a[u+e]+b*a[c+e]+x*a[l+e]+_*a[h+e];return s}}class LinearInterpolant extends Interpolant{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=(n-t)/(r-t),h=1-u;for(let e=0;e!==o;++e)s[e]=a[c+e]*h+a[l+e]*u;return s}}class DiscreteInterpolant extends Interpolant{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class KeyframeTrack{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e;this.times=convertArray(t,this.TimeBufferType);this.values=convertArray(n,this.ValueBufferType);this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:convertArray(e.times,Array),values:convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}n.type=e.ValueTypeName;return n}InterpolantFactoryMethodDiscrete(e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case jt:t=this.InterpolantFactoryMethodDiscrete;break;case Ht:t=this.InterpolantFactoryMethodLinear;break;case zt:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",t);return this}this.createInterpolant=t;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jt;case this.InterpolantFactoryMethodLinear:return Ht;case this.InterpolantFactoryMethodSmooth:return zt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,a=r-1;while(s!==r&&n[s]<e)++s;while(a!==-1&&n[a]>t)--a;++a;if(s!==0||a!==r){if(s>=a){a=Math.max(a,1);s=a-1}const e=this.getValueSize();this.times=n.slice(s,a);this.values=this.values.slice(s*e,a*e)}return this}validate(){let e=true;const t=this.getValueSize();if(t-Math.floor(t)!==0){console.error("THREE.KeyframeTrack: Invalid value size in track.",this);e=false}const n=this.times,r=this.values,s=n.length;if(s===0){console.error("THREE.KeyframeTrack: Track is empty.",this);e=false}let a=null;for(let t=0;t!==s;t++){const r=n[t];if(typeof r==="number"&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r);e=false;break}if(a!==null&&a>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,a);e=false;break}a=r}if(r!==void 0&&isTypedArray(r))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n);e=false;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===zt,s=e.length-1;let a=1;for(let o=1;o<s;++o){let s=false;const l=e[o];const c=e[o+1];if(l!==c&&(o!==1||l!==e[0]))if(r)s=true;else{const e=o*n,r=e-n,a=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[r+o]||n!==t[a+o]){s=true;break}}}if(s){if(o!==a){e[a]=e[o];const r=o*n,s=a*n;for(let e=0;e!==n;++e)t[s+e]=t[r+e]}++a}}if(s>0){e[a]=e[s];for(let e=s*n,r=a*n,o=0;o!==n;++o)t[r+o]=t[e+o];++a}if(a!==e.length){this.times=e.slice(0,a);this.values=t.slice(0,a*n)}else{this.times=e;this.values=t}return this}clone(){const e=this.times.slice();const t=this.values.slice();const n=this.constructor;const r=new n(this.name,e,t);r.createInterpolant=this.createInterpolant;return r}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=Ht;class BooleanKeyframeTrack extends KeyframeTrack{constructor(e,t,n){super(e,t,n)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=jt;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(n-t)/(r-t);let c=e*o;for(let e=c+o;c!==e;c+=4)Quaternion.slerpFlat(s,0,a,c-o,a,c,l);return s}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(e,t,n){super(e,t,n)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=jt;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(e="",t=-1,n=[],r=Xt){this.name=e;this.tracks=n;this.duration=t;this.blendMode=r;this.uuid=generateUUID();this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let e=0,s=n.length;e!==s;++e)t.push(parseKeyframeTrack(n[e]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);s.uuid=e.uuid;return s}static toJSON(e){const t=[],n=e.tracks;const r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,r=n.length;e!==r;++e)t.push(KeyframeTrack.toJSON(n[e]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length;const a=[];for(let e=0;e<s;e++){let o=[];let l=[];o.push((e+s-1)%s,e,(e+1)%s);l.push(0,1,0);const c=getKeyframeOrder(o);o=sortedArray(o,1,c);l=sortedArray(l,1,c);if(!r&&o[0]===0){o.push(s);l.push(l[0])}a.push(new NumberKeyframeTrack(".morphTargetInfluences["+t[e].name+"]",o,l).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={};const s=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t];const a=n.name.match(s);if(a&&a.length>1){const e=a[1];let t=r[e];t||(r[e]=t=[]);t.push(n)}}const a=[];for(const e in r)a.push(this.CreateFromMorphTargetSequence(e,r[e],t,n));return a}static parseAnimation(e,t){if(!e){console.error("THREE.AnimationClip: No animation in JSONLoader data.");return null}const addNonemptyTrack=function(e,t,n,r,s){if(n.length!==0){const a=[];const o=[];flattenJSON(n,a,o,r);a.length!==0&&s.push(new e(t,a,o))}};const n=[];const r=e.name||"default";const s=e.fps||30;const a=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const r=l[e].keys;if(r&&r.length!==0)if(r[0].morphTargets){const e={};let t;for(t=0;t<r.length;t++)if(r[t].morphTargets)for(let n=0;n<r[t].morphTargets.length;n++)e[r[t].morphTargets[n]]=-1;for(const s in e){const e=[];const a=[];for(let n=0;n!==r[t].morphTargets.length;++n){const n=r[t];e.push(n.time);a.push(n.morphTarget===s?1:0)}n.push(new NumberKeyframeTrack(".morphTargetInfluence["+s+"]",e,a))}o=e.length*s}else{const s=".bones["+t[e].name+"]";addNonemptyTrack(VectorKeyframeTrack,s+".position",r,"pos",n);addNonemptyTrack(QuaternionKeyframeTrack,s+".quaternion",r,"rot",n);addNonemptyTrack(VectorKeyframeTrack,s+".scale",r,"scl",n)}}if(n.length===0)return null;const c=new this(r,o,n,a);return c}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const e=this.tracks[n];t=Math.max(t,e.times[e.times.length-1])}this.duration=t;return this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=true;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function parseKeyframeTrack(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=getTrackTypeForValueTypeName(e.type);if(e.times===void 0){const t=[],n=[];flattenJSON(e.keys,t,n,"value");e.times=t;e.values=n}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Ra={enabled:false,files:{},add:function(e,n){(this||t).enabled!==false&&((this||t).files[e]=n)},get:function(e){if((this||t).enabled!==false)return(this||t).files[e]},remove:function(e){delete(this||t).files[e]},clear:function(){(this||t).files={}}};class LoadingManager{constructor(e,t,n){const r=this;let s=false;let a=0;let o=0;let l;const c=[];this.onStart=void 0;this.onLoad=e;this.onProgress=t;this.onError=n;this.itemStart=function(e){o++;s===false&&r.onStart!==void 0&&r.onStart(e,a,o);s=true};this.itemEnd=function(e){a++;r.onProgress!==void 0&&r.onProgress(e,a,o);if(a===o){s=false;r.onLoad!==void 0&&r.onLoad()}};this.itemError=function(e){r.onError!==void 0&&r.onError(e)};this.resolveURL=function(e){return l?l(e):e};this.setURLModifier=function(e){l=e;return this};this.addHandler=function(e,t){c.push(e,t);return this};this.removeHandler=function(e){const t=c.indexOf(e);t!==-1&&c.splice(t,2);return this};this.getHandler=function(e){for(let t=0,n=c.length;t<n;t+=2){const n=c[t];const r=c[t+1];n.global&&(n.lastIndex=0);if(n.test(e))return r}return null}}}const La=new LoadingManager;class Loader{constructor(e){this.manager=e!==void 0?e:La;this.crossOrigin="anonymous";this.withCredentials=false;this.path="";this.resourcePath="";this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,s){n.load(e,r,t,s)}))}parse(){}setCrossOrigin(e){this.crossOrigin=e;return this}setWithCredentials(e){this.withCredentials=e;return this}setPath(e){this.path=e;return this}setResourcePath(e){this.resourcePath=e;return this}setRequestHeader(e){this.requestHeader=e;return this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const Da={};class HttpError extends Error{constructor(e,t){super(e);this.response=t}}class FileLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e="");this.path!==void 0&&(e=this.path+e);e=this.manager.resolveURL(e);const s=Ra.get(e);if(s!==void 0){this.manager.itemStart(e);setTimeout((()=>{t&&t(s);this.manager.itemEnd(e)}),0);return s}if(Da[e]!==void 0){Da[e].push({onLoad:t,onProgress:n,onError:r});return}Da[e]=[];Da[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});const o=this.mimeType;const l=this.responseType;fetch(a).then((t=>{if(t.status===200||t.status===0){t.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received.");if(typeof ReadableStream==="undefined"||t.body===void 0||t.body.getReader===void 0)return t;const n=Da[e];const r=t.body.getReader();const s=t.headers.get("X-File-Size")||t.headers.get("Content-Length");const a=s?parseInt(s):0;const o=a!==0;let l=0;const c=new ReadableStream({start(e){readData();function readData(){r.read().then((({done:t,value:r})=>{if(t)e.close();else{l+=r.byteLength;const t=new ProgressEvent("progress",{lengthComputable:o,loaded:l,total:a});for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onProgress&&r.onProgress(t)}e.enqueue(r);readData()}}),(t=>{e.error(t)}))}}});return new Response(c)}throw new HttpError(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(l){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>{const t=new DOMParser;return t.parseFromString(e,o)}));case"json":return e.json();default:if(o===void 0)return e.text();{const t=/charset="?([^;"\s]*)"?/i;const n=t.exec(o);const r=n&&n[1]?n[1].toLowerCase():void 0;const s=new TextDecoder(r);return e.arrayBuffer().then((e=>s.decode(e)))}}})).then((t=>{Ra.add(e,t);const n=Da[e];delete Da[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=Da[e];if(n===void 0){this.manager.itemError(e);throw t}delete Da[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)}));this.manager.itemStart(e)}setResponseType(e){this.responseType=e;return this}setMimeType(e){this.mimeType=e;return this}}class AnimationLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=this;const a=new FileLoader(this.manager);a.setPath(this.path);a.setRequestHeader(this.requestHeader);a.setWithCredentials(this.withCredentials);a.load(e,(function(n){try{t(s.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t);s.manager.itemError(e)}}),n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=AnimationClip.parse(e[n]);t.push(r)}return t}}class CompressedTextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=this;const a=[];const o=new CompressedTexture;const l=new FileLoader(this.manager);l.setPath(this.path);l.setResponseType("arraybuffer");l.setRequestHeader(this.requestHeader);l.setWithCredentials(s.withCredentials);let c=0;function loadTexture(u){l.load(e[u],(function(e){const n=s.parse(e,true);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps};c+=1;if(c===6){n.mipmapCount===1&&(o.minFilter=Le);o.image=a;o.format=n.format;o.needsUpdate=true;t&&t(o)}}),n,r)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)loadTexture(t);else l.load(e,(function(e){const n=s.parse(e,true);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++){a[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]);a[t].format=n.format;a[t].width=n.width;a[t].height=n.height}}o.image=a}else{o.image.width=n.width;o.image.height=n.height;o.mipmaps=n.mipmaps}n.mipmapCount===1&&(o.minFilter=Le);o.format=n.format;o.needsUpdate=true;t&&t(o)}),n,r);return o}}class ImageLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e);e=this.manager.resolveURL(e);const s=this;const a=Ra.get(e);if(a!==void 0){s.manager.itemStart(e);setTimeout((function(){t&&t(a);s.manager.itemEnd(e)}),0);return a}const o=createElementNS("img");function onImageLoad(){removeEventListeners();Ra.add(e,this);t&&t(this);s.manager.itemEnd(e)}function onImageError(t){removeEventListeners();r&&r(t);s.manager.itemError(e);s.manager.itemEnd(e)}function removeEventListeners(){o.removeEventListener("load",onImageLoad,false);o.removeEventListener("error",onImageError,false)}o.addEventListener("load",onImageLoad,false);o.addEventListener("error",onImageError,false);e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin);s.manager.itemStart(e);o.src=e;return o}}class CubeTextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=new CubeTexture;s.colorSpace=ln;const a=new ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);let o=0;function loadTexture(n){a.load(e[n],(function(e){s.images[n]=e;o++;if(o===6){s.needsUpdate=true;t&&t(s)}}),void 0,r)}for(let t=0;t<e.length;++t)loadTexture(t);return s}}class DataTextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=this;const a=new DataTexture;const o=new FileLoader(this.manager);o.setResponseType("arraybuffer");o.setRequestHeader(this.requestHeader);o.setPath(this.path);o.setWithCredentials(s.withCredentials);o.load(e,(function(e){let n;try{n=s.parse(e)}catch(e){if(r===void 0){console.error(e);return}r(e)}if(n.image!==void 0)a.image=n.image;else if(n.data!==void 0){a.image.width=n.width;a.image.height=n.height;a.image.data=n.data}a.wrapS=n.wrapS!==void 0?n.wrapS:Me;a.wrapT=n.wrapT!==void 0?n.wrapT:Me;a.magFilter=n.magFilter!==void 0?n.magFilter:Le;a.minFilter=n.minFilter!==void 0?n.minFilter:Le;a.anisotropy=n.anisotropy!==void 0?n.anisotropy:1;n.colorSpace!==void 0&&(a.colorSpace=n.colorSpace);n.flipY!==void 0&&(a.flipY=n.flipY);n.format!==void 0&&(a.format=n.format);n.type!==void 0&&(a.type=n.type);if(n.mipmaps!==void 0){a.mipmaps=n.mipmaps;a.minFilter=Fe}n.mipmapCount===1&&(a.minFilter=Le);n.generateMipmaps!==void 0&&(a.generateMipmaps=n.generateMipmaps);a.needsUpdate=true;t&&t(a,n)}),n,r);return a}}class TextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=new Texture;const a=new ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);a.load(e,(function(e){s.image=e;s.needsUpdate=true;t!==void 0&&t(s)}),n,r);return s}}class Light extends Object3D{constructor(e,t=1){super();this.isLight=true;this.type="Light";this.color=new Color(e);this.intensity=t}dispose(){}copy(e,t){super.copy(e,t);this.color.copy(e.color);this.intensity=e.intensity;return this}toJSON(e){const t=super.toJSON(e);t.object.color=this.color.getHex();t.object.intensity=this.intensity;this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex());this.distance!==void 0&&(t.object.distance=this.distance);this.angle!==void 0&&(t.object.angle=this.angle);this.decay!==void 0&&(t.object.decay=this.decay);this.penumbra!==void 0&&(t.object.penumbra=this.penumbra);this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON());this.target!==void 0&&(t.object.target=this.target.uuid);return t}}class HemisphereLight extends Light{constructor(e,t,n){super(e,n);this.isHemisphereLight=true;this.type="HemisphereLight";this.position.copy(Object3D.DEFAULT_UP);this.updateMatrix();this.groundColor=new Color(t)}copy(e,t){super.copy(e,t);this.groundColor.copy(e.groundColor);return this}}const Pa=new Matrix4;const Fa=new Vector3;const Ua=new Vector3;class LightShadow{constructor(e){this.camera=e;this.intensity=1;this.bias=0;this.normalBias=0;this.radius=1;this.blurSamples=8;this.mapSize=new Vector2(512,512);this.map=null;this.mapPass=null;this.matrix=new Matrix4;this.autoUpdate=true;this.needsUpdate=false;this._frustum=new Frustum;this._frameExtents=new Vector2(1,1);this._viewportCount=1;this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera;const n=this.matrix;Fa.setFromMatrixPosition(e.matrixWorld);t.position.copy(Fa);Ua.setFromMatrixPosition(e.target.matrixWorld);t.lookAt(Ua);t.updateMatrixWorld();Pa.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Pa);n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);n.multiply(Pa)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose();this.mapPass&&this.mapPass.dispose()}copy(e){this.camera=e.camera.clone();this.intensity=e.intensity;this.bias=e.bias;this.radius=e.radius;this.mapSize.copy(e.mapSize);return this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};this.intensity!==1&&(e.intensity=this.intensity);this.bias!==0&&(e.bias=this.bias);this.normalBias!==0&&(e.normalBias=this.normalBias);this.radius!==1&&(e.radius=this.radius);this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray());e.camera=this.camera.toJSON(false).object;delete e.camera.matrix;return e}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500));this.isSpotLightShadow=true;this.focus=1}updateMatrices(e){const t=this.camera;const n=$n*2*e.angle*this.focus;const r=this.mapSize.width/this.mapSize.height;const s=e.distance||t.far;if(n!==t.fov||r!==t.aspect||s!==t.far){t.fov=n;t.aspect=r;t.far=s;t.updateProjectionMatrix()}super.updateMatrices(e)}copy(e){super.copy(e);this.focus=e.focus;return this}}class SpotLight extends Light{constructor(e,t,n=0,r=Math.PI/3,s=0,a=2){super(e,t);this.isSpotLight=true;this.type="SpotLight";this.position.copy(Object3D.DEFAULT_UP);this.updateMatrix();this.target=new Object3D;this.distance=n;this.angle=r;this.penumbra=s;this.decay=a;this.map=null;this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){super.copy(e,t);this.distance=e.distance;this.angle=e.angle;this.penumbra=e.penumbra;this.decay=e.decay;this.target=e.target.clone();this.shadow=e.shadow.clone();return this}}const Oa=new Matrix4;const ka=new Vector3;const Na=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500));this.isPointLightShadow=true;this._frameExtents=new Vector2(4,2);this._viewportCount=6;this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)];this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)];this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera;const r=this.matrix;const s=e.distance||n.far;if(s!==n.far){n.far=s;n.updateProjectionMatrix()}ka.setFromMatrixPosition(e.matrixWorld);n.position.copy(ka);Na.copy(n.position);Na.add(this._cubeDirections[t]);n.up.copy(this._cubeUps[t]);n.lookAt(Na);n.updateMatrixWorld();r.makeTranslation(-ka.x,-ka.y,-ka.z);Oa.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Oa)}}class PointLight extends Light{constructor(e,t,n=0,r=2){super(e,t);this.isPointLight=true;this.type="PointLight";this.distance=n;this.decay=r;this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){super.copy(e,t);this.distance=e.distance;this.decay=e.decay;this.shadow=e.shadow.clone();return this}}class OrthographicCamera extends Camera{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super();this.isOrthographicCamera=true;this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=e;this.right=t;this.top=n;this.bottom=r;this.near=s;this.far=a;this.updateProjectionMatrix()}copy(e,t){super.copy(e,t);this.left=e.left;this.right=e.right;this.top=e.top;this.bottom=e.bottom;this.near=e.near;this.far=e.far;this.zoom=e.zoom;this.view=e.view===null?null:Object.assign({},e.view);return this}setViewOffset(e,t,n,r,s,a){this.view===null&&(this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=true;this.view.fullWidth=e;this.view.fullHeight=t;this.view.offsetX=n;this.view.offsetY=r;this.view.width=s;this.view.height=a;this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=false);this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom);const t=(this.top-this.bottom)/(2*this.zoom);const n=(this.right+this.left)/2;const r=(this.top+this.bottom)/2;let s=n-e;let a=n+e;let o=r+t;let l=r-t;if(this.view!==null&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom;const t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=e*this.view.offsetX;a=s+e*this.view.width;o-=t*this.view.offsetY;l=o-t*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);t.object.zoom=this.zoom;t.object.left=this.left;t.object.right=this.right;t.object.top=this.top;t.object.bottom=this.bottom;t.object.near=this.near;t.object.far=this.far;this.view!==null&&(t.object.view=Object.assign({},this.view));return t}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500));this.isDirectionalLightShadow=true}}class DirectionalLight extends Light{constructor(e,t){super(e,t);this.isDirectionalLight=true;this.type="DirectionalLight";this.position.copy(Object3D.DEFAULT_UP);this.updateMatrix();this.target=new Object3D;this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(e){super.copy(e);this.target=e.target.clone();this.shadow=e.shadow.clone();return this}}class AmbientLight extends Light{constructor(e,t){super(e,t);this.isAmbientLight=true;this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(e,t,n=10,r=10){super(e,t);this.isRectAreaLight=true;this.type="RectAreaLight";this.width=n;this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){super.copy(e);this.width=e.width;this.height=e.height;return this}toJSON(e){const t=super.toJSON(e);t.object.width=this.width;t.object.height=this.height;return t}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=true;this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Vector3)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z;const a=this.coefficients;t.copy(a[0]).multiplyScalar(.282095);t.addScaledVector(a[1],.488603*r);t.addScaledVector(a[2],.488603*s);t.addScaledVector(a[3],.488603*n);t.addScaledVector(a[4],n*r*1.092548);t.addScaledVector(a[5],r*s*1.092548);t.addScaledVector(a[6],.315392*(3*s*s-1));t.addScaledVector(a[7],n*s*1.092548);t.addScaledVector(a[8],.546274*(n*n-r*r));return t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z;const a=this.coefficients;t.copy(a[0]).multiplyScalar(.886227);t.addScaledVector(a[1],1.023328*r);t.addScaledVector(a[2],1.023328*s);t.addScaledVector(a[3],1.023328*n);t.addScaledVector(a[4],.858086*n*r);t.addScaledVector(a[5],.858086*r*s);t.addScaledVector(a[6],.743125*s*s-.247708);t.addScaledVector(a[7],.858086*n*s);t.addScaledVector(a[8],.429043*(n*n-r*r));return t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return false;return true}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095;t[1]=.488603*r;t[2]=.488603*s;t[3]=.488603*n;t[4]=1.092548*n*r;t[5]=1.092548*r*s;t[6]=.315392*(3*s*s-1);t[7]=1.092548*n*s;t[8]=.546274*(n*n-r*r)}}class LightProbe extends Light{constructor(e=new SphericalHarmonics3,t=1){super(void 0,t);this.isLightProbe=true;this.sh=e}copy(e){super.copy(e);this.sh.copy(e.sh);return this}fromJSON(e){this.intensity=e.intensity;this.sh.fromArray(e.sh);return this}toJSON(e){const t=super.toJSON(e);t.object.sh=this.sh.toArray();return t}}class MaterialLoader extends Loader{constructor(e){super(e);this.textures={}}load(e,t,n,r){const s=this;const a=new FileLoader(s.manager);a.setPath(s.path);a.setRequestHeader(s.requestHeader);a.setWithCredentials(s.withCredentials);a.load(e,(function(n){try{t(s.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t);s.manager.itemError(e)}}),n,r)}parse(e){const t=this.textures;function getTexture(e){t[e]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",e);return t[e]}const n=this.createMaterialFromType(e.type);e.uuid!==void 0&&(n.uuid=e.uuid);e.name!==void 0&&(n.name=e.name);e.color!==void 0&&n.color!==void 0&&n.color.setHex(e.color);e.roughness!==void 0&&(n.roughness=e.roughness);e.metalness!==void 0&&(n.metalness=e.metalness);e.sheen!==void 0&&(n.sheen=e.sheen);e.sheenColor!==void 0&&(n.sheenColor=(new Color).setHex(e.sheenColor));e.sheenRoughness!==void 0&&(n.sheenRoughness=e.sheenRoughness);e.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(e.emissive);e.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(e.specular);e.specularIntensity!==void 0&&(n.specularIntensity=e.specularIntensity);e.specularColor!==void 0&&n.specularColor!==void 0&&n.specularColor.setHex(e.specularColor);e.shininess!==void 0&&(n.shininess=e.shininess);e.clearcoat!==void 0&&(n.clearcoat=e.clearcoat);e.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=e.clearcoatRoughness);e.dispersion!==void 0&&(n.dispersion=e.dispersion);e.iridescence!==void 0&&(n.iridescence=e.iridescence);e.iridescenceIOR!==void 0&&(n.iridescenceIOR=e.iridescenceIOR);e.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=e.iridescenceThicknessRange);e.transmission!==void 0&&(n.transmission=e.transmission);e.thickness!==void 0&&(n.thickness=e.thickness);e.attenuationDistance!==void 0&&(n.attenuationDistance=e.attenuationDistance);e.attenuationColor!==void 0&&n.attenuationColor!==void 0&&n.attenuationColor.setHex(e.attenuationColor);e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy);e.anisotropyRotation!==void 0&&(n.anisotropyRotation=e.anisotropyRotation);e.fog!==void 0&&(n.fog=e.fog);e.flatShading!==void 0&&(n.flatShading=e.flatShading);e.blending!==void 0&&(n.blending=e.blending);e.combine!==void 0&&(n.combine=e.combine);e.side!==void 0&&(n.side=e.side);e.shadowSide!==void 0&&(n.shadowSide=e.shadowSide);e.opacity!==void 0&&(n.opacity=e.opacity);e.transparent!==void 0&&(n.transparent=e.transparent);e.alphaTest!==void 0&&(n.alphaTest=e.alphaTest);e.alphaHash!==void 0&&(n.alphaHash=e.alphaHash);e.depthFunc!==void 0&&(n.depthFunc=e.depthFunc);e.depthTest!==void 0&&(n.depthTest=e.depthTest);e.depthWrite!==void 0&&(n.depthWrite=e.depthWrite);e.colorWrite!==void 0&&(n.colorWrite=e.colorWrite);e.blendSrc!==void 0&&(n.blendSrc=e.blendSrc);e.blendDst!==void 0&&(n.blendDst=e.blendDst);e.blendEquation!==void 0&&(n.blendEquation=e.blendEquation);e.blendSrcAlpha!==void 0&&(n.blendSrcAlpha=e.blendSrcAlpha);e.blendDstAlpha!==void 0&&(n.blendDstAlpha=e.blendDstAlpha);e.blendEquationAlpha!==void 0&&(n.blendEquationAlpha=e.blendEquationAlpha);e.blendColor!==void 0&&n.blendColor!==void 0&&n.blendColor.setHex(e.blendColor);e.blendAlpha!==void 0&&(n.blendAlpha=e.blendAlpha);e.stencilWriteMask!==void 0&&(n.stencilWriteMask=e.stencilWriteMask);e.stencilFunc!==void 0&&(n.stencilFunc=e.stencilFunc);e.stencilRef!==void 0&&(n.stencilRef=e.stencilRef);e.stencilFuncMask!==void 0&&(n.stencilFuncMask=e.stencilFuncMask);e.stencilFail!==void 0&&(n.stencilFail=e.stencilFail);e.stencilZFail!==void 0&&(n.stencilZFail=e.stencilZFail);e.stencilZPass!==void 0&&(n.stencilZPass=e.stencilZPass);e.stencilWrite!==void 0&&(n.stencilWrite=e.stencilWrite);e.wireframe!==void 0&&(n.wireframe=e.wireframe);e.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=e.wireframeLinewidth);e.wireframeLinecap!==void 0&&(n.wireframeLinecap=e.wireframeLinecap);e.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=e.wireframeLinejoin);e.rotation!==void 0&&(n.rotation=e.rotation);e.linewidth!==void 0&&(n.linewidth=e.linewidth);e.dashSize!==void 0&&(n.dashSize=e.dashSize);e.gapSize!==void 0&&(n.gapSize=e.gapSize);e.scale!==void 0&&(n.scale=e.scale);e.polygonOffset!==void 0&&(n.polygonOffset=e.polygonOffset);e.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=e.polygonOffsetFactor);e.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=e.polygonOffsetUnits);e.dithering!==void 0&&(n.dithering=e.dithering);e.alphaToCoverage!==void 0&&(n.alphaToCoverage=e.alphaToCoverage);e.premultipliedAlpha!==void 0&&(n.premultipliedAlpha=e.premultipliedAlpha);e.forceSinglePass!==void 0&&(n.forceSinglePass=e.forceSinglePass);e.visible!==void 0&&(n.visible=e.visible);e.toneMapped!==void 0&&(n.toneMapped=e.toneMapped);e.userData!==void 0&&(n.userData=e.userData);e.vertexColors!==void 0&&(typeof e.vertexColors==="number"?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors);if(e.uniforms!==void 0)for(const t in e.uniforms){const r=e.uniforms[t];n.uniforms[t]={};switch(r.type){case"t":n.uniforms[t].value=getTexture(r.value);break;case"c":n.uniforms[t].value=(new Color).setHex(r.value);break;case"v2":n.uniforms[t].value=(new Vector2).fromArray(r.value);break;case"v3":n.uniforms[t].value=(new Vector3).fromArray(r.value);break;case"v4":n.uniforms[t].value=(new Vector4).fromArray(r.value);break;case"m3":n.uniforms[t].value=(new Matrix3).fromArray(r.value);break;case"m4":n.uniforms[t].value=(new Matrix4).fromArray(r.value);break;default:n.uniforms[t].value=r.value}}e.defines!==void 0&&(n.defines=e.defines);e.vertexShader!==void 0&&(n.vertexShader=e.vertexShader);e.fragmentShader!==void 0&&(n.fragmentShader=e.fragmentShader);e.glslVersion!==void 0&&(n.glslVersion=e.glslVersion);if(e.extensions!==void 0)for(const t in e.extensions)n.extensions[t]=e.extensions[t];e.lights!==void 0&&(n.lights=e.lights);e.clipping!==void 0&&(n.clipping=e.clipping);e.size!==void 0&&(n.size=e.size);e.sizeAttenuation!==void 0&&(n.sizeAttenuation=e.sizeAttenuation);e.map!==void 0&&(n.map=getTexture(e.map));e.matcap!==void 0&&(n.matcap=getTexture(e.matcap));e.alphaMap!==void 0&&(n.alphaMap=getTexture(e.alphaMap));e.bumpMap!==void 0&&(n.bumpMap=getTexture(e.bumpMap));e.bumpScale!==void 0&&(n.bumpScale=e.bumpScale);e.normalMap!==void 0&&(n.normalMap=getTexture(e.normalMap));e.normalMapType!==void 0&&(n.normalMapType=e.normalMapType);if(e.normalScale!==void 0){let t=e.normalScale;Array.isArray(t)===false&&(t=[t,t]);n.normalScale=(new Vector2).fromArray(t)}e.displacementMap!==void 0&&(n.displacementMap=getTexture(e.displacementMap));e.displacementScale!==void 0&&(n.displacementScale=e.displacementScale);e.displacementBias!==void 0&&(n.displacementBias=e.displacementBias);e.roughnessMap!==void 0&&(n.roughnessMap=getTexture(e.roughnessMap));e.metalnessMap!==void 0&&(n.metalnessMap=getTexture(e.metalnessMap));e.emissiveMap!==void 0&&(n.emissiveMap=getTexture(e.emissiveMap));e.emissiveIntensity!==void 0&&(n.emissiveIntensity=e.emissiveIntensity);e.specularMap!==void 0&&(n.specularMap=getTexture(e.specularMap));e.specularIntensityMap!==void 0&&(n.specularIntensityMap=getTexture(e.specularIntensityMap));e.specularColorMap!==void 0&&(n.specularColorMap=getTexture(e.specularColorMap));e.envMap!==void 0&&(n.envMap=getTexture(e.envMap));e.envMapRotation!==void 0&&n.envMapRotation.fromArray(e.envMapRotation);e.envMapIntensity!==void 0&&(n.envMapIntensity=e.envMapIntensity);e.reflectivity!==void 0&&(n.reflectivity=e.reflectivity);e.refractionRatio!==void 0&&(n.refractionRatio=e.refractionRatio);e.lightMap!==void 0&&(n.lightMap=getTexture(e.lightMap));e.lightMapIntensity!==void 0&&(n.lightMapIntensity=e.lightMapIntensity);e.aoMap!==void 0&&(n.aoMap=getTexture(e.aoMap));e.aoMapIntensity!==void 0&&(n.aoMapIntensity=e.aoMapIntensity);e.gradientMap!==void 0&&(n.gradientMap=getTexture(e.gradientMap));e.clearcoatMap!==void 0&&(n.clearcoatMap=getTexture(e.clearcoatMap));e.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=getTexture(e.clearcoatRoughnessMap));e.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=getTexture(e.clearcoatNormalMap));e.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=(new Vector2).fromArray(e.clearcoatNormalScale));e.iridescenceMap!==void 0&&(n.iridescenceMap=getTexture(e.iridescenceMap));e.iridescenceThicknessMap!==void 0&&(n.iridescenceThicknessMap=getTexture(e.iridescenceThicknessMap));e.transmissionMap!==void 0&&(n.transmissionMap=getTexture(e.transmissionMap));e.thicknessMap!==void 0&&(n.thicknessMap=getTexture(e.thicknessMap));e.anisotropyMap!==void 0&&(n.anisotropyMap=getTexture(e.anisotropyMap));e.sheenColorMap!==void 0&&(n.sheenColorMap=getTexture(e.sheenColorMap));e.sheenRoughnessMap!==void 0&&(n.sheenRoughnessMap=getTexture(e.sheenRoughnessMap));return n}setTextures(e){this.textures=e;return this}createMaterialFromType(e){return MaterialLoader.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:ShadowMaterial,SpriteMaterial:SpriteMaterial,RawShaderMaterial:RawShaderMaterial,ShaderMaterial:ShaderMaterial,PointsMaterial:PointsMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshToonMaterial:MeshToonMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshBasicMaterial:MeshBasicMaterial,MeshMatcapMaterial:MeshMatcapMaterial,LineDashedMaterial:LineDashedMaterial,LineBasicMaterial:LineBasicMaterial,Material:Material};return new t[e]}}class LoaderUtils{static decodeText(e){console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead.");if(typeof TextDecoder!=="undefined")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){if(typeof e!=="string"||e==="")return"";/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1"));return/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super();this.isInstancedBufferGeometry=true;this.type="InstancedBufferGeometry";this.instanceCount=Infinity}copy(e){super.copy(e);this.instanceCount=e.instanceCount;return this}toJSON(){const e=super.toJSON();e.instanceCount=this.instanceCount;e.isInstancedBufferGeometry=true;return e}}class BufferGeometryLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=this;const a=new FileLoader(s.manager);a.setPath(s.path);a.setRequestHeader(s.requestHeader);a.setWithCredentials(s.withCredentials);a.load(e,(function(n){try{t(s.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t);s.manager.itemError(e)}}),n,r)}parse(e){const t={};const n={};function getInterleavedBuffer(e,n){if(t[n]!==void 0)return t[n];const r=e.interleavedBuffers;const s=r[n];const a=getArrayBuffer(e,s.buffer);const o=getTypedArray(s.type,a);const l=new InterleavedBuffer(o,s.stride);l.uuid=s.uuid;t[n]=l;return l}function getArrayBuffer(e,t){if(n[t]!==void 0)return n[t];const r=e.arrayBuffers;const s=r[t];const a=new Uint32Array(s).buffer;n[t]=a;return a}const r=e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry;const s=e.data.index;if(s!==void 0){const e=getTypedArray(s.type,s.array);r.setIndex(new BufferAttribute(e,1))}const a=e.data.attributes;for(const t in a){const n=a[t];let s;if(n.isInterleavedBufferAttribute){const t=getInterleavedBuffer(e.data,n.data);s=new InterleavedBufferAttribute(t,n.itemSize,n.offset,n.normalized)}else{const e=getTypedArray(n.type,n.array);const t=n.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;s=new t(e,n.itemSize,n.normalized)}n.name!==void 0&&(s.name=n.name);n.usage!==void 0&&s.setUsage(n.usage);r.setAttribute(t,s)}const o=e.data.morphAttributes;if(o)for(const t in o){const n=o[t];const s=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];let a;if(r.isInterleavedBufferAttribute){const t=getInterleavedBuffer(e.data,r.data);a=new InterleavedBufferAttribute(t,r.itemSize,r.offset,r.normalized)}else{const e=getTypedArray(r.type,r.array);a=new BufferAttribute(e,r.itemSize,r.normalized)}r.name!==void 0&&(a.name=r.name);s.push(a)}r.morphAttributes[t]=s}const l=e.data.morphTargetsRelative;l&&(r.morphTargetsRelative=true);const c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let e=0,t=c.length;e!==t;++e){const t=c[e];r.addGroup(t.start,t.count,t.materialIndex)}const u=e.data.boundingSphere;if(u!==void 0){const e=new Vector3;u.center!==void 0&&e.fromArray(u.center);r.boundingSphere=new Sphere(e,u.radius)}e.name&&(r.name=e.name);e.userData&&(r.userData=e.userData);return r}}class ObjectLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=this;const a=this.path===""?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new FileLoader(this.manager);o.setPath(this.path);o.setRequestHeader(this.requestHeader);o.setWithCredentials(this.withCredentials);o.load(e,(function(n){let a=null;try{a=JSON.parse(n)}catch(t){r!==void 0&&r(t);console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message);return}const o=a.metadata;if(o!==void 0&&o.type!==void 0&&o.type.toLowerCase()!=="geometry")s.parse(a,t);else{r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e));console.error("THREE.ObjectLoader: Can't load "+e)}}),n,r)}async loadAsync(e,t){const n=this;const r=this.path===""?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new FileLoader(this.manager);s.setPath(this.path);s.setRequestHeader(this.requestHeader);s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t);const o=JSON.parse(a);const l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(o)}parse(e,t){const n=this.parseAnimations(e.animations);const r=this.parseShapes(e.shapes);const s=this.parseGeometries(e.geometries,r);const a=this.parseImages(e.images,(function(){t!==void 0&&t(c)}));const o=this.parseTextures(e.textures,a);const l=this.parseMaterials(e.materials,o);const c=this.parseObject(e.object,s,l,o,n);const u=this.parseSkeletons(e.skeletons,c);this.bindSkeletons(c,u);this.bindLightTargets(c);if(t!==void 0){let e=false;for(const t in a)if(a[t].data instanceof HTMLImageElement){e=true;break}e===false&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations);const n=this.parseShapes(e.shapes);const r=this.parseGeometries(e.geometries,n);const s=await this.parseImagesAsync(e.images);const a=this.parseTextures(e.textures,s);const o=this.parseMaterials(e.materials,a);const l=this.parseObject(e.object,r,o,a,t);const c=this.parseSkeletons(e.skeletons,l);this.bindSkeletons(l,c);this.bindLightTargets(l);return l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const r=(new Shape).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={};const r={};t.traverse((function(e){e.isBone&&(r[e.uuid]=e)}));if(e!==void 0)for(let t=0,s=e.length;t<s;t++){const s=(new Skeleton).fromJSON(e[t],r);n[s.uuid]=s}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new BufferGeometryLoader;for(let a=0,o=e.length;a<o;a++){let o;const l=e[a];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=s.parse(l);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var r=new THREE.LegacyJSONLoader;o=r.parse(l,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:l.type in Ba?o=Ba[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid;l.name!==void 0&&(o.name=l.name);l.userData!==void 0&&(o.userData=l.userData);n[l.uuid]=o}}return n}parseMaterials(e,t){const n={};const r={};if(e!==void 0){const s=new MaterialLoader;s.setTextures(t);for(let t=0,a=e.length;t<a;t++){const a=e[t];n[a.uuid]===void 0&&(n[a.uuid]=s.parse(a));r[a.uuid]=n[a.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n];const s=AnimationClip.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this;const r={};let s;function loadImage(e){n.manager.itemStart(e);return s.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e);n.manager.itemEnd(e)}))}function deserializeImage(e){if(typeof e==="string"){const t=e;const r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t;return loadImage(r)}return e.data?{data:getTypedArray(e.type,e.data),width:e.width,height:e.height}:null}if(e!==void 0&&e.length>0){const n=new LoadingManager(t);s=new ImageLoader(n);s.setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){const n=e[t];const s=n.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t];const r=deserializeImage(n);r!==null&&(r instanceof HTMLImageElement?e.push(r):e.push(new DataTexture(r.data,r.width,r.height)))}r[n.uuid]=new Source(e)}else{const e=deserializeImage(n.url);r[n.uuid]=new Source(e)}}}return r}async parseImagesAsync(e){const t=this;const n={};let r;async function deserializeImage(e){if(typeof e==="string"){const n=e;const s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(s)}return e.data?{data:getTypedArray(e.type,e.data),width:e.width,height:e.height}:null}if(e!==void 0&&e.length>0){r=new ImageLoader(this.manager);r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t];const s=r.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t];const r=await deserializeImage(n);r!==null&&(r instanceof HTMLImageElement?e.push(r):e.push(new DataTexture(r.data,r.width,r.height)))}n[r.uuid]=new Source(e)}else{const e=await deserializeImage(r.url);n[r.uuid]=new Source(e)}}}return n}parseTextures(e,t){function parseConstant(e,t){if(typeof e==="number")return e;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e);return t[e]}const n={};if(e!==void 0)for(let r=0,s=e.length;r<s;r++){const s=e[r];s.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid);t[s.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const a=t[s.image];const o=a.data;let l;if(Array.isArray(o)){l=new CubeTexture;o.length===6&&(l.needsUpdate=true)}else{l=o&&o.data?new DataTexture:new Texture;o&&(l.needsUpdate=true)}l.source=a;l.uuid=s.uuid;s.name!==void 0&&(l.name=s.name);s.mapping!==void 0&&(l.mapping=parseConstant(s.mapping,Ga));s.channel!==void 0&&(l.channel=s.channel);s.offset!==void 0&&l.offset.fromArray(s.offset);s.repeat!==void 0&&l.repeat.fromArray(s.repeat);s.center!==void 0&&l.center.fromArray(s.center);s.rotation!==void 0&&(l.rotation=s.rotation);if(s.wrap!==void 0){l.wrapS=parseConstant(s.wrap[0],Va);l.wrapT=parseConstant(s.wrap[1],Va)}s.format!==void 0&&(l.format=s.format);s.internalFormat!==void 0&&(l.internalFormat=s.internalFormat);s.type!==void 0&&(l.type=s.type);s.colorSpace!==void 0&&(l.colorSpace=s.colorSpace);s.minFilter!==void 0&&(l.minFilter=parseConstant(s.minFilter,Qa));s.magFilter!==void 0&&(l.magFilter=parseConstant(s.magFilter,Qa));s.anisotropy!==void 0&&(l.anisotropy=s.anisotropy);s.flipY!==void 0&&(l.flipY=s.flipY);s.generateMipmaps!==void 0&&(l.generateMipmaps=s.generateMipmaps);s.premultiplyAlpha!==void 0&&(l.premultiplyAlpha=s.premultiplyAlpha);s.unpackAlignment!==void 0&&(l.unpackAlignment=s.unpackAlignment);s.compareFunction!==void 0&&(l.compareFunction=s.compareFunction);s.userData!==void 0&&(l.userData=s.userData);n[s.uuid]=l}return n}parseObject(e,t,n,r,s){let a;function getGeometry(e){t[e]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",e);return t[e]}function getMaterial(e){if(e!==void 0){if(Array.isArray(e)){const t=[];for(let r=0,s=e.length;r<s;r++){const s=e[r];n[s]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",s);t.push(n[s])}return t}n[e]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",e);return n[e]}}function getTexture(e){r[e]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",e);return r[e]}let o,l;switch(e.type){case"Scene":a=new Scene;e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Color(e.background):a.background=getTexture(e.background));e.environment!==void 0&&(a.environment=getTexture(e.environment));if(e.fog!==void 0){e.fog.type==="Fog"?a.fog=new Fog(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new FogExp2(e.fog.color,e.fog.density));e.fog.name!==""&&(a.fog.name=e.fog.name)}e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness);e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity);e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation);e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity);e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new PerspectiveCamera(e.fov,e.aspect,e.near,e.far);e.focus!==void 0&&(a.focus=e.focus);e.zoom!==void 0&&(a.zoom=e.zoom);e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge);e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset);e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);e.zoom!==void 0&&(a.zoom=e.zoom);e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new AmbientLight(e.color,e.intensity);break;case"DirectionalLight":a=new DirectionalLight(e.color,e.intensity);a.target=e.target||"";break;case"PointLight":a=new PointLight(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new RectAreaLight(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);a.target=e.target||"";break;case"HemisphereLight":a=new HemisphereLight(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new LightProbe).fromJSON(e);break;case"SkinnedMesh":o=getGeometry(e.geometry);l=getMaterial(e.material);a=new SkinnedMesh(o,l);e.bindMode!==void 0&&(a.bindMode=e.bindMode);e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix);e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":o=getGeometry(e.geometry);l=getMaterial(e.material);a=new Mesh(o,l);break;case"InstancedMesh":o=getGeometry(e.geometry);l=getMaterial(e.material);const t=e.count;const n=e.instanceMatrix;const r=e.instanceColor;a=new InstancedMesh(o,l,t);a.instanceMatrix=new InstancedBufferAttribute(new Float32Array(n.array),16);r!==void 0&&(a.instanceColor=new InstancedBufferAttribute(new Float32Array(r.array),r.itemSize));break;case"BatchedMesh":o=getGeometry(e.geometry);l=getMaterial(e.material);a=new BatchedMesh(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,l);a.geometry=o;a.perObjectFrustumCulled=e.perObjectFrustumCulled;a.sortObjects=e.sortObjects;a._drawRanges=e.drawRanges;a._reservedRanges=e.reservedRanges;a._visibility=e.visibility;a._active=e.active;a._bounds=e.bounds.map((e=>{const t=new Box3;t.min.fromArray(e.boxMin);t.max.fromArray(e.boxMax);const n=new Sphere;n.radius=e.sphereRadius;n.center.fromArray(e.sphereCenter);return{boxInitialized:e.boxInitialized,box:t,sphereInitialized:e.sphereInitialized,sphere:n}}));a._maxInstanceCount=e.maxInstanceCount;a._maxVertexCount=e.maxVertexCount;a._maxIndexCount=e.maxIndexCount;a._geometryInitialized=e.geometryInitialized;a._geometryCount=e.geometryCount;a._matricesTexture=getTexture(e.matricesTexture.uuid);e.colorsTexture!==void 0&&(a._colorsTexture=getTexture(e.colorsTexture.uuid));break;case"LOD":a=new LOD;break;case"Line":a=new Line(getGeometry(e.geometry),getMaterial(e.material));break;case"LineLoop":a=new LineLoop(getGeometry(e.geometry),getMaterial(e.material));break;case"LineSegments":a=new LineSegments(getGeometry(e.geometry),getMaterial(e.material));break;case"PointCloud":case"Points":a=new Points(getGeometry(e.geometry),getMaterial(e.material));break;case"Sprite":a=new Sprite(getMaterial(e.material));break;case"Group":a=new Group;break;case"Bone":a=new Bone;break;default:a=new Object3D}a.uuid=e.uuid;e.name!==void 0&&(a.name=e.name);if(e.matrix!==void 0){a.matrix.fromArray(e.matrix);e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate);a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)}else{e.position!==void 0&&a.position.fromArray(e.position);e.rotation!==void 0&&a.rotation.fromArray(e.rotation);e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion);e.scale!==void 0&&a.scale.fromArray(e.scale)}e.up!==void 0&&a.up.fromArray(e.up);e.castShadow!==void 0&&(a.castShadow=e.castShadow);e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow);if(e.shadow){e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity);e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias);e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias);e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius);e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize);e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))}e.visible!==void 0&&(a.visible=e.visible);e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled);e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder);e.userData!==void 0&&(a.userData=e.userData);e.layers!==void 0&&(a.layers.mask=e.layers);if(e.children!==void 0){const o=e.children;for(let e=0;e<o.length;e++)a.add(this.parseObject(o[e],t,n,r,s))}if(e.animations!==void 0){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];a.animations.push(s[n])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e];const r=a.getObjectByProperty("uuid",n.object);r!==void 0&&a.addLevel(r,n.distance,n.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse((function(e){if(e.isSkinnedMesh===true&&e.skeleton!==void 0){const n=t[e.skeleton];n===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}bindLightTargets(e){e.traverse((function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target;const r=e.getObjectByProperty("uuid",n);t.target=r!==void 0?r:new Object3D}}))}}const Ga={UVMapping:ve,CubeReflectionMapping:ye,CubeRefractionMapping:Ce,EquirectangularReflectionMapping:Ee,EquirectangularRefractionMapping:be,CubeUVReflectionMapping:xe};const Va={RepeatWrapping:_e,ClampToEdgeWrapping:Me,MirroredRepeatWrapping:we};const Qa={NearestFilter:Se,NearestMipmapNearestFilter:Te,NearestMipmapLinearFilter:Ie,LinearFilter:Le,LinearMipmapNearestFilter:De,LinearMipmapLinearFilter:Fe};class ImageBitmapLoader extends Loader{constructor(e){super(e);this.isImageBitmapLoader=true;typeof createImageBitmap==="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");typeof fetch==="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.options={premultiplyAlpha:"none"}}setOptions(e){this.options=e;return this}load(e,t,n,r){e===void 0&&(e="");this.path!==void 0&&(e=this.path+e);e=this.manager.resolveURL(e);const s=this;const a=Ra.get(e);if(a!==void 0){s.manager.itemStart(e);if(a.then){a.then((n=>{t&&t(n);s.manager.itemEnd(e)})).catch((e=>{r&&r(e)}));return}setTimeout((function(){t&&t(a);s.manager.itemEnd(e)}),0);return a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include";o.headers=this.requestHeader;const l=fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(s.options,{colorSpaceConversion:"none"}))})).then((function(n){Ra.add(e,n);t&&t(n);s.manager.itemEnd(e);return n})).catch((function(t){r&&r(t);Ra.remove(e);s.manager.itemError(e);s.manager.itemEnd(e)}));Ra.add(e,l);s.manager.itemStart(e)}}let ja;class AudioContext{static getContext(){ja===void 0&&(ja=new(window.AudioContext||window.webkitAudioContext));return ja}static setContext(e){ja=e}}class AudioLoader extends Loader{constructor(e){super(e)}load(e,t,n,r){const s=this;const a=new FileLoader(this.manager);a.setResponseType("arraybuffer");a.setPath(this.path);a.setRequestHeader(this.requestHeader);a.setWithCredentials(this.withCredentials);a.load(e,(function(e){try{const n=e.slice(0);const r=AudioContext.getContext();r.decodeAudioData(n,(function(e){t(e)})).catch(handleError)}catch(e){handleError(e)}}),n,r);function handleError(t){r?r(t):console.error(t);s.manager.itemError(e)}}}const Ha=new Matrix4;const za=new Matrix4;const Wa=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new PerspectiveCamera;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=false;this.cameraR=new PerspectiveCamera;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=false;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;const n=t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep;if(n){t.focus=e.focus;t.fov=e.fov;t.aspect=e.aspect*this.aspect;t.near=e.near;t.far=e.far;t.zoom=e.zoom;t.eyeSep=this.eyeSep;Wa.copy(e.projectionMatrix);const n=t.eyeSep/2;const r=n*t.near/t.focus;const s=t.near*Math.tan(Zn*t.fov*.5)/t.zoom;let a,o;za.elements[12]=-n;Ha.elements[12]=n;a=-s*t.aspect+r;o=s*t.aspect+r;Wa.elements[0]=2*t.near/(o-a);Wa.elements[8]=(o+a)/(o-a);this.cameraL.projectionMatrix.copy(Wa);a=-s*t.aspect-r;o=s*t.aspect-r;Wa.elements[0]=2*t.near/(o-a);Wa.elements[8]=(o+a)/(o-a);this.cameraR.projectionMatrix.copy(Wa)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(za);this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Ha)}}class ArrayCamera extends PerspectiveCamera{constructor(e=[]){super();this.isArrayCamera=true;this.cameras=e;this.index=0}}class Clock{constructor(e=true){this.autoStart=e;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false}start(){this.startTime=now();this.oldTime=this.startTime;this.elapsedTime=0;this.running=true}stop(){this.getElapsedTime();this.running=false;this.autoStart=false}getElapsedTime(){this.getDelta();return this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running){this.start();return 0}if(this.running){const t=now();e=(t-this.oldTime)/1e3;this.oldTime=t;this.elapsedTime+=e}return e}}function now(){return performance.now()}const qa=new Vector3;const Ka=new Quaternion;const Xa=new Vector3;const Ya=new Vector3;class AudioListener extends Object3D{constructor(){super();this.type="AudioListener";this.context=AudioContext.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null;this.timeDelta=0;this._clock=new Clock}getInput(){return this.gain}removeFilter(){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination);this.gain.connect(this.context.destination);this.filter=null}return this}getFilter(){return this.filter}setFilter(e){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination)}else this.gain.disconnect(this.context.destination);this.filter=e;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01);return this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;const n=this.up;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(qa,Ka,Xa);Ya.set(0,0,-1).applyQuaternion(Ka);if(t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(qa.x,e);t.positionY.linearRampToValueAtTime(qa.y,e);t.positionZ.linearRampToValueAtTime(qa.z,e);t.forwardX.linearRampToValueAtTime(Ya.x,e);t.forwardY.linearRampToValueAtTime(Ya.y,e);t.forwardZ.linearRampToValueAtTime(Ya.z,e);t.upX.linearRampToValueAtTime(n.x,e);t.upY.linearRampToValueAtTime(n.y,e);t.upZ.linearRampToValueAtTime(n.z,e)}else{t.setPosition(qa.x,qa.y,qa.z);t.setOrientation(Ya.x,Ya.y,Ya.z,n.x,n.y,n.z)}}}class Audio extends Object3D{constructor(e){super();this.type="Audio";this.listener=e;this.context=e.context;this.gain=this.context.createGain();this.gain.connect(e.getInput());this.autoplay=false;this.buffer=null;this.detune=0;this.loop=false;this.loopStart=0;this.loopEnd=0;this.offset=0;this.duration=void 0;this.playbackRate=1;this.isPlaying=false;this.hasPlaybackControl=true;this.source=null;this.sourceType="empty";this._startedAt=0;this._progress=0;this._connected=false;this.filters=[]}getOutput(){return this.gain}setNodeSource(e){this.hasPlaybackControl=false;this.sourceType="audioNode";this.source=e;this.connect();return this}setMediaElementSource(e){this.hasPlaybackControl=false;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(e);this.connect();return this}setMediaStreamSource(e){this.hasPlaybackControl=false;this.sourceType="mediaStreamNode";this.source=this.context.createMediaStreamSource(e);this.connect();return this}setBuffer(e){this.buffer=e;this.sourceType="buffer";this.autoplay&&this.play();return this}play(e=0){if(this.isPlaying===true){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();t.buffer=this.buffer;t.loop=this.loop;t.loopStart=this.loopStart;t.loopEnd=this.loopEnd;t.onended=this.onEnded.bind(this);t.start(this._startedAt,this._progress+this.offset,this.duration);this.isPlaying=true;this.source=t;this.setDetune(this.detune);this.setPlaybackRate(this.playbackRate);return this.connect()}pause(){if(this.hasPlaybackControl!==false){if(this.isPlaying===true){this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate;this.loop===true&&(this._progress=this._progress%(this.duration||this.buffer.duration));this.source.stop();this.source.onended=null;this.isPlaying=false}return this}console.warn("THREE.Audio: this Audio has no playback control.")}stop(e=0){if(this.hasPlaybackControl!==false){this._progress=0;if(this.source!==null){this.source.stop(this.context.currentTime+e);this.source.onended=null}this.isPlaying=false;return this}console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());this._connected=true;return this}disconnect(){if(this._connected!==false){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());this._connected=false;return this}}getFilters(){return this.filters}setFilters(e){e||(e=[]);if(this._connected===true){this.disconnect();this.filters=e.slice();this.connect()}else this.filters=e.slice();return this}setDetune(e){this.detune=e;this.isPlaying===true&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01);return this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl!==false){this.playbackRate=e;this.isPlaying===true&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01);return this}console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=false;this._progress=0}getLoop(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return false}return this.loop}setLoop(e){if(this.hasPlaybackControl!==false){this.loop=e;this.isPlaying===true&&(this.source.loop=this.loop);return this}console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){this.loopStart=e;return this}setLoopEnd(e){this.loopEnd=e;return this}getVolume(){return this.gain.gain.value}setVolume(e){this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01);return this}copy(e,t){super.copy(e,t);if(e.sourceType!=="buffer"){console.warn("THREE.Audio: Audio source type cannot be copied.");return this}this.autoplay=e.autoplay;this.buffer=e.buffer;this.detune=e.detune;this.loop=e.loop;this.loopStart=e.loopStart;this.loopEnd=e.loopEnd;this.offset=e.offset;this.duration=e.duration;this.playbackRate=e.playbackRate;this.hasPlaybackControl=e.hasPlaybackControl;this.sourceType=e.sourceType;this.filters=e.filters.slice();return this}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Ja=new Vector3;const Za=new Quaternion;const $a=new Vector3;const eo=new Vector3;class PositionalAudio extends Audio{constructor(e){super(e);this.panner=this.context.createPanner();this.panner.panningModel="HRTF";this.panner.connect(this.gain)}connect(){super.connect();this.panner.connect(this.gain)}disconnect(){super.disconnect();this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){this.panner.refDistance=e;return this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){this.panner.rolloffFactor=e;return this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){this.panner.distanceModel=e;return this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){this.panner.maxDistance=e;return this}setDirectionalCone(e,t,n){this.panner.coneInnerAngle=e;this.panner.coneOuterAngle=t;this.panner.coneOuterGain=n;return this}updateMatrixWorld(e){super.updateMatrixWorld(e);if(this.hasPlaybackControl===true&&this.isPlaying===false)return;this.matrixWorld.decompose(Ja,Za,$a);eo.set(0,0,1).applyQuaternion(Za);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Ja.x,e);t.positionY.linearRampToValueAtTime(Ja.y,e);t.positionZ.linearRampToValueAtTime(Ja.z,e);t.orientationX.linearRampToValueAtTime(eo.x,e);t.orientationY.linearRampToValueAtTime(eo.y,e);t.orientationZ.linearRampToValueAtTime(eo.z,e)}else{t.setPosition(Ja.x,Ja.y,Ja.z);t.setOrientation(eo.x,eo.y,eo.z)}}}class AudioAnalyser{constructor(e,t=2048){this.analyser=e.context.createAnalyser();this.analyser.fftSize=t;this.data=new Uint8Array(this.analyser.frequencyBinCount);e.getOutput().connect(this.analyser)}getFrequencyData(){this.analyser.getByteFrequencyData(this.data);return this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class PropertyMixer{constructor(e,t,n){this.binding=e;this.valueSize=n;let r,s,a;switch(t){case"quaternion":r=this._slerp;s=this._slerpAdditive;a=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(n*6);this._workIndex=5;break;case"string":case"bool":r=this._select;s=this._select;a=this._setAdditiveIdentityOther;this.buffer=new Array(n*5);break;default:r=this._lerp;s=this._lerpAdditive;a=this._setAdditiveIdentityNumeric;this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r;this._mixBufferRegionAdditive=s;this._setIdentity=a;this._origIndex=3;this._addIndex=4;this.cumulativeWeight=0;this.cumulativeWeightAdditive=0;this.useCount=0;this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let e=0;e!==r;++e)n[s+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,s,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity();this._mixBufferRegionAdditive(t,r,0,e,n);this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;this.cumulativeWeight=0;this.cumulativeWeightAdditive=0;if(s<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let e=t,s=t+t;e!==s;++e)if(n[e]!==n[e+t]){o.setValue(n,r);break}}saveOriginalState(){const e=this.binding;const t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let e=n,s=r;e!==s;++e)t[e]=t[r+e%n];this._setIdentity();this.cumulativeWeight=0;this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize;const t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize;const t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let r=0;r!==s;++r)e[t+r]=e[n+r]}_slerp(e,t,n,r){Quaternion.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const a=this._workIndex*s;Quaternion.multiplyQuaternionsFlat(e,a,e,t,e,n);Quaternion.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,s){const a=1-r;for(let o=0;o!==s;++o){const s=t+o;e[s]=e[s]*a+e[n+o]*r}}_lerpAdditive(e,t,n,r,s){for(let a=0;a!==s;++a){const s=t+a;e[s]=e[s]+e[n+a]*r}}}const to="\\[\\]\\.:\\/";const no=new RegExp("["+to+"]","g");const ro="[^"+to+"]";const io="[^"+to.replace("\\.","")+"]";const so=/((?:WC+[\/:])*)/.source.replace("WC",ro);const ao=/(WCOD+)?/.source.replace("WCOD",io);const oo=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ro);const lo=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ro);const co=new RegExp("^"+so+ao+oo+lo+"$");const uo=["material","materials","bones","map"];class Composite{constructor(e,t,n){const r=n||PropertyBinding.parseTrackName(t);this._targetGroup=e;this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class PropertyBinding{constructor(e,t,n){this.path=t;this.parsedPath=n||PropertyBinding.parseTrackName(t);this.node=PropertyBinding.findNode(e,this.parsedPath.nodeName);this.rootNode=e;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new PropertyBinding.Composite(e,t,n):new PropertyBinding(e,t,n)}
/**
            * Replaces spaces with underscores and removes unsupported characters from
            * node names, to ensure compatibility with parseTrackName().
            *
            * @param {string} name Node name to be sanitized.
            * @return {string}
            */static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(no,"")}static parseTrackName(e){const t=co.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]};const r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const e=n.nodeName.substring(r+1);if(uo.indexOf(e)!==-1){n.nodeName=n.nodeName.substring(0,r);n.objectName=e}}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const searchNodeSubtree=function(e){for(let n=0;n<e.length;n++){const r=e[n];if(r.name===t||r.uuid===t)return r;const s=searchNodeSubtree(r.children);if(s)return s}return null};const n=searchNodeSubtree(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t];this.targetObject.needsUpdate=true}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t];this.targetObject.matrixWorldNeedsUpdate=true}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=true}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=true}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t];this.targetObject.needsUpdate=true}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t];this.targetObject.matrixWorldNeedsUpdate=true}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t);this.targetObject.needsUpdate=true}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t);this.targetObject.matrixWorldNeedsUpdate=true}_getValue_unbound(e,t){this.bind();this.getValue(e,t)}_setValue_unbound(e,t){this.bind();this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath;const n=t.objectName;const r=t.propertyName;let s=t.propertyIndex;if(!e){e=PropertyBinding.findNode(this.rootNode,t.nodeName);this.node=e}this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(r!==void 0){if(e[r]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[r]}}const a=e[r];if(a===void 0){const n=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e;e.isMaterial===true?o=this.Versioning.NeedsUpdate:e.isObject3D===true&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement;this.resolvedProperty=a;this.propertyIndex=s}else if(a.fromArray!==void 0&&a.toArray!==void 0){l=this.BindingType.HasFromToArray;this.resolvedProperty=a}else if(Array.isArray(a)){l=this.BindingType.EntireArray;this.resolvedProperty=a}else this.propertyName=r;this.getValue=this.GetterByBindingType[l];this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=true;this.uuid=generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const h=arguments[u],d=h.uuid;let p=t[d];if(p===void 0){p=l++;t[d]=p;e.push(h);for(let e=0,t=a;e!==t;++e)s[e].push(new PropertyBinding(h,n[e],r[e]))}else if(p<c){o=e[p];const l=--c,u=e[l];t[u.uuid]=p;e[p]=u;t[d]=l;e[l]=h;for(let e=0,t=a;e!==t;++e){const t=s[e],a=t[l];let o=t[p];t[p]=a;o===void 0&&(o=new PropertyBinding(h,n[e],r[e]));t[l]=o}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a],l=o.uuid,c=t[l];if(c!==void 0&&c>=s){const a=s++,u=e[a];t[u.uuid]=c;e[c]=u;t[l]=a;e[a]=o;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[a],s=t[c];t[c]=r;t[a]=s}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0){delete t[c];if(u<s){const o=--s,l=e[o],c=--a,h=e[c];t[l.uuid]=u;e[u]=l;t[h.uuid]=o;e[o]=h;e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[o],s=t[c];t[u]=r;t[o]=s;t.pop()}}else{const s=--a,o=e[s];s>0&&(t[o.uuid]=u);e[u]=o;e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[u]=t[s];t.pop()}}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,h=new Array(c);r=s.length;n[e]=r;a.push(e);o.push(t);s.push(h);for(let n=u,r=l.length;n!==r;++n){const r=l[n];h[n]=new PropertyBinding(r,e,t)}return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];t[c]=n;a[n]=l;a.pop();s[n]=s[o];s.pop();r[n]=r[o];r.pop()}}}class AnimationAction{constructor(e,t,n=null,r=t.blendMode){this._mixer=e;this._clip=t;this._localRoot=n;this.blendMode=r;const s=t.tracks,a=s.length,o=new Array(a);const l={endingStart:Wt,endingEnd:Wt};for(let e=0;e!==a;++e){const t=s[e].createInterpolant(null);o[e]=t;t.settings=l}this._interpolantSettings=l;this._interpolants=o;this._propertyBindings=new Array(a);this._cacheIndex=null;this._byClipCacheIndex=null;this._timeScaleInterpolant=null;this._weightInterpolant=null;this.loop=Vt;this._loopCount=-1;this._startTime=null;this.time=0;this.timeScale=1;this._effectiveTimeScale=1;this.weight=1;this._effectiveWeight=1;this.repetitions=Infinity;this.paused=false;this.enabled=true;this.clampWhenFinished=false;this.zeroSlopeAtStart=true;this.zeroSlopeAtEnd=true}play(){this._mixer._activateAction(this);return this}stop(){this._mixer._deactivateAction(this);return this.reset()}reset(){this.paused=false;this.enabled=true;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){this._startTime=e;return this}setLoop(e,t){this.loop=e;this.repetitions=t;return this}setEffectiveWeight(e){this.weight=e;this._effectiveWeight=this.enabled?e:0;return this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){e.fadeOut(t);this.fadeIn(t);if(n){const n=this._clip.duration,r=e._clip.duration,s=r/n,a=n/r;e.warp(1,s,t);this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;if(e!==null){this._weightInterpolant=null;this._mixer._takeBackControlInterpolant(e)}return this}setEffectiveTimeScale(e){this.timeScale=e;this._effectiveTimeScale=this.paused?0:e;return this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){this.timeScale=this._clip.duration/e;return this.stopWarping()}syncWith(e){this.time=e.time;this.timeScale=e.timeScale;return this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;if(o===null){o=r._lendControlInterpolant();this._timeScaleInterpolant=o}const l=o.parameterPositions,c=o.sampleValues;l[0]=s;l[1]=s+n;c[0]=e/a;c[1]=t/a;return this}stopWarping(){const e=this._timeScaleInterpolant;if(e!==null){this._timeScaleInterpolant=null;this._mixer._takeBackControlInterpolant(e)}return this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const r=(e-s)*n;if(r<0||n===0)t=0;else{this._startTime=null;t=n*r}}t*=this._updateTimeScale(e);const a=this._updateTime(t);const o=this._updateWeight(e);if(o>0){const e=this._interpolants;const t=this._propertyBindings;switch(this.blendMode){case Yt:for(let n=0,r=e.length;n!==r;++n){e[n].evaluate(a);t[n].accumulateAdditive(o)}break;case Xt:default:for(let n=0,s=e.length;n!==s;++n){e[n].evaluate(a);t[n].accumulate(r,o)}}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r;if(e>n.parameterPositions[1]){this.stopFading();r===0&&(this.enabled=false)}}}this._effectiveWeight=t;return t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r;if(e>n.parameterPositions[1]){this.stopWarping();t===0?this.paused=true:this.timeScale=t}}}this._effectiveTimeScale=t;return t}_updateTime(e){const t=this._clip.duration;const n=this.loop;let r=this.time+e;let s=this._loopCount;const a=n===Qt;if(e===0)return s===-1?r:a&&(s&1)===1?t-r:r;if(n===Gt){if(s===-1){this._loopCount=0;this._setEndings(true,true,false)}e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=true:this.enabled=false;this.time=r;this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1)if(e>=0){s=0;this._setEndings(true,this.repetitions===0,a)}else this._setEndings(this.repetitions===0,true,a);if(r>=t||r<0){const n=Math.floor(r/t);r-=t*n;s+=Math.abs(n);const o=this.repetitions-s;if(o<=0){this.clampWhenFinished?this.paused=true:this.enabled=false;r=e>0?t:0;this.time=r;this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1})}else{if(o===1){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(false,false,a);this._loopCount=s;this.time=r;this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;if(n){r.endingStart=qt;r.endingEnd=qt}else{r.endingStart=e?this.zeroSlopeAtStart?qt:Wt:Kt;r.endingEnd=t?this.zeroSlopeAtEnd?qt:Wt:Kt}}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let a=this._weightInterpolant;if(a===null){a=r._lendControlInterpolant();this._weightInterpolant=a}const o=a.parameterPositions,l=a.sampleValues;o[0]=s;l[0]=t;o[1]=s+e;l[1]=n;return this}}const ho=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(e){super();this._root=e;this._initMemoryManager();this._accuIndex=0;this.time=0;this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let u=c[l];if(u===void 0){u={};c[l]=u}for(let e=0;e!==s;++e){const s=r[e],c=s.name;let h=u[c];if(h!==void 0){++h.referenceCount;a[e]=h}else{h=a[e];if(h!==void 0){if(h._cacheIndex===null){++h.referenceCount;this._addInactiveBinding(h,l,c)}continue}const r=t&&t._propertyBindings[e].binding.parsedPath;h=new PropertyMixer(PropertyBinding.create(n,c,r),s.ValueTypeName,s.getValueSize());++h.referenceCount;this._addInactiveBinding(h,l,c);a[e]=h}o[e].resultBuffer=h.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]);this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];if(n.useCount++===0){this._lendBinding(n);n.saveOriginalState()}}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];if(--n.useCount===0){n.restoreOriginalState();this._takeBackBinding(n)}}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0){a={knownActions:[e],actionByRoot:{}};e._byClipCacheIndex=0;s[t]=a}else{const t=a.knownActions;e._byClipCacheIndex=t.length;t.push(e)}e._cacheIndex=r.length;r.push(e);a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r;t[r]=n;t.pop();e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u;l[u]=c;l.pop();e._byClipCacheIndex=null;const h=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d];l.length===0&&delete a[s];this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r;t[r]=e;s._cacheIndex=n;t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r;t[r]=e;s._cacheIndex=n;t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[t];if(a===void 0){a={};r[t]=a}a[n]=e;e._cacheIndex=s.length;s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,o=a[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c;t[c]=l;t.pop();delete o[s];Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r;t[r]=e;s._cacheIndex=n;t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r;t[r]=e;s._cacheIndex=n;t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];if(n===void 0){n=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,ho);n.__cacheIndex=t;e[t]=n}return n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r;t[r]=e;s.__cacheIndex=n;t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let a=typeof e==="string"?AnimationClip.findByName(r,e):e;const o=a!==null?a.uuid:e;const l=this._actionsByClip[o];let c=null;n===void 0&&(n=a!==null?a.blendMode:Xt);if(l!==void 0){const e=l.actionByRoot[s];if(e!==void 0&&e.blendMode===n)return e;c=l.knownActions[0];a===null&&(a=c._clip)}if(a===null)return null;const u=new AnimationAction(this,a,t,n);this._bindAction(u,c);this._addInactiveAction(u,o,s);return u}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e==="string"?AnimationClip.findByName(n,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==n;++o){const n=t[o];n._update(r,e,s,a)}const o=this._bindings,l=this._nActiveBindings;for(let e=0;e!==l;++e)o[e].apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const e=s.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const s=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null;r._byClipCacheIndex=null;a._cacheIndex=s;t[s]=a;t.pop();this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const e in n){const r=n[e].actionByRoot,s=r[t];if(s!==void 0){this._deactivateAction(s);this._removeInactiveAction(s)}}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const e in s){const t=s[e];t.restoreOriginalState();this._removeInactiveBinding(t)}}uncacheAction(e,t){const n=this.existingAction(e,t);if(n!==null){this._deactivateAction(n);this._removeInactiveAction(n)}}}class RenderTarget3D extends RenderTarget{constructor(e=1,t=1,n=1,r={}){super(e,t,r);this.isRenderTarget3D=true;this.depth=n;this.texture=new Data3DTexture(null,e,t,n);this.texture.isRenderTargetTexture=true}}class RenderTargetArray extends RenderTarget{constructor(e=1,t=1,n=1,r={}){super(e,t,r);this.isRenderTargetArray=true;this.depth=n;this.texture=new DataArrayTexture(null,e,t,n);this.texture.isRenderTargetTexture=true}}class Uniform{constructor(e){this.value=e}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let po=0;class UniformsGroup extends EventDispatcher{constructor(){super();this.isUniformsGroup=true;Object.defineProperty(this,"id",{value:po++});this.name="";this.usage=Un;this.uniforms=[]}add(e){this.uniforms.push(e);return this}remove(e){const t=this.uniforms.indexOf(e);t!==-1&&this.uniforms.splice(t,1);return this}setName(e){this.name=e;return this}setUsage(e){this.usage=e;return this}dispose(){this.dispatchEvent({type:"dispose"});return this}copy(e){this.name=e.name;this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let e=0,n=t.length;e<n;e++){const n=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0;e<n.length;e++)this.uniforms.push(n[e].clone())}return this}clone(){return(new this.constructor).copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(e,t,n=1){super(e,t);this.isInstancedInterleavedBuffer=true;this.meshPerAttribute=n}copy(e){super.copy(e);this.meshPerAttribute=e.meshPerAttribute;return this}clone(e){const t=super.clone(e);t.meshPerAttribute=this.meshPerAttribute;return t}toJSON(e){const t=super.toJSON(e);t.isInstancedInterleavedBuffer=true;t.meshPerAttribute=this.meshPerAttribute;return t}}class GLBufferAttribute{constructor(e,t,n,r,s){this.isGLBufferAttribute=true;this.name="";this.buffer=e;this.type=t;this.itemSize=n;this.elementSize=r;this.count=s;this.version=0}set needsUpdate(e){e===true&&this.version++}setBuffer(e){this.buffer=e;return this}setType(e,t){this.type=e;this.elementSize=t;return this}setItemSize(e){this.itemSize=e;return this}setCount(e){this.count=e;return this}}const fo=new Matrix4;class Raycaster{constructor(e,t,n=0,r=Infinity){this.ray=new Ray(e,t);this.near=n;this.far=r;this.camera=null;this.layers=new Layers;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){if(t.isPerspectiveCamera){this.ray.origin.setFromMatrixPosition(t.matrixWorld);this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize();this.camera=t}else if(t.isOrthographicCamera){this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t);this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld);this.camera=t}else console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){fo.identity().extractRotation(e.matrixWorld);this.ray.origin.setFromMatrixPosition(e.matrixWorld);this.ray.direction.set(0,0,-1).applyMatrix4(fo);return this}intersectObject(e,t=true,n=[]){intersect(e,this,n,t);n.sort(ascSort);return n}intersectObjects(e,t=true,n=[]){for(let r=0,s=e.length;r<s;r++)intersect(e[r],this,n,t);n.sort(ascSort);return n}}function ascSort(e,t){return e.distance-t.distance}function intersect(e,t,n,r){let s=true;if(e.layers.test(t.layers)){const r=e.raycast(t,n);r===false&&(s=false)}if(s===true&&r===true){const r=e.children;for(let e=0,s=r.length;e<s;e++)intersect(r[e],t,n,true)}}class Spherical{constructor(e=1,t=0,n=0){this.radius=e;this.phi=t;this.theta=n;return this}set(e,t,n){this.radius=e;this.phi=t;this.theta=n;return this}copy(e){this.radius=e.radius;this.phi=e.phi;this.theta=e.theta;return this}makeSafe(){const e=1e-6;this.phi=clamp(this.phi,e,Math.PI-e);return this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){this.radius=Math.sqrt(e*e+t*t+n*n);if(this.radius===0){this.theta=0;this.phi=0}else{this.theta=Math.atan2(e,n);this.phi=Math.acos(clamp(t/this.radius,-1,1))}return this}clone(){return(new this.constructor).copy(this)}}class Cylindrical{constructor(e=1,t=0,n=0){this.radius=e;this.theta=t;this.y=n;return this}set(e,t,n){this.radius=e;this.theta=t;this.y=n;return this}copy(e){this.radius=e.radius;this.theta=e.theta;this.y=e.y;return this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){this.radius=Math.sqrt(e*e+n*n);this.theta=Math.atan2(e,n);this.y=t;return this}clone(){return(new this.constructor).copy(this)}}class Matrix2{constructor(e,t,n,r){Matrix2.prototype.isMatrix2=true;this.elements=[1,0,0,1];e!==void 0&&this.set(e,t,n,r)}identity(){this.set(1,0,0,1);return this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;s[0]=e;s[2]=t;s[1]=n;s[3]=r;return this}}const mo=new Vector2;class Box2{constructor(e=new Vector2(Infinity,Infinity),t=new Vector2(-Infinity,-Infinity)){this.isBox2=true;this.min=e;this.max=t}set(e,t){this.min.copy(e);this.max.copy(t);return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=mo.copy(t).multiplyScalar(.5);this.min.copy(e).sub(n);this.max.copy(e).add(n);return this}clone(){return(new this.constructor).copy(this)}copy(e){this.min.copy(e.min);this.max.copy(e.max);return this}makeEmpty(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){this.min.min(e);this.max.max(e);return this}expandByVector(e){this.min.sub(e);this.max.add(e);return this}expandByScalar(e){this.min.addScalar(-e);this.max.addScalar(e);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,mo).distanceTo(e)}intersect(e){this.min.max(e.min);this.max.min(e.max);this.isEmpty()&&this.makeEmpty();return this}union(e){this.min.min(e.min);this.max.max(e.max);return this}translate(e){this.min.add(e);this.max.add(e);return this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ao=new Vector3;const go=new Vector3;class Line3{constructor(e=new Vector3,t=new Vector3){this.start=e;this.end=t}set(e,t){this.start.copy(e);this.end.copy(t);return this}copy(e){this.start.copy(e.start);this.end.copy(e.end);return this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Ao.subVectors(e,this.start);go.subVectors(this.end,this.start);const n=go.dot(go);const r=go.dot(Ao);let s=r/n;t&&(s=clamp(s,0,1));return s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const vo=new Vector3;class SpotLightHelper extends Object3D{constructor(e,t){super();this.light=e;this.matrixAutoUpdate=false;this.color=t;this.type="SpotLightHelper";const n=new BufferGeometry;const r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,n=32;e<n;e++,t++){const s=e/n*Math.PI*2;const a=t/n*Math.PI*2;r.push(Math.cos(s),Math.sin(s),1,Math.cos(a),Math.sin(a),1)}n.setAttribute("position",new Float32BufferAttribute(r,3));const s=new LineBasicMaterial({fog:false,toneMapped:false});this.cone=new LineSegments(n,s);this.add(this.cone);this.update()}dispose(){this.cone.geometry.dispose();this.cone.material.dispose()}update(){this.light.updateWorldMatrix(true,false);this.light.target.updateWorldMatrix(true,false);if(this.parent){this.parent.updateWorldMatrix(true);this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)}else this.matrix.copy(this.light.matrixWorld);this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3;const t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e);vo.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(vo);this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const yo=new Vector3;const Co=new Matrix4;const Eo=new Matrix4;class SkeletonHelper extends LineSegments{constructor(e){const t=getBoneList(e);const n=new BufferGeometry;const r=[];const s=[];const a=new Color(0,0,1);const o=new Color(0,1,0);for(let e=0;e<t.length;e++){const n=t[e];if(n.parent&&n.parent.isBone){r.push(0,0,0);r.push(0,0,0);s.push(a.r,a.g,a.b);s.push(o.r,o.g,o.b)}}n.setAttribute("position",new Float32BufferAttribute(r,3));n.setAttribute("color",new Float32BufferAttribute(s,3));const l=new LineBasicMaterial({vertexColors:true,depthTest:false,depthWrite:false,toneMapped:false,transparent:true});super(n,l);this.isSkeletonHelper=true;this.type="SkeletonHelper";this.root=e;this.bones=t;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false}updateMatrixWorld(e){const t=this.bones;const n=this.geometry;const r=n.getAttribute("position");Eo.copy(this.root.matrixWorld).invert();for(let e=0,n=0;e<t.length;e++){const s=t[e];if(s.parent&&s.parent.isBone){Co.multiplyMatrices(Eo,s.matrixWorld);yo.setFromMatrixPosition(Co);r.setXYZ(n,yo.x,yo.y,yo.z);Co.multiplyMatrices(Eo,s.parent.matrixWorld);yo.setFromMatrixPosition(Co);r.setXYZ(n+1,yo.x,yo.y,yo.z);n+=2}}n.getAttribute("position").needsUpdate=true;super.updateMatrixWorld(e)}dispose(){this.geometry.dispose();this.material.dispose()}}function getBoneList(e){const t=[];e.isBone===true&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,getBoneList(e.children[n]));return t}class PointLightHelper extends Mesh{constructor(e,t,n){const r=new SphereGeometry(t,4,2);const s=new MeshBasicMaterial({wireframe:true,fog:false,toneMapped:false});super(r,s);this.light=e;this.color=n;this.type="PointLightHelper";this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=false;this.update()}dispose(){this.geometry.dispose();this.material.dispose()}update(){this.light.updateWorldMatrix(true,false);this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const bo=new Vector3;const xo=new Color;const _o=new Color;class HemisphereLightHelper extends Object3D{constructor(e,t,n){super();this.light=e;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=n;this.type="HemisphereLightHelper";const r=new OctahedronGeometry(t);r.rotateY(Math.PI*.5);this.material=new MeshBasicMaterial({wireframe:true,fog:false,toneMapped:false});this.color===void 0&&(this.material.vertexColors=true);const s=r.getAttribute("position");const a=new Float32Array(s.count*3);r.setAttribute("color",new BufferAttribute(a,3));this.add(new Mesh(r,this.material));this.update()}dispose(){this.children[0].geometry.dispose();this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");xo.copy(this.light.color);_o.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?xo:_o;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=true}this.light.updateWorldMatrix(true,false);e.lookAt(bo.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(e=10,t=10,n=4473924,r=8947848){n=new Color(n);r=new Color(r);const s=t/2;const a=e/t;const o=e/2;const l=[],c=[];for(let e=0,u=0,h=-o;e<=t;e++,h+=a){l.push(-o,0,h,o,0,h);l.push(h,0,-o,h,0,o);const t=e===s?n:r;t.toArray(c,u);u+=3;t.toArray(c,u);u+=3;t.toArray(c,u);u+=3;t.toArray(c,u);u+=3}const u=new BufferGeometry;u.setAttribute("position",new Float32BufferAttribute(l,3));u.setAttribute("color",new Float32BufferAttribute(c,3));const h=new LineBasicMaterial({vertexColors:true,toneMapped:false});super(u,h);this.type="GridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(e=10,t=16,n=8,r=64,s=4473924,a=8947848){s=new Color(s);a=new Color(a);const o=[];const l=[];if(t>1)for(let n=0;n<t;n++){const r=n/t*(Math.PI*2);const c=Math.sin(r)*e;const u=Math.cos(r)*e;o.push(0,0,0);o.push(c,0,u);const h=n&1?s:a;l.push(h.r,h.g,h.b);l.push(h.r,h.g,h.b)}for(let t=0;t<n;t++){const c=t&1?s:a;const u=e-e/n*t;for(let e=0;e<r;e++){let t=e/r*(Math.PI*2);let n=Math.sin(t)*u;let s=Math.cos(t)*u;o.push(n,0,s);l.push(c.r,c.g,c.b);t=(e+1)/r*(Math.PI*2);n=Math.sin(t)*u;s=Math.cos(t)*u;o.push(n,0,s);l.push(c.r,c.g,c.b)}}const c=new BufferGeometry;c.setAttribute("position",new Float32BufferAttribute(o,3));c.setAttribute("color",new Float32BufferAttribute(l,3));const u=new LineBasicMaterial({vertexColors:true,toneMapped:false});super(c,u);this.type="PolarGridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}const Mo=new Vector3;const wo=new Vector3;const So=new Vector3;class DirectionalLightHelper extends Object3D{constructor(e,t,n){super();this.light=e;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=n;this.type="DirectionalLightHelper";t===void 0&&(t=1);let r=new BufferGeometry;r.setAttribute("position",new Float32BufferAttribute([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new LineBasicMaterial({fog:false,toneMapped:false});this.lightPlane=new Line(r,s);this.add(this.lightPlane);r=new BufferGeometry;r.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3));this.targetLine=new Line(r,s);this.add(this.targetLine);this.update()}dispose(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(true,false);this.light.target.updateWorldMatrix(true,false);Mo.setFromMatrixPosition(this.light.matrixWorld);wo.setFromMatrixPosition(this.light.target.matrixWorld);So.subVectors(wo,Mo);this.lightPlane.lookAt(wo);if(this.color!==void 0){this.lightPlane.material.color.set(this.color);this.targetLine.material.color.set(this.color)}else{this.lightPlane.material.color.copy(this.light.color);this.targetLine.material.color.copy(this.light.color)}this.targetLine.lookAt(wo);this.targetLine.scale.z=So.length()}}const To=new Vector3;const Bo=new Camera;class CameraHelper extends LineSegments{constructor(e){const t=new BufferGeometry;const n=new LineBasicMaterial({color:16777215,vertexColors:true,toneMapped:false});const r=[];const s=[];const a={};addLine("n1","n2");addLine("n2","n4");addLine("n4","n3");addLine("n3","n1");addLine("f1","f2");addLine("f2","f4");addLine("f4","f3");addLine("f3","f1");addLine("n1","f1");addLine("n2","f2");addLine("n3","f3");addLine("n4","f4");addLine("p","n1");addLine("p","n2");addLine("p","n3");addLine("p","n4");addLine("u1","u2");addLine("u2","u3");addLine("u3","u1");addLine("c","t");addLine("p","c");addLine("cn1","cn2");addLine("cn3","cn4");addLine("cf1","cf2");addLine("cf3","cf4");function addLine(e,t){addPoint(e);addPoint(t)}function addPoint(e){r.push(0,0,0);s.push(0,0,0);a[e]===void 0&&(a[e]=[]);a[e].push(r.length/3-1)}t.setAttribute("position",new Float32BufferAttribute(r,3));t.setAttribute("color",new Float32BufferAttribute(s,3));super(t,n);this.type="CameraHelper";this.camera=e;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=a;this.update();const o=new Color(16755200);const l=new Color(16711680);const c=new Color(43775);const u=new Color(16777215);const h=new Color(3355443);this.setColors(o,l,c,u,h)}setColors(e,t,n,r,s){const a=this.geometry;const o=a.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b);o.setXYZ(1,e.r,e.g,e.b);o.setXYZ(2,e.r,e.g,e.b);o.setXYZ(3,e.r,e.g,e.b);o.setXYZ(4,e.r,e.g,e.b);o.setXYZ(5,e.r,e.g,e.b);o.setXYZ(6,e.r,e.g,e.b);o.setXYZ(7,e.r,e.g,e.b);o.setXYZ(8,e.r,e.g,e.b);o.setXYZ(9,e.r,e.g,e.b);o.setXYZ(10,e.r,e.g,e.b);o.setXYZ(11,e.r,e.g,e.b);o.setXYZ(12,e.r,e.g,e.b);o.setXYZ(13,e.r,e.g,e.b);o.setXYZ(14,e.r,e.g,e.b);o.setXYZ(15,e.r,e.g,e.b);o.setXYZ(16,e.r,e.g,e.b);o.setXYZ(17,e.r,e.g,e.b);o.setXYZ(18,e.r,e.g,e.b);o.setXYZ(19,e.r,e.g,e.b);o.setXYZ(20,e.r,e.g,e.b);o.setXYZ(21,e.r,e.g,e.b);o.setXYZ(22,e.r,e.g,e.b);o.setXYZ(23,e.r,e.g,e.b);o.setXYZ(24,t.r,t.g,t.b);o.setXYZ(25,t.r,t.g,t.b);o.setXYZ(26,t.r,t.g,t.b);o.setXYZ(27,t.r,t.g,t.b);o.setXYZ(28,t.r,t.g,t.b);o.setXYZ(29,t.r,t.g,t.b);o.setXYZ(30,t.r,t.g,t.b);o.setXYZ(31,t.r,t.g,t.b);o.setXYZ(32,n.r,n.g,n.b);o.setXYZ(33,n.r,n.g,n.b);o.setXYZ(34,n.r,n.g,n.b);o.setXYZ(35,n.r,n.g,n.b);o.setXYZ(36,n.r,n.g,n.b);o.setXYZ(37,n.r,n.g,n.b);o.setXYZ(38,r.r,r.g,r.b);o.setXYZ(39,r.r,r.g,r.b);o.setXYZ(40,s.r,s.g,s.b);o.setXYZ(41,s.r,s.g,s.b);o.setXYZ(42,s.r,s.g,s.b);o.setXYZ(43,s.r,s.g,s.b);o.setXYZ(44,s.r,s.g,s.b);o.setXYZ(45,s.r,s.g,s.b);o.setXYZ(46,s.r,s.g,s.b);o.setXYZ(47,s.r,s.g,s.b);o.setXYZ(48,s.r,s.g,s.b);o.setXYZ(49,s.r,s.g,s.b);o.needsUpdate=true}update(){const e=this.geometry;const t=this.pointMap;const n=1,r=1;Bo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===qn?-1:0;setPoint("c",t,e,Bo,0,0,s);setPoint("t",t,e,Bo,0,0,1);setPoint("n1",t,e,Bo,-n,-r,s);setPoint("n2",t,e,Bo,n,-r,s);setPoint("n3",t,e,Bo,-n,r,s);setPoint("n4",t,e,Bo,n,r,s);setPoint("f1",t,e,Bo,-n,-r,1);setPoint("f2",t,e,Bo,n,-r,1);setPoint("f3",t,e,Bo,-n,r,1);setPoint("f4",t,e,Bo,n,r,1);setPoint("u1",t,e,Bo,n*.7,r*1.1,s);setPoint("u2",t,e,Bo,.7*-n,r*1.1,s);setPoint("u3",t,e,Bo,0,r*2,s);setPoint("cf1",t,e,Bo,-n,0,1);setPoint("cf2",t,e,Bo,n,0,1);setPoint("cf3",t,e,Bo,0,-r,1);setPoint("cf4",t,e,Bo,0,r,1);setPoint("cn1",t,e,Bo,-n,0,s);setPoint("cn2",t,e,Bo,n,0,s);setPoint("cn3",t,e,Bo,0,-r,s);setPoint("cn4",t,e,Bo,0,r,s);e.getAttribute("position").needsUpdate=true}dispose(){this.geometry.dispose();this.material.dispose()}}function setPoint(e,t,n,r,s,a,o){To.set(s,a,o).unproject(r);const l=t[e];if(l!==void 0){const e=n.getAttribute("position");for(let t=0,n=l.length;t<n;t++)e.setXYZ(l[t],To.x,To.y,To.z)}}const Io=new Box3;class BoxHelper extends LineSegments{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);const r=new Float32Array(24);const s=new BufferGeometry;s.setIndex(new BufferAttribute(n,1));s.setAttribute("position",new BufferAttribute(r,3));super(s,new LineBasicMaterial({color:t,toneMapped:false}));this.object=e;this.type="BoxHelper";this.matrixAutoUpdate=false;this.update()}update(e){e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");this.object!==void 0&&Io.setFromObject(this.object);if(Io.isEmpty())return;const t=Io.min;const n=Io.max;const r=this.geometry.attributes.position;const s=r.array;s[0]=n.x;s[1]=n.y;s[2]=n.z;s[3]=t.x;s[4]=n.y;s[5]=n.z;s[6]=t.x;s[7]=t.y;s[8]=n.z;s[9]=n.x;s[10]=t.y;s[11]=n.z;s[12]=n.x;s[13]=n.y;s[14]=t.z;s[15]=t.x;s[16]=n.y;s[17]=t.z;s[18]=t.x;s[19]=t.y;s[20]=t.z;s[21]=n.x;s[22]=t.y;s[23]=t.z;r.needsUpdate=true;this.geometry.computeBoundingSphere()}setFromObject(e){this.object=e;this.update();return this}copy(e,t){super.copy(e,t);this.object=e.object;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class Box3Helper extends LineSegments{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);const r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1];const s=new BufferGeometry;s.setIndex(new BufferAttribute(n,1));s.setAttribute("position",new Float32BufferAttribute(r,3));super(s,new LineBasicMaterial({color:t,toneMapped:false}));this.box=e;this.type="Box3Helper";this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;if(!t.isEmpty()){t.getCenter(this.position);t.getSize(this.scale);this.scale.multiplyScalar(.5);super.updateMatrixWorld(e)}}dispose(){this.geometry.dispose();this.material.dispose()}}class PlaneHelper extends Line{constructor(e,t=1,n=16776960){const r=n;const s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0];const a=new BufferGeometry;a.setAttribute("position",new Float32BufferAttribute(s,3));a.computeBoundingSphere();super(a,new LineBasicMaterial({color:r,toneMapped:false}));this.type="PlaneHelper";this.plane=e;this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0];const l=new BufferGeometry;l.setAttribute("position",new Float32BufferAttribute(o,3));l.computeBoundingSphere();this.add(new Mesh(l,new MeshBasicMaterial({color:r,opacity:.2,transparent:true,depthWrite:false,toneMapped:false})))}updateMatrixWorld(e){this.position.set(0,0,0);this.scale.set(.5*this.size,.5*this.size,1);this.lookAt(this.plane.normal);this.translateZ(-this.plane.constant);super.updateMatrixWorld(e)}dispose(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()}}const Ro=new Vector3;let Lo,Do;class ArrowHelper extends Object3D{constructor(e=new Vector3(0,0,1),t=new Vector3(0,0,0),n=1,r=16776960,s=n*.2,a=s*.2){super();this.type="ArrowHelper";if(Lo===void 0){Lo=new BufferGeometry;Lo.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3));Do=new CylinderGeometry(0,.5,1,5,1);Do.translate(0,-.5,0)}this.position.copy(t);this.line=new Line(Lo,new LineBasicMaterial({color:r,toneMapped:false}));this.line.matrixAutoUpdate=false;this.add(this.line);this.cone=new Mesh(Do,new MeshBasicMaterial({color:r,toneMapped:false}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(e);this.setLength(n,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Ro.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Ro,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1);this.line.updateMatrix();this.cone.scale.set(n,t,n);this.cone.position.y=e;this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e);this.cone.material.color.set(e)}copy(e){super.copy(e,false);this.line.copy(e.line);this.cone.copy(e.cone);return this}dispose(){this.line.geometry.dispose();this.line.material.dispose();this.cone.geometry.dispose();this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];const n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1];const r=new BufferGeometry;r.setAttribute("position",new Float32BufferAttribute(t,3));r.setAttribute("color",new Float32BufferAttribute(n,3));const s=new LineBasicMaterial({vertexColors:true,toneMapped:false});super(r,s);this.type="AxesHelper"}setColors(e,t,n){const r=new Color;const s=this.geometry.attributes.color.array;r.set(e);r.toArray(s,0);r.toArray(s,3);r.set(t);r.toArray(s,6);r.toArray(s,9);r.set(n);r.toArray(s,12);r.toArray(s,15);this.geometry.attributes.color.needsUpdate=true;return this}dispose(){this.geometry.dispose();this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath";this.color=new Color;this.subPaths=[];this.currentPath=null}moveTo(e,t){this.currentPath=new Path;this.subPaths.push(this.currentPath);this.currentPath.moveTo(e,t);return this}lineTo(e,t){this.currentPath.lineTo(e,t);return this}quadraticCurveTo(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r);return this}bezierCurveTo(e,t,n,r,s,a){this.currentPath.bezierCurveTo(e,t,n,r,s,a);return this}splineThru(e){this.currentPath.splineThru(e);return this}toShapes(e){function toShapesNoHoles(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];const s=new Shape;s.curves=r.curves;t.push(s)}return t}function isPointInsidePolygon(e,t){const n=t.length;let r=false;for(let s=n-1,a=0;a<n;s=a++){let n=t[s];let o=t[a];let l=o.x-n.x;let c=o.y-n.y;if(Math.abs(c)>Number.EPSILON){if(c<0){n=t[a];l=-l;o=t[s];c=-c}if(e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return true}else{const t=c*(e.x-n.x)-l*(e.y-n.y);if(t===0)return true;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return true}}return r}const t=ShapeUtils.isClockWise;const n=this.subPaths;if(n.length===0)return[];let r,s,a;const o=[];if(n.length===1){s=n[0];a=new Shape;a.curves=s.curves;o.push(a);return o}let l=!t(n[0].getPoints());l=e?!l:l;const c=[];const u=[];let h=[];let d=0;let p;u[d]=void 0;h[d]=[];for(let a=0,o=n.length;a<o;a++){s=n[a];p=s.getPoints();r=t(p);r=e?!r:r;if(r){!l&&u[d]&&d++;u[d]={s:new Shape,p:p};u[d].s.curves=s.curves;l&&d++;h[d]=[]}else h[d].push({h:s,p:p[0]})}if(!u[0])return toShapesNoHoles(n);if(u.length>1){let e=false;let t=0;for(let e=0,t=u.length;e<t;e++)c[e]=[];for(let n=0,r=u.length;n<r;n++){const r=h[n];for(let s=0;s<r.length;s++){const a=r[s];let o=true;for(let r=0;r<u.length;r++)if(isPointInsidePolygon(a.p,u[r].p)){n!==r&&t++;if(o){o=false;c[r].push(a)}else e=true}o&&c[n].push(a)}}t>0&&e===false&&(h=c)}let f;for(let e=0,t=u.length;e<t;e++){a=u[e].s;o.push(a);f=h[e];for(let e=0,t=f.length;e<t;e++)a.holes.push(f[e].h)}return o}}class Controls extends EventDispatcher{constructor(e,t=null){super();this.object=e;this.domElement=t;this.enabled=true;this.state=-1;this.keys={};this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null};this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function contain(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;if(n>t){e.repeat.x=1;e.repeat.y=n/t;e.offset.x=0;e.offset.y=(1-e.repeat.y)/2}else{e.repeat.x=t/n;e.repeat.y=1;e.offset.x=(1-e.repeat.x)/2;e.offset.y=0}return e}function cover(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;if(n>t){e.repeat.x=t/n;e.repeat.y=1;e.offset.x=(1-e.repeat.x)/2;e.offset.y=0}else{e.repeat.x=1;e.repeat.y=n/t;e.offset.x=0;e.offset.y=(1-e.repeat.y)/2}return e}function fill(e){e.repeat.x=1;e.repeat.y=1;e.offset.x=0;e.offset.y=0;return e}
/**
          * Given the width, height, format, and type of a texture. Determines how many
          * bytes must be used to represent the texture.
          *
          * @param {Number} width
          * @param {Number} height
          * @param {Number} format
          * @param {Number} type
          * @return {Number} The number of bytes required to represent the texture.
          */function getByteLength(e,t,n,r){const s=getTextureTypeByteLength(r);switch(n){case Xe:return e*t;case Ze:return e*t;case $e:return e*t*2;case nt:return e*t/s.components*s.byteLength;case rt:return e*t/s.components*s.byteLength;case it:return e*t*2/s.components*s.byteLength;case st:return e*t*2/s.components*s.byteLength;case Ye:return e*t*3/s.components*s.byteLength;case Je:return e*t*4/s.components*s.byteLength;case ot:return e*t*4/s.components*s.byteLength;case lt:case ct:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case ut:case ht:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case pt:case mt:return Math.max(e,16)*Math.max(t,8)/4;case dt:case ft:return Math.max(e,8)*Math.max(t,8)/2;case At:case gt:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case vt:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case yt:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Ct:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case Et:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case bt:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case xt:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case _t:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case Mt:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case wt:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case St:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case Tt:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case Bt:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case It:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case Rt:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case Lt:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case Dt:case Pt:case Ft:return Math.ceil(e/4)*Math.ceil(t/4)*16;case Ut:case Ot:return Math.ceil(e/4)*Math.ceil(t/4)*8;case kt:case Nt:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function getTextureTypeByteLength(e){switch(e){case Oe:case ke:return{byteLength:1,components:1};case Ge:case Ne:case He:return{byteLength:2,components:1};case ze:case We:return{byteLength:2,components:4};case Qe:case Ve:case je:return{byteLength:4,components:1};case Ke:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}const Po={contain:contain,cover:cover,fill:fill,getByteLength:getByteLength};typeof __THREE_DEVTOOLS__!=="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:s}}));typeof window!=="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=s)},"./node_modules/three/build/three.module.js":(e,n,r)=>{r.r(n);r.d(n,{ACESFilmicToneMapping:()=>s.ACESFilmicToneMapping,AddEquation:()=>s.AddEquation,AddOperation:()=>s.AddOperation,AdditiveAnimationBlendMode:()=>s.AdditiveAnimationBlendMode,AdditiveBlending:()=>s.AdditiveBlending,AgXToneMapping:()=>s.AgXToneMapping,AlphaFormat:()=>s.AlphaFormat,AlwaysCompare:()=>s.AlwaysCompare,AlwaysDepth:()=>s.AlwaysDepth,AlwaysStencilFunc:()=>s.AlwaysStencilFunc,AmbientLight:()=>s.AmbientLight,AnimationAction:()=>s.AnimationAction,AnimationClip:()=>s.AnimationClip,AnimationLoader:()=>s.AnimationLoader,AnimationMixer:()=>s.AnimationMixer,AnimationObjectGroup:()=>s.AnimationObjectGroup,AnimationUtils:()=>s.AnimationUtils,ArcCurve:()=>s.ArcCurve,ArrayCamera:()=>s.ArrayCamera,ArrowHelper:()=>s.ArrowHelper,AttachedBindMode:()=>s.AttachedBindMode,Audio:()=>s.Audio,AudioAnalyser:()=>s.AudioAnalyser,AudioContext:()=>s.AudioContext,AudioListener:()=>s.AudioListener,AudioLoader:()=>s.AudioLoader,AxesHelper:()=>s.AxesHelper,BackSide:()=>s.BackSide,BasicDepthPacking:()=>s.BasicDepthPacking,BasicShadowMap:()=>s.BasicShadowMap,BatchedMesh:()=>s.BatchedMesh,Bone:()=>s.Bone,BooleanKeyframeTrack:()=>s.BooleanKeyframeTrack,Box2:()=>s.Box2,Box3:()=>s.Box3,Box3Helper:()=>s.Box3Helper,BoxGeometry:()=>s.BoxGeometry,BoxHelper:()=>s.BoxHelper,BufferAttribute:()=>s.BufferAttribute,BufferGeometry:()=>s.BufferGeometry,BufferGeometryLoader:()=>s.BufferGeometryLoader,ByteType:()=>s.ByteType,Cache:()=>s.Cache,Camera:()=>s.Camera,CameraHelper:()=>s.CameraHelper,CanvasTexture:()=>s.CanvasTexture,CapsuleGeometry:()=>s.CapsuleGeometry,CatmullRomCurve3:()=>s.CatmullRomCurve3,CineonToneMapping:()=>s.CineonToneMapping,CircleGeometry:()=>s.CircleGeometry,ClampToEdgeWrapping:()=>s.ClampToEdgeWrapping,Clock:()=>s.Clock,Color:()=>s.Color,ColorKeyframeTrack:()=>s.ColorKeyframeTrack,ColorManagement:()=>s.ColorManagement,CompressedArrayTexture:()=>s.CompressedArrayTexture,CompressedCubeTexture:()=>s.CompressedCubeTexture,CompressedTexture:()=>s.CompressedTexture,CompressedTextureLoader:()=>s.CompressedTextureLoader,ConeGeometry:()=>s.ConeGeometry,ConstantAlphaFactor:()=>s.ConstantAlphaFactor,ConstantColorFactor:()=>s.ConstantColorFactor,Controls:()=>s.Controls,CubeCamera:()=>s.CubeCamera,CubeReflectionMapping:()=>s.CubeReflectionMapping,CubeRefractionMapping:()=>s.CubeRefractionMapping,CubeTexture:()=>s.CubeTexture,CubeTextureLoader:()=>s.CubeTextureLoader,CubeUVReflectionMapping:()=>s.CubeUVReflectionMapping,CubicBezierCurve:()=>s.CubicBezierCurve,CubicBezierCurve3:()=>s.CubicBezierCurve3,CubicInterpolant:()=>s.CubicInterpolant,CullFaceBack:()=>s.CullFaceBack,CullFaceFront:()=>s.CullFaceFront,CullFaceFrontBack:()=>s.CullFaceFrontBack,CullFaceNone:()=>s.CullFaceNone,Curve:()=>s.Curve,CurvePath:()=>s.CurvePath,CustomBlending:()=>s.CustomBlending,CustomToneMapping:()=>s.CustomToneMapping,CylinderGeometry:()=>s.CylinderGeometry,Cylindrical:()=>s.Cylindrical,Data3DTexture:()=>s.Data3DTexture,DataArrayTexture:()=>s.DataArrayTexture,DataTexture:()=>s.DataTexture,DataTextureLoader:()=>s.DataTextureLoader,DataUtils:()=>s.DataUtils,DecrementStencilOp:()=>s.DecrementStencilOp,DecrementWrapStencilOp:()=>s.DecrementWrapStencilOp,DefaultLoadingManager:()=>s.DefaultLoadingManager,DepthFormat:()=>s.DepthFormat,DepthStencilFormat:()=>s.DepthStencilFormat,DepthTexture:()=>s.DepthTexture,DetachedBindMode:()=>s.DetachedBindMode,DirectionalLight:()=>s.DirectionalLight,DirectionalLightHelper:()=>s.DirectionalLightHelper,DiscreteInterpolant:()=>s.DiscreteInterpolant,DodecahedronGeometry:()=>s.DodecahedronGeometry,DoubleSide:()=>s.DoubleSide,DstAlphaFactor:()=>s.DstAlphaFactor,DstColorFactor:()=>s.DstColorFactor,DynamicCopyUsage:()=>s.DynamicCopyUsage,DynamicDrawUsage:()=>s.DynamicDrawUsage,DynamicReadUsage:()=>s.DynamicReadUsage,EdgesGeometry:()=>s.EdgesGeometry,EllipseCurve:()=>s.EllipseCurve,EqualCompare:()=>s.EqualCompare,EqualDepth:()=>s.EqualDepth,EqualStencilFunc:()=>s.EqualStencilFunc,EquirectangularReflectionMapping:()=>s.EquirectangularReflectionMapping,EquirectangularRefractionMapping:()=>s.EquirectangularRefractionMapping,Euler:()=>s.Euler,EventDispatcher:()=>s.EventDispatcher,ExtrudeGeometry:()=>s.ExtrudeGeometry,FileLoader:()=>s.FileLoader,Float16BufferAttribute:()=>s.Float16BufferAttribute,Float32BufferAttribute:()=>s.Float32BufferAttribute,FloatType:()=>s.FloatType,Fog:()=>s.Fog,FogExp2:()=>s.FogExp2,FramebufferTexture:()=>s.FramebufferTexture,FrontSide:()=>s.FrontSide,Frustum:()=>s.Frustum,GLBufferAttribute:()=>s.GLBufferAttribute,GLSL1:()=>s.GLSL1,GLSL3:()=>s.GLSL3,GreaterCompare:()=>s.GreaterCompare,GreaterDepth:()=>s.GreaterDepth,GreaterEqualCompare:()=>s.GreaterEqualCompare,GreaterEqualDepth:()=>s.GreaterEqualDepth,GreaterEqualStencilFunc:()=>s.GreaterEqualStencilFunc,GreaterStencilFunc:()=>s.GreaterStencilFunc,GridHelper:()=>s.GridHelper,Group:()=>s.Group,HalfFloatType:()=>s.HalfFloatType,HemisphereLight:()=>s.HemisphereLight,HemisphereLightHelper:()=>s.HemisphereLightHelper,IcosahedronGeometry:()=>s.IcosahedronGeometry,ImageBitmapLoader:()=>s.ImageBitmapLoader,ImageLoader:()=>s.ImageLoader,ImageUtils:()=>s.ImageUtils,IncrementStencilOp:()=>s.IncrementStencilOp,IncrementWrapStencilOp:()=>s.IncrementWrapStencilOp,InstancedBufferAttribute:()=>s.InstancedBufferAttribute,InstancedBufferGeometry:()=>s.InstancedBufferGeometry,InstancedInterleavedBuffer:()=>s.InstancedInterleavedBuffer,InstancedMesh:()=>s.InstancedMesh,Int16BufferAttribute:()=>s.Int16BufferAttribute,Int32BufferAttribute:()=>s.Int32BufferAttribute,Int8BufferAttribute:()=>s.Int8BufferAttribute,IntType:()=>s.IntType,InterleavedBuffer:()=>s.InterleavedBuffer,InterleavedBufferAttribute:()=>s.InterleavedBufferAttribute,Interpolant:()=>s.Interpolant,InterpolateDiscrete:()=>s.InterpolateDiscrete,InterpolateLinear:()=>s.InterpolateLinear,InterpolateSmooth:()=>s.InterpolateSmooth,InvertStencilOp:()=>s.InvertStencilOp,KeepStencilOp:()=>s.KeepStencilOp,KeyframeTrack:()=>s.KeyframeTrack,LOD:()=>s.LOD,LatheGeometry:()=>s.LatheGeometry,Layers:()=>s.Layers,LessCompare:()=>s.LessCompare,LessDepth:()=>s.LessDepth,LessEqualCompare:()=>s.LessEqualCompare,LessEqualDepth:()=>s.LessEqualDepth,LessEqualStencilFunc:()=>s.LessEqualStencilFunc,LessStencilFunc:()=>s.LessStencilFunc,Light:()=>s.Light,LightProbe:()=>s.LightProbe,Line:()=>s.Line,Line3:()=>s.Line3,LineBasicMaterial:()=>s.LineBasicMaterial,LineCurve:()=>s.LineCurve,LineCurve3:()=>s.LineCurve3,LineDashedMaterial:()=>s.LineDashedMaterial,LineLoop:()=>s.LineLoop,LineSegments:()=>s.LineSegments,LinearFilter:()=>s.LinearFilter,LinearInterpolant:()=>s.LinearInterpolant,LinearMipMapLinearFilter:()=>s.LinearMipMapLinearFilter,LinearMipMapNearestFilter:()=>s.LinearMipMapNearestFilter,LinearMipmapLinearFilter:()=>s.LinearMipmapLinearFilter,LinearMipmapNearestFilter:()=>s.LinearMipmapNearestFilter,LinearSRGBColorSpace:()=>s.LinearSRGBColorSpace,LinearToneMapping:()=>s.LinearToneMapping,LinearTransfer:()=>s.LinearTransfer,Loader:()=>s.Loader,LoaderUtils:()=>s.LoaderUtils,LoadingManager:()=>s.LoadingManager,LoopOnce:()=>s.LoopOnce,LoopPingPong:()=>s.LoopPingPong,LoopRepeat:()=>s.LoopRepeat,LuminanceAlphaFormat:()=>s.LuminanceAlphaFormat,LuminanceFormat:()=>s.LuminanceFormat,MOUSE:()=>s.MOUSE,Material:()=>s.Material,MaterialLoader:()=>s.MaterialLoader,MathUtils:()=>s.MathUtils,Matrix2:()=>s.Matrix2,Matrix3:()=>s.Matrix3,Matrix4:()=>s.Matrix4,MaxEquation:()=>s.MaxEquation,Mesh:()=>s.Mesh,MeshBasicMaterial:()=>s.MeshBasicMaterial,MeshDepthMaterial:()=>s.MeshDepthMaterial,MeshDistanceMaterial:()=>s.MeshDistanceMaterial,MeshLambertMaterial:()=>s.MeshLambertMaterial,MeshMatcapMaterial:()=>s.MeshMatcapMaterial,MeshNormalMaterial:()=>s.MeshNormalMaterial,MeshPhongMaterial:()=>s.MeshPhongMaterial,MeshPhysicalMaterial:()=>s.MeshPhysicalMaterial,MeshStandardMaterial:()=>s.MeshStandardMaterial,MeshToonMaterial:()=>s.MeshToonMaterial,MinEquation:()=>s.MinEquation,MirroredRepeatWrapping:()=>s.MirroredRepeatWrapping,MixOperation:()=>s.MixOperation,MultiplyBlending:()=>s.MultiplyBlending,MultiplyOperation:()=>s.MultiplyOperation,NearestFilter:()=>s.NearestFilter,NearestMipMapLinearFilter:()=>s.NearestMipMapLinearFilter,NearestMipMapNearestFilter:()=>s.NearestMipMapNearestFilter,NearestMipmapLinearFilter:()=>s.NearestMipmapLinearFilter,NearestMipmapNearestFilter:()=>s.NearestMipmapNearestFilter,NeutralToneMapping:()=>s.NeutralToneMapping,NeverCompare:()=>s.NeverCompare,NeverDepth:()=>s.NeverDepth,NeverStencilFunc:()=>s.NeverStencilFunc,NoBlending:()=>s.NoBlending,NoColorSpace:()=>s.NoColorSpace,NoToneMapping:()=>s.NoToneMapping,NormalAnimationBlendMode:()=>s.NormalAnimationBlendMode,NormalBlending:()=>s.NormalBlending,NotEqualCompare:()=>s.NotEqualCompare,NotEqualDepth:()=>s.NotEqualDepth,NotEqualStencilFunc:()=>s.NotEqualStencilFunc,NumberKeyframeTrack:()=>s.NumberKeyframeTrack,Object3D:()=>s.Object3D,ObjectLoader:()=>s.ObjectLoader,ObjectSpaceNormalMap:()=>s.ObjectSpaceNormalMap,OctahedronGeometry:()=>s.OctahedronGeometry,OneFactor:()=>s.OneFactor,OneMinusConstantAlphaFactor:()=>s.OneMinusConstantAlphaFactor,OneMinusConstantColorFactor:()=>s.OneMinusConstantColorFactor,OneMinusDstAlphaFactor:()=>s.OneMinusDstAlphaFactor,OneMinusDstColorFactor:()=>s.OneMinusDstColorFactor,OneMinusSrcAlphaFactor:()=>s.OneMinusSrcAlphaFactor,OneMinusSrcColorFactor:()=>s.OneMinusSrcColorFactor,OrthographicCamera:()=>s.OrthographicCamera,PCFShadowMap:()=>s.PCFShadowMap,PCFSoftShadowMap:()=>s.PCFSoftShadowMap,PMREMGenerator:()=>PMREMGenerator,Path:()=>s.Path,PerspectiveCamera:()=>s.PerspectiveCamera,Plane:()=>s.Plane,PlaneGeometry:()=>s.PlaneGeometry,PlaneHelper:()=>s.PlaneHelper,PointLight:()=>s.PointLight,PointLightHelper:()=>s.PointLightHelper,Points:()=>s.Points,PointsMaterial:()=>s.PointsMaterial,PolarGridHelper:()=>s.PolarGridHelper,PolyhedronGeometry:()=>s.PolyhedronGeometry,PositionalAudio:()=>s.PositionalAudio,PropertyBinding:()=>s.PropertyBinding,PropertyMixer:()=>s.PropertyMixer,QuadraticBezierCurve:()=>s.QuadraticBezierCurve,QuadraticBezierCurve3:()=>s.QuadraticBezierCurve3,Quaternion:()=>s.Quaternion,QuaternionKeyframeTrack:()=>s.QuaternionKeyframeTrack,QuaternionLinearInterpolant:()=>s.QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format:()=>s.RED_GREEN_RGTC2_Format,RED_RGTC1_Format:()=>s.RED_RGTC1_Format,REVISION:()=>s.REVISION,RGBADepthPacking:()=>s.RGBADepthPacking,RGBAFormat:()=>s.RGBAFormat,RGBAIntegerFormat:()=>s.RGBAIntegerFormat,RGBA_ASTC_10x10_Format:()=>s.RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format:()=>s.RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format:()=>s.RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format:()=>s.RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format:()=>s.RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format:()=>s.RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format:()=>s.RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format:()=>s.RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format:()=>s.RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format:()=>s.RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format:()=>s.RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format:()=>s.RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format:()=>s.RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format:()=>s.RGBA_ASTC_8x8_Format,RGBA_BPTC_Format:()=>s.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:()=>s.RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format:()=>s.RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format:()=>s.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:()=>s.RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format:()=>s.RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format:()=>s.RGBA_S3TC_DXT5_Format,RGBDepthPacking:()=>s.RGBDepthPacking,RGBFormat:()=>s.RGBFormat,RGBIntegerFormat:()=>s.RGBIntegerFormat,RGB_BPTC_SIGNED_Format:()=>s.RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format:()=>s.RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format:()=>s.RGB_ETC1_Format,RGB_ETC2_Format:()=>s.RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format:()=>s.RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format:()=>s.RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:()=>s.RGB_S3TC_DXT1_Format,RGDepthPacking:()=>s.RGDepthPacking,RGFormat:()=>s.RGFormat,RGIntegerFormat:()=>s.RGIntegerFormat,RawShaderMaterial:()=>s.RawShaderMaterial,Ray:()=>s.Ray,Raycaster:()=>s.Raycaster,RectAreaLight:()=>s.RectAreaLight,RedFormat:()=>s.RedFormat,RedIntegerFormat:()=>s.RedIntegerFormat,ReinhardToneMapping:()=>s.ReinhardToneMapping,RenderTarget:()=>s.RenderTarget,RenderTarget3D:()=>s.RenderTarget3D,RenderTargetArray:()=>s.RenderTargetArray,RepeatWrapping:()=>s.RepeatWrapping,ReplaceStencilOp:()=>s.ReplaceStencilOp,ReverseSubtractEquation:()=>s.ReverseSubtractEquation,RingGeometry:()=>s.RingGeometry,SIGNED_RED_GREEN_RGTC2_Format:()=>s.SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format:()=>s.SIGNED_RED_RGTC1_Format,SRGBColorSpace:()=>s.SRGBColorSpace,SRGBTransfer:()=>s.SRGBTransfer,Scene:()=>s.Scene,ShaderChunk:()=>zt,ShaderLib:()=>qt,ShaderMaterial:()=>s.ShaderMaterial,ShadowMaterial:()=>s.ShadowMaterial,Shape:()=>s.Shape,ShapeGeometry:()=>s.ShapeGeometry,ShapePath:()=>s.ShapePath,ShapeUtils:()=>s.ShapeUtils,ShortType:()=>s.ShortType,Skeleton:()=>s.Skeleton,SkeletonHelper:()=>s.SkeletonHelper,SkinnedMesh:()=>s.SkinnedMesh,Source:()=>s.Source,Sphere:()=>s.Sphere,SphereGeometry:()=>s.SphereGeometry,Spherical:()=>s.Spherical,SphericalHarmonics3:()=>s.SphericalHarmonics3,SplineCurve:()=>s.SplineCurve,SpotLight:()=>s.SpotLight,SpotLightHelper:()=>s.SpotLightHelper,Sprite:()=>s.Sprite,SpriteMaterial:()=>s.SpriteMaterial,SrcAlphaFactor:()=>s.SrcAlphaFactor,SrcAlphaSaturateFactor:()=>s.SrcAlphaSaturateFactor,SrcColorFactor:()=>s.SrcColorFactor,StaticCopyUsage:()=>s.StaticCopyUsage,StaticDrawUsage:()=>s.StaticDrawUsage,StaticReadUsage:()=>s.StaticReadUsage,StereoCamera:()=>s.StereoCamera,StreamCopyUsage:()=>s.StreamCopyUsage,StreamDrawUsage:()=>s.StreamDrawUsage,StreamReadUsage:()=>s.StreamReadUsage,StringKeyframeTrack:()=>s.StringKeyframeTrack,SubtractEquation:()=>s.SubtractEquation,SubtractiveBlending:()=>s.SubtractiveBlending,TOUCH:()=>s.TOUCH,TangentSpaceNormalMap:()=>s.TangentSpaceNormalMap,TetrahedronGeometry:()=>s.TetrahedronGeometry,Texture:()=>s.Texture,TextureLoader:()=>s.TextureLoader,TextureUtils:()=>s.TextureUtils,TimestampQuery:()=>s.TimestampQuery,TorusGeometry:()=>s.TorusGeometry,TorusKnotGeometry:()=>s.TorusKnotGeometry,Triangle:()=>s.Triangle,TriangleFanDrawMode:()=>s.TriangleFanDrawMode,TriangleStripDrawMode:()=>s.TriangleStripDrawMode,TrianglesDrawMode:()=>s.TrianglesDrawMode,TubeGeometry:()=>s.TubeGeometry,UVMapping:()=>s.UVMapping,Uint16BufferAttribute:()=>s.Uint16BufferAttribute,Uint32BufferAttribute:()=>s.Uint32BufferAttribute,Uint8BufferAttribute:()=>s.Uint8BufferAttribute,Uint8ClampedBufferAttribute:()=>s.Uint8ClampedBufferAttribute,Uniform:()=>s.Uniform,UniformsGroup:()=>s.UniformsGroup,UniformsLib:()=>Wt,UniformsUtils:()=>s.UniformsUtils,UnsignedByteType:()=>s.UnsignedByteType,UnsignedInt248Type:()=>s.UnsignedInt248Type,UnsignedInt5999Type:()=>s.UnsignedInt5999Type,UnsignedIntType:()=>s.UnsignedIntType,UnsignedShort4444Type:()=>s.UnsignedShort4444Type,UnsignedShort5551Type:()=>s.UnsignedShort5551Type,UnsignedShortType:()=>s.UnsignedShortType,VSMShadowMap:()=>s.VSMShadowMap,Vector2:()=>s.Vector2,Vector3:()=>s.Vector3,Vector4:()=>s.Vector4,VectorKeyframeTrack:()=>s.VectorKeyframeTrack,VideoFrameTexture:()=>s.VideoFrameTexture,VideoTexture:()=>s.VideoTexture,WebGL3DRenderTarget:()=>s.WebGL3DRenderTarget,WebGLArrayRenderTarget:()=>s.WebGLArrayRenderTarget,WebGLCoordinateSystem:()=>s.WebGLCoordinateSystem,WebGLCubeRenderTarget:()=>s.WebGLCubeRenderTarget,WebGLRenderTarget:()=>s.WebGLRenderTarget,WebGLRenderer:()=>WebGLRenderer,WebGLUtils:()=>WebGLUtils,WebGPUCoordinateSystem:()=>s.WebGPUCoordinateSystem,WebXRController:()=>s.WebXRController,WireframeGeometry:()=>s.WireframeGeometry,WrapAroundEnding:()=>s.WrapAroundEnding,ZeroCurvatureEnding:()=>s.ZeroCurvatureEnding,ZeroFactor:()=>s.ZeroFactor,ZeroSlopeEnding:()=>s.ZeroSlopeEnding,ZeroStencilOp:()=>s.ZeroStencilOp,createCanvasElement:()=>s.createCanvasElement});var s=r("./node_modules/three/build/three.core.js");
/**
         * @license
         * Copyright 2010-2025 Three.js Authors
         * SPDX-License-Identifier: MIT
         */function WebGLAnimation(){let e=null;let t=false;let n=null;let r=null;function onAnimationFrame(t,s){n(t,s);r=e.requestAnimationFrame(onAnimationFrame)}return{start:function(){if(t!==true&&n!==null){r=e.requestAnimationFrame(onAnimationFrame);t=true}},stop:function(){e.cancelAnimationFrame(r);t=false},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function WebGLAttributes(e){const t=new WeakMap;function createBuffer(t,n){const r=t.array;const s=t.usage;const a=r.byteLength;const o=e.createBuffer();e.bindBuffer(n,o);e.bufferData(n,r,s);t.onUploadCallback();let l;if(r instanceof Float32Array)l=e.FLOAT;else if(r instanceof Uint16Array)l=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)l=e.SHORT;else if(r instanceof Uint32Array)l=e.UNSIGNED_INT;else if(r instanceof Int32Array)l=e.INT;else if(r instanceof Int8Array)l=e.BYTE;else if(r instanceof Uint8Array)l=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);l=e.UNSIGNED_BYTE}return{buffer:o,type:l,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}function updateBuffer(t,n,r){const s=n.array;const a=n.updateRanges;e.bindBuffer(r,t);if(a.length===0)e.bufferSubData(r,0,s);else{a.sort(((e,t)=>e.start-t.start));let t=0;for(let e=1;e<a.length;e++){const n=a[t];const r=a[e];if(r.start<=n.start+n.count+1)n.count=Math.max(n.count,r.start+r.count-n.start);else{++t;a[t]=r}}a.length=t+1;for(let t=0,n=a.length;t<n;t++){const n=a[t];e.bufferSubData(r,n.start*s.BYTES_PER_ELEMENT,s,n.start,n.count)}n.clearUpdateRanges()}n.onUploadCallback()}function get(e){e.isInterleavedBufferAttribute&&(e=e.data);return t.get(e)}function remove(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);if(r){e.deleteBuffer(r.buffer);t.delete(n)}}function update(e,n){e.isInterleavedBufferAttribute&&(e=e.data);if(e.isGLBufferAttribute){const n=t.get(e);(!n||n.version<e.version)&&t.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version});return}const r=t.get(e);if(r===void 0)t.set(e,createBuffer(e,n));else if(r.version<e.version){if(r.size!==e.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");updateBuffer(r.buffer,e,n);r.version=e.version}}return{get:get,remove:remove,update:update}}var a="#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif";var o="#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif";var l="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif";var c="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif";var u="#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif";var h="#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif";var d="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif";var p="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif";var f="#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif";var m="#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif";var g="vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif";var y="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif";var b="float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated";var x="#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif";var _="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif";var M="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif";var w="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif";var S="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif";var T="#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif";var I="#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif";var R="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif";var L="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif";var D="#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif";var P="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated";var F="#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif";var U="vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif";var O="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif";var k="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif";var N="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif";var G="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif";var V="gl_FragColor = linearToOutputTexel( gl_FragColor );";var j="vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}";var H="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif";var z="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif";var W="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif";var q="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif";var K="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif";var X="#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif";var Y="#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif";var J="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif";var Z="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif";var $="#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}";var ee="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif";var te="LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;";var ne="varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert";var re="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif";var ie="#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif";var se="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;";var ae="varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon";var oe="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;";var le="varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong";var ce="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif";var ue="struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}";var he="\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif";var de="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif";var pe="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif";var fe="#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif";var me="#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif";var Ae="#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif";var ge="#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif";var ve="#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif";var ye="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif";var Ce="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif";var Ee="#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif";var be="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif";var xe="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif";var _e="#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif";var Me="#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif";var we="#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif";var Se="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif";var Te="#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif";var Be="float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;";var Ie="#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif";var Re="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif";var Le="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif";var De="#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif";var Pe="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif";var Fe="#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif";var Ue="#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif";var Oe="#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif";var ke="#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif";var Ne="#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );";var Ge="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}";var Ve="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif";var Qe="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;";var je="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif";var He="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif";var ze="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif";var We="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif";var qe="#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif";var Ke="#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif";var Xe="#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif";var Ye="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}";var Je="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif";var Ze="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif";var $e="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif";var et="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif";var tt="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif";var nt="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif";var rt="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif";var it="#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }";var st="#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif";var at="#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif";var ot="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif";var lt="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif";var ct="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif";var ut="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif";const ht="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}";const dt="uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}";const pt="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}";const ft="#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}";const mt="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}";const At="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}";const gt="#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}";const vt="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}";const yt="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}";const Ct="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}";const Et="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}";const bt="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}";const xt="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}";const _t="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}";const Mt="#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}";const wt="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";const St="#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";const Tt="#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";const Bt="#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}";const It="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";const Rt="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}";const Lt="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}";const Dt="#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";const Pt="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";const Ft="#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}";const Ut="#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";const Ot="#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";const kt="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";const Nt="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}";const Gt="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}";const Vt="#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";const Qt="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}";const jt="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}";const Ht="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}";const zt={alphahash_fragment:a,alphahash_pars_fragment:o,alphamap_fragment:l,alphamap_pars_fragment:c,alphatest_fragment:u,alphatest_pars_fragment:h,aomap_fragment:d,aomap_pars_fragment:p,batching_pars_vertex:f,batching_vertex:m,begin_vertex:g,beginnormal_vertex:y,bsdfs:b,iridescence_fragment:x,bumpmap_pars_fragment:_,clipping_planes_fragment:M,clipping_planes_pars_fragment:w,clipping_planes_pars_vertex:S,clipping_planes_vertex:T,color_fragment:I,color_pars_fragment:R,color_pars_vertex:L,color_vertex:D,common:P,cube_uv_reflection_fragment:F,defaultnormal_vertex:U,displacementmap_pars_vertex:O,displacementmap_vertex:k,emissivemap_fragment:N,emissivemap_pars_fragment:G,colorspace_fragment:V,colorspace_pars_fragment:j,envmap_fragment:H,envmap_common_pars_fragment:z,envmap_pars_fragment:W,envmap_pars_vertex:q,envmap_physical_pars_fragment:ie,envmap_vertex:K,fog_vertex:X,fog_pars_vertex:Y,fog_fragment:J,fog_pars_fragment:Z,gradientmap_pars_fragment:$,lightmap_pars_fragment:ee,lights_lambert_fragment:te,lights_lambert_pars_fragment:ne,lights_pars_begin:re,lights_toon_fragment:se,lights_toon_pars_fragment:ae,lights_phong_fragment:oe,lights_phong_pars_fragment:le,lights_physical_fragment:ce,lights_physical_pars_fragment:ue,lights_fragment_begin:he,lights_fragment_maps:de,lights_fragment_end:pe,logdepthbuf_fragment:fe,logdepthbuf_pars_fragment:me,logdepthbuf_pars_vertex:Ae,logdepthbuf_vertex:ge,map_fragment:ve,map_pars_fragment:ye,map_particle_fragment:Ce,map_particle_pars_fragment:Ee,metalnessmap_fragment:be,metalnessmap_pars_fragment:xe,morphinstance_vertex:_e,morphcolor_vertex:Me,morphnormal_vertex:we,morphtarget_pars_vertex:Se,morphtarget_vertex:Te,normal_fragment_begin:Be,normal_fragment_maps:Ie,normal_pars_fragment:Re,normal_pars_vertex:Le,normal_vertex:De,normalmap_pars_fragment:Pe,clearcoat_normal_fragment_begin:Fe,clearcoat_normal_fragment_maps:Ue,clearcoat_pars_fragment:Oe,iridescence_pars_fragment:ke,opaque_fragment:Ne,packing:Ge,premultiplied_alpha_fragment:Ve,project_vertex:Qe,dithering_fragment:je,dithering_pars_fragment:He,roughnessmap_fragment:ze,roughnessmap_pars_fragment:We,shadowmap_pars_fragment:qe,shadowmap_pars_vertex:Ke,shadowmap_vertex:Xe,shadowmask_pars_fragment:Ye,skinbase_vertex:Je,skinning_pars_vertex:Ze,skinning_vertex:$e,skinnormal_vertex:et,specularmap_fragment:tt,specularmap_pars_fragment:nt,tonemapping_fragment:rt,tonemapping_pars_fragment:it,transmission_fragment:st,transmission_pars_fragment:at,uv_pars_fragment:ot,uv_pars_vertex:lt,uv_vertex:ct,worldpos_vertex:ut,background_vert:ht,background_frag:dt,backgroundCube_vert:pt,backgroundCube_frag:ft,cube_vert:mt,cube_frag:At,depth_vert:gt,depth_frag:vt,distanceRGBA_vert:yt,distanceRGBA_frag:Ct,equirect_vert:Et,equirect_frag:bt,linedashed_vert:xt,linedashed_frag:_t,meshbasic_vert:Mt,meshbasic_frag:wt,meshlambert_vert:St,meshlambert_frag:Tt,meshmatcap_vert:Bt,meshmatcap_frag:It,meshnormal_vert:Rt,meshnormal_frag:Lt,meshphong_vert:Dt,meshphong_frag:Pt,meshphysical_vert:Ft,meshphysical_frag:Ut,meshtoon_vert:Ot,meshtoon_frag:kt,points_vert:Nt,points_frag:Gt,shadow_vert:Vt,shadow_frag:Qt,sprite_vert:jt,sprite_frag:Ht};const Wt={common:{diffuse:{value:new s.Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new s.Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new s.Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new s.Matrix3}},envmap:{envMap:{value:null},envMapRotation:{value:new s.Matrix3},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new s.Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new s.Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new s.Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new s.Matrix3},normalScale:{value:new s.Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new s.Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new s.Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new s.Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new s.Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new s.Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new s.Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new s.Matrix3},alphaTest:{value:0},uvTransform:{value:new s.Matrix3}},sprite:{diffuse:{value:new s.Color(16777215)},opacity:{value:1},center:{value:new s.Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new s.Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new s.Matrix3},alphaTest:{value:0}}};const qt={basic:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.fog]),vertexShader:zt.meshbasic_vert,fragmentShader:zt.meshbasic_frag},lambert:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,Wt.lights,{emissive:{value:new s.Color(0)}}]),vertexShader:zt.meshlambert_vert,fragmentShader:zt.meshlambert_frag},phong:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,Wt.lights,{emissive:{value:new s.Color(0)},specular:{value:new s.Color(1118481)},shininess:{value:30}}]),vertexShader:zt.meshphong_vert,fragmentShader:zt.meshphong_frag},standard:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.roughnessmap,Wt.metalnessmap,Wt.fog,Wt.lights,{emissive:{value:new s.Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:zt.meshphysical_vert,fragmentShader:zt.meshphysical_frag},toon:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.gradientmap,Wt.fog,Wt.lights,{emissive:{value:new s.Color(0)}}]),vertexShader:zt.meshtoon_vert,fragmentShader:zt.meshtoon_frag},matcap:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,{matcap:{value:null}}]),vertexShader:zt.meshmatcap_vert,fragmentShader:zt.meshmatcap_frag},points:{uniforms:(0,s.mergeUniforms)([Wt.points,Wt.fog]),vertexShader:zt.points_vert,fragmentShader:zt.points_frag},dashed:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:zt.linedashed_vert,fragmentShader:zt.linedashed_frag},depth:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.displacementmap]),vertexShader:zt.depth_vert,fragmentShader:zt.depth_frag},normal:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,{opacity:{value:1}}]),vertexShader:zt.meshnormal_vert,fragmentShader:zt.meshnormal_frag},sprite:{uniforms:(0,s.mergeUniforms)([Wt.sprite,Wt.fog]),vertexShader:zt.sprite_vert,fragmentShader:zt.sprite_frag},background:{uniforms:{uvTransform:{value:new s.Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:zt.background_vert,fragmentShader:zt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new s.Matrix3}},vertexShader:zt.backgroundCube_vert,fragmentShader:zt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:zt.cube_vert,fragmentShader:zt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:zt.equirect_vert,fragmentShader:zt.equirect_frag},distanceRGBA:{uniforms:(0,s.mergeUniforms)([Wt.common,Wt.displacementmap,{referencePosition:{value:new s.Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:zt.distanceRGBA_vert,fragmentShader:zt.distanceRGBA_frag},shadow:{uniforms:(0,s.mergeUniforms)([Wt.lights,Wt.fog,{color:{value:new s.Color(0)},opacity:{value:1}}]),vertexShader:zt.shadow_vert,fragmentShader:zt.shadow_frag}};qt.physical={uniforms:(0,s.mergeUniforms)([qt.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new s.Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new s.Matrix3},clearcoatNormalScale:{value:new s.Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new s.Matrix3},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new s.Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new s.Matrix3},sheen:{value:0},sheenColor:{value:new s.Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new s.Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new s.Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new s.Matrix3},transmissionSamplerSize:{value:new s.Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new s.Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new s.Color(0)},specularColor:{value:new s.Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new s.Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new s.Matrix3},anisotropyVector:{value:new s.Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new s.Matrix3}}]),vertexShader:zt.meshphysical_vert,fragmentShader:zt.meshphysical_frag};const Kt={r:0,b:0,g:0};const Xt=new s.Euler;const Yt=new s.Matrix4;function WebGLBackground(e,n,r,a,o,l,c){const u=new s.Color(0);let h=l===true?0:1;let d;let p;let f=null;let m=0;let g=null;function getBackground(e){let t=e.isScene===true?e.background:null;if(t&&t.isTexture){const s=e.backgroundBlurriness>0;t=(s?r:n).get(t)}return t}function render(t){let n=false;const r=getBackground(t);if(r===null)setClear(u,h);else if(r&&r.isColor){setClear(r,1);n=true}const s=e.xr.getEnvironmentBlendMode();s==="additive"?a.buffers.color.setClear(0,0,0,1,c):s==="alpha-blend"&&a.buffers.color.setClear(0,0,0,0,c);if(e.autoClear||n){a.buffers.depth.setTest(true);a.buffers.depth.setMask(true);a.buffers.color.setMask(true);e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)}}function addToRenderList(n,r){const a=getBackground(r);if(a&&(a.isCubeTexture||a.mapping===s.CubeUVReflectionMapping)){if(p===void 0){p=new s.Mesh(new s.BoxGeometry(1e4,1e4,1e4),new s.ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:(0,s.cloneUniforms)(qt.backgroundCube.uniforms),vertexShader:qt.backgroundCube.vertexShader,fragmentShader:qt.backgroundCube.fragmentShader,side:s.BackSide,depthTest:false,depthWrite:false,fog:false}));p.geometry.deleteAttribute("normal");p.geometry.deleteAttribute("uv");p.onBeforeRender=function(e,n,r){(this||t).matrixWorld.copyPosition(r.matrixWorld)};Object.defineProperty(p.material,"envMap",{get:function(){return(this||t).uniforms.envMap.value}});o.update(p)}Xt.copy(r.backgroundRotation);Xt.x*=-1;Xt.y*=-1;Xt.z*=-1;if(a.isCubeTexture&&a.isRenderTargetTexture===false){Xt.y*=-1;Xt.z*=-1}p.material.uniforms.envMap.value=a;p.material.uniforms.flipEnvMap.value=a.isCubeTexture&&a.isRenderTargetTexture===false?-1:1;p.material.uniforms.backgroundBlurriness.value=r.backgroundBlurriness;p.material.uniforms.backgroundIntensity.value=r.backgroundIntensity;p.material.uniforms.backgroundRotation.value.setFromMatrix4(Yt.makeRotationFromEuler(Xt));p.material.toneMapped=s.ColorManagement.getTransfer(a.colorSpace)!==s.SRGBTransfer;if(f!==a||m!==a.version||g!==e.toneMapping){p.material.needsUpdate=true;f=a;m=a.version;g=e.toneMapping}p.layers.enableAll();n.unshift(p,p.geometry,p.material,0,0,null)}else if(a&&a.isTexture){if(d===void 0){d=new s.Mesh(new s.PlaneGeometry(2,2),new s.ShaderMaterial({name:"BackgroundMaterial",uniforms:(0,s.cloneUniforms)(qt.background.uniforms),vertexShader:qt.background.vertexShader,fragmentShader:qt.background.fragmentShader,side:s.FrontSide,depthTest:false,depthWrite:false,fog:false}));d.geometry.deleteAttribute("normal");Object.defineProperty(d.material,"map",{get:function(){return(this||t).uniforms.t2D.value}});o.update(d)}d.material.uniforms.t2D.value=a;d.material.uniforms.backgroundIntensity.value=r.backgroundIntensity;d.material.toneMapped=s.ColorManagement.getTransfer(a.colorSpace)!==s.SRGBTransfer;a.matrixAutoUpdate===true&&a.updateMatrix();d.material.uniforms.uvTransform.value.copy(a.matrix);if(f!==a||m!==a.version||g!==e.toneMapping){d.material.needsUpdate=true;f=a;m=a.version;g=e.toneMapping}d.layers.enableAll();n.unshift(d,d.geometry,d.material,0,0,null)}}function setClear(t,n){t.getRGB(Kt,(0,s.getUnlitUniformColorSpace)(e));a.buffers.color.setClear(Kt.r,Kt.g,Kt.b,n,c)}function dispose(){if(p!==void 0){p.geometry.dispose();p.material.dispose();p=void 0}if(d!==void 0){d.geometry.dispose();d.material.dispose();d=void 0}}return{getClearColor:function(){return u},setClearColor:function(e,t=1){u.set(e);h=t;setClear(u,h)},getClearAlpha:function(){return h},setClearAlpha:function(e){h=e;setClear(u,h)},render:render,addToRenderList:addToRenderList,dispose:dispose}}function WebGLBindingStates(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS);const r={};const a=createBindingState(null);let o=a;let l=false;function setup(n,r,s,a,c){let u=false;const h=getBindingState(a,s,r);if(o!==h){o=h;bindVertexArrayObject(o.object)}u=needsUpdate(n,a,s,c);u&&saveCache(n,a,s,c);c!==null&&t.update(c,e.ELEMENT_ARRAY_BUFFER);if(u||l){l=false;setupVertexAttributes(n,r,s,a);c!==null&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(c).buffer)}}function createVertexArrayObject(){return e.createVertexArray()}function bindVertexArrayObject(t){return e.bindVertexArray(t)}function deleteVertexArrayObject(t){return e.deleteVertexArray(t)}function getBindingState(e,t,n){const s=n.wireframe===true;let a=r[e.id];if(a===void 0){a={};r[e.id]=a}let o=a[t.id];if(o===void 0){o={};a[t.id]=o}let l=o[s];if(l===void 0){l=createBindingState(createVertexArrayObject());o[s]=l}return l}function createBindingState(e){const t=[];const r=[];const s=[];for(let e=0;e<n;e++){t[e]=0;r[e]=0;s[e]=0}return{geometry:null,program:null,wireframe:false,newAttributes:t,enabledAttributes:r,attributeDivisors:s,object:e,attributes:{},index:null}}function needsUpdate(e,t,n,r){const s=o.attributes;const a=t.attributes;let l=0;const c=n.getAttributes();for(const t in c){const n=c[t];if(n.location>=0){const n=s[t];let r=a[t];if(r===void 0){t==="instanceMatrix"&&e.instanceMatrix&&(r=e.instanceMatrix);t==="instanceColor"&&e.instanceColor&&(r=e.instanceColor)}if(n===void 0)return true;if(n.attribute!==r)return true;if(r&&n.data!==r.data)return true;l++}}return o.attributesNum!==l||o.index!==r}function saveCache(e,t,n,r){const s={};const a=t.attributes;let l=0;const c=n.getAttributes();for(const t in c){const n=c[t];if(n.location>=0){let n=a[t];if(n===void 0){t==="instanceMatrix"&&e.instanceMatrix&&(n=e.instanceMatrix);t==="instanceColor"&&e.instanceColor&&(n=e.instanceColor)}const r={};r.attribute=n;n&&n.data&&(r.data=n.data);s[t]=r;l++}}o.attributes=s;o.attributesNum=l;o.index=r}function initAttributes(){const e=o.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function enableAttribute(e){enableAttributeAndDivisor(e,0)}function enableAttributeAndDivisor(t,n){const r=o.newAttributes;const s=o.enabledAttributes;const a=o.attributeDivisors;r[t]=1;if(s[t]===0){e.enableVertexAttribArray(t);s[t]=1}if(a[t]!==n){e.vertexAttribDivisor(t,n);a[t]=n}}function disableUnusedAttributes(){const t=o.newAttributes;const n=o.enabledAttributes;for(let r=0,s=n.length;r<s;r++)if(n[r]!==t[r]){e.disableVertexAttribArray(r);n[r]=0}}function vertexAttribPointer(t,n,r,s,a,o,l){l===true?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,s,a,o)}function setupVertexAttributes(n,r,a,o){initAttributes();const l=o.attributes;const c=a.getAttributes();const u=r.defaultAttributeValues;for(const r in c){const a=c[r];if(a.location>=0){let c=l[r];if(c===void 0){r==="instanceMatrix"&&n.instanceMatrix&&(c=n.instanceMatrix);r==="instanceColor"&&n.instanceColor&&(c=n.instanceColor)}if(c!==void 0){const r=c.normalized;const l=c.itemSize;const u=t.get(c);if(u===void 0)continue;const h=u.buffer;const d=u.type;const p=u.bytesPerElement;const f=d===e.INT||d===e.UNSIGNED_INT||c.gpuType===s.IntType;if(c.isInterleavedBufferAttribute){const t=c.data;const s=t.stride;const u=c.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<a.locationSize;e++)enableAttributeAndDivisor(a.location+e,t.meshPerAttribute);n.isInstancedMesh!==true&&o._maxInstanceCount===void 0&&(o._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<a.locationSize;e++)enableAttribute(a.location+e);e.bindBuffer(e.ARRAY_BUFFER,h);for(let e=0;e<a.locationSize;e++)vertexAttribPointer(a.location+e,l/a.locationSize,d,r,s*p,(u+l/a.locationSize*e)*p,f)}else{if(c.isInstancedBufferAttribute){for(let e=0;e<a.locationSize;e++)enableAttributeAndDivisor(a.location+e,c.meshPerAttribute);n.isInstancedMesh!==true&&o._maxInstanceCount===void 0&&(o._maxInstanceCount=c.meshPerAttribute*c.count)}else for(let e=0;e<a.locationSize;e++)enableAttribute(a.location+e);e.bindBuffer(e.ARRAY_BUFFER,h);for(let e=0;e<a.locationSize;e++)vertexAttribPointer(a.location+e,l/a.locationSize,d,r,l*p,l/a.locationSize*e*p,f)}}else if(u!==void 0){const t=u[r];if(t!==void 0)switch(t.length){case 2:e.vertexAttrib2fv(a.location,t);break;case 3:e.vertexAttrib3fv(a.location,t);break;case 4:e.vertexAttrib4fv(a.location,t);break;default:e.vertexAttrib1fv(a.location,t)}}}}disableUnusedAttributes()}function dispose(){reset();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n){deleteVertexArrayObject(n[e].object);delete n[e]}delete t[e]}delete r[e]}}function releaseStatesOfGeometry(e){if(r[e.id]===void 0)return;const t=r[e.id];for(const e in t){const n=t[e];for(const e in n){deleteVertexArrayObject(n[e].object);delete n[e]}delete t[e]}delete r[e.id]}function releaseStatesOfProgram(e){for(const t in r){const n=r[t];if(n[e.id]===void 0)continue;const s=n[e.id];for(const e in s){deleteVertexArrayObject(s[e].object);delete s[e]}delete n[e.id]}}function reset(){resetDefaultState();l=true;if(o!==a){o=a;bindVertexArrayObject(o.object)}}function resetDefaultState(){a.geometry=null;a.program=null;a.wireframe=false}return{setup:setup,reset:reset,resetDefaultState:resetDefaultState,dispose:dispose,releaseStatesOfGeometry:releaseStatesOfGeometry,releaseStatesOfProgram:releaseStatesOfProgram,initAttributes:initAttributes,enableAttribute:enableAttribute,disableUnusedAttributes:disableUnusedAttributes}}function WebGLBufferRenderer(e,n,r){let s;function setMode(e){s=e}function render(t,n){e.drawArrays(s,t,n);r.update(n,s,1)}function renderInstances(t,n,a){if(a!==0){e.drawArraysInstanced(s,t,n,a);r.update(n,s,a)}}function renderMultiDraw(e,t,a){if(a===0)return;const o=n.get("WEBGL_multi_draw");o.multiDrawArraysWEBGL(s,e,0,t,0,a);let l=0;for(let e=0;e<a;e++)l+=t[e];r.update(l,s,1)}function renderMultiDrawInstances(e,t,a,o){if(a===0)return;const l=n.get("WEBGL_multi_draw");if(l===null)for(let n=0;n<e.length;n++)renderInstances(e[n],t[n],o[n]);else{l.multiDrawArraysInstancedWEBGL(s,e,0,t,0,o,0,a);let n=0;for(let e=0;e<a;e++)n+=t[e]*o[e];r.update(n,s,1)}}(this||t).setMode=setMode;(this||t).render=render;(this||t).renderInstances=renderInstances;(this||t).renderMultiDraw=renderMultiDraw;(this||t).renderMultiDrawInstances=renderMultiDrawInstances}function WebGLCapabilities(e,t,n,r){let a;function getMaxAnisotropy(){if(a!==void 0)return a;if(t.has("EXT_texture_filter_anisotropic")===true){const n=t.get("EXT_texture_filter_anisotropic");a=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function textureFormatReadable(t){return t===s.RGBAFormat||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)}function textureTypeReadable(n){const a=n===s.HalfFloatType&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==s.UnsignedByteType&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==s.FloatType&&!a)}function getMaxPrecision(t){if(t==="highp"){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return t==="mediump"&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=n.precision!==void 0?n.precision:"highp";const l=getMaxPrecision(o);if(l!==o){console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead.");o=l}const c=n.logarithmicDepthBuffer===true;const u=n.reverseDepthBuffer===true&&t.has("EXT_clip_control");const h=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);const d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);const p=e.getParameter(e.MAX_TEXTURE_SIZE);const f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE);const m=e.getParameter(e.MAX_VERTEX_ATTRIBS);const g=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS);const y=e.getParameter(e.MAX_VARYING_VECTORS);const b=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);const x=d>0;const _=e.getParameter(e.MAX_SAMPLES);return{isWebGL2:true,getMaxAnisotropy:getMaxAnisotropy,getMaxPrecision:getMaxPrecision,textureFormatReadable:textureFormatReadable,textureTypeReadable:textureTypeReadable,precision:o,logarithmicDepthBuffer:c,reverseDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:y,maxFragmentUniforms:b,vertexTextures:x,maxSamples:_}}function WebGLClipping(e){const n=this||t;let r=null,a=0,o=false,l=false;const c=new s.Plane,u=new s.Matrix3,h={value:null,needsUpdate:false};(this||t).uniform=h;(this||t).numPlanes=0;(this||t).numIntersection=0;(this||t).init=function(e,t){const n=e.length!==0||t||a!==0||o;o=t;a=e.length;return n};(this||t).beginShadows=function(){l=true;projectPlanes(null)};(this||t).endShadows=function(){l=false};(this||t).setGlobalState=function(e,t){r=projectPlanes(e,t,0)};(this||t).setState=function(n,s,c){const u=n.clippingPlanes,d=n.clipIntersection,p=n.clipShadows;const f=e.get(n);if(!o||u===null||u.length===0||l&&!p)l?projectPlanes(null):resetGlobalState();else{const e=l?0:a,n=e*4;let o=f.clippingState||null;h.value=o;o=projectPlanes(u,s,n,c);for(let e=0;e!==n;++e)o[e]=r[e];f.clippingState=o;(this||t).numIntersection=d?(this||t).numPlanes:0;(this||t).numPlanes+=e}};function resetGlobalState(){if(h.value!==r){h.value=r;h.needsUpdate=a>0}n.numPlanes=a;n.numIntersection=0}function projectPlanes(e,t,r,s){const a=e!==null?e.length:0;let o=null;if(a!==0){o=h.value;if(s!==true||o===null){const n=r+a*4,s=t.matrixWorldInverse;u.getNormalMatrix(s);(o===null||o.length<n)&&(o=new Float32Array(n));for(let t=0,n=r;t!==a;++t,n+=4){c.copy(e[t]).applyMatrix4(s,u);c.normal.toArray(o,n);o[n+3]=c.constant}}h.value=o;h.needsUpdate=true}n.numPlanes=a;n.numIntersection=0;return o}}function WebGLCubeMaps(e){let t=new WeakMap;function mapTextureMapping(e,t){t===s.EquirectangularReflectionMapping?e.mapping=s.CubeReflectionMapping:t===s.EquirectangularRefractionMapping&&(e.mapping=s.CubeRefractionMapping);return e}function get(n){if(n&&n.isTexture){const r=n.mapping;if(r===s.EquirectangularReflectionMapping||r===s.EquirectangularRefractionMapping){if(t.has(n)){const e=t.get(n).texture;return mapTextureMapping(e,n.mapping)}{const r=n.image;if(r&&r.height>0){const a=new s.WebGLCubeRenderTarget(r.height);a.fromEquirectangularTexture(e,n);t.set(n,a);n.addEventListener("dispose",onTextureDispose);return mapTextureMapping(a.texture,n.mapping)}return null}}}return n}function onTextureDispose(e){const n=e.target;n.removeEventListener("dispose",onTextureDispose);const r=t.get(n);if(r!==void 0){t.delete(n);r.dispose()}}function dispose(){t=new WeakMap}return{get:get,dispose:dispose}}const Jt=4;const Zt=[.125,.215,.35,.446,.526,.582];const $t=20;const en=new s.OrthographicCamera;const tn=new s.Color;let nn=null;let rn=0;let sn=0;let an=false;const on=(1+Math.sqrt(5))/2;const ln=1/on;const cn=[new s.Vector3(-on,ln,0),new s.Vector3(on,ln,0),new s.Vector3(-ln,0,on),new s.Vector3(ln,0,on),new s.Vector3(0,on,-ln),new s.Vector3(0,on,ln),new s.Vector3(-1,1,-1),new s.Vector3(1,1,-1),new s.Vector3(-1,1,1),new s.Vector3(1,1,1)];class PMREMGenerator{constructor(e){this._renderer=e;this._pingPongRenderTarget=null;this._lodMax=0;this._cubeSize=0;this._lodPlanes=[];this._sizeLods=[];this._sigmas=[];this._blurMaterial=null;this._cubemapMaterial=null;this._equirectMaterial=null;this._compileMaterial(this._blurMaterial)}
/**
            * Generates a PMREM from a supplied Scene, which can be faster than using an
            * image if networking bandwidth is low. Optional sigma specifies a blur radius
            * in radians to be applied to the scene before PMREM generation. Optional near
            * and far planes ensure the scene is rendered in its entirety (the cubeCamera
            * is placed at the origin).
            *
            * @param {Scene} scene
            * @param {number} sigma
            * @param {number} near
            * @param {number} far
            * @return {WebGLRenderTarget}
            */fromScene(e,t=0,n=.1,r=100){nn=this._renderer.getRenderTarget();rn=this._renderer.getActiveCubeFace();sn=this._renderer.getActiveMipmapLevel();an=this._renderer.xr.enabled;this._renderer.xr.enabled=false;this._setSize(256);const s=this._allocateTargets();s.depthBuffer=true;this._sceneToCubeUV(e,n,r,s);t>0&&this._blur(s,0,0,t);this._applyPMREM(s);this._cleanup(s);return s}
/**
            * Generates a PMREM from an equirectangular texture, which can be either LDR
            * or HDR. The ideal input image size is 1k (1024 x 512),
            * as this matches best with the 256 x 256 cubemap output.
            * The smallest supported equirectangular image size is 64 x 32.
            *
            * @param {Texture} equirectangular
            * @param {WebGLRenderTarget} [renderTarget=null] - Optional render target.
            * @return {WebGLRenderTarget}
            */fromEquirectangular(e,t=null){return this._fromTexture(e,t)}
/**
            * Generates a PMREM from an cubemap texture, which can be either LDR
            * or HDR. The ideal input cube size is 256 x 256,
            * as this matches best with the 256 x 256 cubemap output.
            * The smallest supported cube size is 16 x 16.
            *
            * @param {Texture} cubemap
            * @param {null} [renderTarget=null] - Optional render target.
            * @return {WebGLRenderTarget}
            */fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){if(this._cubemapMaterial===null){this._cubemapMaterial=_getCubemapMaterial();this._compileMaterial(this._cubemapMaterial)}}compileEquirectangularShader(){if(this._equirectMaterial===null){this._equirectMaterial=_getEquirectMaterial();this._compileMaterial(this._equirectMaterial)}}dispose(){this._dispose();this._cubemapMaterial!==null&&this._cubemapMaterial.dispose();this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e));this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose();this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(nn,rn,sn);this._renderer.xr.enabled=an;e.scissorTest=false;_setViewport(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===s.CubeReflectionMapping||e.mapping===s.CubeRefractionMapping?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4);nn=this._renderer.getRenderTarget();rn=this._renderer.getActiveCubeFace();sn=this._renderer.getActiveMipmapLevel();an=this._renderer.xr.enabled;this._renderer.xr.enabled=false;const n=t||this._allocateTargets();this._textureToCubeUV(e,n);this._applyPMREM(n);this._cleanup(n);return n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112);const t=4*this._cubeSize;const n={magFilter:s.LinearFilter,minFilter:s.LinearFilter,generateMipmaps:false,type:s.HalfFloatType,format:s.RGBAFormat,colorSpace:s.LinearSRGBColorSpace,depthBuffer:false};const r=_createRenderTarget(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose();this._pingPongRenderTarget=_createRenderTarget(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(r));this._blurMaterial=_getBlurShader(r,e,t)}return r}_compileMaterial(e){const t=new s.Mesh(this._lodPlanes[0],e);this._renderer.compile(t,en)}_sceneToCubeUV(e,t,n,r){const a=90;const o=1;const l=new s.PerspectiveCamera(a,o,t,n);const c=[1,-1,1,1,1,1];const u=[1,1,1,-1,-1,-1];const h=this._renderer;const d=h.autoClear;const p=h.toneMapping;h.getClearColor(tn);h.toneMapping=s.NoToneMapping;h.autoClear=false;const f=new s.MeshBasicMaterial({name:"PMREM.Background",side:s.BackSide,depthWrite:false,depthTest:false});const m=new s.Mesh(new s.BoxGeometry,f);let g=false;const y=e.background;if(y){if(y.isColor){f.color.copy(y);e.background=null;g=true}}else{f.color.copy(tn);g=true}for(let t=0;t<6;t++){const n=t%3;if(n===0){l.up.set(0,c[t],0);l.lookAt(u[t],0,0)}else if(n===1){l.up.set(0,0,c[t]);l.lookAt(0,u[t],0)}else{l.up.set(0,c[t],0);l.lookAt(0,0,u[t])}const s=this._cubeSize;_setViewport(r,n*s,t>2?s:0,s,s);h.setRenderTarget(r);g&&h.render(m,l);h.render(e,l)}m.geometry.dispose();m.material.dispose();h.toneMapping=p;h.autoClear=d;e.background=y}_textureToCubeUV(e,t){const n=this._renderer;const r=e.mapping===s.CubeReflectionMapping||e.mapping===s.CubeRefractionMapping;if(r){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial());this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===false?-1:1}else this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const a=r?this._cubemapMaterial:this._equirectMaterial;const o=new s.Mesh(this._lodPlanes[0],a);const l=a.uniforms;l.envMap.value=e;const c=this._cubeSize;_setViewport(t,0,0,3*c,2*c);n.setRenderTarget(t);n.render(o,en)}_applyPMREM(e){const t=this._renderer;const n=t.autoClear;t.autoClear=false;const r=this._lodPlanes.length;for(let t=1;t<r;t++){const n=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]);const s=cn[(r-t-1)%cn.length];this._blur(e,t-1,t,n,s)}t.autoClear=n}
/**
            * This is a two-pass Gaussian blur for a cubemap. Normally this is done
            * vertically and horizontally, but this breaks down on a cube. Here we apply
            * the blur latitudinally (around the poles), and then longitudinally (towards
            * the poles) to approximate the orthogonally-separable blur. It is least
            * accurate at the poles, but still does a decent job.
            *
            * @param {WebGLRenderTarget} cubeUVRenderTarget
            * @param {number} lodIn
            * @param {number} lodOut
            * @param {number} sigma
            * @param {Vector3} [poleAxis]
            */_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s);this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,a,o,l){const c=this._renderer;const u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3;const d=new s.Mesh(this._lodPlanes[r],u);const p=u.uniforms;const f=this._sizeLods[n]-1;const m=isFinite(a)?Math.PI/(2*f):2*Math.PI/(2*$t-1);const g=a/m;const y=isFinite(a)?1+Math.floor(h*g):$t;y>$t&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${$t}`);const b=[];let x=0;for(let e=0;e<$t;++e){const t=e/g;const n=Math.exp(-t*t/2);b.push(n);e===0?x+=n:e<y&&(x+=2*n)}for(let e=0;e<b.length;e++)b[e]=b[e]/x;p.envMap.value=e.texture;p.samples.value=y;p.weights.value=b;p.latitudinal.value=o==="latitudinal";l&&(p.poleAxis.value=l);const{_lodMax:_}=this;p.dTheta.value=m;p.mipInt.value=_-n;const M=this._sizeLods[r];const w=3*M*(r>_-Jt?r-_+Jt:0);const S=4*(this._cubeSize-M);_setViewport(t,w,S,3*M,2*M);c.setRenderTarget(t);c.render(d,en)}}function _createPlanes(e){const t=[];const n=[];const r=[];let a=e;const o=e-Jt+1+Zt.length;for(let l=0;l<o;l++){const o=Math.pow(2,a);n.push(o);let c=1/o;l>e-Jt?c=Zt[l-e+Jt-1]:l===0&&(c=0);r.push(c);const u=1/(o-2);const h=-u;const d=1+u;const p=[h,h,d,h,d,d,h,h,d,d,h,d];const f=6;const m=6;const g=3;const y=2;const b=1;const x=new Float32Array(g*m*f);const _=new Float32Array(y*m*f);const M=new Float32Array(b*m*f);for(let e=0;e<f;e++){const t=e%3*2/3-1;const n=e>2?0:-1;const r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];x.set(r,g*m*e);_.set(p,y*m*e);const s=[e,e,e,e,e,e];M.set(s,b*m*e)}const w=new s.BufferGeometry;w.setAttribute("position",new s.BufferAttribute(x,g));w.setAttribute("uv",new s.BufferAttribute(_,y));w.setAttribute("faceIndex",new s.BufferAttribute(M,b));t.push(w);a>Jt&&a--}return{lodPlanes:t,sizeLods:n,sigmas:r}}function _createRenderTarget(e,t,n){const r=new s.WebGLRenderTarget(e,t,n);r.texture.mapping=s.CubeUVReflectionMapping;r.texture.name="PMREM.cubeUv";r.scissorTest=true;return r}function _setViewport(e,t,n,r,s){e.viewport.set(t,n,r,s);e.scissor.set(t,n,r,s)}function _getBlurShader(e,t,n){const r=new Float32Array($t);const a=new s.Vector3(0,1,0);const o=new s.ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:$t,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:false},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:_getCommonVertexShader(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:s.NoBlending,depthTest:false,depthWrite:false});return o}function _getEquirectMaterial(){return new s.ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:s.NoBlending,depthTest:false,depthWrite:false})}function _getCubemapMaterial(){return new s.ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:s.NoBlending,depthTest:false,depthWrite:false})}function _getCommonVertexShader(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function WebGLCubeUVMaps(e){let t=new WeakMap;let n=null;function get(r){if(r&&r.isTexture){const a=r.mapping;const o=a===s.EquirectangularReflectionMapping||a===s.EquirectangularRefractionMapping;const l=a===s.CubeReflectionMapping||a===s.CubeRefractionMapping;if(o||l){let s=t.get(r);const a=s!==void 0?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==a){n===null&&(n=new PMREMGenerator(e));s=o?n.fromEquirectangular(r,s):n.fromCubemap(r,s);s.texture.pmremVersion=r.pmremVersion;t.set(r,s);return s.texture}if(s!==void 0)return s.texture;{const a=r.image;if(o&&a&&a.height>0||l&&a&&isCubeTextureComplete(a)){n===null&&(n=new PMREMGenerator(e));s=o?n.fromEquirectangular(r):n.fromCubemap(r);s.texture.pmremVersion=r.pmremVersion;t.set(r,s);r.addEventListener("dispose",onTextureDispose);return s.texture}return null}}}return r}function isCubeTextureComplete(e){let t=0;const n=6;for(let r=0;r<n;r++)e[r]!==void 0&&t++;return t===n}function onTextureDispose(e){const n=e.target;n.removeEventListener("dispose",onTextureDispose);const r=t.get(n);if(r!==void 0){t.delete(n);r.dispose()}}function dispose(){t=new WeakMap;if(n!==null){n.dispose();n=null}}return{get:get,dispose:dispose}}function WebGLExtensions(e){const t={};function getExtension(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}t[n]=r;return r}return{has:function(e){return getExtension(e)!==null},init:function(){getExtension("EXT_color_buffer_float");getExtension("WEBGL_clip_cull_distance");getExtension("OES_texture_float_linear");getExtension("EXT_color_buffer_half_float");getExtension("WEBGL_multisampled_render_to_texture");getExtension("WEBGL_render_shared_exponent")},get:function(e){const t=getExtension(e);t===null&&(0,s.warnOnce)("THREE.WebGLRenderer: "+e+" extension not supported.");return t}}}function WebGLGeometries(e,t,n,r){const a={};const o=new WeakMap;function onGeometryDispose(e){const s=e.target;s.index!==null&&t.remove(s.index);for(const e in s.attributes)t.remove(s.attributes[e]);s.removeEventListener("dispose",onGeometryDispose);delete a[s.id];const l=o.get(s);if(l){t.remove(l);o.delete(s)}r.releaseStatesOfGeometry(s);s.isInstancedBufferGeometry===true&&delete s._maxInstanceCount;n.memory.geometries--}function get(e,t){if(a[t.id]===true)return t;t.addEventListener("dispose",onGeometryDispose);a[t.id]=true;n.memory.geometries++;return t}function update(n){const r=n.attributes;for(const n in r)t.update(r[n],e.ARRAY_BUFFER)}function updateWireframeAttribute(e){const n=[];const r=e.index;const a=e.attributes.position;let l=0;if(r!==null){const e=r.array;l=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0];const s=e[t+1];const a=e[t+2];n.push(r,s,s,a,a,r)}}else{if(a===void 0)return;{const e=a.array;l=a.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0;const r=t+1;const s=t+2;n.push(e,r,r,s,s,e)}}}const c=new((0,s.arrayNeedsUint32)(n)?s.Uint32BufferAttribute:s.Uint16BufferAttribute)(n,1);c.version=l;const u=o.get(e);u&&t.remove(u);o.set(e,c)}function getWireframeAttribute(e){const t=o.get(e);if(t){const n=e.index;n!==null&&t.version<n.version&&updateWireframeAttribute(e)}else updateWireframeAttribute(e);return o.get(e)}return{get:get,update:update,getWireframeAttribute:getWireframeAttribute}}function WebGLIndexedBufferRenderer(e,n,r){let s;function setMode(e){s=e}let a,o;function setIndex(e){a=e.type;o=e.bytesPerElement}function render(t,n){e.drawElements(s,n,a,t*o);r.update(n,s,1)}function renderInstances(t,n,l){if(l!==0){e.drawElementsInstanced(s,n,a,t*o,l);r.update(n,s,l)}}function renderMultiDraw(e,t,o){if(o===0)return;const l=n.get("WEBGL_multi_draw");l.multiDrawElementsWEBGL(s,t,0,a,e,0,o);let c=0;for(let e=0;e<o;e++)c+=t[e];r.update(c,s,1)}function renderMultiDrawInstances(e,t,l,c){if(l===0)return;const u=n.get("WEBGL_multi_draw");if(u===null)for(let n=0;n<e.length;n++)renderInstances(e[n]/o,t[n],c[n]);else{u.multiDrawElementsInstancedWEBGL(s,t,0,a,e,0,c,0,l);let n=0;for(let e=0;e<l;e++)n+=t[e]*c[e];r.update(n,s,1)}}(this||t).setMode=setMode;(this||t).setIndex=setIndex;(this||t).render=render;(this||t).renderInstances=renderInstances;(this||t).renderMultiDraw=renderMultiDraw;(this||t).renderMultiDrawInstances=renderMultiDrawInstances}function WebGLInfo(e){const t={geometries:0,textures:0};const n={frame:0,calls:0,triangles:0,points:0,lines:0};function update(t,r,s){n.calls++;switch(r){case e.TRIANGLES:n.triangles+=s*(t/3);break;case e.LINES:n.lines+=s*(t/2);break;case e.LINE_STRIP:n.lines+=s*(t-1);break;case e.LINE_LOOP:n.lines+=s*t;break;case e.POINTS:n.points+=s*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r);break}}function reset(){n.calls=0;n.triangles=0;n.points=0;n.lines=0}return{memory:t,render:n,programs:null,autoReset:true,reset:reset,update:update}}function WebGLMorphtargets(e,t,n){const r=new WeakMap;const a=new s.Vector4;function update(o,l,c){const u=o.morphTargetInfluences;const h=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color;const d=h!==void 0?h.length:0;let p=r.get(l);if(p===void 0||p.count!==d){p!==void 0&&p.texture.dispose();const f=l.morphAttributes.position!==void 0;const m=l.morphAttributes.normal!==void 0;const g=l.morphAttributes.color!==void 0;const y=l.morphAttributes.position||[];const b=l.morphAttributes.normal||[];const x=l.morphAttributes.color||[];let _=0;f===true&&(_=1);m===true&&(_=2);g===true&&(_=3);let M=l.attributes.position.count*_;let w=1;if(M>t.maxTextureSize){w=Math.ceil(M/t.maxTextureSize);M=t.maxTextureSize}const S=new Float32Array(M*w*4*d);const T=new s.DataArrayTexture(S,M,w,d);T.type=s.FloatType;T.needsUpdate=true;const I=_*4;for(let R=0;R<d;R++){const L=y[R];const D=b[R];const P=x[R];const F=M*w*4*R;for(let U=0;U<L.count;U++){const O=U*I;if(f===true){a.fromBufferAttribute(L,U);S[F+O+0]=a.x;S[F+O+1]=a.y;S[F+O+2]=a.z;S[F+O+3]=0}if(m===true){a.fromBufferAttribute(D,U);S[F+O+4]=a.x;S[F+O+5]=a.y;S[F+O+6]=a.z;S[F+O+7]=0}if(g===true){a.fromBufferAttribute(P,U);S[F+O+8]=a.x;S[F+O+9]=a.y;S[F+O+10]=a.z;S[F+O+11]=P.itemSize===4?a.w:1}}}p={count:d,texture:T,size:new s.Vector2(M,w)};r.set(l,p);function disposeTexture(){T.dispose();r.delete(l);l.removeEventListener("dispose",disposeTexture)}l.addEventListener("dispose",disposeTexture)}if(o.isInstancedMesh===true&&o.morphTexture!==null)c.getUniforms().setValue(e,"morphTexture",o.morphTexture,n);else{let k=0;for(let G=0;G<u.length;G++)k+=u[G];const N=l.morphTargetsRelative?1:1-k;c.getUniforms().setValue(e,"morphTargetBaseInfluence",N);c.getUniforms().setValue(e,"morphTargetInfluences",u)}c.getUniforms().setValue(e,"morphTargetsTexture",p.texture,n);c.getUniforms().setValue(e,"morphTargetsTextureSize",p.size)}return{update:update}}class WebGLMultiview{constructor(e,t,n){this.renderer=e;this.DEFAULT_NUMVIEWS=2;this.maxNumViews=0;this.gl=n;this.extensions=t;this.available=this.extensions.has("OCULUS_multiview");if(this.available){const e=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(e.MAX_VIEWS_OVR);this.mat4=[];this.mat3=[];this.cameraArray=[];for(var r=0;r<this.maxNumViews;r++){this.mat4[r]=new s.Matrix4;this.mat3[r]=new s.Matrix3}}}getCameraArray(e){if(e.isArrayCamera)return e.cameras;this.cameraArray[0]=e;return this.cameraArray}updateCameraProjectionMatricesUniform(e,t){var n=this.getCameraArray(e);for(var r=0;r<n.length;r++)this.mat4[r].copy(n[r].projectionMatrix);t.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(e,t){var n=this.getCameraArray(e);for(var r=0;r<n.length;r++)this.mat4[r].copy(n[r].matrixWorldInverse);t.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(e,t,n){var r=this.getCameraArray(t);for(var s=0;s<r.length;s++){this.mat4[s].multiplyMatrices(r[s].matrixWorldInverse,e.matrixWorld);this.mat3[s].getNormalMatrix(this.mat4[s])}n.setValue(this.gl,"modelViewMatrices",this.mat4);n.setValue(this.gl,"normalMatrices",this.mat3)}}function WebGLObjects(e,t,n,r){let s=new WeakMap;function update(a){const o=r.render.frame;const l=a.geometry;const c=t.get(a,l);if(s.get(c)!==o){t.update(c);s.set(c,o)}if(a.isInstancedMesh){a.hasEventListener("dispose",onInstancedMeshDispose)===false&&a.addEventListener("dispose",onInstancedMeshDispose);if(s.get(a)!==o){n.update(a.instanceMatrix,e.ARRAY_BUFFER);a.instanceColor!==null&&n.update(a.instanceColor,e.ARRAY_BUFFER);s.set(a,o)}}if(a.isSkinnedMesh){const e=a.skeleton;if(s.get(e)!==o){e.update();s.set(e,o)}}return c}function dispose(){s=new WeakMap}function onInstancedMeshDispose(e){const t=e.target;t.removeEventListener("dispose",onInstancedMeshDispose);n.remove(t.instanceMatrix);t.instanceColor!==null&&n.remove(t.instanceColor)}return{update:update,dispose:dispose}}const un=new s.Texture;const hn=new s.DepthTexture(1,1);const dn=new s.DataArrayTexture;const pn=new s.Data3DTexture;const fn=new s.CubeTexture;const mn=[];const An=[];const gn=new Float32Array(16);const vn=new Float32Array(9);const yn=new Float32Array(4);function flatten(e,t,n){const r=e[0];if(r<=0||r>0)return e;const s=t*n;let a=mn[s];if(a===void 0){a=new Float32Array(s);mn[s]=a}if(t!==0){r.toArray(a,0);for(let r=1,s=0;r!==t;++r){s+=n;e[r].toArray(a,s)}}return a}function arraysEqual(e,t){if(e.length!==t.length)return false;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return false;return true}function copyArray(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function allocTexUnits(e,t){let n=An[t];if(n===void 0){n=new Int32Array(t);An[t]=n}for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function setValueV1f(e,n){const r=(this||t).cache;if(r[0]!==n){e.uniform1f((this||t).addr,n);r[0]=n}}function setValueV2f(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y){e.uniform2f((this||t).addr,n.x,n.y);r[0]=n.x;r[1]=n.y}}else{if(arraysEqual(r,n))return;e.uniform2fv((this||t).addr,n);copyArray(r,n)}}function setValueV3f(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z){e.uniform3f((this||t).addr,n.x,n.y,n.z);r[0]=n.x;r[1]=n.y;r[2]=n.z}}else if(n.r!==void 0){if(r[0]!==n.r||r[1]!==n.g||r[2]!==n.b){e.uniform3f((this||t).addr,n.r,n.g,n.b);r[0]=n.r;r[1]=n.g;r[2]=n.b}}else{if(arraysEqual(r,n))return;e.uniform3fv((this||t).addr,n);copyArray(r,n)}}function setValueV4f(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z||r[3]!==n.w){e.uniform4f((this||t).addr,n.x,n.y,n.z,n.w);r[0]=n.x;r[1]=n.y;r[2]=n.z;r[3]=n.w}}else{if(arraysEqual(r,n))return;e.uniform4fv((this||t).addr,n);copyArray(r,n)}}function setValueM2(e,n){const r=(this||t).cache;const s=n.elements;if(s===void 0){if(arraysEqual(r,n))return;e.uniformMatrix2fv((this||t).addr,false,n);copyArray(r,n)}else{if(arraysEqual(r,s))return;yn.set(s);e.uniformMatrix2fv((this||t).addr,false,yn);copyArray(r,s)}}function setValueM3(e,n){const r=(this||t).cache;const s=n.elements;if(s===void 0){if(arraysEqual(r,n))return;e.uniformMatrix3fv((this||t).addr,false,n);copyArray(r,n)}else{if(arraysEqual(r,s))return;vn.set(s);e.uniformMatrix3fv((this||t).addr,false,vn);copyArray(r,s)}}function setValueM4(e,n){const r=(this||t).cache;const s=n.elements;if(s===void 0){if(arraysEqual(r,n))return;e.uniformMatrix4fv((this||t).addr,false,n);copyArray(r,n)}else{if(arraysEqual(r,s))return;gn.set(s);e.uniformMatrix4fv((this||t).addr,false,gn);copyArray(r,s)}}function setValueV1i(e,n){const r=(this||t).cache;if(r[0]!==n){e.uniform1i((this||t).addr,n);r[0]=n}}function setValueV2i(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y){e.uniform2i((this||t).addr,n.x,n.y);r[0]=n.x;r[1]=n.y}}else{if(arraysEqual(r,n))return;e.uniform2iv((this||t).addr,n);copyArray(r,n)}}function setValueV3i(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z){e.uniform3i((this||t).addr,n.x,n.y,n.z);r[0]=n.x;r[1]=n.y;r[2]=n.z}}else{if(arraysEqual(r,n))return;e.uniform3iv((this||t).addr,n);copyArray(r,n)}}function setValueV4i(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z||r[3]!==n.w){e.uniform4i((this||t).addr,n.x,n.y,n.z,n.w);r[0]=n.x;r[1]=n.y;r[2]=n.z;r[3]=n.w}}else{if(arraysEqual(r,n))return;e.uniform4iv((this||t).addr,n);copyArray(r,n)}}function setValueV1ui(e,n){const r=(this||t).cache;if(r[0]!==n){e.uniform1ui((this||t).addr,n);r[0]=n}}function setValueV2ui(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y){e.uniform2ui((this||t).addr,n.x,n.y);r[0]=n.x;r[1]=n.y}}else{if(arraysEqual(r,n))return;e.uniform2uiv((this||t).addr,n);copyArray(r,n)}}function setValueV3ui(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z){e.uniform3ui((this||t).addr,n.x,n.y,n.z);r[0]=n.x;r[1]=n.y;r[2]=n.z}}else{if(arraysEqual(r,n))return;e.uniform3uiv((this||t).addr,n);copyArray(r,n)}}function setValueV4ui(e,n){const r=(this||t).cache;if(n.x!==void 0){if(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z||r[3]!==n.w){e.uniform4ui((this||t).addr,n.x,n.y,n.z,n.w);r[0]=n.x;r[1]=n.y;r[2]=n.z;r[3]=n.w}}else{if(arraysEqual(r,n))return;e.uniform4uiv((this||t).addr,n);copyArray(r,n)}}function setValueT1(e,n,r){const a=(this||t).cache;const o=r.allocateTextureUnit();if(a[0]!==o){e.uniform1i((this||t).addr,o);a[0]=o}let l;if((this||t).type===e.SAMPLER_2D_SHADOW){hn.compareFunction=s.LessEqualCompare;l=hn}else l=un;r.setTexture2D(n||l,o)}function setValueT3D1(e,n,r){const s=(this||t).cache;const a=r.allocateTextureUnit();if(s[0]!==a){e.uniform1i((this||t).addr,a);s[0]=a}r.setTexture3D(n||pn,a)}function setValueT6(e,n,r){const s=(this||t).cache;const a=r.allocateTextureUnit();if(s[0]!==a){e.uniform1i((this||t).addr,a);s[0]=a}r.setTextureCube(n||fn,a)}function setValueT2DArray1(e,n,r){const s=(this||t).cache;const a=r.allocateTextureUnit();if(s[0]!==a){e.uniform1i((this||t).addr,a);s[0]=a}r.setTexture2DArray(n||dn,a)}function getSingularSetter(e){switch(e){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(e,n){e.uniform1fv((this||t).addr,n)}function setValueV2fArray(e,n){const r=flatten(n,(this||t).size,2);e.uniform2fv((this||t).addr,r)}function setValueV3fArray(e,n){const r=flatten(n,(this||t).size,3);e.uniform3fv((this||t).addr,r)}function setValueV4fArray(e,n){const r=flatten(n,(this||t).size,4);e.uniform4fv((this||t).addr,r)}function setValueM2Array(e,n){const r=flatten(n,(this||t).size,4);e.uniformMatrix2fv((this||t).addr,false,r)}function setValueM3Array(e,n){const r=flatten(n,(this||t).size,9);e.uniformMatrix3fv((this||t).addr,false,r)}function setValueM4Array(e,n){const r=flatten(n,(this||t).size,16);e.uniformMatrix4fv((this||t).addr,false,r)}function setValueV1iArray(e,n){e.uniform1iv((this||t).addr,n)}function setValueV2iArray(e,n){e.uniform2iv((this||t).addr,n)}function setValueV3iArray(e,n){e.uniform3iv((this||t).addr,n)}function setValueV4iArray(e,n){e.uniform4iv((this||t).addr,n)}function setValueV1uiArray(e,n){e.uniform1uiv((this||t).addr,n)}function setValueV2uiArray(e,n){e.uniform2uiv((this||t).addr,n)}function setValueV3uiArray(e,n){e.uniform3uiv((this||t).addr,n)}function setValueV4uiArray(e,n){e.uniform4uiv((this||t).addr,n)}function setValueT1Array(e,n,r){const s=(this||t).cache;const a=n.length;const o=allocTexUnits(r,a);if(!arraysEqual(s,o)){e.uniform1iv((this||t).addr,o);copyArray(s,o)}for(let e=0;e!==a;++e)r.setTexture2D(n[e]||un,o[e])}function setValueT3DArray(e,n,r){const s=(this||t).cache;const a=n.length;const o=allocTexUnits(r,a);if(!arraysEqual(s,o)){e.uniform1iv((this||t).addr,o);copyArray(s,o)}for(let e=0;e!==a;++e)r.setTexture3D(n[e]||pn,o[e])}function setValueT6Array(e,n,r){const s=(this||t).cache;const a=n.length;const o=allocTexUnits(r,a);if(!arraysEqual(s,o)){e.uniform1iv((this||t).addr,o);copyArray(s,o)}for(let e=0;e!==a;++e)r.setTextureCube(n[e]||fn,o[e])}function setValueT2DArrayArray(e,n,r){const s=(this||t).cache;const a=n.length;const o=allocTexUnits(r,a);if(!arraysEqual(s,o)){e.uniform1iv((this||t).addr,o);copyArray(s,o)}for(let e=0;e!==a;++e)r.setTexture2DArray(n[e]||dn,o[e])}function getPureArraySetter(e){switch(e){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(e,t,n){this.id=e;this.addr=n;this.cache=[];this.type=t.type;this.setValue=getSingularSetter(t.type)}}class PureArrayUniform{constructor(e,t,n){this.id=e;this.addr=n;this.cache=[];this.type=t.type;this.size=t.size;this.setValue=getPureArraySetter(t.type)}}class StructuredUniform{constructor(e){this.id=e;this.seq=[];this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const Cn=/(\w+)(\])?(\[|\.)?/g;function addUniform(e,t){e.seq.push(t);e.map[t.id]=t}function parseUniform(e,t,n){const r=e.name,s=r.length;Cn.lastIndex=0;while(true){const a=Cn.exec(r),o=Cn.lastIndex;let l=a[1];const c=a[2]==="]",u=a[3];c&&(l|=0);if(u===void 0||u==="["&&o+2===s){addUniform(n,u===void 0?new SingleUniform(l,e,t):new PureArrayUniform(l,e,t));break}{const e=n.map;let t=e[l];if(t===void 0){t=new StructuredUniform(l);addUniform(n,t)}n=t}}}class WebGLUniforms{constructor(e,t){this.seq=[];this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r),s=e.getUniformLocation(t,n.name);parseUniform(n,s,this)}}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const a=t[s],o=n[a.id];o.needsUpdate!==false&&a.setValue(e,o.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const s=e[r];s.id in t&&n.push(s)}return n}}function WebGLShader(e,t,n){const r=e.createShader(t);e.shaderSource(r,n);e.compileShader(r);return r}const En=37297;let bn=0;function handleSource(e,t){const n=e.split("\n");const r=[];const s=Math.max(t-6,0);const a=Math.min(t+6,n.length);for(let e=s;e<a;e++){const s=e+1;r.push(`${s===t?">":" "} ${s}: ${n[e]}`)}return r.join("\n")}const xn=new s.Matrix3;function getEncodingComponents(e){s.ColorManagement._getMatrix(xn,s.ColorManagement.workingColorSpace,e);const t=`mat3( ${xn.elements.map((e=>e.toFixed(4)))} )`;switch(s.ColorManagement.getTransfer(e)){case s.LinearTransfer:return[t,"LinearTransferOETF"];case s.SRGBTransfer:return[t,"sRGBTransferOETF"];default:console.warn("THREE.WebGLProgram: Unsupported color space: ",e);return[t,"LinearTransferOETF"]}}function getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS);const s=e.getShaderInfoLog(t).trim();if(r&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+s+"\n\n"+handleSource(e.getShaderSource(t),r)}return s}function getTexelEncodingFunction(e,t){const n=getEncodingComponents(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function getToneMappingFunction(e,t){let n;switch(t){case s.LinearToneMapping:n="Linear";break;case s.ReinhardToneMapping:n="Reinhard";break;case s.CineonToneMapping:n="Cineon";break;case s.ACESFilmicToneMapping:n="ACESFilmic";break;case s.AgXToneMapping:n="AgX";break;case s.NeutralToneMapping:n="Neutral";break;case s.CustomToneMapping:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t);n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const _n=new s.Vector3;function getLuminanceFunction(){s.ColorManagement.getLuminanceCoefficients(_n);const e=_n.x.toFixed(4);const t=_n.y.toFixed(4);const n=_n.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${e}, ${t}, ${n} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function generateVertexExtensions(e){const t=[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""];return t.filter(filterEmptyLine).join("\n")}function generateDefines(e){const t=[];for(const n in e){const r=e[n];r!==false&&t.push("#define "+n+" "+r)}return t.join("\n")}function fetchAttributeLocations(e,t){const n={};const r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const r=e.getActiveAttrib(t,s);const a=r.name;let o=1;r.type===e.FLOAT_MAT2&&(o=2);r.type===e.FLOAT_MAT3&&(o=3);r.type===e.FLOAT_MAT4&&(o=4);n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:o}}return n}function filterEmptyLine(e){return e!==""}function replaceLightNums(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function replaceClippingPlaneNums(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Mn=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(e){return e.replace(Mn,includeReplacer)}const wn=new Map;function includeReplacer(e,t){let n=zt[t];if(n===void 0){const e=wn.get(t);if(e===void 0)throw new Error("Can not resolve #include <"+t+">");n=zt[e];console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return resolveIncludes(n)}const Sn=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(e){return e.replace(Sn,loopReplacer)}function loopReplacer(e,t,n,r){let s="";for(let e=parseInt(t);e<parseInt(n);e++)s+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return s}function generatePrecision(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;e.precision==="highp"?t+="\n#define HIGH_PRECISION":e.precision==="mediump"?t+="\n#define MEDIUM_PRECISION":e.precision==="lowp"&&(t+="\n#define LOW_PRECISION");return t}function generateShadowMapTypeDefine(e){let t="SHADOWMAP_TYPE_BASIC";e.shadowMapType===s.PCFShadowMap?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===s.PCFSoftShadowMap?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===s.VSMShadowMap&&(t="SHADOWMAP_TYPE_VSM");return t}function generateEnvMapTypeDefine(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case s.CubeReflectionMapping:case s.CubeRefractionMapping:t="ENVMAP_TYPE_CUBE";break;case s.CubeUVReflectionMapping:t="ENVMAP_TYPE_CUBE_UV";break}return t}function generateEnvMapModeDefine(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case s.CubeRefractionMapping:t="ENVMAP_MODE_REFRACTION";break}return t}function generateEnvMapBlendingDefine(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case s.MultiplyOperation:t="ENVMAP_BLENDING_MULTIPLY";break;case s.MixOperation:t="ENVMAP_BLENDING_MIX";break;case s.AddOperation:t="ENVMAP_BLENDING_ADD";break}return t}function generateCubeUVSize(e){const t=e.envMapCubeUVHeight;if(t===null)return null;const n=Math.log2(t)-2;const r=1/t;const s=1/(3*Math.max(Math.pow(2,n),112));return{texelWidth:s,texelHeight:r,maxMip:n}}function WebGLProgram(e,n,r,a){const o=e.getContext();const l=r.defines;let c=r.vertexShader;let u=r.fragmentShader;const h=generateShadowMapTypeDefine(r);const d=generateEnvMapTypeDefine(r);const p=generateEnvMapModeDefine(r);const f=generateEnvMapBlendingDefine(r);const m=generateCubeUVSize(r);const g=generateVertexExtensions(r);const y=generateDefines(l);const b=o.createProgram();let x,_;let M=r.glslVersion?"#version "+r.glslVersion+"\n":"";const w=r.numMultiviewViews;if(r.isRawShaderMaterial){x=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,y].filter(filterEmptyLine).join("\n");x.length>0&&(x+="\n");_=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,y].filter(filterEmptyLine).join("\n");_.length>0&&(_+="\n")}else{x=[generatePrecision(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,y,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&r.flatShading===false?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===false?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n");_=[generatePrecision(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,y,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&r.flatShading===false?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==s.NoToneMapping?"#define TONE_MAPPING":"",r.toneMapping!==s.NoToneMapping?zt.tonemapping_pars_fragment:"",r.toneMapping!==s.NoToneMapping?getToneMappingFunction("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",zt.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",r.outputColorSpace),getLuminanceFunction(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(filterEmptyLine).join("\n")}c=resolveIncludes(c);c=replaceLightNums(c,r);c=replaceClippingPlaneNums(c,r);u=resolveIncludes(u);u=replaceLightNums(u,r);u=replaceClippingPlaneNums(u,r);c=unrollLoops(c);u=unrollLoops(u);if(r.isRawShaderMaterial!==true){M="#version 300 es\n";x=[g,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+x;_=["#define varying in",r.glslVersion===s.GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===s.GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_;if(w>0){x=["#extension GL_OVR_multiview : require","layout(num_views = "+w+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n")+"\n"+x;x=x.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+w+"];","uniform mat4 projectionMatrices["+w+"];","uniform mat4 viewMatrices["+w+"];","uniform mat3 normalMatrices["+w+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n"));_=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join("\n")+"\n"+_;_=_.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+w+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n"))}}const S=M+x+c;const T=M+_+u;const I=WebGLShader(o,o.VERTEX_SHADER,S);const R=WebGLShader(o,o.FRAGMENT_SHADER,T);o.attachShader(b,I);o.attachShader(b,R);r.index0AttributeName!==void 0?o.bindAttribLocation(b,0,r.index0AttributeName):r.morphTargets===true&&o.bindAttribLocation(b,0,"position");o.linkProgram(b);function onFirstUse(t){if(e.debug.checkShaderErrors){const n=o.getProgramInfoLog(b).trim();const r=o.getShaderInfoLog(I).trim();const s=o.getShaderInfoLog(R).trim();let a=true;let l=true;if(o.getProgramParameter(b,o.LINK_STATUS)===false){a=false;if(typeof e.debug.onShaderError==="function")e.debug.onShaderError(o,b,I,R);else{const e=getShaderErrors(o,I,"vertex");const r=getShaderErrors(o,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(b,o.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+r)}}else n!==""?console.warn("THREE.WebGLProgram: Program Info Log:",n):r!==""&&s!==""||(l=false);l&&(t.diagnostics={runnable:a,programLog:n,vertexShader:{log:r,prefix:x},fragmentShader:{log:s,prefix:_}})}o.deleteShader(I);o.deleteShader(R);L=new WebGLUniforms(o,b);D=fetchAttributeLocations(o,b)}let L;(this||t).getUniforms=function(){L===void 0&&onFirstUse(this||t);return L};let D;(this||t).getAttributes=function(){D===void 0&&onFirstUse(this||t);return D};let P=r.rendererExtensionParallelShaderCompile===false;(this||t).isReady=function(){P===false&&(P=o.getProgramParameter(b,En));return P};(this||t).destroy=function(){a.releaseStatesOfProgram(this||t);o.deleteProgram(b);(this||t).program=void 0};(this||t).type=r.shaderType;(this||t).name=r.shaderName;(this||t).id=bn++;(this||t).cacheKey=n;(this||t).usedTimes=1;(this||t).program=b;(this||t).vertexShader=I;(this||t).fragmentShader=R;(this||t).numMultiviewViews=w;return this||t}let Tn=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map;this.materialCache=new Map}update(e){const t=e.vertexShader;const n=e.fragmentShader;const r=this._getShaderStage(t);const s=this._getShaderStage(n);const a=this._getShaderCacheForMaterial(e);if(a.has(r)===false){a.add(r);r.usedTimes++}if(a.has(s)===false){a.add(s);s.usedTimes++}return this}remove(e){const t=this.materialCache.get(e);for(const e of t){e.usedTimes--;e.usedTimes===0&&this.shaderCache.delete(e.code)}this.materialCache.delete(e);return this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear();this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);if(n===void 0){n=new Set;t.set(e,n)}return n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);if(n===void 0){n=new WebGLShaderStage(e);t.set(e,n)}return n}}class WebGLShaderStage{constructor(e){this.id=Tn++;this.code=e;this.usedTimes=0}}function WebGLPrograms(e,t,n,r,a,o,l){const c=new s.Layers;const u=new WebGLShaderCache;const h=new Set;const d=[];const p=a.logarithmicDepthBuffer;const f=a.vertexTextures;let m=a.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function getChannel(e){h.add(e);return e===0?"uv":`uv${e}`}function getParameters(o,c,d,y,b){const x=y.fog;const _=b.geometry;const M=o.isMeshStandardMaterial?y.environment:null;const w=(o.isMeshStandardMaterial?n:t).get(o.envMap||M);const S=!w||w.mapping!==s.CubeUVReflectionMapping?null:w.image.height;const T=g[o.type];if(o.precision!==null){m=a.getMaxPrecision(o.precision);m!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",m,"instead.")}const I=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color;const R=I!==void 0?I.length:0;let L=0;_.morphAttributes.position!==void 0&&(L=1);_.morphAttributes.normal!==void 0&&(L=2);_.morphAttributes.color!==void 0&&(L=3);let D,P;let F,U;if(T){const e=qt[T];D=e.vertexShader;P=e.fragmentShader}else{D=o.vertexShader;P=o.fragmentShader;u.update(o);F=u.getVertexShaderID(o);U=u.getFragmentShaderID(o)}const O=e.getRenderTarget();const k=e.state.buffers.depth.getReversed();const N=O&&O.isWebGLMultiviewRenderTarget?O.numViews:0;const G=b.isInstancedMesh===true;const V=b.isBatchedMesh===true;const j=!!o.map;const H=!!o.matcap;const z=!!w;const W=!!o.aoMap;const q=!!o.lightMap;const K=!!o.bumpMap;const X=!!o.normalMap;const Y=!!o.displacementMap;const J=!!o.emissiveMap;const Z=!!o.metalnessMap;const $=!!o.roughnessMap;const ee=o.anisotropy>0;const te=o.clearcoat>0;const ne=o.dispersion>0;const re=o.iridescence>0;const ie=o.sheen>0;const se=o.transmission>0;const ae=ee&&!!o.anisotropyMap;const oe=te&&!!o.clearcoatMap;const le=te&&!!o.clearcoatNormalMap;const ce=te&&!!o.clearcoatRoughnessMap;const ue=re&&!!o.iridescenceMap;const he=re&&!!o.iridescenceThicknessMap;const de=ie&&!!o.sheenColorMap;const pe=ie&&!!o.sheenRoughnessMap;const fe=!!o.specularMap;const me=!!o.specularColorMap;const Ae=!!o.specularIntensityMap;const ge=se&&!!o.transmissionMap;const ve=se&&!!o.thicknessMap;const ye=!!o.gradientMap;const Ce=!!o.alphaMap;const Ee=o.alphaTest>0;const be=!!o.alphaHash;const xe=!!o.extensions;let _e=s.NoToneMapping;o.toneMapped&&(O!==null&&O.isXRRenderTarget!==true||(_e=e.toneMapping));const Me={shaderID:T,shaderType:o.type,shaderName:o.name,vertexShader:D,fragmentShader:P,defines:o.defines,customVertexShaderID:F,customFragmentShaderID:U,isRawShaderMaterial:o.isRawShaderMaterial===true,glslVersion:o.glslVersion,precision:m,batching:V,batchingColor:V&&b._colorsTexture!==null,instancing:G,instancingColor:G&&b.instanceColor!==null,instancingMorph:G&&b.morphTexture!==null,supportsVertexTextures:f,numMultiviewViews:N,outputColorSpace:O===null?e.outputColorSpace:O.isXRRenderTarget===true?O.texture.colorSpace:s.LinearSRGBColorSpace,alphaToCoverage:!!o.alphaToCoverage,map:j,matcap:H,envMap:z,envMapMode:z&&w.mapping,envMapCubeUVHeight:S,aoMap:W,lightMap:q,bumpMap:K,normalMap:X,displacementMap:f&&Y,emissiveMap:J,normalMapObjectSpace:X&&o.normalMapType===s.ObjectSpaceNormalMap,normalMapTangentSpace:X&&o.normalMapType===s.TangentSpaceNormalMap,metalnessMap:Z,roughnessMap:$,anisotropy:ee,anisotropyMap:ae,clearcoat:te,clearcoatMap:oe,clearcoatNormalMap:le,clearcoatRoughnessMap:ce,dispersion:ne,iridescence:re,iridescenceMap:ue,iridescenceThicknessMap:he,sheen:ie,sheenColorMap:de,sheenRoughnessMap:pe,specularMap:fe,specularColorMap:me,specularIntensityMap:Ae,transmission:se,transmissionMap:ge,thicknessMap:ve,gradientMap:ye,opaque:o.transparent===false&&o.blending===s.NormalBlending&&o.alphaToCoverage===false,alphaMap:Ce,alphaTest:Ee,alphaHash:be,combine:o.combine,mapUv:j&&getChannel(o.map.channel),aoMapUv:W&&getChannel(o.aoMap.channel),lightMapUv:q&&getChannel(o.lightMap.channel),bumpMapUv:K&&getChannel(o.bumpMap.channel),normalMapUv:X&&getChannel(o.normalMap.channel),displacementMapUv:Y&&getChannel(o.displacementMap.channel),emissiveMapUv:J&&getChannel(o.emissiveMap.channel),metalnessMapUv:Z&&getChannel(o.metalnessMap.channel),roughnessMapUv:$&&getChannel(o.roughnessMap.channel),anisotropyMapUv:ae&&getChannel(o.anisotropyMap.channel),clearcoatMapUv:oe&&getChannel(o.clearcoatMap.channel),clearcoatNormalMapUv:le&&getChannel(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ce&&getChannel(o.clearcoatRoughnessMap.channel),iridescenceMapUv:ue&&getChannel(o.iridescenceMap.channel),iridescenceThicknessMapUv:he&&getChannel(o.iridescenceThicknessMap.channel),sheenColorMapUv:de&&getChannel(o.sheenColorMap.channel),sheenRoughnessMapUv:pe&&getChannel(o.sheenRoughnessMap.channel),specularMapUv:fe&&getChannel(o.specularMap.channel),specularColorMapUv:me&&getChannel(o.specularColorMap.channel),specularIntensityMapUv:Ae&&getChannel(o.specularIntensityMap.channel),transmissionMapUv:ge&&getChannel(o.transmissionMap.channel),thicknessMapUv:ve&&getChannel(o.thicknessMap.channel),alphaMapUv:Ce&&getChannel(o.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(X||ee),vertexColors:o.vertexColors,vertexAlphas:o.vertexColors===true&&!!_.attributes.color&&_.attributes.color.itemSize===4,pointsUvs:b.isPoints===true&&!!_.attributes.uv&&(j||Ce),fog:!!x,useFog:o.fog===true,fogExp2:!!x&&x.isFogExp2,flatShading:o.flatShading===true,sizeAttenuation:o.sizeAttenuation===true,logarithmicDepthBuffer:p,reverseDepthBuffer:k,skinning:b.isSkinnedMesh===true,morphTargets:_.morphAttributes.position!==void 0,morphNormals:_.morphAttributes.normal!==void 0,morphColors:_.morphAttributes.color!==void 0,morphTargetsCount:R,morphTextureStride:L,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numSpotLightMaps:c.spotLightMap.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numSpotLightShadowsWithMaps:c.numSpotLightShadowsWithMaps,numLightProbes:c.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:_e,decodeVideoTexture:j&&o.map.isVideoTexture===true&&s.ColorManagement.getTransfer(o.map.colorSpace)===s.SRGBTransfer,decodeVideoTextureEmissive:J&&o.emissiveMap.isVideoTexture===true&&s.ColorManagement.getTransfer(o.emissiveMap.colorSpace)===s.SRGBTransfer,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===s.DoubleSide,flipSided:o.side===s.BackSide,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:xe&&o.extensions.clipCullDistance===true&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(xe&&o.extensions.multiDraw===true||V)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};Me.vertexUv1s=h.has(1);Me.vertexUv2s=h.has(2);Me.vertexUv3s=h.has(3);h.clear();return Me}function getProgramCacheKey(t){const n=[];if(t.shaderID)n.push(t.shaderID);else{n.push(t.customVertexShaderID);n.push(t.customFragmentShaderID)}if(t.defines!==void 0)for(const e in t.defines){n.push(e);n.push(t.defines[e])}if(t.isRawShaderMaterial===false){getProgramCacheKeyParameters(n,t);getProgramCacheKeyBooleans(n,t);n.push(e.outputColorSpace)}n.push(t.customProgramCacheKey);return n.join()}function getProgramCacheKeyParameters(e,t){e.push(t.precision);e.push(t.outputColorSpace);e.push(t.envMapMode);e.push(t.envMapCubeUVHeight);e.push(t.mapUv);e.push(t.alphaMapUv);e.push(t.lightMapUv);e.push(t.aoMapUv);e.push(t.bumpMapUv);e.push(t.normalMapUv);e.push(t.displacementMapUv);e.push(t.emissiveMapUv);e.push(t.metalnessMapUv);e.push(t.roughnessMapUv);e.push(t.anisotropyMapUv);e.push(t.clearcoatMapUv);e.push(t.clearcoatNormalMapUv);e.push(t.clearcoatRoughnessMapUv);e.push(t.iridescenceMapUv);e.push(t.iridescenceThicknessMapUv);e.push(t.sheenColorMapUv);e.push(t.sheenRoughnessMapUv);e.push(t.specularMapUv);e.push(t.specularColorMapUv);e.push(t.specularIntensityMapUv);e.push(t.transmissionMapUv);e.push(t.thicknessMapUv);e.push(t.combine);e.push(t.fogExp2);e.push(t.sizeAttenuation);e.push(t.morphTargetsCount);e.push(t.morphAttributeCount);e.push(t.numDirLights);e.push(t.numPointLights);e.push(t.numSpotLights);e.push(t.numSpotLightMaps);e.push(t.numHemiLights);e.push(t.numRectAreaLights);e.push(t.numDirLightShadows);e.push(t.numPointLightShadows);e.push(t.numSpotLightShadows);e.push(t.numSpotLightShadowsWithMaps);e.push(t.numLightProbes);e.push(t.shadowMapType);e.push(t.toneMapping);e.push(t.numClippingPlanes);e.push(t.numClipIntersection);e.push(t.depthPacking)}function getProgramCacheKeyBooleans(e,t){c.disableAll();t.supportsVertexTextures&&c.enable(0);t.instancing&&c.enable(1);t.instancingColor&&c.enable(2);t.instancingMorph&&c.enable(3);t.matcap&&c.enable(4);t.envMap&&c.enable(5);t.normalMapObjectSpace&&c.enable(6);t.normalMapTangentSpace&&c.enable(7);t.clearcoat&&c.enable(8);t.iridescence&&c.enable(9);t.alphaTest&&c.enable(10);t.vertexColors&&c.enable(11);t.vertexAlphas&&c.enable(12);t.vertexUv1s&&c.enable(13);t.vertexUv2s&&c.enable(14);t.vertexUv3s&&c.enable(15);t.vertexTangents&&c.enable(16);t.anisotropy&&c.enable(17);t.alphaHash&&c.enable(18);t.batching&&c.enable(19);t.dispersion&&c.enable(20);t.batchingColor&&c.enable(21);e.push(c.mask);c.disableAll();t.fog&&c.enable(0);t.useFog&&c.enable(1);t.flatShading&&c.enable(2);t.logarithmicDepthBuffer&&c.enable(3);t.reverseDepthBuffer&&c.enable(4);t.skinning&&c.enable(5);t.morphTargets&&c.enable(6);t.morphNormals&&c.enable(7);t.morphColors&&c.enable(8);t.premultipliedAlpha&&c.enable(9);t.shadowMapEnabled&&c.enable(10);t.doubleSided&&c.enable(11);t.flipSided&&c.enable(12);t.useDepthPacking&&c.enable(13);t.dithering&&c.enable(14);t.transmission&&c.enable(15);t.sheen&&c.enable(16);t.opaque&&c.enable(17);t.pointsUvs&&c.enable(18);t.decodeVideoTexture&&c.enable(19);t.decodeVideoTextureEmissive&&c.enable(20);t.alphaToCoverage&&c.enable(21);t.numMultiviewViews&&c.enable(21);e.push(c.mask)}function getUniforms(e){const t=g[e.type];let n;if(t){const e=qt[t];n=s.UniformsUtils.clone(e.uniforms)}else n=e.uniforms;return n}function acquireProgram(t,n){let r;for(let e=0,t=d.length;e<t;e++){const t=d[e];if(t.cacheKey===n){r=t;++r.usedTimes;break}}if(r===void 0){r=new WebGLProgram(e,n,t,o);d.push(r)}return r}function releaseProgram(e){if(--e.usedTimes===0){const t=d.indexOf(e);d[t]=d[d.length-1];d.pop();e.destroy()}}function releaseShaderCache(e){u.remove(e)}function dispose(){u.dispose()}return{getParameters:getParameters,getProgramCacheKey:getProgramCacheKey,getUniforms:getUniforms,acquireProgram:acquireProgram,releaseProgram:releaseProgram,releaseShaderCache:releaseShaderCache,programs:d,dispose:dispose}}function WebGLProperties(){let e=new WeakMap;function has(t){return e.has(t)}function get(t){let n=e.get(t);if(n===void 0){n={};e.set(t,n)}return n}function remove(t){e.delete(t)}function update(t,n,r){e.get(t)[n]=r}function dispose(){e=new WeakMap}return{has:has,get:get,remove:remove,update:update,dispose:dispose}}function painterSortStable(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function reversePainterSortStable(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function WebGLRenderList(){const e=[];let t=0;const n=[];const r=[];const s=[];function init(){t=0;n.length=0;r.length=0;s.length=0}function getNextRenderItem(n,r,s,a,o,l){let c=e[t];if(c===void 0){c={id:n.id,object:n,geometry:r,material:s,groupOrder:a,renderOrder:n.renderOrder,z:o,group:l};e[t]=c}else{c.id=n.id;c.object=n;c.geometry=r;c.material=s;c.groupOrder=a;c.renderOrder=n.renderOrder;c.z=o;c.group=l}t++;return c}function push(e,t,a,o,l,c){const u=getNextRenderItem(e,t,a,o,l,c);a.transmission>0?r.push(u):a.transparent===true?s.push(u):n.push(u)}function unshift(e,t,a,o,l,c){const u=getNextRenderItem(e,t,a,o,l,c);a.transmission>0?r.unshift(u):a.transparent===true?s.unshift(u):n.unshift(u)}function sort(e,t){n.length>1&&n.sort(e||painterSortStable);r.length>1&&r.sort(t||reversePainterSortStable);s.length>1&&s.sort(t||reversePainterSortStable)}function finish(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(t.id===null)break;t.id=null;t.object=null;t.geometry=null;t.material=null;t.group=null}}return{opaque:n,transmissive:r,transparent:s,init:init,push:push,unshift:unshift,finish:finish,sort:sort}}function WebGLRenderLists(){let e=new WeakMap;function get(t,n){const r=e.get(t);let s;if(r===void 0){s=new WebGLRenderList;e.set(t,[s])}else if(n>=r.length){s=new WebGLRenderList;r.push(s)}else s=r[n];return s}function dispose(){e=new WeakMap}return{get:get,dispose:dispose}}function UniformsCache(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new s.Vector3,color:new s.Color};break;case"SpotLight":n={position:new s.Vector3,direction:new s.Vector3,color:new s.Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new s.Vector3,color:new s.Color,distance:0,decay:0};break;case"HemisphereLight":n={direction:new s.Vector3,skyColor:new s.Color,groundColor:new s.Color};break;case"RectAreaLight":n={color:new s.Color,position:new s.Vector3,halfWidth:new s.Vector3,halfHeight:new s.Vector3};break}e[t.id]=n;return n}}}function ShadowUniformsCache(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let n;switch(t.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new s.Vector2};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new s.Vector2};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new s.Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}e[t.id]=n;return n}}}let Bn=0;function shadowCastingAndTexturingLightsFirst(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function WebGLLights(e){const t=new UniformsCache;const n=ShadowUniformsCache();const r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)r.probe.push(new s.Vector3);const a=new s.Vector3;const o=new s.Matrix4;const l=new s.Matrix4;function setup(s){let a=0,o=0,l=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let c=0;let u=0;let h=0;let d=0;let p=0;let f=0;let m=0;let g=0;let y=0;let b=0;let x=0;s.sort(shadowCastingAndTexturingLightsFirst);for(let e=0,_=s.length;e<_;e++){const _=s[e];const M=_.color;const w=_.intensity;const S=_.distance;const T=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight){a+=M.r*w;o+=M.g*w;l+=M.b*w}else if(_.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(_.sh.coefficients[e],w);x++}else if(_.isDirectionalLight){const e=t.get(_);e.color.copy(_.color).multiplyScalar(_.intensity);if(_.castShadow){const e=_.shadow;const t=n.get(_);t.shadowIntensity=e.intensity;t.shadowBias=e.bias;t.shadowNormalBias=e.normalBias;t.shadowRadius=e.radius;t.shadowMapSize=e.mapSize;r.directionalShadow[c]=t;r.directionalShadowMap[c]=T;r.directionalShadowMatrix[c]=_.shadow.matrix;f++}r.directional[c]=e;c++}else if(_.isSpotLight){const e=t.get(_);e.position.setFromMatrixPosition(_.matrixWorld);e.color.copy(M).multiplyScalar(w);e.distance=S;e.coneCos=Math.cos(_.angle);e.penumbraCos=Math.cos(_.angle*(1-_.penumbra));e.decay=_.decay;r.spot[h]=e;const s=_.shadow;if(_.map){r.spotLightMap[y]=_.map;y++;s.updateMatrices(_);_.castShadow&&b++}r.spotLightMatrix[h]=s.matrix;if(_.castShadow){const e=n.get(_);e.shadowIntensity=s.intensity;e.shadowBias=s.bias;e.shadowNormalBias=s.normalBias;e.shadowRadius=s.radius;e.shadowMapSize=s.mapSize;r.spotShadow[h]=e;r.spotShadowMap[h]=T;g++}h++}else if(_.isRectAreaLight){const e=t.get(_);e.color.copy(M).multiplyScalar(w);e.halfWidth.set(_.width*.5,0,0);e.halfHeight.set(0,_.height*.5,0);r.rectArea[d]=e;d++}else if(_.isPointLight){const e=t.get(_);e.color.copy(_.color).multiplyScalar(_.intensity);e.distance=_.distance;e.decay=_.decay;if(_.castShadow){const e=_.shadow;const t=n.get(_);t.shadowIntensity=e.intensity;t.shadowBias=e.bias;t.shadowNormalBias=e.normalBias;t.shadowRadius=e.radius;t.shadowMapSize=e.mapSize;t.shadowCameraNear=e.camera.near;t.shadowCameraFar=e.camera.far;r.pointShadow[u]=t;r.pointShadowMap[u]=T;r.pointShadowMatrix[u]=_.shadow.matrix;m++}r.point[u]=e;u++}else if(_.isHemisphereLight){const e=t.get(_);e.skyColor.copy(_.color).multiplyScalar(w);e.groundColor.copy(_.groundColor).multiplyScalar(w);r.hemi[p]=e;p++}}if(d>0)if(e.has("OES_texture_float_linear")===true){r.rectAreaLTC1=Wt.LTC_FLOAT_1;r.rectAreaLTC2=Wt.LTC_FLOAT_2}else{r.rectAreaLTC1=Wt.LTC_HALF_1;r.rectAreaLTC2=Wt.LTC_HALF_2}r.ambient[0]=a;r.ambient[1]=o;r.ambient[2]=l;const _=r.hash;if(_.directionalLength!==c||_.pointLength!==u||_.spotLength!==h||_.rectAreaLength!==d||_.hemiLength!==p||_.numDirectionalShadows!==f||_.numPointShadows!==m||_.numSpotShadows!==g||_.numSpotMaps!==y||_.numLightProbes!==x){r.directional.length=c;r.spot.length=h;r.rectArea.length=d;r.point.length=u;r.hemi.length=p;r.directionalShadow.length=f;r.directionalShadowMap.length=f;r.pointShadow.length=m;r.pointShadowMap.length=m;r.spotShadow.length=g;r.spotShadowMap.length=g;r.directionalShadowMatrix.length=f;r.pointShadowMatrix.length=m;r.spotLightMatrix.length=g+y-b;r.spotLightMap.length=y;r.numSpotLightShadowsWithMaps=b;r.numLightProbes=x;_.directionalLength=c;_.pointLength=u;_.spotLength=h;_.rectAreaLength=d;_.hemiLength=p;_.numDirectionalShadows=f;_.numPointShadows=m;_.numSpotShadows=g;_.numSpotMaps=y;_.numLightProbes=x;r.version=Bn++}}function setupView(e,t){let n=0;let s=0;let c=0;let u=0;let h=0;const d=t.matrixWorldInverse;for(let t=0,p=e.length;t<p;t++){const p=e[t];if(p.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(p.matrixWorld);a.setFromMatrixPosition(p.target.matrixWorld);e.direction.sub(a);e.direction.transformDirection(d);n++}else if(p.isSpotLight){const e=r.spot[c];e.position.setFromMatrixPosition(p.matrixWorld);e.position.applyMatrix4(d);e.direction.setFromMatrixPosition(p.matrixWorld);a.setFromMatrixPosition(p.target.matrixWorld);e.direction.sub(a);e.direction.transformDirection(d);c++}else if(p.isRectAreaLight){const e=r.rectArea[u];e.position.setFromMatrixPosition(p.matrixWorld);e.position.applyMatrix4(d);l.identity();o.copy(p.matrixWorld);o.premultiply(d);l.extractRotation(o);e.halfWidth.set(p.width*.5,0,0);e.halfHeight.set(0,p.height*.5,0);e.halfWidth.applyMatrix4(l);e.halfHeight.applyMatrix4(l);u++}else if(p.isPointLight){const e=r.point[s];e.position.setFromMatrixPosition(p.matrixWorld);e.position.applyMatrix4(d);s++}else if(p.isHemisphereLight){const e=r.hemi[h];e.direction.setFromMatrixPosition(p.matrixWorld);e.direction.transformDirection(d);h++}}}return{setup:setup,setupView:setupView,state:r}}function WebGLRenderState(e){const t=new WebGLLights(e);const n=[];const r=[];function init(e){s.camera=e;n.length=0;r.length=0}function pushLight(e){n.push(e)}function pushShadow(e){r.push(e)}function setupLights(){t.setup(n)}function setupLightsView(e){t.setupView(n,e)}const s={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:init,state:s,setupLights:setupLights,setupLightsView:setupLightsView,pushLight:pushLight,pushShadow:pushShadow}}function WebGLRenderStates(e){let t=new WeakMap;function get(n,r=0){const s=t.get(n);let a;if(s===void 0){a=new WebGLRenderState(e);t.set(n,[a])}else if(r>=s.length){a=new WebGLRenderState(e);s.push(a)}else a=s[r];return a}function dispose(){t=new WeakMap}return{get:get,dispose:dispose}}const In="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";const Rn="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function WebGLShadowMap(e,n,r){let a=new s.Frustum;const o=new s.Vector2,l=new s.Vector2,c=new s.Vector4,u=new s.MeshDepthMaterial({depthPacking:s.RGBADepthPacking}),h=new s.MeshDistanceMaterial,d={},p=r.maxTextureSize;const f={[s.FrontSide]:s.BackSide,[s.BackSide]:s.FrontSide,[s.DoubleSide]:s.DoubleSide};const m=new s.ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new s.Vector2},radius:{value:4}},vertexShader:In,fragmentShader:Rn});const g=m.clone();g.defines.HORIZONTAL_PASS=1;const y=new s.BufferGeometry;y.setAttribute("position",new s.BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new s.Mesh(y,m);const x=this||t;(this||t).enabled=false;(this||t).autoUpdate=true;(this||t).needsUpdate=false;(this||t).type=s.PCFShadowMap;let _=(this||t).type;(this||t).render=function(n,r,u){if(x.enabled===false)return;if(x.autoUpdate===false&&x.needsUpdate===false)return;if(n.length===0)return;const h=e.getRenderTarget();const d=e.getActiveCubeFace();const f=e.getActiveMipmapLevel();const m=e.state;m.setBlending(s.NoBlending);m.buffers.color.setClear(1,1,1,1);m.buffers.depth.setTest(true);m.setScissorTest(false);const g=_!==s.VSMShadowMap&&(this||t).type===s.VSMShadowMap;const y=_===s.VSMShadowMap&&(this||t).type!==s.VSMShadowMap;for(let h=0,d=n.length;h<d;h++){const d=n[h];const f=d.shadow;if(f===void 0){console.warn("THREE.WebGLShadowMap:",d,"has no shadow.");continue}if(f.autoUpdate===false&&f.needsUpdate===false)continue;o.copy(f.mapSize);const b=f.getFrameExtents();o.multiply(b);l.copy(f.mapSize);if(o.x>p||o.y>p){if(o.x>p){l.x=Math.floor(p/b.x);o.x=l.x*b.x;f.mapSize.x=l.x}if(o.y>p){l.y=Math.floor(p/b.y);o.y=l.y*b.y;f.mapSize.y=l.y}}if(f.map===null||g===true||y===true){const e=(this||t).type!==s.VSMShadowMap?{minFilter:s.NearestFilter,magFilter:s.NearestFilter}:{};f.map!==null&&f.map.dispose();f.map=new s.WebGLRenderTarget(o.x,o.y,e);f.map.texture.name=d.name+".shadowMap";f.camera.updateProjectionMatrix()}e.setRenderTarget(f.map);e.clear();const x=f.getViewportCount();for(let e=0;e<x;e++){const n=f.getViewport(e);c.set(l.x*n.x,l.y*n.y,l.x*n.z,l.y*n.w);m.viewport(c);f.updateMatrices(d,e);a=f.getFrustum();renderObject(r,u,f.camera,d,(this||t).type)}f.isPointLightShadow!==true&&(this||t).type===s.VSMShadowMap&&VSMPass(f,u);f.needsUpdate=false}_=(this||t).type;x.needsUpdate=false;e.setRenderTarget(h,d,f)};function VSMPass(t,r){const a=n.update(b);if(m.defines.VSM_SAMPLES!==t.blurSamples){m.defines.VSM_SAMPLES=t.blurSamples;g.defines.VSM_SAMPLES=t.blurSamples;m.needsUpdate=true;g.needsUpdate=true}t.mapPass===null&&(t.mapPass=new s.WebGLRenderTarget(o.x,o.y));m.uniforms.shadow_pass.value=t.map.texture;m.uniforms.resolution.value=t.mapSize;m.uniforms.radius.value=t.radius;e.setRenderTarget(t.mapPass);e.clear();e.renderBufferDirect(r,null,a,m,b,null);g.uniforms.shadow_pass.value=t.mapPass.texture;g.uniforms.resolution.value=t.mapSize;g.uniforms.radius.value=t.radius;e.setRenderTarget(t.map);e.clear();e.renderBufferDirect(r,null,a,g,b,null)}function getDepthMaterial(t,n,r,a){let o=null;const l=r.isPointLight===true?t.customDistanceMaterial:t.customDepthMaterial;if(l!==void 0)o=l;else{o=r.isPointLight===true?h:u;if(e.localClippingEnabled&&n.clipShadows===true&&Array.isArray(n.clippingPlanes)&&n.clippingPlanes.length!==0||n.displacementMap&&n.displacementScale!==0||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=o.uuid,t=n.uuid;let r=d[e];if(r===void 0){r={};d[e]=r}let s=r[t];if(s===void 0){s=o.clone();r[t]=s;n.addEventListener("dispose",onMaterialDispose)}o=s}}o.visible=n.visible;o.wireframe=n.wireframe;a===s.VSMShadowMap?o.side=n.shadowSide!==null?n.shadowSide:n.side:o.side=n.shadowSide!==null?n.shadowSide:f[n.side];o.alphaMap=n.alphaMap;o.alphaTest=n.alphaTest;o.map=n.map;o.clipShadows=n.clipShadows;o.clippingPlanes=n.clippingPlanes;o.clipIntersection=n.clipIntersection;o.displacementMap=n.displacementMap;o.displacementScale=n.displacementScale;o.displacementBias=n.displacementBias;o.wireframeLinewidth=n.wireframeLinewidth;o.linewidth=n.linewidth;if(r.isPointLight===true&&o.isMeshDistanceMaterial===true){const t=e.properties.get(o);t.light=r}return o}function renderObject(t,r,o,l,c){if(t.visible===false)return;const u=t.layers.test(r.layers);if(u&&(t.isMesh||t.isLine||t.isPoints)&&(t.castShadow||t.receiveShadow&&c===s.VSMShadowMap)&&(!t.frustumCulled||a.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,t.matrixWorld);const s=n.update(t);const a=t.material;if(Array.isArray(a)){const n=s.groups;for(let u=0,h=n.length;u<h;u++){const h=n[u];const d=a[h.materialIndex];if(d&&d.visible){const n=getDepthMaterial(t,d,l,c);t.onBeforeShadow(e,t,r,o,s,n,h);e.renderBufferDirect(o,null,s,n,t,h);t.onAfterShadow(e,t,r,o,s,n,h)}}}else if(a.visible){const n=getDepthMaterial(t,a,l,c);t.onBeforeShadow(e,t,r,o,s,n,null);e.renderBufferDirect(o,null,s,n,t,null);t.onAfterShadow(e,t,r,o,s,n,null)}}const h=t.children;for(let e=0,t=h.length;e<t;e++)renderObject(h[e],r,o,l,c)}function onMaterialDispose(e){const t=e.target;t.removeEventListener("dispose",onMaterialDispose);for(const t in d){const n=d[t];const r=e.target.uuid;if(r in n){const e=n[r];e.dispose();delete n[r]}}}}const Ln={[s.NeverDepth]:s.AlwaysDepth,[s.LessDepth]:s.GreaterDepth,[s.EqualDepth]:s.NotEqualDepth,[s.LessEqualDepth]:s.GreaterEqualDepth,[s.AlwaysDepth]:s.NeverDepth,[s.GreaterDepth]:s.LessDepth,[s.NotEqualDepth]:s.EqualDepth,[s.GreaterEqualDepth]:s.LessEqualDepth};function WebGLState(e,t){function ColorBuffer(){let t=false;const n=new s.Vector4;let r=null;const a=new s.Vector4(0,0,0,0);return{setMask:function(n){if(r!==n&&!t){e.colorMask(n,n,n,n);r=n}},setLocked:function(e){t=e},setClear:function(t,r,s,o,l){if(l===true){t*=o;r*=o;s*=o}n.set(t,r,s,o);if(a.equals(n)===false){e.clearColor(t,r,s,o);a.copy(n)}},reset:function(){t=false;r=null;a.set(-1,0,0,0)}}}function DepthBuffer(){let n=false;let r=false;let a=null;let o=null;let l=null;return{setReversed:function(e){if(r!==e){const e=t.get("EXT_clip_control");r?e.clipControlEXT(e.LOWER_LEFT_EXT,e.ZERO_TO_ONE_EXT):e.clipControlEXT(e.LOWER_LEFT_EXT,e.NEGATIVE_ONE_TO_ONE_EXT);const n=l;l=null;this.setClear(n)}r=e},getReversed:function(){return r},setTest:function(t){t?enable(e.DEPTH_TEST):disable(e.DEPTH_TEST)},setMask:function(t){if(a!==t&&!n){e.depthMask(t);a=t}},setFunc:function(t){r&&(t=Ln[t]);if(o!==t){switch(t){case s.NeverDepth:e.depthFunc(e.NEVER);break;case s.AlwaysDepth:e.depthFunc(e.ALWAYS);break;case s.LessDepth:e.depthFunc(e.LESS);break;case s.LessEqualDepth:e.depthFunc(e.LEQUAL);break;case s.EqualDepth:e.depthFunc(e.EQUAL);break;case s.GreaterEqualDepth:e.depthFunc(e.GEQUAL);break;case s.GreaterDepth:e.depthFunc(e.GREATER);break;case s.NotEqualDepth:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}o=t}},setLocked:function(e){n=e},setClear:function(t){if(l!==t){r&&(t=1-t);e.clearDepth(t);l=t}},reset:function(){n=false;a=null;o=null;l=null;r=false}}}function StencilBuffer(){let t=false;let n=null;let r=null;let s=null;let a=null;let o=null;let l=null;let c=null;let u=null;return{setTest:function(n){t||(n?enable(e.STENCIL_TEST):disable(e.STENCIL_TEST))},setMask:function(r){if(n!==r&&!t){e.stencilMask(r);n=r}},setFunc:function(t,n,o){if(r!==t||s!==n||a!==o){e.stencilFunc(t,n,o);r=t;s=n;a=o}},setOp:function(t,n,r){if(o!==t||l!==n||c!==r){e.stencilOp(t,n,r);o=t;l=n;c=r}},setLocked:function(e){t=e},setClear:function(t){if(u!==t){e.clearStencil(t);u=t}},reset:function(){t=false;n=null;r=null;s=null;a=null;o=null;l=null;c=null;u=null}}}const n=new ColorBuffer;const r=new DepthBuffer;const a=new StencilBuffer;const o=new WeakMap;const l=new WeakMap;let c={};let u={};let h=new WeakMap;let d=[];let p=null;let f=false;let m=null;let g=null;let y=null;let b=null;let x=null;let _=null;let M=null;let w=new s.Color(0,0,0);let S=0;let T=false;let I=null;let R=null;let L=null;let D=null;let P=null;const F=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let U=false;let O=0;const k=e.getParameter(e.VERSION);if(k.indexOf("WebGL")!==-1){O=parseFloat(/^WebGL (\d)/.exec(k)[1]);U=O>=1}else if(k.indexOf("OpenGL ES")!==-1){O=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]);U=O>=2}let N=null;let G={};const V=e.getParameter(e.SCISSOR_BOX);const j=e.getParameter(e.VIEWPORT);const H=(new s.Vector4).fromArray(V);const z=(new s.Vector4).fromArray(j);function createTexture(t,n,r,s){const a=new Uint8Array(4);const o=e.createTexture();e.bindTexture(t,o);e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,s,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}const W={};W[e.TEXTURE_2D]=createTexture(e.TEXTURE_2D,e.TEXTURE_2D,1);W[e.TEXTURE_CUBE_MAP]=createTexture(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6);W[e.TEXTURE_2D_ARRAY]=createTexture(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1);W[e.TEXTURE_3D]=createTexture(e.TEXTURE_3D,e.TEXTURE_3D,1,1);n.setClear(0,0,0,1);r.setClear(1);a.setClear(0);enable(e.DEPTH_TEST);r.setFunc(s.LessEqualDepth);setFlipSided(false);setCullFace(s.CullFaceBack);enable(e.CULL_FACE);setBlending(s.NoBlending);function enable(t){if(c[t]!==true){e.enable(t);c[t]=true}}function disable(t){if(c[t]!==false){e.disable(t);c[t]=false}}function bindFramebuffer(t,n){if(u[t]!==n){e.bindFramebuffer(t,n);u[t]=n;t===e.DRAW_FRAMEBUFFER&&(u[e.FRAMEBUFFER]=n);t===e.FRAMEBUFFER&&(u[e.DRAW_FRAMEBUFFER]=n);return true}return false}function drawBuffers(t,n){let r=d;let s=false;if(t){r=h.get(n);if(r===void 0){r=[];h.set(n,r)}const a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=a.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=a.length;s=true}}else if(r[0]!==e.BACK){r[0]=e.BACK;s=true}s&&e.drawBuffers(r)}function useProgram(t){if(p!==t){e.useProgram(t);p=t;return true}return false}const q={[s.AddEquation]:e.FUNC_ADD,[s.SubtractEquation]:e.FUNC_SUBTRACT,[s.ReverseSubtractEquation]:e.FUNC_REVERSE_SUBTRACT};q[s.MinEquation]=e.MIN;q[s.MaxEquation]=e.MAX;const K={[s.ZeroFactor]:e.ZERO,[s.OneFactor]:e.ONE,[s.SrcColorFactor]:e.SRC_COLOR,[s.SrcAlphaFactor]:e.SRC_ALPHA,[s.SrcAlphaSaturateFactor]:e.SRC_ALPHA_SATURATE,[s.DstColorFactor]:e.DST_COLOR,[s.DstAlphaFactor]:e.DST_ALPHA,[s.OneMinusSrcColorFactor]:e.ONE_MINUS_SRC_COLOR,[s.OneMinusSrcAlphaFactor]:e.ONE_MINUS_SRC_ALPHA,[s.OneMinusDstColorFactor]:e.ONE_MINUS_DST_COLOR,[s.OneMinusDstAlphaFactor]:e.ONE_MINUS_DST_ALPHA,[s.ConstantColorFactor]:e.CONSTANT_COLOR,[s.OneMinusConstantColorFactor]:e.ONE_MINUS_CONSTANT_COLOR,[s.ConstantAlphaFactor]:e.CONSTANT_ALPHA,[s.OneMinusConstantAlphaFactor]:e.ONE_MINUS_CONSTANT_ALPHA};function setBlending(t,n,r,a,o,l,c,u,h,d){if(t!==s.NoBlending){if(f===false){enable(e.BLEND);f=true}if(t===s.CustomBlending){o=o||n;l=l||r;c=c||a;if(n!==g||o!==x){e.blendEquationSeparate(q[n],q[o]);g=n;x=o}if(r!==y||a!==b||l!==_||c!==M){e.blendFuncSeparate(K[r],K[a],K[l],K[c]);y=r;b=a;_=l;M=c}if(u.equals(w)===false||h!==S){e.blendColor(u.r,u.g,u.b,h);w.copy(u);S=h}m=t;T=false}else if(t!==m||d!==T){if(g!==s.AddEquation||x!==s.AddEquation){e.blendEquation(e.FUNC_ADD);g=s.AddEquation;x=s.AddEquation}if(d)switch(t){case s.NormalBlending:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case s.AdditiveBlending:e.blendFunc(e.ONE,e.ONE);break;case s.SubtractiveBlending:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case s.MultiplyBlending:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t);break}else switch(t){case s.NormalBlending:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case s.AdditiveBlending:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case s.SubtractiveBlending:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case s.MultiplyBlending:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t);break}y=null;b=null;_=null;M=null;w.set(0,0,0);S=0;m=t;T=d}}else if(f===true){disable(e.BLEND);f=false}}function setMaterial(t,o){t.side===s.DoubleSide?disable(e.CULL_FACE):enable(e.CULL_FACE);let l=t.side===s.BackSide;o&&(l=!l);setFlipSided(l);t.blending===s.NormalBlending&&t.transparent===false?setBlending(s.NoBlending):setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha);r.setFunc(t.depthFunc);r.setTest(t.depthTest);r.setMask(t.depthWrite);n.setMask(t.colorWrite);const c=t.stencilWrite;a.setTest(c);if(c){a.setMask(t.stencilWriteMask);a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask);a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)}setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits);t.alphaToCoverage===true?enable(e.SAMPLE_ALPHA_TO_COVERAGE):disable(e.SAMPLE_ALPHA_TO_COVERAGE)}function setFlipSided(t){if(I!==t){t?e.frontFace(e.CW):e.frontFace(e.CCW);I=t}}function setCullFace(t){if(t!==s.CullFaceNone){enable(e.CULL_FACE);t!==R&&(t===s.CullFaceBack?e.cullFace(e.BACK):t===s.CullFaceFront?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))}else disable(e.CULL_FACE);R=t}function setLineWidth(t){if(t!==L){U&&e.lineWidth(t);L=t}}function setPolygonOffset(t,n,r){if(t){enable(e.POLYGON_OFFSET_FILL);if(D!==n||P!==r){e.polygonOffset(n,r);D=n;P=r}}else disable(e.POLYGON_OFFSET_FILL)}function setScissorTest(t){t?enable(e.SCISSOR_TEST):disable(e.SCISSOR_TEST)}function activeTexture(t){t===void 0&&(t=e.TEXTURE0+F-1);if(N!==t){e.activeTexture(t);N=t}}function bindTexture(t,n,r){r===void 0&&(r=N===null?e.TEXTURE0+F-1:N);let s=G[r];if(s===void 0){s={type:void 0,texture:void 0};G[r]=s}if(s.type!==t||s.texture!==n){if(N!==r){e.activeTexture(r);N=r}e.bindTexture(t,n||W[t]);s.type=t;s.texture=n}}function unbindTexture(){const t=G[N];if(t!==void 0&&t.type!==void 0){e.bindTexture(t.type,null);t.type=void 0;t.texture=void 0}}function compressedTexImage2D(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function compressedTexImage3D(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function texSubImage2D(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function texSubImage3D(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function compressedTexSubImage2D(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function compressedTexSubImage3D(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function texStorage2D(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function texStorage3D(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function texImage2D(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function texImage3D(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function scissor(t){if(H.equals(t)===false){e.scissor(t.x,t.y,t.z,t.w);H.copy(t)}}function viewport(t){if(z.equals(t)===false){e.viewport(t.x,t.y,t.z,t.w);z.copy(t)}}function updateUBOMapping(t,n){let r=l.get(n);if(r===void 0){r=new WeakMap;l.set(n,r)}let s=r.get(t);if(s===void 0){s=e.getUniformBlockIndex(n,t.name);r.set(t,s)}}function uniformBlockBinding(t,n){const r=l.get(n);const s=r.get(t);if(o.get(n)!==s){e.uniformBlockBinding(n,s,t.__bindingPointIndex);o.set(n,s)}}function reset(){e.disable(e.BLEND);e.disable(e.CULL_FACE);e.disable(e.DEPTH_TEST);e.disable(e.POLYGON_OFFSET_FILL);e.disable(e.SCISSOR_TEST);e.disable(e.STENCIL_TEST);e.disable(e.SAMPLE_ALPHA_TO_COVERAGE);e.blendEquation(e.FUNC_ADD);e.blendFunc(e.ONE,e.ZERO);e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO);e.blendColor(0,0,0,0);e.colorMask(true,true,true,true);e.clearColor(0,0,0,0);e.depthMask(true);e.depthFunc(e.LESS);r.setReversed(false);e.clearDepth(1);e.stencilMask(4294967295);e.stencilFunc(e.ALWAYS,0,4294967295);e.stencilOp(e.KEEP,e.KEEP,e.KEEP);e.clearStencil(0);e.cullFace(e.BACK);e.frontFace(e.CCW);e.polygonOffset(0,0);e.activeTexture(e.TEXTURE0);e.bindFramebuffer(e.FRAMEBUFFER,null);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null);e.bindFramebuffer(e.READ_FRAMEBUFFER,null);e.useProgram(null);e.lineWidth(1);e.scissor(0,0,e.canvas.width,e.canvas.height);e.viewport(0,0,e.canvas.width,e.canvas.height);c={};N=null;G={};u={};h=new WeakMap;d=[];p=null;f=false;m=null;g=null;y=null;b=null;x=null;_=null;M=null;w=new s.Color(0,0,0);S=0;T=false;I=null;R=null;L=null;D=null;P=null;H.set(0,0,e.canvas.width,e.canvas.height);z.set(0,0,e.canvas.width,e.canvas.height);n.reset();r.reset();a.reset()}return{buffers:{color:n,depth:r,stencil:a},enable:enable,disable:disable,bindFramebuffer:bindFramebuffer,drawBuffers:drawBuffers,useProgram:useProgram,setBlending:setBlending,setMaterial:setMaterial,setFlipSided:setFlipSided,setCullFace:setCullFace,setLineWidth:setLineWidth,setPolygonOffset:setPolygonOffset,setScissorTest:setScissorTest,activeTexture:activeTexture,bindTexture:bindTexture,unbindTexture:unbindTexture,compressedTexImage2D:compressedTexImage2D,compressedTexImage3D:compressedTexImage3D,texImage2D:texImage2D,texImage3D:texImage3D,updateUBOMapping:updateUBOMapping,uniformBlockBinding:uniformBlockBinding,texStorage2D:texStorage2D,texStorage3D:texStorage3D,texSubImage2D:texSubImage2D,texSubImage3D:texSubImage3D,compressedTexSubImage2D:compressedTexSubImage2D,compressedTexSubImage3D:compressedTexSubImage3D,scissor:scissor,viewport:viewport,reset:reset}}function WebGLTextures(e,n,r,a,o,l,c){const u=n.has("WEBGL_multisampled_render_to_texture")?n.get("WEBGL_multisampled_render_to_texture"):null;const h=typeof navigator!=="undefined"&&/OculusBrowser/g.test(navigator.userAgent);const d=n.has("OCULUS_multiview")?n.get("OCULUS_multiview"):null;const p=new s.Vector2;const f=new WeakMap;let m;const g=new WeakMap;let y=[];let b=false;let x=false;try{x=typeof OffscreenCanvas!=="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(e){}function createCanvas(e,t){return x?new OffscreenCanvas(e,t):(0,s.createElementNS)("canvas")}function resizeImage(e,t,n){let r=1;const s=getDimensions(e);(s.width>n||s.height>n)&&(r=n/Math.max(s.width,s.height));if(r<1){if(typeof HTMLImageElement!=="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&e instanceof ImageBitmap||typeof VideoFrame!=="undefined"&&e instanceof VideoFrame){const n=Math.floor(r*s.width);const a=Math.floor(r*s.height);m===void 0&&(m=createCanvas(n,a));const o=t?createCanvas(n,a):m;o.width=n;o.height=a;const l=o.getContext("2d");l.drawImage(e,0,0,n,a);console.warn("THREE.WebGLRenderer: Texture has been resized from ("+s.width+"x"+s.height+") to ("+n+"x"+a+").");return o}"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+s.width+"x"+s.height+").");return e}return e}function textureNeedsGenerateMipmaps(e){return e.generateMipmaps}function generateMipmap(t){e.generateMipmap(t)}function getTargetType(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function getInternalFormat(t,r,a,o,l=false){if(t!==null){if(e[t]!==void 0)return e[t];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+t+"'")}let c=r;if(r===e.RED){a===e.FLOAT&&(c=e.R32F);a===e.HALF_FLOAT&&(c=e.R16F);a===e.UNSIGNED_BYTE&&(c=e.R8)}if(r===e.RED_INTEGER){a===e.UNSIGNED_BYTE&&(c=e.R8UI);a===e.UNSIGNED_SHORT&&(c=e.R16UI);a===e.UNSIGNED_INT&&(c=e.R32UI);a===e.BYTE&&(c=e.R8I);a===e.SHORT&&(c=e.R16I);a===e.INT&&(c=e.R32I)}if(r===e.RG){a===e.FLOAT&&(c=e.RG32F);a===e.HALF_FLOAT&&(c=e.RG16F);a===e.UNSIGNED_BYTE&&(c=e.RG8)}if(r===e.RG_INTEGER){a===e.UNSIGNED_BYTE&&(c=e.RG8UI);a===e.UNSIGNED_SHORT&&(c=e.RG16UI);a===e.UNSIGNED_INT&&(c=e.RG32UI);a===e.BYTE&&(c=e.RG8I);a===e.SHORT&&(c=e.RG16I);a===e.INT&&(c=e.RG32I)}if(r===e.RGB_INTEGER){a===e.UNSIGNED_BYTE&&(c=e.RGB8UI);a===e.UNSIGNED_SHORT&&(c=e.RGB16UI);a===e.UNSIGNED_INT&&(c=e.RGB32UI);a===e.BYTE&&(c=e.RGB8I);a===e.SHORT&&(c=e.RGB16I);a===e.INT&&(c=e.RGB32I)}if(r===e.RGBA_INTEGER){a===e.UNSIGNED_BYTE&&(c=e.RGBA8UI);a===e.UNSIGNED_SHORT&&(c=e.RGBA16UI);a===e.UNSIGNED_INT&&(c=e.RGBA32UI);a===e.BYTE&&(c=e.RGBA8I);a===e.SHORT&&(c=e.RGBA16I);a===e.INT&&(c=e.RGBA32I)}r===e.RGB&&a===e.UNSIGNED_INT_5_9_9_9_REV&&(c=e.RGB9_E5);if(r===e.RGBA){const t=l?s.LinearTransfer:s.ColorManagement.getTransfer(o);a===e.FLOAT&&(c=e.RGBA32F);a===e.HALF_FLOAT&&(c=e.RGBA16F);a===e.UNSIGNED_BYTE&&(c=t===s.SRGBTransfer?e.SRGB8_ALPHA8:e.RGBA8);a===e.UNSIGNED_SHORT_4_4_4_4&&(c=e.RGBA4);a===e.UNSIGNED_SHORT_5_5_5_1&&(c=e.RGB5_A1)}c!==e.R16F&&c!==e.R32F&&c!==e.RG16F&&c!==e.RG32F&&c!==e.RGBA16F&&c!==e.RGBA32F||n.get("EXT_color_buffer_float");return c}function getInternalDepthFormat(t,n){let r;if(t){if(n===null||n===s.UnsignedIntType||n===s.UnsignedInt248Type)r=e.DEPTH24_STENCIL8;else if(n===s.FloatType)r=e.DEPTH32F_STENCIL8;else if(n===s.UnsignedShortType){r=e.DEPTH24_STENCIL8;console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")}}else n===null||n===s.UnsignedIntType||n===s.UnsignedInt248Type?r=e.DEPTH_COMPONENT24:n===s.FloatType?r=e.DEPTH_COMPONENT32F:n===s.UnsignedShortType&&(r=e.DEPTH_COMPONENT16);return r}function getMipLevels(e,t){return textureNeedsGenerateMipmaps(e)===true||e.isFramebufferTexture&&e.minFilter!==s.NearestFilter&&e.minFilter!==s.LinearFilter?Math.log2(Math.max(t.width,t.height))+1:e.mipmaps!==void 0&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function onTextureDispose(e){const t=e.target;t.removeEventListener("dispose",onTextureDispose);deallocateTexture(t);t.isVideoTexture&&f.delete(t)}function onRenderTargetDispose(e){const t=e.target;t.removeEventListener("dispose",onRenderTargetDispose);deallocateRenderTarget(t)}function deallocateTexture(e){const t=a.get(e);if(t.__webglInit===void 0)return;const n=e.source;const r=g.get(n);if(r){const s=r[t.__cacheKey];s.usedTimes--;s.usedTimes===0&&deleteTexture(e);Object.keys(r).length===0&&g.delete(n)}a.remove(e)}function deleteTexture(t){const n=a.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;const s=g.get(r);delete s[n.__cacheKey];c.memory.textures--}function deallocateRenderTarget(t){const n=a.get(t);if(t.depthTexture){t.depthTexture.dispose();a.remove(t.depthTexture)}if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(n.__webglFramebuffer[t]))for(let r=0;r<n.__webglFramebuffer[t].length;r++)e.deleteFramebuffer(n.__webglFramebuffer[t][r]);else e.deleteFramebuffer(n.__webglFramebuffer[t]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer);if(n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let t=0,n=r.length;t<n;t++){const n=a.get(r[t]);if(n.__webglTexture){e.deleteTexture(n.__webglTexture);c.memory.textures--}a.remove(r[t])}a.remove(t)}let _=0;function resetTextureUnits(){_=0}function allocateTextureUnit(){const e=_;e>=o.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+o.maxTextures);_+=1;return e}function getTextureCacheKey(e){const t=[];t.push(e.wrapS);t.push(e.wrapT);t.push(e.wrapR||0);t.push(e.magFilter);t.push(e.minFilter);t.push(e.anisotropy);t.push(e.internalFormat);t.push(e.format);t.push(e.type);t.push(e.generateMipmaps);t.push(e.premultiplyAlpha);t.push(e.flipY);t.push(e.unpackAlignment);t.push(e.colorSpace);return t.join()}function setTexture2D(t,n){const s=a.get(t);t.isVideoTexture&&updateVideoTexture(t);if(t.isRenderTargetTexture===false&&t.version>0&&s.__version!==t.version){const e=t.image;if(e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(e.complete===false)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(uploadTexture(s,t,n))return}r.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+n)}function setTexture2DArray(t,n){const s=a.get(t);t.version>0&&s.__version!==t.version?uploadTexture(s,t,n):r.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+n)}function setTexture3D(t,n){const s=a.get(t);t.version>0&&s.__version!==t.version?uploadTexture(s,t,n):r.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+n)}function setTextureCube(t,n){const s=a.get(t);t.version>0&&s.__version!==t.version?uploadCubeTexture(s,t,n):r.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+n)}const M={[s.RepeatWrapping]:e.REPEAT,[s.ClampToEdgeWrapping]:e.CLAMP_TO_EDGE,[s.MirroredRepeatWrapping]:e.MIRRORED_REPEAT};const w={[s.NearestFilter]:e.NEAREST,[s.NearestMipmapNearestFilter]:e.NEAREST_MIPMAP_NEAREST,[s.NearestMipmapLinearFilter]:e.NEAREST_MIPMAP_LINEAR,[s.LinearFilter]:e.LINEAR,[s.LinearMipmapNearestFilter]:e.LINEAR_MIPMAP_NEAREST,[s.LinearMipmapLinearFilter]:e.LINEAR_MIPMAP_LINEAR};const S={[s.NeverCompare]:e.NEVER,[s.AlwaysCompare]:e.ALWAYS,[s.LessCompare]:e.LESS,[s.LessEqualCompare]:e.LEQUAL,[s.EqualCompare]:e.EQUAL,[s.GreaterEqualCompare]:e.GEQUAL,[s.GreaterCompare]:e.GREATER,[s.NotEqualCompare]:e.NOTEQUAL};function setTextureParameters(t,r){r.type!==s.FloatType||n.has("OES_texture_float_linear")!==false||r.magFilter!==s.LinearFilter&&r.magFilter!==s.LinearMipmapNearestFilter&&r.magFilter!==s.NearestMipmapLinearFilter&&r.magFilter!==s.LinearMipmapLinearFilter&&r.minFilter!==s.LinearFilter&&r.minFilter!==s.LinearMipmapNearestFilter&&r.minFilter!==s.NearestMipmapLinearFilter&&r.minFilter!==s.LinearMipmapLinearFilter||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device.");e.texParameteri(t,e.TEXTURE_WRAP_S,M[r.wrapS]);e.texParameteri(t,e.TEXTURE_WRAP_T,M[r.wrapT]);t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY||e.texParameteri(t,e.TEXTURE_WRAP_R,M[r.wrapR]);e.texParameteri(t,e.TEXTURE_MAG_FILTER,w[r.magFilter]);e.texParameteri(t,e.TEXTURE_MIN_FILTER,w[r.minFilter]);if(r.compareFunction){e.texParameteri(t,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE);e.texParameteri(t,e.TEXTURE_COMPARE_FUNC,S[r.compareFunction])}if(n.has("EXT_texture_filter_anisotropic")===true){if(r.magFilter===s.NearestFilter)return;if(r.minFilter!==s.NearestMipmapLinearFilter&&r.minFilter!==s.LinearMipmapLinearFilter)return;if(r.type===s.FloatType&&n.has("OES_texture_float_linear")===false)return;if(r.anisotropy>1||a.get(r).__currentAnisotropy){const s=n.get("EXT_texture_filter_anisotropic");e.texParameterf(t,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,o.getMaxAnisotropy()));a.get(r).__currentAnisotropy=r.anisotropy}}}function initTexture(t,n){let r=false;if(t.__webglInit===void 0){t.__webglInit=true;n.addEventListener("dispose",onTextureDispose)}const s=n.source;let a=g.get(s);if(a===void 0){a={};g.set(s,a)}const o=getTextureCacheKey(n);if(o!==t.__cacheKey){if(a[o]===void 0){a[o]={texture:e.createTexture(),usedTimes:0};c.memory.textures++;r=true}a[o].usedTimes++;const s=a[t.__cacheKey];if(s!==void 0){a[t.__cacheKey].usedTimes--;s.usedTimes===0&&deleteTexture(n)}t.__cacheKey=o;t.__webglTexture=a[o].texture}return r}function setDeferTextureUploads(e){b=e}function runDeferredUploads(){const e=b;b=false;for(const e of y){uploadTexture(e.textureProperties,e.texture,e.slot);e.texture.isPendingDeferredUpload=false}y=[];b=e}function uploadTexture(t,n,c){if(b){if(!n.isPendingDeferredUpload){n.isPendingDeferredUpload=true;y.push({textureProperties:t,texture:n,slot:c})}return false}let u=e.TEXTURE_2D;(n.isDataArrayTexture||n.isCompressedArrayTexture)&&(u=e.TEXTURE_2D_ARRAY);n.isData3DTexture&&(u=e.TEXTURE_3D);const h=initTexture(t,n);const d=n.source;r.bindTexture(u,t.__webglTexture,e.TEXTURE0+c);const p=a.get(d);if(d.version!==p.__version||h===true){r.activeTexture(e.TEXTURE0+c);const t=s.ColorManagement.getPrimaries(s.ColorManagement.workingColorSpace);const a=n.colorSpace===s.NoColorSpace?null:s.ColorManagement.getPrimaries(n.colorSpace);const f=n.colorSpace===s.NoColorSpace||t===a?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha);e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,f);let m=resizeImage(n.image,false,o.maxTextureSize);m=verifyColorSpace(n,m);const g=l.convert(n.format,n.colorSpace);const y=l.convert(n.type);let b=getInternalFormat(n.internalFormat,g,y,n.colorSpace,n.isVideoTexture);setTextureParameters(u,n);let x;const _=n.mipmaps;const M=n.isVideoTexture!==true;const w=p.__version===void 0||h===true;const S=d.dataReady;const T=getMipLevels(n,m);if(n.isDepthTexture){b=getInternalDepthFormat(n.format===s.DepthStencilFormat,n.type);w&&(M?r.texStorage2D(e.TEXTURE_2D,1,b,m.width,m.height):r.texImage2D(e.TEXTURE_2D,0,b,m.width,m.height,0,g,y,null))}else if(n.isDataTexture)if(_.length>0){M&&w&&r.texStorage2D(e.TEXTURE_2D,T,b,_[0].width,_[0].height);for(let t=0,n=_.length;t<n;t++){x=_[t];M?S&&r.texSubImage2D(e.TEXTURE_2D,t,0,0,x.width,x.height,g,y,x.data):r.texImage2D(e.TEXTURE_2D,t,b,x.width,x.height,0,g,y,x.data)}n.generateMipmaps=false}else if(M){w&&r.texStorage2D(e.TEXTURE_2D,T,b,m.width,m.height);S&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,m.width,m.height,g,y,m.data)}else r.texImage2D(e.TEXTURE_2D,0,b,m.width,m.height,0,g,y,m.data);else if(n.isCompressedTexture)if(n.isCompressedArrayTexture){M&&w&&r.texStorage3D(e.TEXTURE_2D_ARRAY,T,b,_[0].width,_[0].height,m.depth);for(let t=0,a=_.length;t<a;t++){x=_[t];if(n.format!==s.RGBAFormat)if(g!==null)if(M){if(S)if(n.layerUpdates.size>0){const a=(0,s.getByteLength)(x.width,x.height,n.format,n.type);for(const s of n.layerUpdates){const n=x.data.subarray(s*a/x.data.BYTES_PER_ELEMENT,(s+1)*a/x.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,s,x.width,x.height,1,g,n)}n.clearLayerUpdates()}else r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,x.width,x.height,m.depth,g,x.data)}else r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,b,x.width,x.height,m.depth,0,x.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else M?S&&r.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,x.width,x.height,m.depth,g,y,x.data):r.texImage3D(e.TEXTURE_2D_ARRAY,t,b,x.width,x.height,m.depth,0,g,y,x.data)}}else{M&&w&&r.texStorage2D(e.TEXTURE_2D,T,b,_[0].width,_[0].height);for(let t=0,a=_.length;t<a;t++){x=_[t];n.format!==s.RGBAFormat?g!==null?M?S&&r.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,x.width,x.height,g,x.data):r.compressedTexImage2D(e.TEXTURE_2D,t,b,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):M?S&&r.texSubImage2D(e.TEXTURE_2D,t,0,0,x.width,x.height,g,y,x.data):r.texImage2D(e.TEXTURE_2D,t,b,x.width,x.height,0,g,y,x.data)}}else if(n.isDataArrayTexture)if(M){w&&r.texStorage3D(e.TEXTURE_2D_ARRAY,T,b,m.width,m.height,m.depth);if(S)if(n.layerUpdates.size>0){const t=(0,s.getByteLength)(m.width,m.height,n.format,n.type);for(const s of n.layerUpdates){const n=m.data.subarray(s*t/m.data.BYTES_PER_ELEMENT,(s+1)*t/m.data.BYTES_PER_ELEMENT);r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,s,m.width,m.height,1,g,y,n)}n.clearLayerUpdates()}else r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,m.width,m.height,m.depth,g,y,m.data)}else r.texImage3D(e.TEXTURE_2D_ARRAY,0,b,m.width,m.height,m.depth,0,g,y,m.data);else if(n.isData3DTexture)if(M){w&&r.texStorage3D(e.TEXTURE_3D,T,b,m.width,m.height,m.depth);S&&r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,m.width,m.height,m.depth,g,y,m.data)}else r.texImage3D(e.TEXTURE_3D,0,b,m.width,m.height,m.depth,0,g,y,m.data);else if(n.isFramebufferTexture){if(w)if(M)r.texStorage2D(e.TEXTURE_2D,T,b,m.width,m.height);else{let t=m.width,n=m.height;for(let s=0;s<T;s++){r.texImage2D(e.TEXTURE_2D,s,b,t,n,0,g,y,null);t>>=1;n>>=1}}}else if(_.length>0){if(M&&w){const t=getDimensions(_[0]);r.texStorage2D(e.TEXTURE_2D,T,b,t.width,t.height)}for(let t=0,n=_.length;t<n;t++){x=_[t];M?S&&r.texSubImage2D(e.TEXTURE_2D,t,0,0,g,y,x):r.texImage2D(e.TEXTURE_2D,t,b,g,y,x)}n.generateMipmaps=false}else if(M){if(w){const t=getDimensions(m);r.texStorage2D(e.TEXTURE_2D,T,b,t.width,t.height)}S&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,g,y,m)}else r.texImage2D(e.TEXTURE_2D,0,b,g,y,m);textureNeedsGenerateMipmaps(n)&&generateMipmap(u);p.__version=d.version;n.onUpdate&&n.onUpdate(n)}t.__version=n.version;return true}function uploadCubeTexture(t,n,c){if(n.image.length!==6)return;const u=initTexture(t,n);const h=n.source;r.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+c);const d=a.get(h);if(h.version!==d.__version||u===true){r.activeTexture(e.TEXTURE0+c);const t=s.ColorManagement.getPrimaries(s.ColorManagement.workingColorSpace);const a=n.colorSpace===s.NoColorSpace?null:s.ColorManagement.getPrimaries(n.colorSpace);const p=n.colorSpace===s.NoColorSpace||t===a?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha);e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);const f=n.isCompressedTexture||n.image[0].isCompressedTexture;const m=n.image[0]&&n.image[0].isDataTexture;const g=[];for(let e=0;e<6;e++){g[e]=f||m?m?n.image[e].image:n.image[e]:resizeImage(n.image[e],true,o.maxCubemapSize);g[e]=verifyColorSpace(n,g[e])}const y=g[0],b=l.convert(n.format,n.colorSpace),x=l.convert(n.type),_=getInternalFormat(n.internalFormat,b,x,n.colorSpace);const M=n.isVideoTexture!==true;const w=d.__version===void 0||u===true;const S=h.dataReady;let T=getMipLevels(n,y);setTextureParameters(e.TEXTURE_CUBE_MAP,n);let I;if(f){M&&w&&r.texStorage2D(e.TEXTURE_CUBE_MAP,T,_,y.width,y.height);for(let t=0;t<6;t++){I=g[t].mipmaps;for(let a=0;a<I.length;a++){const o=I[a];n.format!==s.RGBAFormat?b!==null?M?S&&r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,a,0,0,o.width,o.height,b,o.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,a,_,o.width,o.height,0,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):M?S&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,a,0,0,o.width,o.height,b,x,o.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,a,_,o.width,o.height,0,b,x,o.data)}}}else{I=n.mipmaps;if(M&&w){I.length>0&&T++;const t=getDimensions(g[0]);r.texStorage2D(e.TEXTURE_CUBE_MAP,T,_,t.width,t.height)}for(let t=0;t<6;t++)if(m){M?S&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,g[t].width,g[t].height,b,x,g[t].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,_,g[t].width,g[t].height,0,b,x,g[t].data);for(let n=0;n<I.length;n++){const s=I[n];const a=s.image[t].image;M?S&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,a.width,a.height,b,x,a.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,_,a.width,a.height,0,b,x,a.data)}}else{M?S&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,b,x,g[t]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,_,b,x,g[t]);for(let n=0;n<I.length;n++){const s=I[n];M?S&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,b,x,s.image[t]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,_,b,x,s.image[t])}}}textureNeedsGenerateMipmaps(n)&&generateMipmap(e.TEXTURE_CUBE_MAP);d.__version=h.version;n.onUpdate&&n.onUpdate(n)}t.__version=n.version}function setupFrameBufferTexture(t,n,s,o,c,h){const p=l.convert(s.format,s.colorSpace);const f=l.convert(s.type);const m=getInternalFormat(s.internalFormat,p,f,s.colorSpace);const g=a.get(n);const y=a.get(s);y.__renderTarget=n;if(!g.__hasExternalTextures){const t=Math.max(1,n.width>>h);const s=Math.max(1,n.height>>h);n.isWebGLMultiviewRenderTarget===true?r.texStorage3D(e.TEXTURE_2D_ARRAY,0,m,n.width,n.height,n.numViews):c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?r.texImage3D(c,h,m,t,s,n.depth,0,p,f,null):r.texImage2D(c,h,m,t,s,0,p,f,null)}r.bindFramebuffer(e.FRAMEBUFFER,t);const b=useMultisampledRTT(n);n.isWebGLMultiviewRenderTarget===true?b?d.framebufferTextureMultisampleMultiviewOVR(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,y.__webglTexture,0,getRenderTargetSamples(n),0,n.numViews):d.framebufferTextureMultiviewOVR(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,y.__webglTexture,0,0,n.numViews):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(b?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,o,c,y.__webglTexture,0,getRenderTargetSamples(n)):e.framebufferTexture2D(e.FRAMEBUFFER,o,c,y.__webglTexture,h));r.bindFramebuffer(e.FRAMEBUFFER,null)}function setupRenderBufferStorage(t,n,r){e.bindRenderbuffer(e.RENDERBUFFER,t);if(n.isWebGLMultiviewRenderTarget===true){const t=useMultisampledRTT(n);const r=n.numViews;const o=n.depthTexture;let l=e.DEPTH_COMPONENT24;let c=e.DEPTH_ATTACHMENT;if(o&&o.isDepthTexture)if(o.type===s.FloatType)l=e.DEPTH_COMPONENT32F;else if(o.type===s.UnsignedInt248Type){l=e.DEPTH24_STENCIL8;c=e.DEPTH_STENCIL_ATTACHMENT}let u=a.get(n.depthTexture).__webglTexture;if(u===void 0){u=e.createTexture();e.bindTexture(e.TEXTURE_2D_ARRAY,u);e.texStorage3D(e.TEXTURE_2D_ARRAY,1,l,n.width,n.height,r)}t?d.framebufferTextureMultisampleMultiviewOVR(e.FRAMEBUFFER,c,u,0,getRenderTargetSamples(n),0,r):d.framebufferTextureMultiviewOVR(e.FRAMEBUFFER,c,u,0,0,r)}else if(n.depthBuffer){const s=n.depthTexture;const a=s&&s.isDepthTexture?s.type:null;const o=getInternalDepthFormat(n.stencilBuffer,a);const l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;const c=getRenderTargetSamples(n);const h=useMultisampledRTT(n);h?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,o,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,o,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,o,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let s=0;s<t.length;s++){const a=t[s];const o=l.convert(a.format,a.colorSpace);const c=l.convert(a.type);const h=getInternalFormat(a.internalFormat,o,c,a.colorSpace);const d=getRenderTargetSamples(n);r&&useMultisampledRTT(n)===false?e.renderbufferStorageMultisample(e.RENDERBUFFER,d,h,n.width,n.height):useMultisampledRTT(n)?u.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,d,h,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,h,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function setupDepthTexture(t,n){const o=n&&n.isWebGLCubeRenderTarget;if(o)throw new Error("Depth Texture with cube render targets is not supported");r.bindFramebuffer(e.FRAMEBUFFER,t);if(!(n.depthTexture&&n.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const l=a.get(n.depthTexture);l.__renderTarget=n;if(!l.__webglTexture||n.depthTexture.image.width!==n.width||n.depthTexture.image.height!==n.height){n.depthTexture.image.width=n.width;n.depthTexture.image.height=n.height;n.depthTexture.needsUpdate=true}n.depthTexture.image.depth!=1?setTexture2DArray(n.depthTexture,0):setTexture2D(n.depthTexture,0);const c=l.__webglTexture;const h=getRenderTargetSamples(n);if(n.isWebGLMultiviewRenderTarget===true){const t=useMultisampledRTT(n);const r=n.numViews;if(n.depthTexture.format===s.DepthFormat)t?d.framebufferTextureMultisampleMultiviewOVR(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,c,0,h,0,r):d.framebufferTextureMultiviewOVR(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,c,0,0,r);else{if(n.depthTexture.format!==s.DepthStencilFormat)throw new Error("Unknown depthTexture format");t?d.framebufferTextureMultisampleMultiviewOVR(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,c,0,h,0,r):d.framebufferTextureMultiviewOVR(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,c,0,0,r)}}else if(n.depthTexture.format===s.DepthFormat)useMultisampledRTT(n)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,c,0,h):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,c,0);else{if(n.depthTexture.format!==s.DepthStencilFormat)throw new Error("Unknown depthTexture format");useMultisampledRTT(n)?u.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,c,0,h):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,c,0)}}function setupDepthRenderbuffer(t){const n=a.get(t);const s=t.isWebGLCubeRenderTarget===true;if(n.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;n.__depthDisposeCallback&&n.__depthDisposeCallback();if(e){const disposeEvent=()=>{delete n.__boundDepthTexture;delete n.__depthDisposeCallback;e.removeEventListener("dispose",disposeEvent)};e.addEventListener("dispose",disposeEvent);n.__depthDisposeCallback=disposeEvent}n.__boundDepthTexture=e}if(t.depthTexture&&!n.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");setupDepthTexture(n.__webglFramebuffer,t)}else if(s){n.__webglDepthbuffer=[];for(let s=0;s<6;s++){r.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[s]);if(n.__webglDepthbuffer[s]===void 0){n.__webglDepthbuffer[s]=e.createRenderbuffer();setupRenderBufferStorage(n.__webglDepthbuffer[s],t,false)}else{const r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;const a=n.__webglDepthbuffer[s];e.bindRenderbuffer(e.RENDERBUFFER,a);e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,a)}}}else{r.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer);if(n.__webglDepthbuffer===void 0){n.__webglDepthbuffer=e.createRenderbuffer();setupRenderBufferStorage(n.__webglDepthbuffer,t,false)}else{const r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;const s=n.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,s);e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,s)}}r.bindFramebuffer(e.FRAMEBUFFER,null)}function rebindTextures(t,n,r){const s=a.get(t);n!==void 0&&setupFrameBufferTexture(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0);r!==void 0&&setupDepthRenderbuffer(t)}function setupRenderTarget(t){const n=t.texture;const s=a.get(t);const o=a.get(n);t.addEventListener("dispose",onRenderTargetDispose);const u=t.textures;const h=t.isWebGLCubeRenderTarget===true;const d=u.length>1;if(!d){o.__webglTexture===void 0&&(o.__webglTexture=e.createTexture());o.__version=n.version;c.memory.textures++}if(h){s.__webglFramebuffer=[];for(let t=0;t<6;t++)if(n.mipmaps&&n.mipmaps.length>0){s.__webglFramebuffer[t]=[];for(let r=0;r<n.mipmaps.length;r++)s.__webglFramebuffer[t][r]=e.createFramebuffer()}else s.__webglFramebuffer[t]=e.createFramebuffer()}else{if(n.mipmaps&&n.mipmaps.length>0){s.__webglFramebuffer=[];for(let t=0;t<n.mipmaps.length;t++)s.__webglFramebuffer[t]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer();if(d)for(let t=0,n=u.length;t<n;t++){const n=a.get(u[t]);if(n.__webglTexture===void 0){n.__webglTexture=e.createTexture();c.memory.textures++}}if(t.samples>0&&useMultisampledRTT(t)===false){s.__webglMultisampledFramebuffer=e.createFramebuffer();s.__webglColorRenderbuffer=[];r.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(let n=0;n<u.length;n++){const r=u[n];s.__webglColorRenderbuffer[n]=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer[n]);const a=l.convert(r.format,r.colorSpace);const o=l.convert(r.type);const c=getInternalFormat(r.internalFormat,a,o,r.colorSpace,t.isXRRenderTarget===true);const h=getRenderTargetSamples(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,h,c,t.width,t.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,s.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null);if(t.depthBuffer){s.__webglDepthRenderbuffer=e.createRenderbuffer();setupRenderBufferStorage(s.__webglDepthRenderbuffer,t,true)}r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(h){r.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture);setTextureParameters(e.TEXTURE_CUBE_MAP,n);for(let r=0;r<6;r++)if(n.mipmaps&&n.mipmaps.length>0)for(let a=0;a<n.mipmaps.length;a++)setupFrameBufferTexture(s.__webglFramebuffer[r][a],t,n,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,a);else setupFrameBufferTexture(s.__webglFramebuffer[r],t,n,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0);textureNeedsGenerateMipmaps(n)&&generateMipmap(e.TEXTURE_CUBE_MAP);r.unbindTexture()}else if(d){for(let n=0,o=u.length;n<o;n++){const o=u[n];const l=a.get(o);r.bindTexture(e.TEXTURE_2D,l.__webglTexture);setTextureParameters(e.TEXTURE_2D,o);setupFrameBufferTexture(s.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+n,e.TEXTURE_2D,0);textureNeedsGenerateMipmaps(o)&&generateMipmap(e.TEXTURE_2D)}r.unbindTexture()}else{let a=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(a=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY);t.isWebGLMultiviewRenderTarget===true&&(a=e.TEXTURE_2D_ARRAY);r.bindTexture(a,o.__webglTexture);setTextureParameters(a,n);if(n.mipmaps&&n.mipmaps.length>0)for(let r=0;r<n.mipmaps.length;r++)setupFrameBufferTexture(s.__webglFramebuffer[r],t,n,e.COLOR_ATTACHMENT0,a,r);else setupFrameBufferTexture(s.__webglFramebuffer,t,n,e.COLOR_ATTACHMENT0,a,0);textureNeedsGenerateMipmaps(n)&&generateMipmap(a);r.unbindTexture()}(t.depthBuffer||t.isWebGLMultiviewRenderTarget===true)&&this.setupDepthRenderbuffer(t)}function updateRenderTargetMipmap(e){const t=e.textures;for(let n=0,s=t.length;n<s;n++){const s=t[n];if(textureNeedsGenerateMipmaps(s)){const t=getTargetType(e);const n=a.get(s).__webglTexture;r.bindTexture(t,n);generateMipmap(t);r.unbindTexture()}}}const T=[];const I=[];function updateMultisampleRenderTarget(t){if(t.samples>0)if(useMultisampledRTT(t)===false){const n=t.textures;const s=t.width;const o=t.height;let l=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;const u=a.get(t);const d=n.length>1;if(d)for(let t=0;t<n.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null);r.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer);e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0)}r.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);r.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let r=0;r<n.length;r++){if(t.resolveDepthBuffer){t.depthBuffer&&(l|=e.DEPTH_BUFFER_BIT);t.stencilBuffer&&t.resolveStencilBuffer&&(l|=e.STENCIL_BUFFER_BIT)}if(d){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[r]);const t=a.get(n[r]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,l,e.NEAREST);if(h===true){T.length=0;I.length=0;T.push(e.COLOR_ATTACHMENT0+r);if(t.depthBuffer&&t.resolveDepthBuffer===false){T.push(c);I.push(c);e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,I)}e.invalidateFramebuffer(e.READ_FRAMEBUFFER,T)}}r.bindFramebuffer(e.READ_FRAMEBUFFER,null);r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null);if(d)for(let t=0;t<n.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=a.get(n[t]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer);e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&t.resolveDepthBuffer===false&&h){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}}function getRenderTargetSamples(e){return Math.min(o.maxSamples,e.samples)}function useMultisampledRTT(e){const t=a.get(e);return e.samples>0&&n.has("WEBGL_multisampled_render_to_texture")===true&&t.__useRenderToTexture!==false}function updateVideoTexture(e){const t=c.render.frame;if(f.get(e)!==t){f.set(e,t);e.update()}}function verifyColorSpace(e,t){const n=e.colorSpace;const r=e.format;const a=e.type;if(e.isCompressedTexture===true||e.isVideoTexture===true)return t;n!==s.LinearSRGBColorSpace&&n!==s.NoColorSpace&&(s.ColorManagement.getTransfer(n)===s.SRGBTransfer?r===s.RGBAFormat&&a===s.UnsignedByteType||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n));return t}function getDimensions(e){if(typeof HTMLImageElement!=="undefined"&&e instanceof HTMLImageElement){p.width=e.naturalWidth||e.width;p.height=e.naturalHeight||e.height}else if(typeof VideoFrame!=="undefined"&&e instanceof VideoFrame){p.width=e.displayWidth;p.height=e.displayHeight}else{p.width=e.width;p.height=e.height}return p}(this||t).allocateTextureUnit=allocateTextureUnit;(this||t).resetTextureUnits=resetTextureUnits;(this||t).setTexture2D=setTexture2D;(this||t).setTexture2DArray=setTexture2DArray;(this||t).setTexture3D=setTexture3D;(this||t).setTextureCube=setTextureCube;(this||t).rebindTextures=rebindTextures;(this||t).uploadTexture=uploadTexture;(this||t).setupRenderTarget=setupRenderTarget;(this||t).updateRenderTargetMipmap=updateRenderTargetMipmap;(this||t).updateMultisampleRenderTarget=updateMultisampleRenderTarget;(this||t).setupDepthTexture=setupDepthTexture;(this||t).setupDepthRenderbuffer=setupDepthRenderbuffer;(this||t).setupFrameBufferTexture=setupFrameBufferTexture;(this||t).useMultisampledRTT=useMultisampledRTT;(this||t).runDeferredUploads=runDeferredUploads;(this||t).setDeferTextureUploads=setDeferTextureUploads}function WebGLUtils(e,t){function convert(n,r=s.NoColorSpace){let a;const o=s.ColorManagement.getTransfer(r);if(n===s.UnsignedByteType)return e.UNSIGNED_BYTE;if(n===s.UnsignedShort4444Type)return e.UNSIGNED_SHORT_4_4_4_4;if(n===s.UnsignedShort5551Type)return e.UNSIGNED_SHORT_5_5_5_1;if(n===s.UnsignedInt5999Type)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===s.ByteType)return e.BYTE;if(n===s.ShortType)return e.SHORT;if(n===s.UnsignedShortType)return e.UNSIGNED_SHORT;if(n===s.IntType)return e.INT;if(n===s.UnsignedIntType)return e.UNSIGNED_INT;if(n===s.FloatType)return e.FLOAT;if(n===s.HalfFloatType)return e.HALF_FLOAT;if(n===s.AlphaFormat)return e.ALPHA;if(n===s.RGBFormat)return e.RGB;if(n===s.RGBAFormat)return e.RGBA;if(n===s.LuminanceFormat)return e.LUMINANCE;if(n===s.LuminanceAlphaFormat)return e.LUMINANCE_ALPHA;if(n===s.DepthFormat)return e.DEPTH_COMPONENT;if(n===s.DepthStencilFormat)return e.DEPTH_STENCIL;if(n===s.RedFormat)return e.RED;if(n===s.RedIntegerFormat)return e.RED_INTEGER;if(n===s.RGFormat)return e.RG;if(n===s.RGIntegerFormat)return e.RG_INTEGER;if(n===s.RGBAIntegerFormat)return e.RGBA_INTEGER;if(n===s.RGB_S3TC_DXT1_Format||n===s.RGBA_S3TC_DXT1_Format||n===s.RGBA_S3TC_DXT3_Format||n===s.RGBA_S3TC_DXT5_Format)if(o===s.SRGBTransfer){a=t.get("WEBGL_compressed_texture_s3tc_srgb");if(a===null)return null;if(n===s.RGB_S3TC_DXT1_Format)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===s.RGBA_S3TC_DXT1_Format)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===s.RGBA_S3TC_DXT3_Format)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===s.RGBA_S3TC_DXT5_Format)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{a=t.get("WEBGL_compressed_texture_s3tc");if(a===null)return null;if(n===s.RGB_S3TC_DXT1_Format)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===s.RGBA_S3TC_DXT1_Format)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===s.RGBA_S3TC_DXT3_Format)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===s.RGBA_S3TC_DXT5_Format)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===s.RGB_PVRTC_4BPPV1_Format||n===s.RGB_PVRTC_2BPPV1_Format||n===s.RGBA_PVRTC_4BPPV1_Format||n===s.RGBA_PVRTC_2BPPV1_Format){a=t.get("WEBGL_compressed_texture_pvrtc");if(a===null)return null;if(n===s.RGB_PVRTC_4BPPV1_Format)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===s.RGB_PVRTC_2BPPV1_Format)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===s.RGBA_PVRTC_4BPPV1_Format)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===s.RGBA_PVRTC_2BPPV1_Format)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===s.RGB_ETC1_Format||n===s.RGB_ETC2_Format||n===s.RGBA_ETC2_EAC_Format){a=t.get("WEBGL_compressed_texture_etc");if(a===null)return null;if(n===s.RGB_ETC1_Format||n===s.RGB_ETC2_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===s.RGBA_ETC2_EAC_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(n===s.RGBA_ASTC_4x4_Format||n===s.RGBA_ASTC_5x4_Format||n===s.RGBA_ASTC_5x5_Format||n===s.RGBA_ASTC_6x5_Format||n===s.RGBA_ASTC_6x6_Format||n===s.RGBA_ASTC_8x5_Format||n===s.RGBA_ASTC_8x6_Format||n===s.RGBA_ASTC_8x8_Format||n===s.RGBA_ASTC_10x5_Format||n===s.RGBA_ASTC_10x6_Format||n===s.RGBA_ASTC_10x8_Format||n===s.RGBA_ASTC_10x10_Format||n===s.RGBA_ASTC_12x10_Format||n===s.RGBA_ASTC_12x12_Format){a=t.get("WEBGL_compressed_texture_astc");if(a===null)return null;if(n===s.RGBA_ASTC_4x4_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===s.RGBA_ASTC_5x4_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===s.RGBA_ASTC_5x5_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===s.RGBA_ASTC_6x5_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===s.RGBA_ASTC_6x6_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===s.RGBA_ASTC_8x5_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===s.RGBA_ASTC_8x6_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===s.RGBA_ASTC_8x8_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===s.RGBA_ASTC_10x5_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===s.RGBA_ASTC_10x6_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===s.RGBA_ASTC_10x8_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===s.RGBA_ASTC_10x10_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===s.RGBA_ASTC_12x10_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===s.RGBA_ASTC_12x12_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===s.RGBA_BPTC_Format||n===s.RGB_BPTC_SIGNED_Format||n===s.RGB_BPTC_UNSIGNED_Format){a=t.get("EXT_texture_compression_bptc");if(a===null)return null;if(n===s.RGBA_BPTC_Format)return o===s.SRGBTransfer?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===s.RGB_BPTC_SIGNED_Format)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===s.RGB_BPTC_UNSIGNED_Format)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===s.RED_RGTC1_Format||n===s.SIGNED_RED_RGTC1_Format||n===s.RED_GREEN_RGTC2_Format||n===s.SIGNED_RED_GREEN_RGTC2_Format){a=t.get("EXT_texture_compression_rgtc");if(a===null)return null;if(n===s.RGBA_BPTC_Format)return a.COMPRESSED_RED_RGTC1_EXT;if(n===s.SIGNED_RED_RGTC1_Format)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===s.RED_GREEN_RGTC2_Format)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===s.SIGNED_RED_GREEN_RGTC2_Format)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===s.UnsignedInt248Type?e.UNSIGNED_INT_24_8:e[n]!==void 0?e[n]:null}return{convert:convert}}class WebGLMultiviewRenderTarget extends s.WebGLRenderTarget{constructor(e,t,n,r={}){super(e,t,r);this.depthBuffer=false;this.stencilBuffer=false;this.numViews=n}copy(e){super.copy(e);this.numViews=e.numViews;return this}}WebGLMultiviewRenderTarget.prototype.isWebGLMultiviewRenderTarget=true;const Dn="\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}";const Pn="\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}";class WebXRDepthSensing{constructor(){this.texture=null;this.mesh=null;this.depthNear=0;this.depthFar=0}init(e,t,n){if(this.texture===null){const r=new s.Texture;const a=e.properties.get(r);a.__webglTexture=t.texture;if(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar){this.depthNear=t.depthNear;this.depthFar=t.depthFar}this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport;const n=new s.ShaderMaterial({vertexShader:Dn,fragmentShader:Pn,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new s.Mesh(new s.PlaneGeometry(20,20),n)}return this.mesh}reset(){this.texture=null;this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends s.EventDispatcher{constructor(e,t,n,r){super();const a=this;let o=null;let l=1;var c=null;let u=null;let h="local-floor";let d=1;let p=null;let f=null;var m=[];let g=null;let y=null;let b=null;let x=null;const _=new WebXRDepthSensing;const M=t.getContextAttributes();let w=null;let S=null;const T=[];const I=[];const R=new s.Vector2;let L=null;const D=new s.PerspectiveCamera;D.viewport=new s.Vector4;const P=new s.PerspectiveCamera;P.viewport=new s.Vector4;const F=[D,P];const U=new s.ArrayCamera;let O=null;let k=null;this.cameraAutoUpdate=true;this.layersEnabled=false;this.enabled=false;this.isPresenting=false;this.isMultiview=false;this.getCameraPose=function(){return f};this.getController=function(e){let t=T[e];if(t===void 0){t=new s.WebXRController;T[e]=t}return t.getTargetRaySpace()};this.getControllerGrip=function(e){let t=T[e];if(t===void 0){t=new s.WebXRController;T[e]=t}return t.getGripSpace()};this.getHand=function(e){let t=T[e];if(t===void 0){t=new s.WebXRController;T[e]=t}return t.getHandSpace()};function onSessionEvent(e){const t=I.indexOf(e.inputSource);if(t===-1)return;const n=T[t];if(n!==void 0){n.update(e.inputSource,e.frame,p||u);n.dispatchEvent({type:e.type,data:e.inputSource})}}function onSessionEnd(){o.removeEventListener("select",onSessionEvent);o.removeEventListener("selectstart",onSessionEvent);o.removeEventListener("selectend",onSessionEvent);o.removeEventListener("squeeze",onSessionEvent);o.removeEventListener("squeezestart",onSessionEvent);o.removeEventListener("squeezeend",onSessionEvent);o.removeEventListener("end",onSessionEnd);o.removeEventListener("inputsourceschange",onInputSourcesChange);for(let e=0;e<T.length;e++){const t=I[e];if(t!==null){I[e]=null;T[e].disconnect(t)}}O=null;k=null;_.reset();e.setRenderTarget(w);b=null;y=null;g=null;o=null;S=null;j.stop();a.isPresenting=false;e.setPixelRatio(L);e.setSize(R.width,R.height,false);a.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(e){l=e;a.isPresenting===true&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")};this.setReferenceSpaceType=function(e){h=e;a.isPresenting===true&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")};this.getReferenceSpace=function(){return p||u};this.setReferenceSpace=function(e){p=e};this.getBaseLayer=function(){return y!==null?y:b};this.getBinding=function(){return g};this.getRenderTarget=function(){return S};this.getFrame=function(){return x};this.getSession=function(){return o};this.setSession=async function(c){o=c;if(o!==null){w=e.getRenderTarget();o.addEventListener("select",onSessionEvent);o.addEventListener("selectstart",onSessionEvent);o.addEventListener("selectend",onSessionEvent);o.addEventListener("squeeze",onSessionEvent);o.addEventListener("squeezestart",onSessionEvent);o.addEventListener("squeezeend",onSessionEvent);o.addEventListener("end",onSessionEnd);o.addEventListener("inputsourceschange",onInputSourcesChange);M.xrCompatible!==true&&await t.makeXRCompatible();L=e.getPixelRatio();e.getSize(R);const c=typeof XRWebGLBinding!=="undefined"&&"createProjectionLayer"in XRWebGLBinding.prototype;if(c){let c=null;let u=null;let h=null;if(M.depth){h=M.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24;c=M.stencil?s.DepthStencilFormat:s.DepthFormat;u=M.stencil?s.UnsignedInt248Type:s.UnsignedIntType}a.isMultiview=r&&n.has("OCULUS_multiview");const d={colorFormat:t.RGBA8,depthFormat:h,scaleFactor:l};a.isMultiview&&(d.textureType="texture-array");g=new XRWebGLBinding(o,t);y=g.createProjectionLayer(d);o.updateRenderState({layers:[y]});e.setPixelRatio(1);e.setSize(y.textureWidth,y.textureHeight,false);const p={format:s.RGBAFormat,type:s.UnsignedByteType,depthTexture:new s.DepthTexture(y.textureWidth,y.textureHeight,u,void 0,void 0,void 0,void 0,void 0,void 0,c),stencilBuffer:M.stencil,colorSpace:e.outputColorSpace,samples:M.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===false};if(a.isMultiview){const e=n.get("OCULUS_multiview");this.maxNumViews=t.getParameter(e.MAX_VIEWS_OVR);S=new WebGLMultiviewRenderTarget(y.textureWidth,y.textureHeight,2,p)}else S=new s.WebGLRenderTarget(y.textureWidth,y.textureHeight,p)}else{const n={antialias:M.antialias,alpha:true,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:l};b=new XRWebGLLayer(o,t,n);o.updateRenderState({baseLayer:b});e.setPixelRatio(1);e.setSize(b.framebufferWidth,b.framebufferHeight,false);S=new s.WebGLRenderTarget(b.framebufferWidth,b.framebufferHeight,{format:s.RGBAFormat,type:s.UnsignedByteType,colorSpace:e.outputColorSpace,stencilBuffer:M.stencil})}S.isXRRenderTarget=true;this.setFoveation(d);p=null;u=await o.requestReferenceSpace(h);j.setContext(o);j.start();a.isPresenting=true;a.dispatchEvent({type:"sessionstart"})}};this.getEnvironmentBlendMode=function(){if(o!==null)return o.environmentBlendMode};this.addLayer=function(e){if(window.XRWebGLBinding&&this.layersEnabled&&o){m.push(e);this.updateLayers()}};this.removeLayer=function(e){m.splice(m.indexOf(e),1);window.XRWebGLBinding&&this.layersEnabled&&o&&this.updateLayers()};this.updateLayers=function(){var e=m.map((function(e){return e}));e.unshift(o.renderState.layers[0]);o.updateRenderState({layers:e})};this.getDepthTexture=function(){return _.getDepthTexture()};function onInputSourcesChange(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t];const r=I.indexOf(n);if(r>=0){I[r]=null;T[r].disconnect(n)}}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=I.indexOf(n);if(r===-1){for(let e=0;e<T.length;e++){if(e>=I.length){I.push(n);r=e;break}if(I[e]===null){I[e]=n;r=e;break}}if(r===-1)break}const s=T[r];s&&s.connect(n)}}const N=new s.Vector3;const G=new s.Vector3;
/**
                                                                                          * Assumes 2 cameras that are parallel and share an X-axis, and that
                                                                                          * the cameras' projection and world matrices have already been set.
                                                                                          * And that near and far planes are identical for both cameras.
                                                                                          * Visualization of this technique: https://computergraphics.stackexchange.com/a/4765
                                                                                          *
                                                                                          * @param {ArrayCamera} camera - The camera to update.
                                                                                          * @param {PerspectiveCamera} cameraL - The left camera.
                                                                                          * @param {PerspectiveCamera} cameraR - The right camera.
                                                                                          */function setProjectionFromUnion(e,t,n){N.setFromMatrixPosition(t.matrixWorld);G.setFromMatrixPosition(n.matrixWorld);const r=N.distanceTo(G);const s=t.projectionMatrix.elements;const a=n.projectionMatrix.elements;const o=s[14]/(s[10]-1);const l=s[14]/(s[10]+1);const c=(s[9]+1)/s[5];const u=(s[9]-1)/s[5];const h=(s[8]-1)/s[0];const d=(a[8]+1)/a[0];const p=o*h;const f=o*d;const m=r/(-h+d);const g=m*-h;t.matrixWorld.decompose(e.position,e.quaternion,e.scale);e.translateX(g);e.translateZ(m);e.matrixWorld.compose(e.position,e.quaternion,e.scale);e.matrixWorldInverse.copy(e.matrixWorld).invert();if(s[10]===-1){e.projectionMatrix.copy(t.projectionMatrix);e.projectionMatrixInverse.copy(t.projectionMatrixInverse)}else{const t=o+m;const n=l+m;const s=p-g;const a=f+(r-g);const h=c*l/n*t;const d=u*l/n*t;e.projectionMatrix.makePerspective(s,a,h,d,t,n);e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}function updateCamera(e,t){t===null?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix);e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.setPoseTarget=function(e){e!==void 0&&(c=e)};this.updateCamera=function(e){if(o===null)return;let t=e.near;let n=e.far;if(_.texture!==null){_.depthNear>0&&(t=_.depthNear);_.depthFar>0&&(n=_.depthFar)}U.near=P.near=D.near=t;U.far=P.far=D.far=n;if(O!==U.near||k!==U.far){o.updateRenderState({depthNear:U.near,depthFar:U.far});O=U.near;k=U.far}D.layers.mask=e.layers.mask|2;P.layers.mask=e.layers.mask|4;U.layers.mask=D.layers.mask|P.layers.mask;const r=U.cameras;var s=c||e;const a=s.parent;updateCamera(U,a);for(let e=0;e<r.length;e++)updateCamera(r[e],a);r.length===2?setProjectionFromUnion(U,D,P):U.projectionMatrix.copy(D.projectionMatrix);updateUserCamera(e,U,s)};function updateUserCamera(e,t,n){t.matrixWorld.decompose(t.position,t.quaternion,t.scale);if(n.parent===null)n.matrix.copy(t.matrixWorld);else{n.matrix.copy(n.parent.matrixWorld);n.matrix.invert();n.matrix.multiply(t.matrixWorld)}n.matrix.decompose(n.position,n.quaternion,n.scale);n.updateMatrixWorld(true);e.projectionMatrix.copy(t.projectionMatrix);e.projectionMatrixInverse.copy(t.projectionMatrixInverse);if(e.isPerspectiveCamera){e.fov=s.RAD2DEG*2*Math.atan(1/e.projectionMatrix.elements[5]);e.zoom=1}}this.getCamera=function(){return U};this.getFoveation=function(){if(y!==null||b!==null)return d};this.setFoveation=function(e){d=e;y!==null&&(y.fixedFoveation=e);b!==null&&b.fixedFoveation!==void 0&&(b.fixedFoveation=e)};this.hasDepthSensing=function(){return _.texture!==null};this.getDepthSensingMesh=function(){return _.getMesh(U)};let V=null;function onAnimationFrame(t,n){f=n.getViewerPose(p||u);x=n;if(f!==null){const t=f.views;if(b!==null){e.setRenderTargetFramebuffer(S,b.framebuffer);e.setRenderTarget(S)}let n=false;if(t.length!==U.cameras.length){U.cameras.length=0;n=true}for(let r=0;r<t.length;r++){const a=t[r];let o=null;if(b!==null)o=b.getViewport(a);else{const t=g.getViewSubImage(y,a);o=t.viewport;if(r===0){e.setRenderTargetTextures(S,t.colorTexture,y.ignoreDepthValues?void 0:t.depthStencilTexture);e.setRenderTarget(S)}}let l=F[r];if(l===void 0){l=new s.PerspectiveCamera;l.layers.enable(r);l.viewport=new s.Vector4;F[r]=l}l.matrix.fromArray(a.transform.matrix);l.matrix.decompose(l.position,l.quaternion,l.scale);l.projectionMatrix.fromArray(a.projectionMatrix);l.projectionMatrixInverse.copy(l.projectionMatrix).invert();l.viewport.set(o.x,o.y,o.width,o.height);if(r===0){U.matrix.copy(l.matrix);U.matrix.decompose(U.position,U.quaternion,U.scale)}n===true&&U.cameras.push(l)}const r=o.enabledFeatures;const a=r&&r.includes("depth-sensing")&&o.depthUsage=="gpu-optimized";if(a&&g){const n=g.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&_.init(e,n,o.renderState)}}for(let e=0;e<T.length;e++){const t=I[e];const r=T[e];t!==null&&r!==void 0&&r.update(t,n,p||u)}V&&V(t,n);n.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:n});x=null}const j=new WebGLAnimation;j.setAnimationLoop(onAnimationFrame);this.setAnimationLoop=function(e){V=e};this.dispose=function(){}}}const Fn=new s.Euler;const Un=new s.Matrix4;function WebGLMaterials(e,t){function refreshTransformUniform(e,t){e.matrixAutoUpdate===true&&e.updateMatrix();t.value.copy(e.matrix)}function refreshFogUniforms(t,n){n.color.getRGB(t.fogColor.value,(0,s.getUnlitUniformColorSpace)(e));if(n.isFog){t.fogNear.value=n.near;t.fogFar.value=n.far}else n.isFogExp2&&(t.fogDensity.value=n.density)}function refreshMaterialUniforms(e,t,n,r,s){if(t.isMeshBasicMaterial)refreshUniformsCommon(e,t);else if(t.isMeshLambertMaterial)refreshUniformsCommon(e,t);else if(t.isMeshToonMaterial){refreshUniformsCommon(e,t);refreshUniformsToon(e,t)}else if(t.isMeshPhongMaterial){refreshUniformsCommon(e,t);refreshUniformsPhong(e,t)}else if(t.isMeshStandardMaterial){refreshUniformsCommon(e,t);refreshUniformsStandard(e,t);t.isMeshPhysicalMaterial&&refreshUniformsPhysical(e,t,s)}else if(t.isMeshMatcapMaterial){refreshUniformsCommon(e,t);refreshUniformsMatcap(e,t)}else if(t.isMeshDepthMaterial)refreshUniformsCommon(e,t);else if(t.isMeshDistanceMaterial){refreshUniformsCommon(e,t);refreshUniformsDistance(e,t)}else if(t.isMeshNormalMaterial)refreshUniformsCommon(e,t);else if(t.isLineBasicMaterial){refreshUniformsLine(e,t);t.isLineDashedMaterial&&refreshUniformsDash(e,t)}else if(t.isPointsMaterial)refreshUniformsPoints(e,t,n,r);else if(t.isSpriteMaterial)refreshUniformsSprites(e,t);else if(t.isShadowMaterial){e.color.value.copy(t.color);e.opacity.value=t.opacity}else t.isShaderMaterial&&(t.uniformsNeedUpdate=false)}function refreshUniformsCommon(e,n){e.opacity.value=n.opacity;n.color&&e.diffuse.value.copy(n.color);n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity);if(n.map){e.map.value=n.map;refreshTransformUniform(n.map,e.mapTransform)}if(n.alphaMap){e.alphaMap.value=n.alphaMap;refreshTransformUniform(n.alphaMap,e.alphaMapTransform)}if(n.bumpMap){e.bumpMap.value=n.bumpMap;refreshTransformUniform(n.bumpMap,e.bumpMapTransform);e.bumpScale.value=n.bumpScale;n.side===s.BackSide&&(e.bumpScale.value*=-1)}if(n.normalMap){e.normalMap.value=n.normalMap;refreshTransformUniform(n.normalMap,e.normalMapTransform);e.normalScale.value.copy(n.normalScale);n.side===s.BackSide&&e.normalScale.value.negate()}if(n.displacementMap){e.displacementMap.value=n.displacementMap;refreshTransformUniform(n.displacementMap,e.displacementMapTransform);e.displacementScale.value=n.displacementScale;e.displacementBias.value=n.displacementBias}if(n.emissiveMap){e.emissiveMap.value=n.emissiveMap;refreshTransformUniform(n.emissiveMap,e.emissiveMapTransform)}if(n.specularMap){e.specularMap.value=n.specularMap;refreshTransformUniform(n.specularMap,e.specularMapTransform)}n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);const r=t.get(n);const a=r.envMap;const o=r.envMapRotation;if(a){e.envMap.value=a;Fn.copy(o);Fn.x*=-1;Fn.y*=-1;Fn.z*=-1;if(a.isCubeTexture&&a.isRenderTargetTexture===false){Fn.y*=-1;Fn.z*=-1}e.envMapRotation.value.setFromMatrix4(Un.makeRotationFromEuler(Fn));e.flipEnvMap.value=a.isCubeTexture&&a.isRenderTargetTexture===false?-1:1;e.reflectivity.value=n.reflectivity;e.ior.value=n.ior;e.refractionRatio.value=n.refractionRatio}if(n.lightMap){e.lightMap.value=n.lightMap;e.lightMapIntensity.value=n.lightMapIntensity;refreshTransformUniform(n.lightMap,e.lightMapTransform)}if(n.aoMap){e.aoMap.value=n.aoMap;e.aoMapIntensity.value=n.aoMapIntensity;refreshTransformUniform(n.aoMap,e.aoMapTransform)}}function refreshUniformsLine(e,t){e.diffuse.value.copy(t.color);e.opacity.value=t.opacity;if(t.map){e.map.value=t.map;refreshTransformUniform(t.map,e.mapTransform)}}function refreshUniformsDash(e,t){e.dashSize.value=t.dashSize;e.totalSize.value=t.dashSize+t.gapSize;e.scale.value=t.scale}function refreshUniformsPoints(e,t,n,r){e.diffuse.value.copy(t.color);e.opacity.value=t.opacity;e.size.value=t.size*n;e.scale.value=r*.5;if(t.map){e.map.value=t.map;refreshTransformUniform(t.map,e.uvTransform)}if(t.alphaMap){e.alphaMap.value=t.alphaMap;refreshTransformUniform(t.alphaMap,e.alphaMapTransform)}t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}function refreshUniformsSprites(e,t){e.diffuse.value.copy(t.color);e.opacity.value=t.opacity;e.rotation.value=t.rotation;if(t.map){e.map.value=t.map;refreshTransformUniform(t.map,e.mapTransform)}if(t.alphaMap){e.alphaMap.value=t.alphaMap;refreshTransformUniform(t.alphaMap,e.alphaMapTransform)}t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}function refreshUniformsPhong(e,t){e.specular.value.copy(t.specular);e.shininess.value=Math.max(t.shininess,1e-4)}function refreshUniformsToon(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}function refreshUniformsStandard(e,t){e.metalness.value=t.metalness;if(t.metalnessMap){e.metalnessMap.value=t.metalnessMap;refreshTransformUniform(t.metalnessMap,e.metalnessMapTransform)}e.roughness.value=t.roughness;if(t.roughnessMap){e.roughnessMap.value=t.roughnessMap;refreshTransformUniform(t.roughnessMap,e.roughnessMapTransform)}t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function refreshUniformsPhysical(e,t,n){e.ior.value=t.ior;if(t.sheen>0){e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen);e.sheenRoughness.value=t.sheenRoughness;if(t.sheenColorMap){e.sheenColorMap.value=t.sheenColorMap;refreshTransformUniform(t.sheenColorMap,e.sheenColorMapTransform)}if(t.sheenRoughnessMap){e.sheenRoughnessMap.value=t.sheenRoughnessMap;refreshTransformUniform(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)}}if(t.clearcoat>0){e.clearcoat.value=t.clearcoat;e.clearcoatRoughness.value=t.clearcoatRoughness;if(t.clearcoatMap){e.clearcoatMap.value=t.clearcoatMap;refreshTransformUniform(t.clearcoatMap,e.clearcoatMapTransform)}if(t.clearcoatRoughnessMap){e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap;refreshTransformUniform(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)}if(t.clearcoatNormalMap){e.clearcoatNormalMap.value=t.clearcoatNormalMap;refreshTransformUniform(t.clearcoatNormalMap,e.clearcoatNormalMapTransform);e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale);t.side===s.BackSide&&e.clearcoatNormalScale.value.negate()}}t.dispersion>0&&(e.dispersion.value=t.dispersion);if(t.iridescence>0){e.iridescence.value=t.iridescence;e.iridescenceIOR.value=t.iridescenceIOR;e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0];e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1];if(t.iridescenceMap){e.iridescenceMap.value=t.iridescenceMap;refreshTransformUniform(t.iridescenceMap,e.iridescenceMapTransform)}if(t.iridescenceThicknessMap){e.iridescenceThicknessMap.value=t.iridescenceThicknessMap;refreshTransformUniform(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)}}if(t.transmission>0){e.transmission.value=t.transmission;e.transmissionSamplerMap.value=n.texture;e.transmissionSamplerSize.value.set(n.width,n.height);if(t.transmissionMap){e.transmissionMap.value=t.transmissionMap;refreshTransformUniform(t.transmissionMap,e.transmissionMapTransform)}e.thickness.value=t.thickness;if(t.thicknessMap){e.thicknessMap.value=t.thicknessMap;refreshTransformUniform(t.thicknessMap,e.thicknessMapTransform)}e.attenuationDistance.value=t.attenuationDistance;e.attenuationColor.value.copy(t.attenuationColor)}if(t.anisotropy>0){e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation));if(t.anisotropyMap){e.anisotropyMap.value=t.anisotropyMap;refreshTransformUniform(t.anisotropyMap,e.anisotropyMapTransform)}}e.specularIntensity.value=t.specularIntensity;e.specularColor.value.copy(t.specularColor);if(t.specularColorMap){e.specularColorMap.value=t.specularColorMap;refreshTransformUniform(t.specularColorMap,e.specularColorMapTransform)}if(t.specularIntensityMap){e.specularIntensityMap.value=t.specularIntensityMap;refreshTransformUniform(t.specularIntensityMap,e.specularIntensityMapTransform)}}function refreshUniformsMatcap(e,t){t.matcap&&(e.matcap.value=t.matcap)}function refreshUniformsDistance(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld);e.nearDistance.value=r.shadow.camera.near;e.farDistance.value=r.shadow.camera.far}return{refreshFogUniforms:refreshFogUniforms,refreshMaterialUniforms:refreshMaterialUniforms}}function WebGLUniformsGroups(e,n,r,s){let a={};let o={};let l=[];const c=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function bind(e,t){const n=t.program;s.uniformBlockBinding(e,n)}function update(e,t){let r=a[e.id];if(r===void 0){prepareUniformsGroup(e);r=createBuffer(e);a[e.id]=r;e.addEventListener("dispose",onUniformsGroupsDispose)}const l=t.program;s.updateUBOMapping(e,l);const c=n.render.frame;if(o[e.id]!==c){updateBufferData(e);o[e.id]=c}}function createBuffer(t){const n=allocateBindingPointIndex();t.__bindingPointIndex=n;const r=e.createBuffer();const s=t.__size;const a=t.usage;e.bindBuffer(e.UNIFORM_BUFFER,r);e.bufferData(e.UNIFORM_BUFFER,s,a);e.bindBuffer(e.UNIFORM_BUFFER,null);e.bindBufferBase(e.UNIFORM_BUFFER,n,r);return r}function allocateBindingPointIndex(){for(let e=0;e<c;e++)if(l.indexOf(e)===-1){l.push(e);return e}console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached.");return 0}function updateBufferData(t){const n=a[t.id];const r=t.uniforms;const s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let t=0,n=r.length;t<n;t++){const n=Array.isArray(r[t])?r[t]:[r[t]];for(let r=0,a=n.length;r<a;r++){const a=n[r];if(hasUniformChanged(a,t,r,s)===true){const t=a.__offset;const n=Array.isArray(a.value)?a.value:[a.value];let r=0;for(let s=0;s<n.length;s++){const o=n[s];const l=getUniformSize(o);if(typeof o==="number"||typeof o==="boolean"){a.__data[0]=o;e.bufferSubData(e.UNIFORM_BUFFER,t+r,a.__data)}else if(o.isMatrix3){a.__data[0]=o.elements[0];a.__data[1]=o.elements[1];a.__data[2]=o.elements[2];a.__data[3]=0;a.__data[4]=o.elements[3];a.__data[5]=o.elements[4];a.__data[6]=o.elements[5];a.__data[7]=0;a.__data[8]=o.elements[6];a.__data[9]=o.elements[7];a.__data[10]=o.elements[8];a.__data[11]=0}else{o.toArray(a.__data,r);r+=l.storage/Float32Array.BYTES_PER_ELEMENT}}e.bufferSubData(e.UNIFORM_BUFFER,t,a.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function hasUniformChanged(e,t,n,r){const s=e.value;const a=t+"_"+n;if(r[a]===void 0){r[a]=typeof s==="number"||typeof s==="boolean"?s:s.clone();return true}{const e=r[a];if(typeof s==="number"||typeof s==="boolean"){if(e!==s){r[a]=s;return true}}else if(e.equals(s)===false){e.copy(s);return true}}return false}function prepareUniformsGroup(e){const n=e.uniforms;let r=0;const s=16;for(let e=0,t=n.length;e<t;e++){const t=Array.isArray(n[e])?n[e]:[n[e]];for(let e=0,n=t.length;e<n;e++){const n=t[e];const a=Array.isArray(n.value)?n.value:[n.value];for(let e=0,t=a.length;e<t;e++){const t=a[e];const o=getUniformSize(t);const l=r%s;const c=l%o.boundary;const u=l+c;r+=c;u!==0&&s-u<o.storage&&(r+=s-u);n.__data=new Float32Array(o.storage/Float32Array.BYTES_PER_ELEMENT);n.__offset=r;r+=o.storage}}}const a=r%s;a>0&&(r+=s-a);e.__size=r;e.__cache={};return this||t}function getUniformSize(e){const t={boundary:0,storage:0};if(typeof e==="number"||typeof e==="boolean"){t.boundary=4;t.storage=4}else if(e.isVector2){t.boundary=8;t.storage=8}else if(e.isVector3||e.isColor){t.boundary=16;t.storage=12}else if(e.isVector4){t.boundary=16;t.storage=16}else if(e.isMatrix3){t.boundary=48;t.storage=48}else if(e.isMatrix4){t.boundary=64;t.storage=64}else e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e);return t}function onUniformsGroupsDispose(t){const n=t.target;n.removeEventListener("dispose",onUniformsGroupsDispose);const r=l.indexOf(n.__bindingPointIndex);l.splice(r,1);e.deleteBuffer(a[n.id]);delete a[n.id];delete o[n.id]}function dispose(){for(const t in a)e.deleteBuffer(a[t]);l=[];a={};o={}}return{bind:bind,update:update,dispose:dispose}}class WebGLRenderer{constructor(e={}){const{canvas:t=(0,s.createCanvasElement)(),context:n=null,depth:r=true,stencil:a=false,alpha:o=false,antialias:l=false,premultipliedAlpha:c=true,preserveDrawingBuffer:u=false,powerPreference:h="default",failIfMajorPerformanceCaveat:d=false,reverseDepthBuffer:p=false,multiviewStereo:f=false}=e;this.isWebGLRenderer=true;let m;if(n!==null){if(typeof WebGLRenderingContext!=="undefined"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=n.getContextAttributes().alpha}else m=o;const g=new Uint32Array(4);const y=new Int32Array(4);let b=null;let x=null;const _=[];const M=[];this.domElement=t;this.debug={
/**
              * Enables error checking and reporting when shader programs are being compiled
              * @type {boolean}
              */
checkShaderErrors:true,
/**
              * Callback for custom error reporting.
              * @type {?Function}
              */
onShaderError:null};this.autoClear=true;this.autoClearColor=true;this.autoClearDepth=true;this.autoClearStencil=true;this.sortObjects=true;this.clippingPlanes=[];this.localClippingEnabled=false;this._outputColorSpace=s.SRGBColorSpace;this.toneMapping=s.NoToneMapping;this.toneMappingExposure=1;const w=this;let S=false;let T=0;let I=0;let R=null;let L=-1;let D=null;const P=new s.Vector4;const F=new s.Vector4;let U=null;const O=new s.Color(0);let k=0;let N=t.width;let G=t.height;let V=1;let j=null;let H=null;const z=new s.Vector4(0,0,N,G);const W=new s.Vector4(0,0,N,G);let q=false;const K=new s.Frustum;let X=false;let Y=false;this.transmissionResolutionScale=1;const J=new s.Matrix4;const Z=new s.Matrix4;const $=new s.Vector3;const ee=new s.Vector4;const te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:true};let ne=false;function getTargetPixelRatio(){return R===null?V:1}let re=n;function getContext(e,n){return t.getContext(e,n)}try{const e={alpha:true,depth:r,stencil:a,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:d};"setAttribute"in t&&t.setAttribute("data-engine",`three.js r${s.REVISION}`);t.addEventListener("webglcontextlost",onContextLost,false);t.addEventListener("webglcontextrestored",onContextRestore,false);t.addEventListener("webglcontextcreationerror",onContextCreationError,false);if(re===null){const t="webgl2";re=getContext(t,e);if(re===null)throw getContext(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(e){console.error("THREE.WebGLRenderer: "+e.message);throw e}let ie,se,ae,oe;let le,ce,ue,he,de,pe,fe;let me,Ae,ge,ve,ye,Ce;let Ee;let be,xe,_e,Me;let we,Se,Te;function initGLContext(){ie=new WebGLExtensions(re);ie.init();we=new WebGLUtils(re,ie);se=new WebGLCapabilities(re,ie,e,we);ae=new WebGLState(re,ie);se.reverseDepthBuffer&&p&&ae.buffers.depth.setReversed(true);oe=new WebGLInfo(re);le=new WebGLProperties;ce=new WebGLTextures(re,ie,ae,le,se,we,oe);ue=new WebGLCubeMaps(w);he=new WebGLCubeUVMaps(w);de=new WebGLAttributes(re);Se=new WebGLBindingStates(re,de);pe=new WebGLGeometries(re,de,oe,Se);fe=new WebGLObjects(re,pe,de,oe);xe=new WebGLMorphtargets(re,se,ce);ye=new WebGLClipping(le);me=new WebGLPrograms(w,ue,he,ie,se,Se,ye);Ae=new WebGLMaterials(w,le);ge=new WebGLRenderLists;ve=new WebGLRenderStates(ie);be=new WebGLBackground(w,ue,he,ae,fe,m,c);Ee=new WebGLMultiview(w,ie,re);Ce=new WebGLShadowMap(w,fe,se);Te=new WebGLUniformsGroups(re,oe,se,ae);_e=new WebGLBufferRenderer(re,ie,oe);Me=new WebGLIndexedBufferRenderer(re,ie,oe);oe.programs=me.programs;w.capabilities=se;w.extensions=ie;w.properties=le;w.renderLists=ge;w.shadowMap=Ce;w.state=ae;w.info=oe}initGLContext();const Be=new WebXRManager(w,re);this.xr=Be;this.getContext=function(){return re};this.getContextAttributes=function(){return re.getContextAttributes()};this.forceContextLoss=function(){const e=ie.get("WEBGL_lose_context");e&&e.loseContext()};this.forceContextRestore=function(){const e=ie.get("WEBGL_lose_context");e&&e.restoreContext()};this.getPixelRatio=function(){return V};this.setPixelRatio=function(e){if(e!==void 0){V=e;this.setSize(N,G,false)}};this.getSize=function(e){return e.set(N,G)};this.setSize=function(e,n,r=true){if(Be.isPresenting)console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");else{N=e;G=n;t.width=Math.floor(e*V);t.height=Math.floor(n*V);if(r===true){t.style.width=e+"px";t.style.height=n+"px"}this.setViewport(0,0,e,n)}};this.getDrawingBufferSize=function(e){return e.set(N*V,G*V).floor()};this.setDrawingBufferSize=function(e,n,r){N=e;G=n;V=r;t.width=Math.floor(e*r);t.height=Math.floor(n*r);this.setViewport(0,0,e,n)};this.getCurrentViewport=function(e){return e.copy(P)};this.getViewport=function(e){return e.copy(z)};this.setViewport=function(e,t,n,r){e.isVector4?z.set(e.x,e.y,e.z,e.w):z.set(e,t,n,r);ae.viewport(P.copy(z).multiplyScalar(V).round())};this.getScissor=function(e){return e.copy(W)};this.setScissor=function(e,t,n,r){e.isVector4?W.set(e.x,e.y,e.z,e.w):W.set(e,t,n,r);ae.scissor(F.copy(W).multiplyScalar(V).round())};this.getScissorTest=function(){return q};this.setScissorTest=function(e){ae.setScissorTest(q=e)};this.setOpaqueSort=function(e){j=e};this.setTransparentSort=function(e){H=e};this.getClearColor=function(e){return e.copy(be.getClearColor())};this.setClearColor=function(){be.setClearColor.apply(be,arguments)};this.getClearAlpha=function(){return be.getClearAlpha()};this.setClearAlpha=function(){be.setClearAlpha.apply(be,arguments)};this.clear=function(e=true,t=true,n=true){let r=0;if(e){let e=false;if(R!==null){const t=R.texture.format;e=t===s.RGBAIntegerFormat||t===s.RGIntegerFormat||t===s.RedIntegerFormat}if(e){const e=R.texture.type;const t=e===s.UnsignedByteType||e===s.UnsignedIntType||e===s.UnsignedShortType||e===s.UnsignedInt248Type||e===s.UnsignedShort4444Type||e===s.UnsignedShort5551Type;const n=be.getClearColor();const r=be.getClearAlpha();const a=n.r;const o=n.g;const l=n.b;if(t){g[0]=a;g[1]=o;g[2]=l;g[3]=r;re.clearBufferuiv(re.COLOR,0,g)}else{y[0]=a;y[1]=o;y[2]=l;y[3]=r;re.clearBufferiv(re.COLOR,0,y)}}else r|=re.COLOR_BUFFER_BIT}t&&(r|=re.DEPTH_BUFFER_BIT);if(n){r|=re.STENCIL_BUFFER_BIT;this.state.buffers.stencil.setMask(4294967295)}re.clear(r)};this.clearColor=function(){this.clear(true,false,false)};this.clearDepth=function(){this.clear(false,true,false)};this.clearStencil=function(){this.clear(false,false,true)};this.dispose=function(){t.removeEventListener("webglcontextlost",onContextLost,false);t.removeEventListener("webglcontextrestored",onContextRestore,false);t.removeEventListener("webglcontextcreationerror",onContextCreationError,false);be.dispose();ge.dispose();ve.dispose();le.dispose();ue.dispose();he.dispose();fe.dispose();Se.dispose();Te.dispose();me.dispose();Be.dispose();Be.removeEventListener("sessionstart",onXRSessionStart);Be.removeEventListener("sessionend",onXRSessionEnd);Re.stop()};function onContextLost(e){e.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");S=true}function onContextRestore(){console.log("THREE.WebGLRenderer: Context Restored.");S=false;const e=oe.autoReset;const t=Ce.enabled;const n=Ce.autoUpdate;const r=Ce.needsUpdate;const s=Ce.type;initGLContext();oe.autoReset=e;Ce.enabled=t;Ce.autoUpdate=n;Ce.needsUpdate=r;Ce.type=s}function onContextCreationError(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function onMaterialDispose(e){const t=e.target;t.removeEventListener("dispose",onMaterialDispose);deallocateMaterial(t)}function deallocateMaterial(e){releaseMaterialProgramReferences(e);le.remove(e)}function releaseMaterialProgramReferences(e){const t=le.get(e).programs;if(t!==void 0){t.forEach((function(e){me.releaseProgram(e)}));e.isShaderMaterial&&me.releaseShaderCache(e)}}this.renderBufferDirect=function(e,t,n,r,s,a){t===null&&(t=te);const o=s.isMesh&&s.matrixWorld.determinant()<0;const l=setProgram(e,t,n,r,s);ae.setMaterial(r,o);let c=n.index;let u=1;if(r.wireframe===true){c=pe.getWireframeAttribute(n);if(c===void 0)return;u=2}const h=n.drawRange;const d=n.attributes.position;let p=h.start*u;let f=(h.start+h.count)*u;if(a!==null){p=Math.max(p,a.start*u);f=Math.min(f,(a.start+a.count)*u)}if(c!==null){p=Math.max(p,0);f=Math.min(f,c.count)}else if(d!==void 0&&d!==null){p=Math.max(p,0);f=Math.min(f,d.count)}const m=f-p;if(m<0||m===Infinity)return;Se.setup(s,r,l,n,c);let g;let y=_e;if(c!==null){g=de.get(c);y=Me;y.setIndex(g)}if(s.isMesh)if(r.wireframe===true){ae.setLineWidth(r.wireframeLinewidth*getTargetPixelRatio());y.setMode(re.LINES)}else y.setMode(re.TRIANGLES);else if(s.isLine){let e=r.linewidth;e===void 0&&(e=1);ae.setLineWidth(e*getTargetPixelRatio());s.isLineSegments?y.setMode(re.LINES):s.isLineLoop?y.setMode(re.LINE_LOOP):y.setMode(re.LINE_STRIP)}else s.isPoints?y.setMode(re.POINTS):s.isSprite&&y.setMode(re.TRIANGLES);if(s.isBatchedMesh)if(s._multiDrawInstances!==null)y.renderMultiDrawInstances(s._multiDrawStarts,s._multiDrawCounts,s._multiDrawCount,s._multiDrawInstances);else if(ie.get("WEBGL_multi_draw"))y.renderMultiDraw(s._multiDrawStarts,s._multiDrawCounts,s._multiDrawCount);else{const e=s._multiDrawStarts;const t=s._multiDrawCounts;const n=s._multiDrawCount;const a=c?de.get(c).bytesPerElement:1;const o=le.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++){o.setValue(re,"_gl_DrawID",r);y.render(e[r]/a,t[r])}}else if(s.isInstancedMesh)y.renderInstances(p,m,s.count);else if(n.isInstancedBufferGeometry){const e=n._maxInstanceCount!==void 0?n._maxInstanceCount:Infinity;const t=Math.min(n.instanceCount,e);y.renderInstances(p,m,t)}else y.render(p,m)};function prepareMaterial(e,t,n){if(e.transparent===true&&e.side===s.DoubleSide&&e.forceSinglePass===false){e.side=s.BackSide;e.needsUpdate=true;getProgram(e,t,n);e.side=s.FrontSide;e.needsUpdate=true;getProgram(e,t,n);e.side=s.DoubleSide}else getProgram(e,t,n)}this.compile=function(e,t,n=null){n===null&&(n=e);x=ve.get(n);x.init(t);M.push(x);n.traverseVisible((function(e){if(e.isLight&&e.layers.test(t.layers)){x.pushLight(e);e.castShadow&&x.pushShadow(e)}}));e!==n&&e.traverseVisible((function(e){if(e.isLight&&e.layers.test(t.layers)){x.pushLight(e);e.castShadow&&x.pushShadow(e)}}));x.setupLights();const r=new Set;e.traverse((function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let s=0;s<t.length;s++){const a=t[s];prepareMaterial(a,n,e);r.add(a)}else{prepareMaterial(t,n,e);r.add(t)}}));M.pop();x=null;return r};this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise((t=>{function checkMaterialsReady(){r.forEach((function(e){const t=le.get(e);const n=t.currentProgram;n.isReady()&&r.delete(e)}));r.size!==0?setTimeout(checkMaterialsReady,10):t(e)}ie.get("KHR_parallel_shader_compile")!==null?checkMaterialsReady():setTimeout(checkMaterialsReady,10)}))};let Ie=null;function onAnimationFrame(e){Ie&&Ie(e)}function onXRSessionStart(){Re.stop()}function onXRSessionEnd(){Re.start()}const Re=new WebGLAnimation;Re.setAnimationLoop(onAnimationFrame);typeof self!=="undefined"&&Re.setContext(self);this.setAnimationLoop=function(e){Ie=e;Be.setAnimationLoop(e);e===null?Re.stop():Re.start()};Be.addEventListener("sessionstart",onXRSessionStart);Be.addEventListener("sessionend",onXRSessionEnd);this.render=function(e,t){if(t!==void 0&&t.isCamera!==true){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(S===true)return;e.matrixWorldAutoUpdate===true&&e.updateMatrixWorld();t.parent===null&&t.matrixWorldAutoUpdate===true&&t.updateMatrixWorld();if(Be.enabled===true&&Be.isPresenting===true){Be.cameraAutoUpdate===true&&Be.updateCamera(t);t=Be.getCamera()}e.isScene===true&&e.onBeforeRender(w,e,t,R);x=ve.get(e,M.length);x.init(t);M.push(x);Z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);K.setFromProjectionMatrix(Z);Y=this.localClippingEnabled;X=ye.init(this.clippingPlanes,Y);b=ge.get(e,_.length);b.init();_.push(b);if(Be.enabled===true&&Be.isPresenting===true){const e=w.xr.getDepthSensingMesh();e!==null&&projectObject(e,t,-Infinity,w.sortObjects)}projectObject(e,t,0,w.sortObjects);b.finish();w.sortObjects===true&&b.sort(j,H);ne=Be.enabled===false||Be.isPresenting===false||Be.hasDepthSensing()===false;ne&&be.addToRenderList(b,e);this.info.render.frame++;X===true&&ye.beginShadows();const n=x.state.shadowsArray;Ce.render(n,e,t);X===true&&ye.endShadows();this.info.autoReset===true&&this.info.reset();const r=b.opaque;const s=b.transmissive;x.setupLights();if(t.isArrayCamera){const n=t.cameras;if(s.length>0)for(let t=0,a=n.length;t<a;t++){const a=n[t];renderTransmissionPass(r,s,e,a)}ne&&be.render(e);if(Be.enabled&&Be.isMultiview){ce.setDeferTextureUploads(true);renderScene(b,e,t,t.cameras[0].viewport)}else for(let t=0,r=n.length;t<r;t++){const r=n[t];renderScene(b,e,r,r.viewport)}}else{s.length>0&&renderTransmissionPass(r,s,e,t);ne&&be.render(e);renderScene(b,e,t)}if(R!==null&&I===0){ce.updateMultisampleRenderTarget(R);ce.updateRenderTargetMipmap(R)}e.isScene===true&&e.onAfterRender(w,e,t);Se.resetDefaultState();L=-1;D=null;M.pop();if(M.length>0){x=M[M.length-1];X===true&&ye.setGlobalState(w.clippingPlanes,x.state.camera)}else x=null;_.pop();b=_.length>0?_[_.length-1]:null};function projectObject(e,t,n,r){if(e.visible===false)return;const s=e.layers.test(t.layers);if(s)if(e.isGroup)n=e.renderOrder;else if(e.isLOD)e.autoUpdate===true&&e.update(t);else if(e.isLight){x.pushLight(e);e.castShadow&&x.pushShadow(e)}else if(e.isSprite){if(!e.frustumCulled||K.intersectsSprite(e)){r&&ee.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Z);const t=fe.update(e);const s=e.material;s.visible&&b.push(e,t,s,n,ee.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||K.intersectsObject(e))){const t=fe.update(e);const s=e.material;if(r){if(e.boundingSphere!==void 0){e.boundingSphere===null&&e.computeBoundingSphere();ee.copy(e.boundingSphere.center)}else{t.boundingSphere===null&&t.computeBoundingSphere();ee.copy(t.boundingSphere.center)}ee.applyMatrix4(e.matrixWorld).applyMatrix4(Z)}if(Array.isArray(s)){const r=t.groups;for(let a=0,o=r.length;a<o;a++){const o=r[a];const l=s[o.materialIndex];l&&l.visible&&b.push(e,t,l,n,ee.z,o)}}else s.visible&&b.push(e,t,s,n,ee.z,null)}const a=e.children;for(let e=0,s=a.length;e<s;e++)projectObject(a[e],t,n,r)}function renderScene(e,t,n,r){const s=e.opaque;const a=e.transmissive;const o=e.transparent;x.setupLightsView(n);X===true&&ye.setGlobalState(w.clippingPlanes,n);r&&ae.viewport(P.copy(r));s.length>0&&renderObjects(s,t,n);a.length>0&&renderObjects(a,t,n);o.length>0&&renderObjects(o,t,n);ae.buffers.depth.setTest(true);ae.buffers.depth.setMask(true);ae.buffers.color.setMask(true);ae.setPolygonOffset(false)}function renderTransmissionPass(e,t,n,r){const o=n.isScene===true?n.overrideMaterial:null;if(o!==null)return;x.state.transmissionRenderTarget[r.id]===void 0&&(x.state.transmissionRenderTarget[r.id]=new s.WebGLRenderTarget(1,1,{generateMipmaps:true,type:ie.has("EXT_color_buffer_half_float")||ie.has("EXT_color_buffer_float")?s.HalfFloatType:s.UnsignedByteType,minFilter:s.LinearMipmapLinearFilter,samples:4,stencilBuffer:a,resolveDepthBuffer:false,resolveStencilBuffer:false,colorSpace:s.ColorManagement.workingColorSpace}));const l=x.state.transmissionRenderTarget[r.id];const c=r.viewport||P;l.setSize(c.z*w.transmissionResolutionScale,c.w*w.transmissionResolutionScale);const u=w.getRenderTarget();w.setRenderTarget(l);w.getClearColor(O);k=w.getClearAlpha();k<1&&w.setClearColor(16777215,.5);w.clear();ne&&be.render(n);const h=w.toneMapping;w.toneMapping=s.NoToneMapping;const d=r.viewport;r.viewport!==void 0&&(r.viewport=void 0);x.setupLightsView(r);X===true&&ye.setGlobalState(w.clippingPlanes,r);renderObjects(e,n,r);ce.updateMultisampleRenderTarget(l);ce.updateRenderTargetMipmap(l);if(ie.has("WEBGL_multisampled_render_to_texture")===false){let e=false;for(let a=0,o=t.length;a<o;a++){const o=t[a];const l=o.object;const c=o.geometry;const u=o.material;const h=o.group;if(u.side===s.DoubleSide&&l.layers.test(r.layers)){const t=u.side;u.side=s.BackSide;u.needsUpdate=true;renderObject(l,n,r,c,u,h);u.side=t;u.needsUpdate=true;e=true}}if(e===true){ce.updateMultisampleRenderTarget(l);ce.updateRenderTargetMipmap(l)}}w.setRenderTarget(u);w.setClearColor(O,k);d!==void 0&&(r.viewport=d);w.toneMapping=h}function renderObjects(e,t,n){const r=t.isScene===true?t.overrideMaterial:null;for(let s=0,a=e.length;s<a;s++){const a=e[s];const o=a.object;const l=a.geometry;const c=r===null?a.material:r;const u=a.group;o.layers.test(n.layers)&&renderObject(o,t,n,l,c,u)}}function renderObject(e,t,n,r,a,o){e.onBeforeRender(w,t,n,r,a,o);e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);e.normalMatrix.getNormalMatrix(e.modelViewMatrix);a.onBeforeRender(w,t,n,r,e,o);if(a.transparent===true&&a.side===s.DoubleSide&&a.forceSinglePass===false){a.side=s.BackSide;a.needsUpdate=true;w.renderBufferDirect(n,t,r,a,e,o);a.side=s.FrontSide;a.needsUpdate=true;w.renderBufferDirect(n,t,r,a,e,o);a.side=s.DoubleSide}else w.renderBufferDirect(n,t,r,a,e,o);e.onAfterRender(w,t,n,r,a,o)}function getProgram(e,t,n){t.isScene!==true&&(t=te);const r=le.get(e);const s=x.state.lights;const a=x.state.shadowsArray;const o=s.state.version;const l=me.getParameters(e,s.state,a,t,n);const c=me.getProgramCacheKey(l);let u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null;r.fog=t.fog;r.envMap=(e.isMeshStandardMaterial?he:ue).get(e.envMap||r.environment);r.envMapRotation=r.environment!==null&&e.envMap===null?t.environmentRotation:e.envMapRotation;if(u===void 0){e.addEventListener("dispose",onMaterialDispose);u=new Map;r.programs=u}let h=u.get(c);if(h!==void 0){if(r.currentProgram===h&&r.lightsStateVersion===o){updateCommonMaterialProperties(e,l);return h}}else{l.uniforms=me.getUniforms(e);e.onBeforeCompile(l,w);h=me.acquireProgram(l,c);u.set(c,h);r.uniforms=l.uniforms}const d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&e.clipping!==true||(d.clippingPlanes=ye.uniform);updateCommonMaterialProperties(e,l);r.needsLights=materialNeedsLights(e);r.lightsStateVersion=o;if(r.needsLights){d.ambientLightColor.value=s.state.ambient;d.lightProbe.value=s.state.probe;d.directionalLights.value=s.state.directional;d.directionalLightShadows.value=s.state.directionalShadow;d.spotLights.value=s.state.spot;d.spotLightShadows.value=s.state.spotShadow;d.rectAreaLights.value=s.state.rectArea;d.ltc_1.value=s.state.rectAreaLTC1;d.ltc_2.value=s.state.rectAreaLTC2;d.pointLights.value=s.state.point;d.pointLightShadows.value=s.state.pointShadow;d.hemisphereLights.value=s.state.hemi;d.directionalShadowMap.value=s.state.directionalShadowMap;d.directionalShadowMatrix.value=s.state.directionalShadowMatrix;d.spotShadowMap.value=s.state.spotShadowMap;d.spotLightMatrix.value=s.state.spotLightMatrix;d.spotLightMap.value=s.state.spotLightMap;d.pointShadowMap.value=s.state.pointShadowMap;d.pointShadowMatrix.value=s.state.pointShadowMatrix}r.currentProgram=h;r.uniformsList=null;return h}function getUniformList(e){if(e.uniformsList===null){const t=e.currentProgram.getUniforms();e.uniformsList=WebGLUniforms.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function updateCommonMaterialProperties(e,t){const n=le.get(e);n.outputColorSpace=t.outputColorSpace;n.batching=t.batching;n.batchingColor=t.batchingColor;n.instancing=t.instancing;n.instancingColor=t.instancingColor;n.instancingMorph=t.instancingMorph;n.skinning=t.skinning;n.morphTargets=t.morphTargets;n.morphNormals=t.morphNormals;n.morphColors=t.morphColors;n.morphTargetsCount=t.morphTargetsCount;n.numClippingPlanes=t.numClippingPlanes;n.numIntersection=t.numClipIntersection;n.vertexAlphas=t.vertexAlphas;n.vertexTangents=t.vertexTangents;n.toneMapping=t.toneMapping;n.numMultiviewViews=t.numMultiviewViews}function setProgram(e,t,n,r,a){t.isScene!==true&&(t=te);ce.resetTextureUnits();const o=t.fog;const l=r.isMeshStandardMaterial?t.environment:null;const c=R===null?w.outputColorSpace:R.isXRRenderTarget===true?R.texture.colorSpace:s.LinearSRGBColorSpace;const u=(r.isMeshStandardMaterial?he:ue).get(r.envMap||l);const h=r.vertexColors===true&&!!n.attributes.color&&n.attributes.color.itemSize===4;const d=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0);const p=!!n.morphAttributes.position;const f=!!n.morphAttributes.normal;const m=!!n.morphAttributes.color;let g=s.NoToneMapping;r.toneMapped&&(R!==null&&R.isXRRenderTarget!==true||(g=w.toneMapping));const y=R&&R.isWebGLMultiviewRenderTarget?R.numViews:0;const b=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color;const _=b!==void 0?b.length:0;const M=le.get(r);const S=x.state.lights;if(X===true&&(Y===true||e!==D)){const t=e===D&&r.id===L;ye.setState(r,e,t)}let T=false;if(r.version===M.__version)M.needsLights&&M.lightsStateVersion!==S.state.version||M.outputColorSpace!==c||a.isBatchedMesh&&M.batching===false?T=true:a.isBatchedMesh||M.batching!==true?a.isBatchedMesh&&M.batchingColor===true&&a.colorTexture===null||a.isBatchedMesh&&M.batchingColor===false&&a.colorTexture!==null||a.isInstancedMesh&&M.instancing===false?T=true:a.isInstancedMesh||M.instancing!==true?a.isSkinnedMesh&&M.skinning===false?T=true:a.isSkinnedMesh||M.skinning!==true?a.isInstancedMesh&&M.instancingColor===true&&a.instanceColor===null||a.isInstancedMesh&&M.instancingColor===false&&a.instanceColor!==null||a.isInstancedMesh&&M.instancingMorph===true&&a.morphTexture===null||a.isInstancedMesh&&M.instancingMorph===false&&a.morphTexture!==null||M.envMap!==u||r.fog===true&&M.fog!==o?T=true:M.numClippingPlanes===void 0||M.numClippingPlanes===ye.numPlanes&&M.numIntersection===ye.numIntersection?(M.vertexAlphas!==h||M.vertexTangents!==d||M.morphTargets!==p||M.morphNormals!==f||M.morphColors!==m||M.toneMapping!==g||M.morphTargetsCount!==_||M.numMultiviewViews!==y)&&(T=true):T=true:T=true:T=true:T=true;else{T=true;M.__version=r.version}let I=M.currentProgram;T===true&&(I=getProgram(r,t,a));let P=false;let F=false;let U=false;const O=I.getUniforms(),k=M.uniforms;if(ae.useProgram(I.program)){P=true;F=true;U=true}if(r.id!==L){L=r.id;F=true}if(P||D!==e){if(I.numMultiviewViews>0){Ee.updateCameraProjectionMatricesUniform(e,O);Ee.updateCameraViewMatricesUniform(e,O)}else{const t=ae.buffers.depth.getReversed();if(t){J.copy(e.projectionMatrix);(0,s.toNormalizedProjectionMatrix)(J);(0,s.toReversedProjectionMatrix)(J);O.setValue(re,"projectionMatrix",J)}else O.setValue(re,"projectionMatrix",e.projectionMatrix);O.setValue(re,"viewMatrix",e.matrixWorldInverse)}const t=O.map.cameraPosition;t!==void 0&&t.setValue(re,$.setFromMatrixPosition(e.matrixWorld));se.logarithmicDepthBuffer&&O.setValue(re,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2));(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&O.setValue(re,"isOrthographic",e.isOrthographicCamera===true);if(D!==e){D=e;F=true;U=true}}if(a.isSkinnedMesh){O.setOptional(re,a,"bindMatrix");O.setOptional(re,a,"bindMatrixInverse");const e=a.skeleton;if(e){e.boneTexture===null&&e.computeBoneTexture();O.setValue(re,"boneTexture",e.boneTexture,ce)}}if(a.isBatchedMesh){O.setOptional(re,a,"batchingTexture");O.setValue(re,"batchingTexture",a._matricesTexture,ce);O.setOptional(re,a,"batchingIdTexture");O.setValue(re,"batchingIdTexture",a._indirectTexture,ce);O.setOptional(re,a,"batchingColorTexture");a._colorsTexture!==null&&O.setValue(re,"batchingColorTexture",a._colorsTexture,ce)}const N=n.morphAttributes;N.position===void 0&&N.normal===void 0&&N.color===void 0||xe.update(a,n,I);if(F||M.receiveShadow!==a.receiveShadow){M.receiveShadow=a.receiveShadow;O.setValue(re,"receiveShadow",a.receiveShadow)}if(r.isMeshGouraudMaterial&&r.envMap!==null){k.envMap.value=u;k.flipEnvMap.value=u.isCubeTexture&&u.isRenderTargetTexture===false?-1:1}r.isMeshStandardMaterial&&r.envMap===null&&t.environment!==null&&(k.envMapIntensity.value=t.environmentIntensity);if(F){O.setValue(re,"toneMappingExposure",w.toneMappingExposure);M.needsLights&&markUniformsLightsNeedsUpdate(k,U);o&&r.fog===true&&Ae.refreshFogUniforms(k,o);Ae.refreshMaterialUniforms(k,r,V,G,x.state.transmissionRenderTarget[e.id]);WebGLUniforms.upload(re,getUniformList(M),k,ce)}if(r.isShaderMaterial&&r.uniformsNeedUpdate===true){WebGLUniforms.upload(re,getUniformList(M),k,ce);r.uniformsNeedUpdate=false}r.isSpriteMaterial&&O.setValue(re,"center",a.center);if(I.numMultiviewViews>0)Ee.updateObjectMatricesUniforms(a,e,O);else{O.setValue(re,"modelViewMatrix",a.modelViewMatrix);O.setValue(re,"normalMatrix",a.normalMatrix)}O.setValue(re,"modelMatrix",a.matrixWorld);if(r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];Te.update(n,I);Te.bind(n,I)}}return I}function markUniformsLightsNeedsUpdate(e,t){e.ambientLightColor.needsUpdate=t;e.lightProbe.needsUpdate=t;e.directionalLights.needsUpdate=t;e.directionalLightShadows.needsUpdate=t;e.pointLights.needsUpdate=t;e.pointLightShadows.needsUpdate=t;e.spotLights.needsUpdate=t;e.spotLightShadows.needsUpdate=t;e.rectAreaLights.needsUpdate=t;e.hemisphereLights.needsUpdate=t}function materialNeedsLights(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&e.lights===true}this.setTexture2D=function(){var e=false;return function setTexture2D(t,n){if(t&&t.isWebGLRenderTarget){if(!e){console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead.");e=true}t=t.texture}ce.setTexture2D(t,n)}}();this.getActiveCubeFace=function(){return T};this.getActiveMipmapLevel=function(){return I};this.getRenderTarget=function(){return R};this.setRenderTargetTextures=function(e,t,n){le.get(e.texture).__webglTexture=t;le.get(e.depthTexture).__webglTexture=n;const r=le.get(e);r.__hasExternalTextures=true;r.__autoAllocateDepthBuffer=n===void 0;if(!r.__autoAllocateDepthBuffer&&(!R||!R.isWebGLMultiviewRenderTarget)&&ie.has("WEBGL_multisampled_render_to_texture")===true){console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided");r.__useRenderToTexture=false}};this.setRenderTargetFramebuffer=function(e,t){const n=le.get(e);n.__webglFramebuffer=t;n.__useDefaultFramebuffer=t===void 0};const Le=re.createFramebuffer();this.setRenderTarget=function(e,t=0,n=0){e===null&&this.xr.isPresenting&&(e=this.xr.getRenderTarget());R=e;T=t;I=n;let r=true;let s=null;let a=false;let o=false;if(e){const l=le.get(e);if(l.__useDefaultFramebuffer!==void 0){ae.bindFramebuffer(re.FRAMEBUFFER,null);r=false}else if(l.__webglFramebuffer===void 0)ce.setupRenderTarget(e);else if(l.__hasExternalTextures)ce.rebindTextures(e,le.get(e.texture).__webglTexture,le.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(l.__boundDepthTexture!==t){if(t!==null&&le.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ce.setupDepthRenderbuffer(e)}}const c=e.texture;(c.isData3DTexture||c.isDataArrayTexture||c.isCompressedArrayTexture)&&(o=true);const u=le.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget){s=Array.isArray(u[t])?u[t][n]:u[t];a=true}else s=e.samples>0&&ce.useMultisampledRTT(e)===false?le.get(e).__webglMultisampledFramebuffer:Array.isArray(u)?u[n]:u;P.copy(e.viewport);F.copy(e.scissor);U=e.scissorTest}else{P.copy(z).multiplyScalar(V).floor();F.copy(W).multiplyScalar(V).floor();U=q}n!==0&&(s=Le);const l=ae.bindFramebuffer(re.FRAMEBUFFER,s);l&&r&&ae.drawBuffers(e,s);ae.viewport(P);ae.scissor(F);ae.setScissorTest(U);if(a){const r=le.get(e.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(o){const r=le.get(e.texture);const s=t;re.framebufferTextureLayer(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,r.__webglTexture,n,s)}else if(e!==null&&n!==0){const t=le.get(e.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,t.__webglTexture,n)}L=-1};this.readRenderTargetPixels=function(e,t,n,r,s,a,o){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let l=le.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget&&o!==void 0&&(l=l[o]);if(l){ae.bindFramebuffer(re.FRAMEBUFFER,l);try{const o=e.texture;const l=o.format;const c=o.type;if(!se.textureFormatReadable(l)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!se.textureTypeReadable(c)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}t>=0&&t<=e.width-r&&n>=0&&n<=e.height-s&&re.readPixels(t,n,r,s,we.convert(l),we.convert(c),a)}finally{const e=R!==null?le.get(R).__webglFramebuffer:null;ae.bindFramebuffer(re.FRAMEBUFFER,e)}}};this.readRenderTargetPixelsAsync=async function(e,t,n,r,a,o,l){if(!(e&&e.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let c=le.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget&&l!==void 0&&(c=c[l]);if(c){const l=e.texture;const u=l.format;const h=l.type;if(!se.textureFormatReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!se.textureTypeReadable(h))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-a){ae.bindFramebuffer(re.FRAMEBUFFER,c);const e=re.createBuffer();re.bindBuffer(re.PIXEL_PACK_BUFFER,e);re.bufferData(re.PIXEL_PACK_BUFFER,o.byteLength,re.STREAM_READ);re.readPixels(t,n,r,a,we.convert(u),we.convert(h),0);const l=R!==null?le.get(R).__webglFramebuffer:null;ae.bindFramebuffer(re.FRAMEBUFFER,l);const d=re.fenceSync(re.SYNC_GPU_COMMANDS_COMPLETE,0);re.flush();await(0,s.probeAsync)(re,d,4);re.bindBuffer(re.PIXEL_PACK_BUFFER,e);re.getBufferSubData(re.PIXEL_PACK_BUFFER,0,o);re.deleteBuffer(e);re.deleteSync(d);return o}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}};this.copyFramebufferToTexture=function(e,t=null,n=0){if(e.isTexture!==true){(0,s.warnOnce)("WebGLRenderer: copyFramebufferToTexture function signature has changed.");t=arguments[0]||null;e=arguments[1]}const r=Math.pow(2,-n);const a=Math.floor(e.image.width*r);const o=Math.floor(e.image.height*r);const l=t!==null?t.x:0;const c=t!==null?t.y:0;ce.setTexture2D(e,0);re.copyTexSubImage2D(re.TEXTURE_2D,n,0,0,l,c,a,o);ae.unbindTexture()};const De=re.createFramebuffer();const Pe=re.createFramebuffer();this.copyTextureToTexture=function(e,t,n=null,r=null,a=0,o=null){if(e.isTexture!==true){(0,s.warnOnce)("WebGLRenderer: copyTextureToTexture function signature has changed.");r=arguments[0]||null;e=arguments[1];t=arguments[2];o=arguments[3]||0;n=null}if(o===null)if(a!==0){(0,s.warnOnce)("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels.");o=a;a=0}else o=0;let l,c,u,h,d,p;let f,m,g;const y=e.isCompressedTexture?e.mipmaps[o]:e.image;if(n!==null){l=n.max.x-n.min.x;c=n.max.y-n.min.y;u=n.isBox3?n.max.z-n.min.z:1;h=n.min.x;d=n.min.y;p=n.isBox3?n.min.z:0}else{const t=Math.pow(2,-a);l=Math.floor(y.width*t);c=Math.floor(y.height*t);u=e.isDataArrayTexture?y.depth:e.isData3DTexture?Math.floor(y.depth*t):1;h=0;d=0;p=0}if(r!==null){f=r.x;m=r.y;g=r.z}else{f=0;m=0;g=0}const b=we.convert(t.format);const x=we.convert(t.type);let _;if(t.isData3DTexture){ce.setTexture3D(t,0);_=re.TEXTURE_3D}else if(t.isDataArrayTexture||t.isCompressedArrayTexture){ce.setTexture2DArray(t,0);_=re.TEXTURE_2D_ARRAY}else{ce.setTexture2D(t,0);_=re.TEXTURE_2D}re.pixelStorei(re.UNPACK_FLIP_Y_WEBGL,t.flipY);re.pixelStorei(re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha);re.pixelStorei(re.UNPACK_ALIGNMENT,t.unpackAlignment);const M=re.getParameter(re.UNPACK_ROW_LENGTH);const w=re.getParameter(re.UNPACK_IMAGE_HEIGHT);const S=re.getParameter(re.UNPACK_SKIP_PIXELS);const T=re.getParameter(re.UNPACK_SKIP_ROWS);const I=re.getParameter(re.UNPACK_SKIP_IMAGES);re.pixelStorei(re.UNPACK_ROW_LENGTH,y.width);re.pixelStorei(re.UNPACK_IMAGE_HEIGHT,y.height);re.pixelStorei(re.UNPACK_SKIP_PIXELS,h);re.pixelStorei(re.UNPACK_SKIP_ROWS,d);re.pixelStorei(re.UNPACK_SKIP_IMAGES,p);const R=e.isDataArrayTexture||e.isData3DTexture;const L=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const n=le.get(e);const r=le.get(t);const s=le.get(n.__renderTarget);const y=le.get(r.__renderTarget);ae.bindFramebuffer(re.READ_FRAMEBUFFER,s.__webglFramebuffer);ae.bindFramebuffer(re.DRAW_FRAMEBUFFER,y.__webglFramebuffer);for(let n=0;n<u;n++){if(R){re.framebufferTextureLayer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,le.get(e).__webglTexture,a,p+n);re.framebufferTextureLayer(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,le.get(t).__webglTexture,o,g+n)}re.blitFramebuffer(h,d,l,c,f,m,l,c,re.DEPTH_BUFFER_BIT,re.NEAREST)}ae.bindFramebuffer(re.READ_FRAMEBUFFER,null);ae.bindFramebuffer(re.DRAW_FRAMEBUFFER,null)}else if(a!==0||e.isRenderTargetTexture||le.has(e)){const n=le.get(e);const r=le.get(t);ae.bindFramebuffer(re.READ_FRAMEBUFFER,De);ae.bindFramebuffer(re.DRAW_FRAMEBUFFER,Pe);for(let e=0;e<u;e++){R?re.framebufferTextureLayer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,n.__webglTexture,a,p+e):re.framebufferTexture2D(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,n.__webglTexture,a);L?re.framebufferTextureLayer(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,r.__webglTexture,o,g+e):re.framebufferTexture2D(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,r.__webglTexture,o);a!==0?re.blitFramebuffer(h,d,l,c,f,m,l,c,re.COLOR_BUFFER_BIT,re.NEAREST):L?re.copyTexSubImage3D(_,o,f,m,g+e,h,d,l,c):re.copyTexSubImage2D(_,o,f,m,h,d,l,c)}ae.bindFramebuffer(re.READ_FRAMEBUFFER,null);ae.bindFramebuffer(re.DRAW_FRAMEBUFFER,null)}else L?e.isDataTexture||e.isData3DTexture?re.texSubImage3D(_,o,f,m,g,l,c,u,b,x,y.data):t.isCompressedArrayTexture?re.compressedTexSubImage3D(_,o,f,m,g,l,c,u,b,y.data):re.texSubImage3D(_,o,f,m,g,l,c,u,b,x,y):e.isDataTexture?re.texSubImage2D(re.TEXTURE_2D,o,f,m,l,c,b,x,y.data):e.isCompressedTexture?re.compressedTexSubImage2D(re.TEXTURE_2D,o,f,m,y.width,y.height,b,y.data):re.texSubImage2D(re.TEXTURE_2D,o,f,m,l,c,b,x,y);re.pixelStorei(re.UNPACK_ROW_LENGTH,M);re.pixelStorei(re.UNPACK_IMAGE_HEIGHT,w);re.pixelStorei(re.UNPACK_SKIP_PIXELS,S);re.pixelStorei(re.UNPACK_SKIP_ROWS,T);re.pixelStorei(re.UNPACK_SKIP_IMAGES,I);o===0&&t.generateMipmaps&&re.generateMipmap(_);ae.unbindTexture()};this.copyTextureToTexture3D=function(e,t,n=null,r=null,a=0){if(e.isTexture!==true){(0,s.warnOnce)("WebGLRenderer: copyTextureToTexture3D function signature has changed.");n=arguments[0]||null;r=arguments[1]||null;e=arguments[2];t=arguments[3];a=arguments[4]||0}(0,s.warnOnce)('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.');return this.copyTextureToTexture(e,t,n,r,a)};this.initRenderTarget=function(e){le.get(e).__webglFramebuffer===void 0&&ce.setupRenderTarget(e)};this.initTexture=function(e){e.isCubeTexture?ce.setTextureCube(e,0):e.isData3DTexture?ce.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ce.setTexture2DArray(e,0):ce.setTexture2D(e,0);ae.unbindTexture()};this.resetState=function(){T=0;I=0;R=null;ae.reset();Se.reset()};typeof __THREE_DEVTOOLS__!=="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return s.WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=s.ColorManagement._getDrawingBufferColorSpace(e);t.unpackColorSpace=s.ColorManagement._getUnpackColorSpace()}}},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(e,t,n)=>{n.r(t);n.d(t,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>le,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>se,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>oe,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>ie,KHR_DF_CHANNEL_RGBSDA_RED:()=>re,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>ae,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>x,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>b,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>l,KHR_DF_MODEL_ASTC:()=>m,KHR_DF_MODEL_ETC1:()=>p,KHR_DF_MODEL_ETC1S:()=>g,KHR_DF_MODEL_ETC2:()=>f,KHR_DF_MODEL_RGBSDA:()=>d,KHR_DF_MODEL_UASTC:()=>y,KHR_DF_MODEL_UNSPECIFIED:()=>h,KHR_DF_PRIMARIES_ACES:()=>J,KHR_DF_PRIMARIES_ACESCC:()=>Z,KHR_DF_PRIMARIES_ADOBERGB:()=>ne,KHR_DF_PRIMARIES_BT2020:()=>X,KHR_DF_PRIMARIES_BT601_EBU:()=>q,KHR_DF_PRIMARIES_BT601_SMPTE:()=>K,KHR_DF_PRIMARIES_BT709:()=>W,KHR_DF_PRIMARIES_CIEXYZ:()=>Y,KHR_DF_PRIMARIES_DISPLAYP3:()=>te,KHR_DF_PRIMARIES_NTSC1953:()=>$,KHR_DF_PRIMARIES_PAL525:()=>ee,KHR_DF_PRIMARIES_UNSPECIFIED:()=>z,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>he,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>ce,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>de,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>ue,KHR_DF_TRANSFER_ACESCC:()=>V,KHR_DF_TRANSFER_ACESCCT:()=>j,KHR_DF_TRANSFER_ADOBERGB:()=>H,KHR_DF_TRANSFER_BT1886:()=>L,KHR_DF_TRANSFER_DCIP3:()=>O,KHR_DF_TRANSFER_HLG_EOTF:()=>P,KHR_DF_TRANSFER_HLG_OETF:()=>D,KHR_DF_TRANSFER_ITU:()=>S,KHR_DF_TRANSFER_LINEAR:()=>M,KHR_DF_TRANSFER_NTSC:()=>T,KHR_DF_TRANSFER_PAL625_EOTF:()=>N,KHR_DF_TRANSFER_PAL_OETF:()=>k,KHR_DF_TRANSFER_PQ_EOTF:()=>F,KHR_DF_TRANSFER_PQ_OETF:()=>U,KHR_DF_TRANSFER_SLOG:()=>I,KHR_DF_TRANSFER_SLOG2:()=>R,KHR_DF_TRANSFER_SRGB:()=>w,KHR_DF_TRANSFER_ST240:()=>G,KHR_DF_TRANSFER_UNSPECIFIED:()=>_,KHR_DF_VENDORID_KHRONOS:()=>c,KHR_DF_VERSION:()=>u,KHR_SUPERCOMPRESSION_BASISLZ:()=>s,KHR_SUPERCOMPRESSION_NONE:()=>r,KHR_SUPERCOMPRESSION_ZLIB:()=>o,KHR_SUPERCOMPRESSION_ZSTD:()=>a,KTX2Container:()=>Ii,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>Ee,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>st,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>rt,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>it,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>nt,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>tt,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>$e,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>et,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>Ze,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>Nr,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>kr,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>Fr,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>tr,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>er,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>Lr,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>Xn,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>Kn,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>Dr,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>Jn,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Yn,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>Pr,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>$n,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Zn,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>Ur,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>rr,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>nr,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>Or,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>sr,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>ir,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>_r,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>Dn,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>Ln,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>Mr,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>Fn,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>Pn,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>wr,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>On,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>Un,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>Sr,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>Nn,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>kn,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>Tr,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>Vn,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>Gn,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>Br,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>jn,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Qn,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>Ir,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>zn,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>Hn,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>Rr,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>qn,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>Wn,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>Yt,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>ur,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>mr,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>Ae,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>Ce,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>ve,VK_FORMAT_B8G8R8A8_SINT:()=>Ye,VK_FORMAT_B8G8R8A8_SNORM:()=>Ke,VK_FORMAT_B8G8R8A8_SRGB:()=>Je,VK_FORMAT_B8G8R8A8_UINT:()=>Xe,VK_FORMAT_B8G8R8A8_UNORM:()=>qe,VK_FORMAT_B8G8R8_SINT:()=>Ge,VK_FORMAT_B8G8R8_SNORM:()=>ke,VK_FORMAT_B8G8R8_SRGB:()=>Ve,VK_FORMAT_B8G8R8_UINT:()=>Ne,VK_FORMAT_B8G8R8_UNORM:()=>Oe,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>cn,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>ln,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>on,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>an,VK_FORMAT_BC2_SRGB_BLOCK:()=>hn,VK_FORMAT_BC2_UNORM_BLOCK:()=>un,VK_FORMAT_BC3_SRGB_BLOCK:()=>pn,VK_FORMAT_BC3_UNORM_BLOCK:()=>dn,VK_FORMAT_BC4_SNORM_BLOCK:()=>mn,VK_FORMAT_BC4_UNORM_BLOCK:()=>fn,VK_FORMAT_BC5_SNORM_BLOCK:()=>gn,VK_FORMAT_BC5_UNORM_BLOCK:()=>An,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>yn,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>vn,VK_FORMAT_BC7_SRGB_BLOCK:()=>En,VK_FORMAT_BC7_UNORM_BLOCK:()=>Cn,VK_FORMAT_D16_UNORM:()=>Zt,VK_FORMAT_D16_UNORM_S8_UINT:()=>nn,VK_FORMAT_D24_UNORM_S8_UINT:()=>rn,VK_FORMAT_D32_SFLOAT:()=>en,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>sn,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Jt,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>Rn,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>In,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Bn,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>Tn,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>Mn,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>_n,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>Sn,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>wn,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>xn,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>bn,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>cr,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>fr,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>Cr,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>Ar,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Er,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>gr,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>br,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>vr,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>xr,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>yr,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>lr,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>or,VK_FORMAT_R10X6_UNORM_PACK16:()=>ar,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>pr,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>dr,VK_FORMAT_R12X4_UNORM_PACK16:()=>hr,VK_FORMAT_R16G16B16A16_SFLOAT:()=>Mt,VK_FORMAT_R16G16B16A16_SINT:()=>_t,VK_FORMAT_R16G16B16A16_SNORM:()=>bt,VK_FORMAT_R16G16B16A16_UINT:()=>xt,VK_FORMAT_R16G16B16A16_UNORM:()=>Et,VK_FORMAT_R16G16B16_SFLOAT:()=>Ct,VK_FORMAT_R16G16B16_SINT:()=>yt,VK_FORMAT_R16G16B16_SNORM:()=>gt,VK_FORMAT_R16G16B16_UINT:()=>vt,VK_FORMAT_R16G16B16_UNORM:()=>At,VK_FORMAT_R16G16_SFLOAT:()=>mt,VK_FORMAT_R16G16_SINT:()=>ft,VK_FORMAT_R16G16_SNORM:()=>dt,VK_FORMAT_R16G16_UINT:()=>pt,VK_FORMAT_R16G16_UNORM:()=>ht,VK_FORMAT_R16_SFLOAT:()=>ut,VK_FORMAT_R16_SINT:()=>ct,VK_FORMAT_R16_SNORM:()=>ot,VK_FORMAT_R16_UINT:()=>lt,VK_FORMAT_R16_UNORM:()=>at,VK_FORMAT_R32G32B32A32_SFLOAT:()=>Ot,VK_FORMAT_R32G32B32A32_SINT:()=>Ut,VK_FORMAT_R32G32B32A32_UINT:()=>Ft,VK_FORMAT_R32G32B32_SFLOAT:()=>Pt,VK_FORMAT_R32G32B32_SINT:()=>Dt,VK_FORMAT_R32G32B32_UINT:()=>Lt,VK_FORMAT_R32G32_SFLOAT:()=>Rt,VK_FORMAT_R32G32_SINT:()=>It,VK_FORMAT_R32G32_UINT:()=>Bt,VK_FORMAT_R32_SFLOAT:()=>Tt,VK_FORMAT_R32_SINT:()=>St,VK_FORMAT_R32_UINT:()=>wt,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>me,VK_FORMAT_R4G4_UNORM_PACK8:()=>fe,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>ye,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>ge,VK_FORMAT_R64G64B64A64_SFLOAT:()=>Xt,VK_FORMAT_R64G64B64A64_SINT:()=>Kt,VK_FORMAT_R64G64B64A64_UINT:()=>qt,VK_FORMAT_R64G64B64_SFLOAT:()=>Wt,VK_FORMAT_R64G64B64_SINT:()=>zt,VK_FORMAT_R64G64B64_UINT:()=>Ht,VK_FORMAT_R64G64_SFLOAT:()=>jt,VK_FORMAT_R64G64_SINT:()=>Qt,VK_FORMAT_R64G64_UINT:()=>Vt,VK_FORMAT_R64_SFLOAT:()=>Gt,VK_FORMAT_R64_SINT:()=>Nt,VK_FORMAT_R64_UINT:()=>kt,VK_FORMAT_R8G8B8A8_SINT:()=>ze,VK_FORMAT_R8G8B8A8_SNORM:()=>je,VK_FORMAT_R8G8B8A8_SRGB:()=>We,VK_FORMAT_R8G8B8A8_UINT:()=>He,VK_FORMAT_R8G8B8A8_UNORM:()=>Qe,VK_FORMAT_R8G8B8_SINT:()=>Fe,VK_FORMAT_R8G8B8_SNORM:()=>De,VK_FORMAT_R8G8B8_SRGB:()=>Ue,VK_FORMAT_R8G8B8_UINT:()=>Pe,VK_FORMAT_R8G8B8_UNORM:()=>Le,VK_FORMAT_R8G8_SINT:()=>Ie,VK_FORMAT_R8G8_SNORM:()=>Te,VK_FORMAT_R8G8_SRGB:()=>Re,VK_FORMAT_R8G8_UINT:()=>Be,VK_FORMAT_R8G8_UNORM:()=>Se,VK_FORMAT_R8_SINT:()=>Me,VK_FORMAT_R8_SNORM:()=>xe,VK_FORMAT_R8_SRGB:()=>we,VK_FORMAT_R8_UINT:()=>_e,VK_FORMAT_R8_UNORM:()=>be,VK_FORMAT_S8_UINT:()=>tn,VK_FORMAT_UNDEFINED:()=>pe,VK_FORMAT_X8_D24_UNORM_PACK32:()=>$t,read:()=>Pi,write:()=>Wi});const r=0,s=1,a=2,o=3,l=0,c=0,u=2,h=0,d=1,p=160,f=161,m=162,g=163,y=166,b=0,x=1,_=0,M=1,w=2,S=3,T=4,I=5,R=6,L=7,D=8,P=9,F=10,U=11,O=12,k=13,N=14,G=15,V=16,j=17,H=18,z=0,W=1,q=2,K=3,X=4,Y=5,J=6,Z=7,$=8,ee=9,te=10,ne=11,re=0,ie=1,se=2,ae=13,oe=14,le=15,ce=128,ue=64,he=32,de=16,pe=0,fe=1,me=2,Ae=3,ge=4,ve=5,ye=6,Ce=7,Ee=8,be=9,xe=10,_e=13,Me=14,we=15,Se=16,Te=17,Be=20,Ie=21,Re=22,Le=23,De=24,Pe=27,Fe=28,Ue=29,Oe=30,ke=31,Ne=34,Ge=35,Ve=36,Qe=37,je=38,He=41,ze=42,We=43,qe=44,Ke=45,Xe=48,Ye=49,Je=50,Ze=58,$e=59,et=62,tt=63,nt=64,rt=65,it=68,st=69,at=70,ot=71,lt=74,ct=75,ut=76,ht=77,dt=78,pt=81,ft=82,mt=83,At=84,gt=85,vt=88,yt=89,Ct=90,Et=91,bt=92,xt=95,_t=96,Mt=97,wt=98,St=99,Tt=100,Bt=101,It=102,Rt=103,Lt=104,Dt=105,Pt=106,Ft=107,Ut=108,Ot=109,kt=110,Nt=111,Gt=112,Vt=113,Qt=114,jt=115,Ht=116,zt=117,Wt=118,qt=119,Kt=120,Xt=121,Yt=122,Jt=123,Zt=124,$t=125,en=126,tn=127,nn=128,rn=129,sn=130,an=131,on=132,ln=133,cn=134,un=135,hn=136,dn=137,pn=138,fn=139,mn=140,An=141,gn=142,vn=143,yn=144,Cn=145,En=146,bn=147,xn=148,_n=149,Mn=150,wn=151,Sn=152,Tn=153,Bn=154,In=155,Rn=156,Ln=157,Dn=158,Pn=159,Fn=160,Un=161,On=162,kn=163,Nn=164,Gn=165,Vn=166,Qn=167,jn=168,Hn=169,zn=170,Wn=171,qn=172,Kn=173,Xn=174,Yn=175,Jn=176,Zn=177,$n=178,er=179,tr=180,nr=181,rr=182,ir=183,sr=184,ar=1000156007,or=1000156008,lr=1000156009,cr=1000156010,ur=1000156011,hr=1000156017,dr=1000156018,pr=1000156019,fr=1000156020,mr=1000156021,Ar=1000054e3,gr=1000054001,vr=1000054002,yr=1000054003,Cr=1000054004,Er=1000054005,br=1000054006,xr=1000054007,_r=1000066e3,Mr=1000066001,wr=1000066002,Sr=1000066003,Tr=1000066004,Br=1000066005,Ir=1000066006,Rr=1000066007,Lr=1000066008,Dr=1000066009,Pr=1000066010,Fr=1000066011,Ur=1000066012,Or=1000066013,kr=100034e4,Nr=1000340001;class Ii{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Si{constructor(e,t,n,r){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,n),this._littleEndian=r,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t){void 0===t&&(t=0);const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==t&&r<e;)r++,this._offset++;return r<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}}const Gr=new Uint8Array([0]),Vr=[171,75,84,88,32,50,48,187,13,10,26,10];function Ei(e){return(new TextEncoder).encode(e)}function Ti(e){return(new TextDecoder).decode(e)}function Ci(e){let t=0;for(const n of e)t+=n.byteLength;const n=new Uint8Array(t);let r=0;for(const t of e)n.set(new Uint8Array(t),r),r+=t.byteLength;return n}function Mi(e,t){return void 0===t&&(t=4),Math.ceil(e/t)*t-e}function Pi(e){const t=new Uint8Array(e.buffer,e.byteOffset,Vr.length);if(t[0]!==Vr[0]||t[1]!==Vr[1]||t[2]!==Vr[2]||t[3]!==Vr[3]||t[4]!==Vr[4]||t[5]!==Vr[5]||t[6]!==Vr[6]||t[7]!==Vr[7]||t[8]!==Vr[8]||t[9]!==Vr[9]||t[10]!==Vr[10]||t[11]!==Vr[11])throw new Error("Missing KTX 2.0 identifier.");const n=new Ii,r=17*Uint32Array.BYTES_PER_ELEMENT,s=new Si(e,Vr.length,r,!0);n.vkFormat=s._nextUint32(),n.typeSize=s._nextUint32(),n.pixelWidth=s._nextUint32(),n.pixelHeight=s._nextUint32(),n.pixelDepth=s._nextUint32(),n.layerCount=s._nextUint32(),n.faceCount=s._nextUint32();const a=s._nextUint32();n.supercompressionScheme=s._nextUint32();const o=s._nextUint32(),l=s._nextUint32(),c=s._nextUint32(),u=s._nextUint32(),h=s._nextUint64(),d=s._nextUint64(),p=new Si(e,Vr.length+r,3*a*8,!0);for(let t=0;t<a;t++)n.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+p._nextUint64(),p._nextUint64()),uncompressedByteLength:p._nextUint64()});const f=new Si(e,o,l,!0),m={vendorId:f._skip(4)._nextUint16(),descriptorType:f._nextUint16(),versionNumber:f._nextUint16(),descriptorBlockSize:f._nextUint16(),colorModel:f._nextUint8(),colorPrimaries:f._nextUint8(),transferFunction:f._nextUint8(),flags:f._nextUint8(),texelBlockDimension:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],bytesPlane:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],samples:[]},g=(m.descriptorBlockSize/4-6)/4;for(let e=0;e<g;e++){const t={bitOffset:f._nextUint16(),bitLength:f._nextUint8(),channelType:f._nextUint8(),samplePosition:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],sampleLower:-Infinity,sampleUpper:Infinity};64&t.channelType?(t.sampleLower=f._nextInt32(),t.sampleUpper=f._nextInt32()):(t.sampleLower=f._nextUint32(),t.sampleUpper=f._nextUint32()),m.samples[e]=t}n.dataFormatDescriptor.length=0,n.dataFormatDescriptor.push(m);const y=new Si(e,c,u,!0);for(;y._offset<u;){const e=y._nextUint32(),t=y._scan(e),r=Ti(t);if(n.keyValue[r]=y._nextUint8Array(e-t.byteLength-1),r.match(/^ktx/i)){const e=Ti(n.keyValue[r]);n.keyValue[r]=e.substring(0,e.lastIndexOf("\0"))}y._skip(e%4?4-e%4:0)}if(d<=0)return n;const b=new Si(e,h,d,!0),x=b._nextUint16(),_=b._nextUint16(),M=b._nextUint32(),w=b._nextUint32(),S=b._nextUint32(),T=b._nextUint32(),I=[];for(let e=0;e<a;e++)I.push({imageFlags:b._nextUint32(),rgbSliceByteOffset:b._nextUint32(),rgbSliceByteLength:b._nextUint32(),alphaSliceByteOffset:b._nextUint32(),alphaSliceByteLength:b._nextUint32()});const R=h+b._offset,L=R+M,D=L+w,P=D+S,F=new Uint8Array(e.buffer,e.byteOffset+R,M),U=new Uint8Array(e.buffer,e.byteOffset+L,w),O=new Uint8Array(e.buffer,e.byteOffset+D,S),k=new Uint8Array(e.buffer,e.byteOffset+P,T);return n.globalData={endpointCount:x,selectorCount:_,imageDescs:I,endpointsData:F,selectorsData:U,tablesData:O,extendedData:k},n}const Qr={keepWriter:!1};function Wi(e,t){void 0===t&&(t={}),t={...Qr,...t};let n=new ArrayBuffer(0);if(e.globalData){const t=new ArrayBuffer(20+5*e.globalData.imageDescs.length*4),r=new DataView(t);r.setUint16(0,e.globalData.endpointCount,!0),r.setUint16(2,e.globalData.selectorCount,!0),r.setUint32(4,e.globalData.endpointsData.byteLength,!0),r.setUint32(8,e.globalData.selectorsData.byteLength,!0),r.setUint32(12,e.globalData.tablesData.byteLength,!0),r.setUint32(16,e.globalData.extendedData.byteLength,!0);for(let t=0;t<e.globalData.imageDescs.length;t++){const n=e.globalData.imageDescs[t];r.setUint32(20+5*t*4+0,n.imageFlags,!0),r.setUint32(20+5*t*4+4,n.rgbSliceByteOffset,!0),r.setUint32(20+5*t*4+8,n.rgbSliceByteLength,!0),r.setUint32(20+5*t*4+12,n.alphaSliceByteOffset,!0),r.setUint32(20+5*t*4+16,n.alphaSliceByteLength,!0)}n=Ci([t,e.globalData.endpointsData,e.globalData.selectorsData,e.globalData.tablesData,e.globalData.extendedData])}const r=[];let s=e.keyValue;t.keepWriter||(s={...e.keyValue,KTXwriter:"KTX-Parse v0.7.1"});for(const e in s){const t=s[e],n=Ei(e),a="string"==typeof t?Ci([Ei(t),Gr]):t,o=n.byteLength+1+a.byteLength,l=Mi(o,4);r.push(Ci([new Uint32Array([o]),n,Gr,a,new Uint8Array(l).fill(0)]))}const a=Ci(r);if(1!==e.dataFormatDescriptor.length||0!==e.dataFormatDescriptor[0].descriptorType)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const o=e.dataFormatDescriptor[0],l=new ArrayBuffer(28+16*o.samples.length),c=new DataView(l),u=24+16*o.samples.length;if(c.setUint32(0,l.byteLength,!0),c.setUint16(4,o.vendorId,!0),c.setUint16(6,o.descriptorType,!0),c.setUint16(8,o.versionNumber,!0),c.setUint16(10,u,!0),c.setUint8(12,o.colorModel),c.setUint8(13,o.colorPrimaries),c.setUint8(14,o.transferFunction),c.setUint8(15,o.flags),!Array.isArray(o.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");c.setUint8(16,o.texelBlockDimension[0]),c.setUint8(17,o.texelBlockDimension[1]),c.setUint8(18,o.texelBlockDimension[2]),c.setUint8(19,o.texelBlockDimension[3]);for(let e=0;e<8;e++)c.setUint8(20+e,o.bytesPlane[e]);for(let e=0;e<o.samples.length;e++){const t=o.samples[e],n=28+16*e;if(t.channelID)throw new Error("channelID has been renamed to channelType.");c.setUint16(n+0,t.bitOffset,!0),c.setUint8(n+2,t.bitLength),c.setUint8(n+3,t.channelType),c.setUint8(n+4,t.samplePosition[0]),c.setUint8(n+5,t.samplePosition[1]),c.setUint8(n+6,t.samplePosition[2]),c.setUint8(n+7,t.samplePosition[3]),64&t.channelType?(c.setInt32(n+8,t.sampleLower,!0),c.setInt32(n+12,t.sampleUpper,!0)):(c.setUint32(n+8,t.sampleLower,!0),c.setUint32(n+12,t.sampleUpper,!0))}const h=Vr.length+68+3*e.levels.length*8,d=h+l.byteLength;let p=n.byteLength>0?d+a.byteLength:0;p%8&&(p+=8-p%8);const f=[],m=new DataView(new ArrayBuffer(3*e.levels.length*8)),g=new Uint32Array(e.levels.length);let y=0;0===e.supercompressionScheme&&(y=function(e){const t=Math.max(e,4),n=Math.min(e,4);let r=t;for(;r%n!=0;)r+=t;return r}(function(e){return e.levels[0].levelData.byteLength/function(e){let t=1;const n=[e.pixelWidth,e.pixelHeight,e.pixelDepth],r=function(e){const[t,n,r]=e.dataFormatDescriptor[0].texelBlockDimension;return[t+1,n+1,r+1]}(e);for(let e=0;e<3;e++)if(n[e]>0){const s=Math.ceil(Math.floor(n[e]*Math.pow(2,-0))/r[e]);t*=Math.max(1,s)}return e.layerCount>0&&(t*=e.layerCount),e.faceCount>0&&(t*=e.faceCount),t}(e)}(e)));let b=(p||d+a.byteLength)+n.byteLength;for(let t=e.levels.length-1;t>=0;t--){if(b%y){const e=Mi(b,y);f.push(new Uint8Array(e)),b+=e}const n=e.levels[t];f.push(n.levelData),g[t]=b,b+=n.levelData.byteLength}for(let t=0;t<e.levels.length;t++){const n=e.levels[t];m.setBigUint64(24*t+0,BigInt(g[t]),!0),m.setBigUint64(24*t+8,BigInt(n.levelData.byteLength),!0),m.setBigUint64(24*t+16,BigInt(n.uncompressedByteLength),!0)}const x=new ArrayBuffer(68),_=new DataView(x);return _.setUint32(0,e.vkFormat,!0),_.setUint32(4,e.typeSize,!0),_.setUint32(8,e.pixelWidth,!0),_.setUint32(12,e.pixelHeight,!0),_.setUint32(16,e.pixelDepth,!0),_.setUint32(20,e.layerCount,!0),_.setUint32(24,e.faceCount,!0),_.setUint32(28,e.levels.length,!0),_.setUint32(32,e.supercompressionScheme,!0),_.setUint32(36,h,!0),_.setUint32(40,l.byteLength,!0),_.setUint32(44,d,!0),_.setUint32(48,a.byteLength,!0),_.setBigUint64(52,BigInt(n.byteLength>0?p:0),!0),_.setBigUint64(60,BigInt(n.byteLength),!0),new Uint8Array(Ci([new Uint8Array(Vr).buffer,x,m.buffer,l,a,p>0?new ArrayBuffer(p-(d+a.byteLength)):new ArrayBuffer(0),n,...f]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(e,t,n)=>{n.r(t);n.d(t,{ZSTDDecoder:()=>Q});var r=n("./node_modules/buffer/index.js").Buffer;let s,a,o;const l={env:{emscripten_notify_memory_growth:function(e){o=new Uint8Array(a.exports.memory.buffer)}}};class Q{init(){return s||(s="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+c).then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,l))).then(this._init):WebAssembly.instantiate(r.from(c,"base64"),l).then(this._init),s)}_init(e){a=e.instance,l.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!a)throw new Error("ZSTDDecoder: Await .init() before decoding.");const n=e.byteLength,r=a.exports.malloc(n);o.set(e,r),t=t||Number(a.exports.ZSTD_findDecompressedSize(r,n));const s=a.exports.malloc(t),l=a.exports.ZSTD_decompress(s,t,r,n),c=o.slice(s,s+l);return a.exports.free(r),a.exports.free(s),c}}const c="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(e,t,n)=>{n.r(t);n.d(t,{LightProbeGenerator:()=>LightProbeGenerator});var r=n("./node_modules/three/build/three.core.js");class LightProbeGenerator{static fromCubeTexture(e){let t=0;const n=new r.Vector3;const s=new r.Vector3;const a=new r.Color;const o=[0,0,0,0,0,0,0,0,0];const l=new r.SphericalHarmonics3;const c=l.coefficients;for(let l=0;l<6;l++){const u=e.image[l];const h=u.width;const d=u.height;const p=document.createElement("canvas");p.width=h;p.height=d;const f=p.getContext("2d");f.drawImage(u,0,0,h,d);const m=f.getImageData(0,0,h,d);const g=m.data;const y=m.width;const b=2/y;for(let u=0,h=g.length;u<h;u+=4){a.setRGB(g[u]/255,g[u+1]/255,g[u+2]/255);convertColorToLinear(a,e.colorSpace);const h=u/4;const d=(h%y+.5)*b-1;const p=1-(Math.floor(h/y)+.5)*b;switch(l){case 0:n.set(-1,p,-d);break;case 1:n.set(1,p,d);break;case 2:n.set(-d,1,-p);break;case 3:n.set(-d,-1,p);break;case 4:n.set(-d,p,1);break;case 5:n.set(d,p,-1);break}const f=n.lengthSq();const m=4/(Math.sqrt(f)*f);t+=m;s.copy(n).normalize();r.SphericalHarmonics3.getBasisAt(s,o);for(let e=0;e<9;e++){c[e].x+=o[e]*a.r*m;c[e].y+=o[e]*a.g*m;c[e].z+=o[e]*a.b*m}}}const u=4*Math.PI/t;for(let e=0;e<9;e++){c[e].x*=u;c[e].y*=u;c[e].z*=u}return new r.LightProbe(l)}static async fromCubeRenderTarget(e,t){const n=e.coordinateSystem===r.WebGLCoordinateSystem?-1:1;let s=0;const a=new r.Vector3;const o=new r.Vector3;const l=new r.Color;const c=[0,0,0,0,0,0,0,0,0];const u=new r.SphericalHarmonics3;const h=u.coefficients;const d=t.texture.type;const p=t.width;let f;e.isWebGLRenderer&&(f=d===r.HalfFloatType?new Uint16Array(p*p*4):new Uint8Array(p*p*4));for(let u=0;u<6;u++){e.isWebGLRenderer?await e.readRenderTargetPixelsAsync(t,0,0,p,p,f,u):f=await e.readRenderTargetPixelsAsync(t,0,0,p,p,0,u);const m=2/p;for(let e=0,g=f.length;e<g;e+=4){let g,y,b;if(d===r.HalfFloatType){g=r.DataUtils.fromHalfFloat(f[e]);y=r.DataUtils.fromHalfFloat(f[e+1]);b=r.DataUtils.fromHalfFloat(f[e+2])}else{g=f[e]/255;y=f[e+1]/255;b=f[e+2]/255}l.setRGB(g,y,b);convertColorToLinear(l,t.texture.colorSpace);const x=e/4;const _=(1-(x%p+.5)*m)*n;const M=1-(Math.floor(x/p)+.5)*m;switch(u){case 0:a.set(-1*n,M,_*n);break;case 1:a.set(1*n,M,-_*n);break;case 2:a.set(_,1,-M);break;case 3:a.set(_,-1,M);break;case 4:a.set(_,M,1);break;case 5:a.set(-_,M,-1);break}const w=a.lengthSq();const S=4/(Math.sqrt(w)*w);s+=S;o.copy(a).normalize();r.SphericalHarmonics3.getBasisAt(o,c);for(let e=0;e<9;e++){h[e].x+=c[e]*l.r*S;h[e].y+=c[e]*l.g*S;h[e].z+=c[e]*l.b*S}}}const m=4*Math.PI/s;for(let e=0;e<9;e++){h[e].x*=m;h[e].y*=m;h[e].z*=m}return new r.LightProbe(u)}}function convertColorToLinear(e,t){switch(t){case r.SRGBColorSpace:e.convertSRGBToLinear();break;case r.LinearSRGBColorSpace:case r.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return e}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(e,n,r)=>{r.r(n);r.d(n,{DRACOLoader:()=>DRACOLoader});var s=r("./node_modules/three/build/three.core.js");const a=new WeakMap;class DRACOLoader extends s.Loader{constructor(e){super(e);this.decoderPath="";this.decoderConfig={};this.decoderBinary=null;this.decoderPending=null;this.workerLimit=4;this.workerPool=[];this.workerNextTaskID=1;this.workerSourceURL="";this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"};this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){this.decoderPath=e;return this}setDecoderConfig(e){this.decoderConfig=e;return this}setWorkerLimit(e){this.workerLimit=e;return this}load(e,t,n,r){const a=new s.FileLoader(this.manager);a.setPath(this.path);a.setResponseType("arraybuffer");a.setRequestHeader(this.requestHeader);a.setWithCredentials(this.withCredentials);a.load(e,(e=>{this.parse(e,t,r)}),n,r)}parse(e,t,n=()=>{}){this.decodeDracoFile(e,t,null,null,s.SRGBColorSpace,n).catch(n)}decodeDracoFile(e,t,n,r,a=s.LinearSRGBColorSpace,o=()=>{}){const l={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:a};return this.decodeGeometry(e,l).then(t).catch(o)}decodeGeometry(e,t){const n=JSON.stringify(t);if(a.has(e)){const t=a.get(e);if(t.key===n)return t.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++;const o=e.byteLength;const l=this._getWorker(s,o).then((n=>{r=n;return new Promise(((n,a)=>{r._callbacks[s]={resolve:n,reject:a};r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))})).then((e=>this._createGeometry(e.geometry)));l.catch((()=>true)).then((()=>{r&&s&&this._releaseTask(r,s)}));a.set(e,{key:n,promise:l});return l}_createGeometry(e){const t=new s.BufferGeometry;e.index&&t.setIndex(new s.BufferAttribute(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n];const a=r.name;const o=r.array;const l=r.itemSize;const c=new s.BufferAttribute(o,l);if(a==="color"){this._assignVertexColorSpace(c,r.vertexColorSpace);c.normalized=o instanceof Float32Array===false}t.setAttribute(a,c)}return t}_assignVertexColorSpace(e,t){if(t!==s.SRGBColorSpace)return;const n=new s.Color;for(let t=0,r=e.count;t<r;t++){n.fromBufferAttribute(e,t);s.ColorManagement.toWorkingColorSpace(n,s.SRGBColorSpace);e.setXYZ(t,n.r,n.g,n.b)}}_loadLibrary(e,t){const n=new s.FileLoader(this.manager);n.setPath(this.decoderPath);n.setResponseType(t);n.setWithCredentials(this.withCredentials);return new Promise(((t,r)=>{n.load(e,t,void 0,r)}))}preload(){this._initDecoder();return this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!=="object"||this.decoderConfig.type==="js";const t=[];if(e)t.push(this._loadLibrary("draco_decoder.js","text"));else{t.push(this._loadLibrary("draco_wasm_wrapper.js","text"));t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))}this.decoderPending=Promise.all(t).then((t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=DRACOWorker.toString();const s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))}));return this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={};e._taskCosts={};e._taskLoad=0;e.postMessage({type:"init",decoderConfig:this.decoderConfig});e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}};this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];n._taskCosts[e]=t;n._taskLoad+=t;return n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t];delete e._callbacks[t];delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();this.workerPool.length=0;this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL);return this}}function DRACOWorker(){let e;let n;t.onmessage=function(t){const r=t.data;switch(r.type){case"init":e=r.decoderConfig;n=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})};DracoDecoderModule(e)}));break;case"decode":const t=r.buffer;const s=r.taskConfig;n.then((e=>{const n=e.draco;const a=new n.Decoder;try{const e=decodeGeometry(n,a,new Int8Array(t),s);const o=e.attributes.map((e=>e.array.buffer));e.index&&o.push(e.index.array.buffer);self.postMessage({type:"decode",id:r.id,geometry:e},o)}catch(e){console.error(e);self.postMessage({type:"error",id:r.id,error:e.message})}finally{n.destroy(a)}}));break}};function decodeGeometry(e,t,n,r){const s=r.attributeIDs;const a=r.attributeTypes;let o;let l;const c=t.GetEncodedGeometryType(n);if(c===e.TRIANGULAR_MESH){o=new e.Mesh;l=t.DecodeArrayToMesh(n,n.byteLength,o)}else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud;l=t.DecodeArrayToPointCloud(n,n.byteLength,o)}if(!l.ok()||o.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const u={index:null,attributes:[]};for(const n in s){const l=self[a[n]];let c;let h;if(r.useUniqueIDs){h=s[n];c=t.GetAttributeByUniqueId(o,h)}else{h=t.GetAttributeId(o,e[s[n]]);if(h===-1)continue;c=t.GetAttribute(o,h)}const d=decodeAttribute(e,t,o,n,l,c);n==="color"&&(d.vertexColorSpace=r.vertexColorSpace);u.attributes.push(d)}c===e.TRIANGULAR_MESH&&(u.index=decodeIndex(e,t,o));e.destroy(o);return u}function decodeIndex(e,t,n){const r=n.num_faces();const s=r*3;const a=s*4;const o=e._malloc(a);t.GetTrianglesUInt32Array(n,a,o);const l=new Uint32Array(e.HEAPF32.buffer,o,s).slice();e._free(o);return{array:l,itemSize:1}}function decodeAttribute(e,t,n,r,s,a){const o=a.num_components();const l=n.num_points();const c=l*o;const u=c*s.BYTES_PER_ELEMENT;const h=getDracoDataType(e,s);const d=e._malloc(u);t.GetAttributeDataArrayForAllPoints(n,a,h,u,d);const p=new s(e.HEAPF32.buffer,d,c).slice();e._free(d);return{name:r,array:p,itemSize:o}}function getDracoDataType(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(e,t,n)=>{n.r(t);n.d(t,{GLTFLoader:()=>GLTFLoader});var r=n("./node_modules/three/build/three.core.js");var s=n("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class GLTFLoader extends r.Loader{constructor(e){super(e);this.dracoLoader=null;this.ktx2Loader=null;this.meshoptDecoder=null;this.pluginCallbacks=[];this.register((function(e){return new GLTFMaterialsClearcoatExtension(e)}));this.register((function(e){return new GLTFMaterialsDispersionExtension(e)}));this.register((function(e){return new GLTFTextureBasisUExtension(e)}));this.register((function(e){return new GLTFTextureWebPExtension(e)}));this.register((function(e){return new GLTFTextureAVIFExtension(e)}));this.register((function(e){return new GLTFMaterialsSheenExtension(e)}));this.register((function(e){return new GLTFMaterialsTransmissionExtension(e)}));this.register((function(e){return new GLTFMaterialsVolumeExtension(e)}));this.register((function(e){return new GLTFMaterialsIorExtension(e)}));this.register((function(e){return new GLTFMaterialsEmissiveStrengthExtension(e)}));this.register((function(e){return new GLTFMaterialsSpecularExtension(e)}));this.register((function(e){return new GLTFMaterialsIridescenceExtension(e)}));this.register((function(e){return new GLTFMaterialsAnisotropyExtension(e)}));this.register((function(e){return new GLTFMaterialsBumpExtension(e)}));this.register((function(e){return new GLTFLightsExtension(e)}));this.register((function(e){return new GLTFMeshoptCompression(e)}));this.register((function(e){return new GLTFMeshGpuInstancing(e)}))}load(e,t,n,s){const a=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const t=r.LoaderUtils.extractUrlBase(e);o=r.LoaderUtils.resolveURL(t,this.path)}else o=r.LoaderUtils.extractUrlBase(e);this.manager.itemStart(e);const _onError=function(t){s?s(t):console.error(t);a.manager.itemError(e);a.manager.itemEnd(e)};const l=new r.FileLoader(this.manager);l.setPath(this.path);l.setResponseType("arraybuffer");l.setRequestHeader(this.requestHeader);l.setWithCredentials(this.withCredentials);l.load(e,(function(n){try{a.parse(n,o,(function(n){t(n);a.manager.itemEnd(e)}),_onError)}catch(e){_onError(e)}}),n,_onError)}setDRACOLoader(e){this.dracoLoader=e;return this}setKTX2Loader(e){this.ktx2Loader=e;return this}setMeshoptDecoder(e){this.meshoptDecoder=e;return this}register(e){this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e);return this}unregister(e){this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1);return this}parse(e,t,n,r){let s;const l={};const c={};const u=new TextDecoder;if(typeof e==="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer){const t=u.decode(new Uint8Array(e,0,4));if(t===o){try{l[a.KHR_BINARY_GLTF]=new GLTFBinaryExtension(e)}catch(e){r&&r(e);return}s=JSON.parse(l[a.KHR_BINARY_GLTF].content)}else s=JSON.parse(u.decode(e))}else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new GLTFParser(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](h);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name");c[t.name]=t;l[t.name]=true}if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){const t=s.extensionsUsed[e];const n=s.extensionsRequired||[];switch(t){case a.KHR_MATERIALS_UNLIT:l[t]=new GLTFMaterialsUnlitExtension;break;case a.KHR_DRACO_MESH_COMPRESSION:l[t]=new GLTFDracoMeshCompressionExtension(s,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:l[t]=new GLTFTextureTransformExtension;break;case a.KHR_MESH_QUANTIZATION:l[t]=new GLTFMeshQuantizationExtension;break;default:n.indexOf(t)>=0&&c[t]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}h.setExtensions(l);h.setPlugins(c);h.parse(n,r)}parseAsync(e,t){const n=this;return new Promise((function(r,s){n.parse(e,t,r,s)}))}}function GLTFRegistry(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(e){this.parser=e;this.name=a.KHR_LIGHTS_PUNCTUAL;this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser;const t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser;const n="light:"+e;let s=t.cache.get(n);if(s)return s;const a=t.json;const o=a.extensions&&a.extensions[this.name]||{};const l=o.lights||[];const c=l[e];let u;const h=new r.Color(16777215);c.color!==void 0&&h.setRGB(c.color[0],c.color[1],c.color[2],r.LinearSRGBColorSpace);const d=c.range!==void 0?c.range:0;switch(c.type){case"directional":u=new r.DirectionalLight(h);u.target.position.set(0,0,-1);u.add(u.target);break;case"point":u=new r.PointLight(h);u.distance=d;break;case"spot":u=new r.SpotLight(h);u.distance=d;c.spot=c.spot||{};c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0;c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4;u.angle=c.spot.outerConeAngle;u.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle;u.target.position.set(0,0,-1);u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}u.position.set(0,0,0);assignExtrasToUserData(u,c);c.intensity!==void 0&&(u.intensity=c.intensity);u.name=t.createUniqueName(c.name||"light_"+e);s=Promise.resolve(u);t.cache.add(n,s);return s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this;const n=this.parser;const r=n.json;const s=r.nodes[e];const a=s.extensions&&s.extensions[this.name]||{};const o=a.light;return o===void 0?null:this._loadLight(o).then((function(e){return n._getNodeRef(t.cache,o,e)}))}}class GLTFMaterialsUnlitExtension{constructor(){this.name=a.KHR_MATERIALS_UNLIT}getMaterialType(){return r.MeshBasicMaterial}extendParams(e,t,n){const s=[];e.color=new r.Color(1,1,1);e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const t=a.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],r.LinearSRGBColorSpace);e.opacity=t[3]}a.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",a.baseColorTexture,r.SRGBColorSpace))}return Promise.all(s)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;s!==void 0&&(t.emissiveIntensity=s);return Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];const o=s.extensions[this.name];o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor);o.clearcoatTexture!==void 0&&a.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture));o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor);o.clearcoatRoughnessTexture!==void 0&&a.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture));if(o.clearcoatNormalTexture!==void 0){a.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture));if(o.clearcoatNormalTexture.scale!==void 0){const e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new r.Vector2(e,e)}}return Promise.all(a)}}class GLTFMaterialsDispersionExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];t.dispersion=s.dispersion!==void 0?s.dispersion:0;return Promise.resolve()}}class GLTFMaterialsIridescenceExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];const a=r.extensions[this.name];a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor);a.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture));a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor);t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]);a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum);a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum);a.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture));return Promise.all(s)}}class GLTFMaterialsSheenExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new r.Color(0,0,0);t.sheenRoughness=0;t.sheen=1;const o=s.extensions[this.name];if(o.sheenColorFactor!==void 0){const e=o.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],r.LinearSRGBColorSpace)}o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor);o.sheenColorTexture!==void 0&&a.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,r.SRGBColorSpace));o.sheenRoughnessTexture!==void 0&&a.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture));return Promise.all(a)}}class GLTFMaterialsTransmissionExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];const a=r.extensions[this.name];a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor);a.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture));return Promise.all(s)}}class GLTFMaterialsVolumeExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];const o=s.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0;o.thicknessTexture!==void 0&&a.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture));t.attenuationDistance=o.attenuationDistance||Infinity;const l=o.attenuationColor||[1,1,1];t.attenuationColor=(new r.Color).setRGB(l[0],l[1],l[2],r.LinearSRGBColorSpace);return Promise.all(a)}}class GLTFMaterialsIorExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];t.ior=s.ior!==void 0?s.ior:1.5;return Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const a=[];const o=s.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1;o.specularTexture!==void 0&&a.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const l=o.specularColorFactor||[1,1,1];t.specularColor=(new r.Color).setRGB(l[0],l[1],l[2],r.LinearSRGBColorSpace);o.specularColorTexture!==void 0&&a.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,r.SRGBColorSpace));return Promise.all(a)}}class GLTFMaterialsBumpExtension{constructor(e){this.parser=e;this.name=a.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];const a=r.extensions[this.name];t.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1;a.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",a.bumpTexture));return Promise.all(s)}}class GLTFMaterialsAnisotropyExtension{constructor(e){this.parser=e;this.name=a.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser;const n=t.json.materials[e];return n.extensions&&n.extensions[this.name]?r.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser;const r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];const a=r.extensions[this.name];a.anisotropyStrength!==void 0&&(t.anisotropy=a.anisotropyStrength);a.anisotropyRotation!==void 0&&(t.anisotropyRotation=a.anisotropyRotation);a.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",a.anisotropyTexture));return Promise.all(s)}}class GLTFTextureBasisUExtension{constructor(e){this.parser=e;this.name=a.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser;const n=t.json;const r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name];const a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class GLTFTextureWebPExtension{constructor(e){this.parser=e;this.name=a.EXT_TEXTURE_WEBP;this.isSupported=null}loadTexture(e){const t=this.name;const n=this.parser;const r=n.json;const s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t];const o=r.images[a.source];let l=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);e!==null&&(l=e)}return this.detectSupport().then((function(s){if(s)return n.loadTextureImage(e,a.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA";t.onload=t.onerror=function(){e(t.height===1)}})));return this.isSupported}}class GLTFTextureAVIFExtension{constructor(e){this.parser=e;this.name=a.EXT_TEXTURE_AVIF;this.isSupported=null}loadTexture(e){const t=this.name;const n=this.parser;const r=n.json;const s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t];const o=r.images[a.source];let l=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);e!==null&&(l=e)}return this.detectSupport().then((function(s){if(s)return n.loadTextureImage(e,a.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=";t.onload=t.onerror=function(){e(t.height===1)}})));return this.isSupported}}class GLTFMeshoptCompression{constructor(e){this.name=a.EXT_MESHOPT_COMPRESSION;this.parser=e}loadBufferView(e){const t=this.parser.json;const n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name];const r=this.parser.getDependency("buffer",e.buffer);const s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(t){const n=e.byteOffset||0;const r=e.byteLength||0;const a=e.count;const o=e.byteStride;const l=new Uint8Array(t,n,r);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(a,o,l,e.mode,e.filter).then((function(e){return e.buffer})):s.ready.then((function(){const t=new ArrayBuffer(a*o);s.decodeGltfBuffer(new Uint8Array(t),a,o,l,e.mode,e.filter);return t}))}))}return null}}class GLTFMeshGpuInstancing{constructor(e){this.name=a.EXT_MESH_GPU_INSTANCING;this.parser=e}createNodeMesh(e){const t=this.parser.json;const n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const e of s.primitives)if(e.mode!==h.TRIANGLES&&e.mode!==h.TRIANGLE_STRIP&&e.mode!==h.TRIANGLE_FAN&&e.mode!==void 0)return null;const a=n.extensions[this.name];const o=a.attributes;const l=[];const c={};for(const e in o)l.push(this.parser.getDependency("accessor",o[e]).then((t=>{c[e]=t;return c[e]})));if(l.length<1)return null;l.push(this.parser.createNodeMesh(e));return Promise.all(l).then((e=>{const t=e.pop();const n=t.isGroup?t.children:[t];const s=e[0].count;const a=[];for(const e of n){const t=new r.Matrix4;const n=new r.Vector3;const o=new r.Quaternion;const l=new r.Vector3(1,1,1);const u=new r.InstancedMesh(e.geometry,e.material,s);for(let e=0;e<s;e++){c.TRANSLATION&&n.fromBufferAttribute(c.TRANSLATION,e);c.ROTATION&&o.fromBufferAttribute(c.ROTATION,e);c.SCALE&&l.fromBufferAttribute(c.SCALE,e);u.setMatrixAt(e,t.compose(n,o,l))}for(const t in c)if(t==="_COLOR_0"){const e=c[t];u.instanceColor=new r.InstancedBufferAttribute(e.array,e.itemSize,e.normalized)}else t!=="TRANSLATION"&&t!=="ROTATION"&&t!=="SCALE"&&e.geometry.setAttribute(t,c[t]);r.Object3D.prototype.copy.call(u,e);this.parser.assignFinalMaterial(u);a.push(u)}if(t.isGroup){t.clear();t.add(...a);return t}return a[0]}))}}const o="glTF";const l=12;const c={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(e){this.name=a.KHR_BINARY_GLTF;this.content=null;this.body=null;const t=new DataView(e,0,l);const n=new TextDecoder;this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,true),length:t.getUint32(8,true)};if(this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-l;const s=new DataView(e,l);let u=0;while(u<r){const t=s.getUint32(u,true);u+=4;const r=s.getUint32(u,true);u+=4;if(r===c.JSON){const r=new Uint8Array(e,l+u,t);this.content=n.decode(r)}else if(r===c.BIN){const n=l+u;this.body=e.slice(n,n+t)}u+=t}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION;this.json=e;this.dracoLoader=t;this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json;const s=this.dracoLoader;const a=e.extensions[this.name].bufferView;const o=e.extensions[this.name].attributes;const l={};const c={};const u={};for(const e in o){const t=g[e]||e.toLowerCase();l[t]=o[e]}for(const t in e.attributes){const r=g[t]||t.toLowerCase();if(o[t]!==void 0){const s=n.accessors[e.attributes[t]];const a=d[s.componentType];u[r]=a.name;c[r]=s.normalized===true}}return t.getDependency("bufferView",a).then((function(e){return new Promise((function(t,n){s.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t];const r=c[t];r!==void 0&&(n.normalized=r)}t(e)}),l,u,r.LinearSRGBColorSpace,n)}))}))}}class GLTFTextureTransformExtension{constructor(){this.name=a.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){if((t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0)return e;e=e.clone();t.texCoord!==void 0&&(e.channel=t.texCoord);t.offset!==void 0&&e.offset.fromArray(t.offset);t.rotation!==void 0&&(e.rotation=t.rotation);t.scale!==void 0&&e.repeat.fromArray(t.scale);e.needsUpdate=true;return e}}class GLTFMeshQuantizationExtension{constructor(){this.name=a.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends r.Interpolant{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let e=0;e!==r;e++)t[e]=n[s+e];return t}interpolate_(e,t,n,r){const s=this.resultBuffer;const a=this.sampleValues;const o=this.valueSize;const l=o*2;const c=o*3;const u=r-t;const h=(n-t)/u;const d=h*h;const p=d*h;const f=e*c;const m=f-c;const g=-2*p+3*d;const y=p-d;const b=1-g;const x=y-d+h;for(let e=0;e!==o;e++){const t=a[m+e+o];const n=a[m+e+l]*u;const r=a[f+e+o];const c=a[f+e]*u;s[e]=b*t+x*n+g*r+y*c}return s}}const u=new r.Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);u.fromArray(s).normalize().toArray(s);return s}}const h={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123};const d={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};const p={9728:r.NearestFilter,9729:r.LinearFilter,9984:r.NearestMipmapNearestFilter,9985:r.LinearMipmapNearestFilter,9986:r.NearestMipmapLinearFilter,9987:r.LinearMipmapLinearFilter};const f={33071:r.ClampToEdgeWrapping,33648:r.MirroredRepeatWrapping,10497:r.RepeatWrapping};const m={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};const g={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"};const y={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"};const b={CUBICSPLINE:void 0,LINEAR:r.InterpolateLinear,STEP:r.InterpolateDiscrete};const x={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};
/**
         * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material
         *
         * @param {Object<String, Material>} cache
         * @return {Material}
         */function createDefaultMaterial(e){e.DefaultMaterial===void 0&&(e.DefaultMaterial=new r.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:false,depthTest:true,side:r.FrontSide}));return e.DefaultMaterial}function addUnknownExtensionsToUserData(e,t,n){for(const r in n.extensions)if(e[r]===void 0){t.userData.gltfExtensions=t.userData.gltfExtensions||{};t.userData.gltfExtensions[r]=n.extensions[r]}}
/**
         * @param {Object3D|Material|BufferGeometry} object
         * @param {GLTF.definition} gltfDef
         */function assignExtrasToUserData(e,t){t.extras!==void 0&&(typeof t.extras==="object"?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}
/**
         * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets
         *
         * @param {BufferGeometry} geometry
         * @param {Array<GLTF.Target>} targets
         * @param {GLTFParser} parser
         * @return {Promise<BufferGeometry>}
         */function addMorphTargets(e,t,n){let r=false;let s=false;let a=false;for(let e=0,n=t.length;e<n;e++){const n=t[e];n.POSITION!==void 0&&(r=true);n.NORMAL!==void 0&&(s=true);n.COLOR_0!==void 0&&(a=true);if(r&&s&&a)break}if(!r&&!s&&!a)return Promise.resolve(e);const o=[];const l=[];const c=[];for(let u=0,h=t.length;u<h;u++){const h=t[u];if(r){const t=h.POSITION!==void 0?n.getDependency("accessor",h.POSITION):e.attributes.position;o.push(t)}if(s){const t=h.NORMAL!==void 0?n.getDependency("accessor",h.NORMAL):e.attributes.normal;l.push(t)}if(a){const t=h.COLOR_0!==void 0?n.getDependency("accessor",h.COLOR_0):e.attributes.color;c.push(t)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(c)]).then((function(t){const n=t[0];const o=t[1];const l=t[2];r&&(e.morphAttributes.position=n);s&&(e.morphAttributes.normal=o);a&&(e.morphAttributes.color=l);e.morphTargetsRelative=true;return e}))}
/**
         * @param {Mesh} mesh
         * @param {GLTF.Mesh} meshDef
         */function updateMorphTargets(e,t){e.updateMorphTargets();if(t.weights!==void 0)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(e){let t;const n=e.extensions&&e.extensions[a.KHR_DRACO_MESH_COMPRESSION];t=n?"draco:"+n.bufferView+":"+n.indices+":"+createAttributesKey(n.attributes):e.indices+":"+createAttributesKey(e.attributes)+":"+e.mode;if(e.targets!==void 0)for(let n=0,r=e.targets.length;n<r;n++)t+=":"+createAttributesKey(e.targets[n]);return t}function createAttributesKey(e){let t="";const n=Object.keys(e).sort();for(let r=0,s=n.length;r<s;r++)t+=n[r]+":"+e[n[r]]+";";return t}function getNormalizedComponentScale(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(e){return e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0?"image/jpeg":e.search(/\.webp($|\?)/i)>0||e.search(/^data\:image\/webp/)===0?"image/webp":e.search(/\.ktx2($|\?)/i)>0||e.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const _=new r.Matrix4;class GLTFParser{constructor(e={},t={}){this.json=e;this.extensions={};this.plugins={};this.options=t;this.cache=new GLTFRegistry;this.associations=new Map;this.primitiveCache={};this.nodeCache={};this.meshCache={refs:{},uses:{}};this.cameraCache={refs:{},uses:{}};this.lightCache={refs:{},uses:{}};this.sourceCache={};this.textureCache={};this.nodeNamesUsed={};let n=false;let s=-1;let a=false;let o=-1;if(typeof navigator!=="undefined"){const e=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(e)===true;const t=e.match(/Version\/(\d+)/);s=n&&t?parseInt(t[1],10):-1;a=e.indexOf("Firefox")>-1;o=a?e.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap==="undefined"||n&&s<17||a&&o<98?this.textureLoader=new r.TextureLoader(this.options.manager):this.textureLoader=new r.ImageBitmapLoader(this.options.manager);this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.textureLoader.setRequestHeader(this.options.requestHeader);this.fileLoader=new r.FileLoader(this.options.manager);this.fileLoader.setResponseType("arraybuffer");this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(true)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this;const r=this.json;const s=this.extensions;this.cache.removeAll();this.nodeCache={};this._invokeAll((function(e){return e._markDefs&&e._markDefs()}));Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};addUnknownExtensionsToUserData(s,a,r);assignExtrasToUserData(a,r);return Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){for(const e of a.scenes)e.updateMatrixWorld();e(a)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[];const t=this.json.skins||[];const n=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n].joints;for(let t=0,n=r.length;t<n;t++)e[r[t]].isBone=true}for(let t=0,r=e.length;t<r;t++){const r=e[t];if(r.mesh!==void 0){this._addNodeRef(this.meshCache,r.mesh);r.skin!==void 0&&(n[r.mesh].isSkinnedMesh=true)}r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}
/**
           * Counts references to shared node / Object3D resources. These resources
           * can be reused, or "instantiated", at multiple nodes in the scene
           * hierarchy. Mesh, Camera, and Light instances are instantiated and must
           * be marked. Non-scenegraph resources (like Materials, Geometries, and
           * Textures) can be reused directly and are not marked here.
           *
           * Example: CesiumMilkTruck sample model reuses "Wheel" meshes.
           *
           * @param {Object} cache
           * @param {Object3D} index
           */_addNodeRef(e,t){if(t!==void 0){e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0);e.refs[t]++}}
/**
           * Returns a reference to a shared resource, cloning it if necessary.
           *
           * @param {Object} cache
           * @param {Number} index
           * @param {Object} object
           * @return {Object}
           */_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone();const updateMappings=(e,t)=>{const n=this.associations.get(e);n!=null&&this.associations.set(t,n);for(const[n,r]of e.children.entries())updateMappings(r,t.children[n])};updateMappings(n,r);r.name+="_instance_"+e.uses[t]++;return r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}
/**
           * Requests the specified dependency asynchronously, with caching.
           * @param {string} type
           * @param {number} index
           * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}
           */getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)}));if(!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}
/**
           * Requests all dependencies of the specified type asynchronously, with caching.
           * @param {string} type
           * @return {Promise<Array<Object>>}
           */getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;const r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)})));this.cache.add(e,t)}return t}
/**
           * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views
           * @param {number} bufferIndex
           * @return {Promise<ArrayBuffer>}
           */loadBuffer(e){const t=this.json.buffers[e];const n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);const s=this.options;return new Promise((function(e,a){n.load(r.LoaderUtils.resolveURL(t.uri,s.path),e,void 0,(function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}
/**
           * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views
           * @param {number} bufferViewIndex
           * @return {Promise<ArrayBuffer>}
           */loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0;const r=t.byteOffset||0;return e.slice(r,r+n)}))}
/**
           * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors
           * @param {number} accessorIndex
           * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}
           */loadAccessor(e){const t=this;const n=this.json;const s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const e=m[s.type];const t=d[s.componentType];const n=s.normalized===true;const a=new t(s.count*e);return Promise.resolve(new r.BufferAttribute(a,e,n))}const a=[];s.bufferView!==void 0?a.push(this.getDependency("bufferView",s.bufferView)):a.push(null);if(s.sparse!==void 0){a.push(this.getDependency("bufferView",s.sparse.indices.bufferView));a.push(this.getDependency("bufferView",s.sparse.values.bufferView))}return Promise.all(a).then((function(e){const a=e[0];const o=m[s.type];const l=d[s.componentType];const c=l.BYTES_PER_ELEMENT;const u=c*o;const h=s.byteOffset||0;const p=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0;const f=s.normalized===true;let g,y;if(p&&p!==u){const e=Math.floor(h/p);const n="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+e+":"+s.count;let u=t.cache.get(n);if(!u){g=new l(a,e*p,s.count*p/c);u=new r.InterleavedBuffer(g,p/c);t.cache.add(n,u)}y=new r.InterleavedBufferAttribute(u,o,h%p/c,f)}else{g=a===null?new l(s.count*o):new l(a,h,s.count*o);y=new r.BufferAttribute(g,o,f)}if(s.sparse!==void 0){const t=m.SCALAR;const n=d[s.sparse.indices.componentType];const c=s.sparse.indices.byteOffset||0;const u=s.sparse.values.byteOffset||0;const h=new n(e[1],c,s.sparse.count*t);const p=new l(e[2],u,s.sparse.count*o);a!==null&&(y=new r.BufferAttribute(y.array.slice(),y.itemSize,y.normalized));y.normalized=false;for(let e=0,t=h.length;e<t;e++){const t=h[e];y.setX(t,p[e*o]);o>=2&&y.setY(t,p[e*o+1]);o>=3&&y.setZ(t,p[e*o+2]);o>=4&&y.setW(t,p[e*o+3]);if(o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}y.normalized=f}return y}))}
/**
           * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures
           * @param {number} textureIndex
           * @return {Promise<THREE.Texture|null>}
           */loadTexture(e){const t=this.json;const n=this.options;const r=t.textures[e];const s=r.source;const a=t.images[s];let o=this.textureLoader;if(a.uri){const e=n.manager.getHandler(a.uri);e!==null&&(o=e)}return this.loadTextureImage(e,s,o)}loadTextureImage(e,t,n){const s=this;const a=this.json;const o=a.textures[e];const l=a.images[t];const c=(l.uri||l.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const u=this.loadImageSource(t,n).then((function(t){t.flipY=false;t.name=o.name||l.name||"";t.name===""&&typeof l.uri==="string"&&l.uri.startsWith("data:image/")===false&&(t.name=l.uri);const n=a.samplers||{};const c=n[o.sampler]||{};t.magFilter=p[c.magFilter]||r.LinearFilter;t.minFilter=p[c.minFilter]||r.LinearMipmapLinearFilter;t.wrapS=f[c.wrapS]||r.RepeatWrapping;t.wrapT=f[c.wrapT]||r.RepeatWrapping;t.generateMipmaps=!t.isCompressedTexture&&t.minFilter!==r.NearestFilter&&t.minFilter!==r.LinearFilter;s.associations.set(t,{textures:e});return t})).catch((function(){return null}));this.textureCache[c]=u;return u}loadImageSource(e,t){const n=this;const s=this.json;const a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then((e=>e.clone()));const o=s.images[e];const l=self.URL||self.webkitURL;let c=o.uri||"";let u=false;if(o.bufferView!==void 0)c=n.getDependency("bufferView",o.bufferView).then((function(e){u=true;const t=new Blob([e],{type:o.mimeType});c=l.createObjectURL(t);return c}));else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(c).then((function(e){return new Promise((function(n,s){let o=n;t.isImageBitmapLoader===true&&(o=function(e){const t=new r.Texture(e);t.needsUpdate=true;n(t)});t.load(r.LoaderUtils.resolveURL(e,a.path),o,void 0,s)}))})).then((function(e){u===true&&l.revokeObjectURL(c);assignExtrasToUserData(e,o);e.userData.mimeType=o.mimeType||getImageURIMimeType(o.uri);return e})).catch((function(e){console.error("THREE.GLTFLoader: Couldn't load texture",c);throw e}));this.sourceCache[e]=h;return h}
/**
           * Asynchronously assigns a texture to the given material parameters.
           *
           * @param {Object} materialParams
           * @param {string} mapName
           * @param {Object} mapDef
           * @param {string} colorSpace
           * @return {Promise<Texture>}
           */assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then((function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0){o=o.clone();o.channel=n.texCoord}if(s.extensions[a.KHR_TEXTURE_TRANSFORM]){const e=n.extensions!==void 0?n.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=s.associations.get(o);o=s.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(o,e);s.associations.set(o,t)}}r!==void 0&&(o.colorSpace=r);e[t]=o;return o}))}
/**
           * Assigns final material to a Mesh, Line, or Points instance. The instance
           * already has a material (generated from the glTF material options alone)
           * but reuse of the same glTF material may require multiple threejs materials
           * to accommodate different primitive types, defines, etc. New materials will
           * be created if necessary, and reused from a cache.
           * @param  {Object3D} mesh Mesh, Line, or Points instance.
           */assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0;const a=t.attributes.color!==void 0;const o=t.attributes.normal===void 0;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);if(!t){t=new r.PointsMaterial;r.Material.prototype.copy.call(t,n);t.color.copy(n.color);t.map=n.map;t.sizeAttenuation=false;this.cache.add(e,t)}n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);if(!t){t=new r.LineBasicMaterial;r.Material.prototype.copy.call(t,n);t.color.copy(n.color);t.map=n.map;this.cache.add(e,t)}n=t}if(s||a||o){let e="ClonedMaterial:"+n.uuid+":";s&&(e+="derivative-tangents:");a&&(e+="vertex-colors:");o&&(e+="flat-shading:");let t=this.cache.get(e);if(!t){t=n.clone();a&&(t.vertexColors=true);o&&(t.flatShading=true);if(s){t.normalScale&&(t.normalScale.y*=-1);t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)}this.cache.add(e,t);this.associations.set(t,this.associations.get(n))}n=t}e.material=n}getMaterialType(){return r.MeshStandardMaterial}
/**
           * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials
           * @param {number} materialIndex
           * @return {Promise<Material>}
           */loadMaterial(e){const t=this;const n=this.json;const s=this.extensions;const o=n.materials[e];let l;const c={};const u=o.extensions||{};const h=[];if(u[a.KHR_MATERIALS_UNLIT]){const e=s[a.KHR_MATERIALS_UNLIT];l=e.getMaterialType();h.push(e.extendParams(c,o,t))}else{const n=o.pbrMetallicRoughness||{};c.color=new r.Color(1,1,1);c.opacity=1;if(Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;c.color.setRGB(e[0],e[1],e[2],r.LinearSRGBColorSpace);c.opacity=e[3]}n.baseColorTexture!==void 0&&h.push(t.assignTexture(c,"map",n.baseColorTexture,r.SRGBColorSpace));c.metalness=n.metallicFactor!==void 0?n.metallicFactor:1;c.roughness=n.roughnessFactor!==void 0?n.roughnessFactor:1;if(n.metallicRoughnessTexture!==void 0){h.push(t.assignTexture(c,"metalnessMap",n.metallicRoughnessTexture));h.push(t.assignTexture(c,"roughnessMap",n.metallicRoughnessTexture))}l=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)}));h.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,c)}))))}o.doubleSided===true&&(c.side=r.DoubleSide);const d=o.alphaMode||x.OPAQUE;if(d===x.BLEND){c.transparent=true;c.depthWrite=false}else{c.transparent=false;d===x.MASK&&(c.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)}if(o.normalTexture!==void 0&&l!==r.MeshBasicMaterial){h.push(t.assignTexture(c,"normalMap",o.normalTexture));c.normalScale=new r.Vector2(1,1);if(o.normalTexture.scale!==void 0){const e=o.normalTexture.scale;c.normalScale.set(e,e)}}if(o.occlusionTexture!==void 0&&l!==r.MeshBasicMaterial){h.push(t.assignTexture(c,"aoMap",o.occlusionTexture));o.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=o.occlusionTexture.strength)}if(o.emissiveFactor!==void 0&&l!==r.MeshBasicMaterial){const e=o.emissiveFactor;c.emissive=(new r.Color).setRGB(e[0],e[1],e[2],r.LinearSRGBColorSpace)}o.emissiveTexture!==void 0&&l!==r.MeshBasicMaterial&&h.push(t.assignTexture(c,"emissiveMap",o.emissiveTexture,r.SRGBColorSpace));return Promise.all(h).then((function(){const n=new l(c);o.name&&(n.name=o.name);assignExtrasToUserData(n,o);t.associations.set(n,{materials:e});o.extensions&&addUnknownExtensionsToUserData(s,n,o);return n}))}
/**
           * When Object3D instances are targeted by animation, they need unique names.
           *
           * @param {String} originalName
           * @return {String}
           */createUniqueName(e){const t=r.PropertyBinding.sanitizeNodeName(e||"");if(t in this.nodeNamesUsed)return t+"_"+ ++this.nodeNamesUsed[t];this.nodeNamesUsed[t]=0;return t}
/**
           * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry
           *
           * Creates BufferGeometries from primitives.
           *
           * @param {Array<GLTF.Primitive>} primitives
           * @return {Promise<Array<BufferGeometry>>}
           */loadGeometries(e){const t=this;const n=this.extensions;const s=this.primitiveCache;function createDracoPrimitive(e){return n[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return addPrimitiveAttributes(n,e,t)}))}const o=[];for(let n=0,l=e.length;n<l;n++){const l=e[n];const c=createPrimitiveKey(l);const u=s[c];if(u)o.push(u.promise);else{let e;e=l.extensions&&l.extensions[a.KHR_DRACO_MESH_COMPRESSION]?createDracoPrimitive(l):addPrimitiveAttributes(new r.BufferGeometry,l,t);s[c]={primitive:l,promise:e};o.push(e)}}return Promise.all(o)}
/**
           * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes
           * @param {number} meshIndex
           * @return {Promise<Group|Mesh|SkinnedMesh>}
           */loadMesh(e){const t=this;const n=this.json;const a=this.extensions;const o=n.meshes[e];const l=o.primitives;const c=[];for(let e=0,t=l.length;e<t;e++){const t=l[e].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",l[e].material);c.push(t)}c.push(t.loadGeometries(l));return Promise.all(c).then((function(n){const c=n.slice(0,n.length-1);const u=n[n.length-1];const d=[];for(let n=0,p=u.length;n<p;n++){const p=u[n];const f=l[n];let m;const g=c[n];if(f.mode===h.TRIANGLES||f.mode===h.TRIANGLE_STRIP||f.mode===h.TRIANGLE_FAN||f.mode===void 0){m=o.isSkinnedMesh===true?new r.SkinnedMesh(p,g):new r.Mesh(p,g);m.isSkinnedMesh===true&&m.normalizeSkinWeights();f.mode===h.TRIANGLE_STRIP?m.geometry=(0,s.toTrianglesDrawMode)(m.geometry,r.TriangleStripDrawMode):f.mode===h.TRIANGLE_FAN&&(m.geometry=(0,s.toTrianglesDrawMode)(m.geometry,r.TriangleFanDrawMode))}else if(f.mode===h.LINES)m=new r.LineSegments(p,g);else if(f.mode===h.LINE_STRIP)m=new r.Line(p,g);else if(f.mode===h.LINE_LOOP)m=new r.LineLoop(p,g);else{if(f.mode!==h.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);m=new r.Points(p,g)}Object.keys(m.geometry.morphAttributes).length>0&&updateMorphTargets(m,o);m.name=t.createUniqueName(o.name||"mesh_"+e);assignExtrasToUserData(m,o);f.extensions&&addUnknownExtensionsToUserData(a,m,f);t.assignFinalMaterial(m);d.push(m)}for(let n=0,r=d.length;n<r;n++)t.associations.set(d[n],{meshes:e,primitives:n});if(d.length===1){o.extensions&&addUnknownExtensionsToUserData(a,d[0],o);return d[0]}const p=new r.Group;o.extensions&&addUnknownExtensionsToUserData(a,p,o);t.associations.set(p,{meshes:e});for(let e=0,t=d.length;e<t;e++)p.add(d[e]);return p}))}
/**
           * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras
           * @param {number} cameraIndex
           * @return {Promise<THREE.Camera>}
           */loadCamera(e){let t;const n=this.json.cameras[e];const s=n[n.type];if(s){n.type==="perspective"?t=new r.PerspectiveCamera(r.MathUtils.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new r.OrthographicCamera(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar));n.name&&(t.name=this.createUniqueName(n.name));assignExtrasToUserData(t,n);return Promise.resolve(t)}console.warn("THREE.GLTFLoader: Missing camera parameters.")}
/**
           * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins
           * @param {number} skinIndex
           * @return {Promise<Skeleton>}
           */loadSkin(e){const t=this.json.skins[e];const n=[];for(let e=0,r=t.joints.length;e<r;e++)n.push(this._loadNodeShallow(t.joints[e]));t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null);return Promise.all(n).then((function(e){const n=e.pop();const s=e;const a=[];const o=[];for(let e=0,l=s.length;e<l;e++){const l=s[e];if(l){a.push(l);const t=new r.Matrix4;n!==null&&t.fromArray(n.array,e*16);o.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}return new r.Skeleton(a,o)}))}
/**
           * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations
           * @param {number} animationIndex
           * @return {Promise<AnimationClip>}
           */loadAnimation(e){const t=this.json;const n=this;const s=t.animations[e];const a=s.name?s.name:"animation_"+e;const o=[];const l=[];const c=[];const u=[];const h=[];for(let e=0,t=s.channels.length;e<t;e++){const t=s.channels[e];const n=s.samplers[t.sampler];const r=t.target;const a=r.node;const d=s.parameters!==void 0?s.parameters[n.input]:n.input;const p=s.parameters!==void 0?s.parameters[n.output]:n.output;if(r.node!==void 0){o.push(this.getDependency("node",a));l.push(this.getDependency("accessor",d));c.push(this.getDependency("accessor",p));u.push(n);h.push(r)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(c),Promise.all(u),Promise.all(h)]).then((function(e){const t=e[0];const s=e[1];const o=e[2];const l=e[3];const c=e[4];const u=[];for(let e=0,r=t.length;e<r;e++){const r=t[e];const a=s[e];const h=o[e];const d=l[e];const p=c[e];if(r===void 0)continue;r.updateMatrix&&r.updateMatrix();const f=n._createAnimationTracks(r,a,h,d,p);if(f)for(let e=0;e<f.length;e++)u.push(f[e])}return new r.AnimationClip(a,void 0,u)}))}createNodeMesh(e){const t=this.json;const n=this;const r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);r.weights!==void 0&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]}));return t}))}
/**
           * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy
           * @param {number} nodeIndex
           * @return {Promise<Object3D>}
           */loadNode(e){const t=this.json;const n=this;const r=t.nodes[e];const s=n._loadNodeShallow(e);const a=[];const o=r.children||[];for(let e=0,t=o.length;e<t;e++)a.push(n.getDependency("node",o[e]));const l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(a),l]).then((function(e){const t=e[0];const n=e[1];const r=e[2];r!==null&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,_)}));for(let e=0,r=n.length;e<r;e++)t.add(n[e]);return t}))}_loadNodeShallow(e){const t=this.json;const n=this.extensions;const s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const a=t.nodes[e];const o=a.name?s.createUniqueName(a.name):"";const l=[];const c=s._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));c&&l.push(c);a.camera!==void 0&&l.push(s.getDependency("camera",a.camera).then((function(e){return s._getNodeRef(s.cameraCache,a.camera,e)})));s._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){l.push(e)}));this.nodeCache[e]=Promise.all(l).then((function(t){let l;l=a.isBone===true?new r.Bone:t.length>1?new r.Group:t.length===1?t[0]:new r.Object3D;if(l!==t[0])for(let e=0,n=t.length;e<n;e++)l.add(t[e]);if(a.name){l.userData.name=a.name;l.name=o}assignExtrasToUserData(l,a);a.extensions&&addUnknownExtensionsToUserData(n,l,a);if(a.matrix!==void 0){const e=new r.Matrix4;e.fromArray(a.matrix);l.applyMatrix4(e)}else{a.translation!==void 0&&l.position.fromArray(a.translation);a.rotation!==void 0&&l.quaternion.fromArray(a.rotation);a.scale!==void 0&&l.scale.fromArray(a.scale)}s.associations.has(l)||s.associations.set(l,{});s.associations.get(l).nodes=e;return l}));return this.nodeCache[e]}
/**
           * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes
           * @param {number} sceneIndex
           * @return {Promise<Group>}
           */loadScene(e){const t=this.extensions;const n=this.json.scenes[e];const s=this;const a=new r.Group;n.name&&(a.name=s.createUniqueName(n.name));assignExtrasToUserData(a,n);n.extensions&&addUnknownExtensionsToUserData(t,a,n);const o=n.nodes||[];const l=[];for(let e=0,t=o.length;e<t;e++)l.push(s.getDependency("node",o[e]));return Promise.all(l).then((function(e){for(let t=0,n=e.length;t<n;t++)a.add(e[t]);const reduceAssociations=e=>{const t=new Map;for(const[e,n]of s.associations)(e instanceof r.Material||e instanceof r.Texture)&&t.set(e,n);e.traverse((e=>{const n=s.associations.get(e);n!=null&&t.set(e,n)}));return t};s.associations=reduceAssociations(a);return a}))}_createAnimationTracks(e,t,n,s,a){const o=[];const l=e.name?e.name:e.uuid;const c=[];y[a.path]===y.weights?e.traverse((function(e){e.morphTargetInfluences&&c.push(e.name?e.name:e.uuid)})):c.push(l);let u;switch(y[a.path]){case y.weights:u=r.NumberKeyframeTrack;break;case y.rotation:u=r.QuaternionKeyframeTrack;break;case y.position:case y.scale:u=r.VectorKeyframeTrack;break;default:switch(n.itemSize){case 1:u=r.NumberKeyframeTrack;break;case 2:case 3:default:u=r.VectorKeyframeTrack;break}break}const h=s.interpolation!==void 0?b[s.interpolation]:r.InterpolateLinear;const d=this._getArrayFromAccessor(n);for(let e=0,n=c.length;e<n;e++){const n=new u(c[e]+"."+y[a.path],t.array,d,h);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(n);o.push(n)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=getNormalizedComponentScale(t.constructor);const n=new Float32Array(t.length);for(let r=0,s=t.length;r<s;r++)n[r]=t[r]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function InterpolantFactoryMethodGLTFCubicSpline(e){const t=this instanceof r.QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new t(this.times,this.values,this.getValueSize()/3,e)};e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=true}}
/**
         * @param {BufferGeometry} geometry
         * @param {GLTF.Primitive} primitiveDef
         * @param {GLTFParser} parser
         */function computeBounds(e,t,n){const s=t.attributes;const a=new r.Box3;if(s.POSITION===void 0)return;{const e=n.json.accessors[s.POSITION];const t=e.min;const o=e.max;if(t===void 0||o===void 0){console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}a.set(new r.Vector3(t[0],t[1],t[2]),new r.Vector3(o[0],o[1],o[2]));if(e.normalized){const t=getNormalizedComponentScale(d[e.componentType]);a.min.multiplyScalar(t);a.max.multiplyScalar(t)}}const o=t.targets;if(o!==void 0){const e=new r.Vector3;const t=new r.Vector3;for(let r=0,s=o.length;r<s;r++){const s=o[r];if(s.POSITION!==void 0){const r=n.json.accessors[s.POSITION];const a=r.min;const o=r.max;if(a!==void 0&&o!==void 0){t.setX(Math.max(Math.abs(a[0]),Math.abs(o[0])));t.setY(Math.max(Math.abs(a[1]),Math.abs(o[1])));t.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2])));if(r.normalized){const e=getNormalizedComponentScale(d[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(e)}e.boundingBox=a;const l=new r.Sphere;a.getCenter(l.center);l.radius=a.min.distanceTo(a.max)/2;e.boundingSphere=l}
/**
         * @param {BufferGeometry} geometry
         * @param {GLTF.Primitive} primitiveDef
         * @param {GLTFParser} parser
         * @return {Promise<BufferGeometry>}
         */function addPrimitiveAttributes(e,t,n){const s=t.attributes;const a=[];function assignAttributeAccessor(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const t in s){const n=g[t]||t.toLowerCase();n in e.attributes||a.push(assignAttributeAccessor(s[t],n))}if(t.indices!==void 0&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));a.push(r)}r.ColorManagement.workingColorSpace!==r.LinearSRGBColorSpace&&"COLOR_0"in s&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${r.ColorManagement.workingColorSpace}" not supported.`);assignExtrasToUserData(e,t);computeBounds(e,t,n);return Promise.all(a).then((function(){return t.targets!==void 0?addMorphTargets(e,t.targets,n):e}))}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(e,t,n)=>{n.r(t);n.d(t,{KTX2Loader:()=>KTX2Loader});var r=n("./node_modules/three/build/three.core.js");var s=n("./node_modules/three/examples/jsm/utils/WorkerPool.js");var a=n("./node_modules/three/examples/jsm/libs/ktx-parse.module.js");var o=n("./node_modules/three/examples/jsm/libs/zstddec.module.js");var l=n("./node_modules/three/examples/jsm/math/ColorSpaces.js");const c=new WeakMap;let u=0;let h;class KTX2Loader extends r.Loader{constructor(e){super(e);this.transcoderPath="";this.transcoderBinary=null;this.transcoderPending=null;this.workerPool=new s.WorkerPool;this.workerSourceURL="";this.workerConfig=null;typeof MSC_TRANSCODER!=="undefined"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){this.transcoderPath=e;return this}setWorkerLimit(e){this.workerPool.setWorkerLimit(e);return this}async detectSupportAsync(e){this.workerConfig={astcSupported:await e.hasFeatureAsync("texture-compression-astc"),astcHDRSupported:false,etc1Supported:await e.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await e.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await e.hasFeatureAsync("texture-compression-bc"),bptcSupported:await e.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await e.hasFeatureAsync("texture-compression-pvrtc")};return this}detectSupport(e){e.isWebGPURenderer===true?this.workerConfig={astcSupported:e.hasFeature("texture-compression-astc"),astcHDRSupported:false,etc1Supported:e.hasFeature("texture-compression-etc1"),etc2Supported:e.hasFeature("texture-compression-etc2"),dxtSupported:e.hasFeature("texture-compression-bc"),bptcSupported:e.hasFeature("texture-compression-bptc"),pvrtcSupported:e.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),astcHDRSupported:e.extensions.has("WEBGL_compressed_texture_astc")&&e.extensions.get("WEBGL_compressed_texture_astc").getSupportedProfiles().includes("hdr"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")};return this}init(){if(!this.transcoderPending){const e=new r.FileLoader(this.manager);e.setPath(this.transcoderPath);e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js");const n=new r.FileLoader(this.manager);n.setPath(this.transcoderPath);n.setResponseType("arraybuffer");n.setWithCredentials(this.withCredentials);const s=n.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,s]).then((([e,t])=>{const n=KTX2Loader.BasisWorker.toString();const r=["/* constants */","let _EngineFormat = "+JSON.stringify(KTX2Loader.EngineFormat),"let _EngineType = "+JSON.stringify(KTX2Loader.EngineType),"let _TranscoderFormat = "+JSON.stringify(KTX2Loader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(KTX2Loader.BasisFormat),"/* basis_transcoder.js */",e,"/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]));this.transcoderBinary=t;this.workerPool.setWorkerCreator((()=>{const e=new Worker(this.workerSourceURL);const t=this.transcoderBinary.slice(0);e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:t},[t]);return e}))}));u>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances.");u++}return this.transcoderPending}load(e,t,n,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const a=new r.FileLoader(this.manager);a.setResponseType("arraybuffer");a.setWithCredentials(this.withCredentials);a.load(e,(e=>{this.parse(e,t,s)}),n,s)}parse(e,t,n){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(c.has(e)){const r=c.get(e);return r.promise.then(t).catch(n)}this._createTexture(e).then((e=>t?t(e):null)).catch(n)}_createTextureFrom(e,t){const{type:n,error:s,data:{faces:o,width:l,height:c,format:u,type:h,dfdFlags:d}}=e;if(n==="error")return Promise.reject(s);let p;if(t.faceCount===6)p=new r.CompressedCubeTexture(o,u,h);else{const e=o[0].mipmaps;p=t.layerCount>1?new r.CompressedArrayTexture(e,l,c,t.layerCount,u,h):new r.CompressedTexture(e,l,c,u,h)}p.minFilter=o[0].mipmaps.length===1?r.LinearFilter:r.LinearMipmapLinearFilter;p.magFilter=r.LinearFilter;p.generateMipmaps=false;p.needsUpdate=true;p.colorSpace=parseColorSpace(t);p.premultiplyAlpha=!!(d&a.KHR_DF_FLAG_ALPHA_PREMULTIPLIED);return p}
/**
           * @param {ArrayBuffer} buffer
           * @param {object?} config
           * @return {Promise<CompressedTexture|CompressedArrayTexture|DataTexture|Data3DTexture>}
           */async _createTexture(e,t={}){const n=(0,a.read)(new Uint8Array(e));const r=n.vkFormat===a.VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT&&n.dataFormatDescriptor[0].colorModel===167;const s=n.vkFormat===a.VK_FORMAT_UNDEFINED||r&&!this.workerConfig.astcHDRSupported;if(!s)return createRawTexture(n);const o=t;const l=this.init().then((()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:o},[e]))).then((e=>this._createTextureFrom(e.data,n)));c.set(e,{promise:l});return l}dispose(){this.workerPool.dispose();this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL);u--;return this}}KTX2Loader.BasisFormat={ETC1S:0,UASTC:1,UASTC_HDR:2};KTX2Loader.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16,BC6H:22,RGB_HALF:24,RGBA_HALF:25};KTX2Loader.EngineFormat={RGBAFormat:r.RGBAFormat,RGBA_ASTC_4x4_Format:r.RGBA_ASTC_4x4_Format,RGB_BPTC_UNSIGNED_Format:r.RGB_BPTC_UNSIGNED_Format,RGBA_BPTC_Format:r.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:r.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:r.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:r.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:r.RGB_ETC1_Format,RGB_ETC2_Format:r.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:r.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:r.RGBA_S3TC_DXT1_Format};KTX2Loader.EngineType={UnsignedByteType:r.UnsignedByteType,HalfFloatType:r.HalfFloatType,FloatType:r.FloatType};KTX2Loader.BasisWorker=function(){let e;let t;let n;const r=_EngineFormat;const s=_EngineType;const a=_TranscoderFormat;const o=_BasisFormat;self.addEventListener("message",(function(n){const r=n.data;switch(r.type){case"init":e=r.config;init(r.transcoderBinary);break;case"transcode":t.then((()=>{try{const{faces:e,buffers:t,width:n,height:s,hasAlpha:a,format:o,type:l,dfdFlags:c}=transcode(r.buffer);self.postMessage({type:"transcode",id:r.id,data:{faces:e,width:n,height:s,hasAlpha:a,format:o,type:l,dfdFlags:c}},t)}catch(e){console.error(e);self.postMessage({type:"error",id:r.id,error:e.message})}}));break}}));function init(e){t=new Promise((t=>{n={wasmBinary:e,onRuntimeInitialized:t};BASIS(n)})).then((()=>{n.initializeBasis();n.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")}))}function transcode(e){const t=new n.KTX2File(new Uint8Array(e));function cleanup(){t.close();t.delete()}if(!t.isValid()){cleanup();throw new Error("THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file")}let r;if(t.isUASTC())r=o.UASTC;else if(t.isETC1S())r=o.ETC1S;else{if(!t.isHDR())throw new Error("THREE.KTX2Loader: Unknown Basis encoding");r=o.UASTC_HDR}const a=t.getWidth();const l=t.getHeight();const c=t.getLayers()||1;const u=t.getLevels();const h=t.getFaces();const d=t.getHasAlpha();const p=t.getDFDFlags();const{transcoderFormat:f,engineFormat:m,engineType:g}=getTranscoderFormat(r,a,l,d);if(!a||!l||!u){cleanup();throw new Error("THREE.KTX2Loader:\tInvalid texture")}if(!t.startTranscoding()){cleanup();throw new Error("THREE.KTX2Loader: .startTranscoding failed")}const y=[];const b=[];for(let e=0;e<h;e++){const n=[];for(let r=0;r<u;r++){const a=[];let o,l;for(let n=0;n<c;n++){const c=t.getImageLevelInfo(r,n,e);e!==0||r!==0||n!==0||c.origWidth%4===0&&c.origHeight%4===0||console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions.");if(u>1){o=c.origWidth;l=c.origHeight}else{o=c.width;l=c.height}let h=new Uint8Array(t.getImageTranscodedSizeInBytes(r,n,0,f));const d=t.transcodeImage(h,r,n,e,f,0,-1,-1);g===s.HalfFloatType&&(h=new Uint16Array(h.buffer,h.byteOffset,h.byteLength/Uint16Array.BYTES_PER_ELEMENT));if(!d){cleanup();throw new Error("THREE.KTX2Loader: .transcodeImage failed.")}a.push(h)}const h=concat(a);n.push({data:h,width:o,height:l});b.push(h.buffer)}y.push({mipmaps:n,width:a,height:l,format:m,type:g})}cleanup();return{faces:y,buffers:b,width:a,height:l,hasAlpha:d,dfdFlags:p,format:m,type:g}}const l=[{if:"astcSupported",basisFormat:[o.UASTC],transcoderFormat:[a.ASTC_4x4,a.ASTC_4x4],engineFormat:[r.RGBA_ASTC_4x4_Format,r.RGBA_ASTC_4x4_Format],engineType:[s.UnsignedByteType],priorityETC1S:Infinity,priorityUASTC:1,needsPowerOfTwo:false},{if:"bptcSupported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[a.BC7_M5,a.BC7_M5],engineFormat:[r.RGBA_BPTC_Format,r.RGBA_BPTC_Format],engineType:[s.UnsignedByteType],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:false},{if:"dxtSupported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[a.BC1,a.BC3],engineFormat:[r.RGBA_S3TC_DXT1_Format,r.RGBA_S3TC_DXT5_Format],engineType:[s.UnsignedByteType],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:false},{if:"etc2Supported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[a.ETC1,a.ETC2],engineFormat:[r.RGB_ETC2_Format,r.RGBA_ETC2_EAC_Format],engineType:[s.UnsignedByteType],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:false},{if:"etc1Supported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[a.ETC1],engineFormat:[r.RGB_ETC1_Format],engineType:[s.UnsignedByteType],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:false},{if:"pvrtcSupported",basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[a.PVRTC1_4_RGB,a.PVRTC1_4_RGBA],engineFormat:[r.RGB_PVRTC_4BPPV1_Format,r.RGBA_PVRTC_4BPPV1_Format],engineType:[s.UnsignedByteType],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:true},{if:"bptcSupported",basisFormat:[o.UASTC_HDR],transcoderFormat:[a.BC6H],engineFormat:[r.RGB_BPTC_UNSIGNED_Format],engineType:[s.HalfFloatType],priorityHDR:1,needsPowerOfTwo:false},{basisFormat:[o.ETC1S,o.UASTC],transcoderFormat:[a.RGBA32,a.RGBA32],engineFormat:[r.RGBAFormat,r.RGBAFormat],engineType:[s.UnsignedByteType,s.UnsignedByteType],priorityETC1S:100,priorityUASTC:100,needsPowerOfTwo:false},{basisFormat:[o.UASTC_HDR],transcoderFormat:[a.RGBA_HALF],engineFormat:[r.RGBAFormat],engineType:[s.HalfFloatType],priorityHDR:100,needsPowerOfTwo:false}];const c={[o.ETC1S]:l.filter((e=>e.basisFormat.includes(o.ETC1S))).sort(((e,t)=>e.priorityUASTC-t.priorityUASTC)),[o.UASTC]:l.filter((e=>e.basisFormat.includes(o.UASTC))).sort(((e,t)=>e.priorityUASTC-t.priorityUASTC)),[o.UASTC_HDR]:l.filter((e=>e.basisFormat.includes(o.UASTC_HDR))).sort(((e,t)=>e.priorityHDR-t.priorityHDR))};function getTranscoderFormat(t,n,r,s){const a=c[t];for(let o=0;o<a.length;o++){const l=a[o];if(l.if&&!e[l.if])continue;if(!l.basisFormat.includes(t))continue;if(s&&l.transcoderFormat.length<2)continue;if(l.needsPowerOfTwo&&!(isPowerOfTwo(n)&&isPowerOfTwo(r)))continue;const c=l.transcoderFormat[s?1:0];const u=l.engineFormat[s?1:0];const h=l.engineType[0];return{transcoderFormat:c,engineFormat:u,engineType:h}}throw new Error("THREE.KTX2Loader: Failed to identify transcoding target.")}function isPowerOfTwo(e){return e<=2||(e&e-1)===0&&e!==0}
/**
           * Concatenates N byte arrays.
           *
           * @param {Uint8Array[]} arrays
           * @return {Uint8Array}
           */function concat(e){if(e.length===1)return e[0];let t=0;for(let n=0;n<e.length;n++){const r=e[n];t+=r.byteLength}const n=new Uint8Array(t);let r=0;for(let t=0;t<e.length;t++){const s=e[t];n.set(s,r);r+=s.byteLength}return n}};const d=new Set([r.RGBAFormat,r.RGFormat,r.RedFormat]);const p={[a.VK_FORMAT_R32G32B32A32_SFLOAT]:r.RGBAFormat,[a.VK_FORMAT_R16G16B16A16_SFLOAT]:r.RGBAFormat,[a.VK_FORMAT_R8G8B8A8_UNORM]:r.RGBAFormat,[a.VK_FORMAT_R8G8B8A8_SRGB]:r.RGBAFormat,[a.VK_FORMAT_R32G32_SFLOAT]:r.RGFormat,[a.VK_FORMAT_R16G16_SFLOAT]:r.RGFormat,[a.VK_FORMAT_R8G8_UNORM]:r.RGFormat,[a.VK_FORMAT_R8G8_SRGB]:r.RGFormat,[a.VK_FORMAT_R32_SFLOAT]:r.RedFormat,[a.VK_FORMAT_R16_SFLOAT]:r.RedFormat,[a.VK_FORMAT_R8_SRGB]:r.RedFormat,[a.VK_FORMAT_R8_UNORM]:r.RedFormat,[a.VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT]:r.RGBA_ASTC_4x4_Format,[a.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:r.RGBA_ASTC_6x6_Format,[a.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:r.RGBA_ASTC_6x6_Format};const f={[a.VK_FORMAT_R32G32B32A32_SFLOAT]:r.FloatType,[a.VK_FORMAT_R16G16B16A16_SFLOAT]:r.HalfFloatType,[a.VK_FORMAT_R8G8B8A8_UNORM]:r.UnsignedByteType,[a.VK_FORMAT_R8G8B8A8_SRGB]:r.UnsignedByteType,[a.VK_FORMAT_R32G32_SFLOAT]:r.FloatType,[a.VK_FORMAT_R16G16_SFLOAT]:r.HalfFloatType,[a.VK_FORMAT_R8G8_UNORM]:r.UnsignedByteType,[a.VK_FORMAT_R8G8_SRGB]:r.UnsignedByteType,[a.VK_FORMAT_R32_SFLOAT]:r.FloatType,[a.VK_FORMAT_R16_SFLOAT]:r.HalfFloatType,[a.VK_FORMAT_R8_SRGB]:r.UnsignedByteType,[a.VK_FORMAT_R8_UNORM]:r.UnsignedByteType,[a.VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT]:r.HalfFloatType,[a.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:r.UnsignedByteType,[a.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:r.UnsignedByteType};async function createRawTexture(e){const{vkFormat:t}=e;if(p[t]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let n;if(e.supercompressionScheme===a.KHR_SUPERCOMPRESSION_ZSTD){h||(h=new Promise((async e=>{const t=new o.ZSTDDecoder;await t.init();e(t)})));n=await h}const s=[];for(let o=0;o<e.levels.length;o++){const l=Math.max(1,e.pixelWidth>>o);const c=Math.max(1,e.pixelHeight>>o);const u=e.pixelDepth?Math.max(1,e.pixelDepth>>o):0;const h=e.levels[o];let d;if(e.supercompressionScheme===a.KHR_SUPERCOMPRESSION_NONE)d=h.levelData;else{if(e.supercompressionScheme!==a.KHR_SUPERCOMPRESSION_ZSTD)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");d=n.decode(h.levelData,h.uncompressedByteLength)}let p;p=f[t]===r.FloatType?new Float32Array(d.buffer,d.byteOffset,d.byteLength/Float32Array.BYTES_PER_ELEMENT):f[t]===r.HalfFloatType?new Uint16Array(d.buffer,d.byteOffset,d.byteLength/Uint16Array.BYTES_PER_ELEMENT):d;s.push({data:p,width:l,height:c,depth:u})}let l;if(d.has(p[t]))l=e.pixelDepth===0?new r.DataTexture(s[0].data,e.pixelWidth,e.pixelHeight):new r.Data3DTexture(s[0].data,e.pixelWidth,e.pixelHeight,e.pixelDepth);else{if(e.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");l=new r.CompressedTexture(s,e.pixelWidth,e.pixelHeight);l.minFilter=s.length===1?r.LinearFilter:r.LinearMipmapLinearFilter;l.magFilter=r.LinearFilter}l.mipmaps=s;l.type=f[t];l.format=p[t];l.colorSpace=parseColorSpace(e);l.needsUpdate=true;return Promise.resolve(l)}function parseColorSpace(e){const t=e.dataFormatDescriptor[0];if(t.colorPrimaries===a.KHR_DF_PRIMARIES_BT709)return t.transferFunction===a.KHR_DF_TRANSFER_SRGB?r.SRGBColorSpace:r.LinearSRGBColorSpace;if(t.colorPrimaries===a.KHR_DF_PRIMARIES_DISPLAYP3)return t.transferFunction===a.KHR_DF_TRANSFER_SRGB?l.DisplayP3ColorSpace:l.LinearDisplayP3ColorSpace;if(t.colorPrimaries===a.KHR_DF_PRIMARIES_UNSPECIFIED)return r.NoColorSpace;console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${t.colorPrimaries}"`);return r.NoColorSpace}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(e,t,n)=>{n.r(t);n.d(t,{MTLLoader:()=>MTLLoader});var r=n("./node_modules/three/build/three.core.js");class MTLLoader extends r.Loader{constructor(e){super(e)}
/**
           * Loads and parses a MTL asset from a URL.
           *
           * @param {String} url - URL to the MTL file.
           * @param {Function} [onLoad] - Callback invoked with the loaded object.
           * @param {Function} [onProgress] - Callback for download progress.
           * @param {Function} [onError] - Callback for download errors.
           *
           * @see setPath setResourcePath
           *
           * @note In order for relative texture references to resolve correctly
           * you must call setResourcePath() explicitly prior to load.
           */load(e,t,n,s){const a=this;const o=this.path===""?r.LoaderUtils.extractUrlBase(e):this.path;const l=new r.FileLoader(this.manager);l.setPath(this.path);l.setRequestHeader(this.requestHeader);l.setWithCredentials(this.withCredentials);l.load(e,(function(n){try{t(a.parse(n,o))}catch(t){s?s(t):console.error(t);a.manager.itemError(e)}}),n,s)}setMaterialOptions(e){this.materialOptions=e;return this}
/**
           * Parses a MTL file.
           *
           * @param {String} text - Content of MTL file
           * @param {String} path
           * @return {MaterialCreator}
           *
           * @see setPath setResourcePath
           *
           * @note In order for relative texture references to resolve correctly
           * you must call setResourcePath() explicitly prior to parse.
           */parse(e,t){const n=e.split("\n");let r={};const s=/\s+/;const a={};for(let e=0;e<n.length;e++){let t=n[e];t=t.trim();if(t.length===0||t.charAt(0)==="#")continue;const o=t.indexOf(" ");let l=o>=0?t.substring(0,o):t;l=l.toLowerCase();let c=o>=0?t.substring(o+1):"";c=c.trim();if(l==="newmtl"){r={name:c};a[c]=r}else if(l==="ka"||l==="kd"||l==="ks"||l==="ke"){const e=c.split(s,3);r[l]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]}else r[l]=c}const o=new MaterialCreator(this.resourcePath||t,this.materialOptions);o.setCrossOrigin(this.crossOrigin);o.setManager(this.manager);o.setMaterials(a);return o}}
/**
         * Create a new MTLLoader.MaterialCreator
         * @param baseUrl - Url relative to which textures are loaded
         * @param options - Set of options on how to construct the materials
         *                  side: Which side to apply the material
         *                        FrontSide (default), THREE.BackSide, THREE.DoubleSide
         *                  wrap: What type of wrapping to apply for textures
         *                        RepeatWrapping (default), THREE.ClampToEdgeWrapping, THREE.MirroredRepeatWrapping
         *                  normalizeRGB: RGBs need to be normalized to 0-1 from 0-255
         *                                Default: false, assumed to be already normalized
         *                  ignoreZeroRGBs: Ignore values of RGBs (Ka,Kd,Ks) that are all 0's
         *                                  Default: false
         * @constructor
         */class MaterialCreator{constructor(e="",t={}){this.baseUrl=e;this.options=t;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.crossOrigin="anonymous";this.side=this.options.side!==void 0?this.options.side:r.FrontSide;this.wrap=this.options.wrap!==void 0?this.options.wrap:r.RepeatWrapping}setCrossOrigin(e){this.crossOrigin=e;return this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e);this.materials={};this.materialsArray=[];this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const n in e){const r=e[n];const s={};t[n]=s;for(const e in r){let t=true;let n=r[e];const a=e.toLowerCase();switch(a){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]);this.options&&this.options.ignoreZeroRGBs&&n[0]===0&&n[1]===0&&n[2]===0&&(t=false);break;default:break}t&&(s[a]=n)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo){this.materialsArray[e]=this.create(t);this.nameLookup[t]=e;e++}return this.materialsArray}create(e){this.materials[e]===void 0&&this.createMaterial_(e);return this.materials[e]}createMaterial_(e){const t=this;const n=this.materialsInfo[e];const s={name:e,side:this.side};function resolveURL(e,t){return typeof t!=="string"||t===""?"":/^https?:\/\//i.test(t)?t:e+t}function setMapForType(e,n){if(s[e])return;const a=t.getTextureParams(n,s);const o=t.loadTexture(resolveURL(t.baseUrl,a.url));o.repeat.copy(a.scale);o.offset.copy(a.offset);o.wrapS=t.wrap;o.wrapT=t.wrap;e!=="map"&&e!=="emissiveMap"||(o.colorSpace=r.SRGBColorSpace);s[e]=o}for(const e in n){const t=n[e];let a;if(t!=="")switch(e.toLowerCase()){case"kd":s.color=r.ColorManagement.toWorkingColorSpace((new r.Color).fromArray(t),r.SRGBColorSpace);break;case"ks":s.specular=r.ColorManagement.toWorkingColorSpace((new r.Color).fromArray(t),r.SRGBColorSpace);break;case"ke":s.emissive=r.ColorManagement.toWorkingColorSpace((new r.Color).fromArray(t),r.SRGBColorSpace);break;case"map_kd":setMapForType("map",t);break;case"map_ks":setMapForType("specularMap",t);break;case"map_ke":setMapForType("emissiveMap",t);break;case"norm":setMapForType("normalMap",t);break;case"map_bump":case"bump":setMapForType("bumpMap",t);break;case"map_d":setMapForType("alphaMap",t);s.transparent=true;break;case"ns":s.shininess=parseFloat(t);break;case"d":a=parseFloat(t);if(a<1){s.opacity=a;s.transparent=true}break;case"tr":a=parseFloat(t);this.options&&this.options.invertTrProperty&&(a=1-a);if(a>0){s.opacity=1-a;s.transparent=true}break;default:break}}this.materials[e]=new r.MeshPhongMaterial(s);return this.materials[e]}getTextureParams(e,t){const n={scale:new r.Vector2(1,1),offset:new r.Vector2(0,0)};const s=e.split(/\s+/);let a;a=s.indexOf("-bm");if(a>=0){t.bumpScale=parseFloat(s[a+1]);s.splice(a,2)}a=s.indexOf("-s");if(a>=0){n.scale.set(parseFloat(s[a+1]),parseFloat(s[a+2]));s.splice(a,4)}a=s.indexOf("-o");if(a>=0){n.offset.set(parseFloat(s[a+1]),parseFloat(s[a+2]));s.splice(a,4)}n.url=s.join(" ").trim();return n}loadTexture(e,t,n,s,a){const o=this.manager!==void 0?this.manager:r.DefaultLoadingManager;let l=o.getHandler(e);l===null&&(l=new r.TextureLoader(o));l.setCrossOrigin&&l.setCrossOrigin(this.crossOrigin);const c=l.load(e,n,s,a);t!==void 0&&(c.mapping=t);return c}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(e,n,r)=>{r.r(n);r.d(n,{OBJLoader:()=>OBJLoader});var s=r("./node_modules/three/build/three.core.js");const a=/^[og]\s*(.+)?/;const o=/^mtllib /;const l=/^usemtl /;const c=/^usemap /;const u=/\s+/;const h=new s.Vector3;const d=new s.Vector3;const p=new s.Vector3;const f=new s.Vector3;const m=new s.Vector3;const g=new s.Color;function ParserState(){const e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,n){if((this||t).object&&(this||t).object.fromDeclaration===false){(this||t).object.name=e;(this||t).object.fromDeclaration=n!==false;return}const r=(this||t).object&&typeof(this||t).object.currentMaterial==="function"?(this||t).object.currentMaterial():void 0;(this||t).object&&typeof(this||t).object._finalize==="function"&&(this||t).object._finalize(true);(this||t).object={name:e||"",fromDeclaration:n!==false,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:false},materials:[],smooth:true,startMaterial:function(e,n){const r=this._finalize(false);r&&(r.inherited||r.groupCount<=0)&&(this||t).materials.splice(r.index,1);const s={index:(this||t).materials.length,name:e||"",mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:(this||t).smooth,groupStart:r!==void 0?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:false,clone:function(e){const n={index:typeof e==="number"?e:(this||t).index,name:(this||t).name,mtllib:(this||t).mtllib,smooth:(this||t).smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:false};n.clone=(this||t).clone.bind(n);return n}};(this||t).materials.push(s);return s},currentMaterial:function(){if((this||t).materials.length>0)return(this||t).materials[(this||t).materials.length-1]},_finalize:function(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1){n.groupEnd=(this||t).geometry.vertices.length/3;n.groupCount=n.groupEnd-n.groupStart;n.inherited=false}if(e&&(this||t).materials.length>1)for(let e=(this||t).materials.length-1;e>=0;e--)(this||t).materials[e].groupCount<=0&&(this||t).materials.splice(e,1);e&&(this||t).materials.length===0&&(this||t).materials.push({name:"",smooth:(this||t).smooth});return n}};if(r&&r.name&&typeof r.clone==="function"){const e=r.clone(0);e.inherited=true;(this||t).object.materials.push(e)}(this||t).objects.push((this||t).object)},finalize:function(){(this||t).object&&typeof(this||t).object._finalize==="function"&&(this||t).object._finalize(true)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return(n>=0?n-1:n+t/3)*3},parseNormalIndex:function(e,t){const n=parseInt(e,10);return(n>=0?n-1:n+t/3)*3},parseUVIndex:function(e,t){const n=parseInt(e,10);return(n>=0?n-1:n+t/2)*2},addVertex:function(e,n,r){const s=(this||t).vertices;const a=(this||t).object.geometry.vertices;a.push(s[e+0],s[e+1],s[e+2]);a.push(s[n+0],s[n+1],s[n+2]);a.push(s[r+0],s[r+1],s[r+2])},addVertexPoint:function(e){const n=(this||t).vertices;const r=(this||t).object.geometry.vertices;r.push(n[e+0],n[e+1],n[e+2])},addVertexLine:function(e){const n=(this||t).vertices;const r=(this||t).object.geometry.vertices;r.push(n[e+0],n[e+1],n[e+2])},addNormal:function(e,n,r){const s=(this||t).normals;const a=(this||t).object.geometry.normals;a.push(s[e+0],s[e+1],s[e+2]);a.push(s[n+0],s[n+1],s[n+2]);a.push(s[r+0],s[r+1],s[r+2])},addFaceNormal:function(e,n,r){const s=(this||t).vertices;const a=(this||t).object.geometry.normals;h.fromArray(s,e);d.fromArray(s,n);p.fromArray(s,r);m.subVectors(p,d);f.subVectors(h,d);m.cross(f);m.normalize();a.push(m.x,m.y,m.z);a.push(m.x,m.y,m.z);a.push(m.x,m.y,m.z)},addColor:function(e,n,r){const s=(this||t).colors;const a=(this||t).object.geometry.colors;s[e]!==void 0&&a.push(s[e+0],s[e+1],s[e+2]);s[n]!==void 0&&a.push(s[n+0],s[n+1],s[n+2]);s[r]!==void 0&&a.push(s[r+0],s[r+1],s[r+2])},addUV:function(e,n,r){const s=(this||t).uvs;const a=(this||t).object.geometry.uvs;a.push(s[e+0],s[e+1]);a.push(s[n+0],s[n+1]);a.push(s[r+0],s[r+1])},addDefaultUV:function(){const e=(this||t).object.geometry.uvs;e.push(0,0);e.push(0,0);e.push(0,0)},addUVLine:function(e){const n=(this||t).uvs;const r=(this||t).object.geometry.uvs;r.push(n[e+0],n[e+1])},addFace:function(e,n,r,s,a,o,l,c,u){const h=(this||t).vertices.length;let d=this.parseVertexIndex(e,h);let p=this.parseVertexIndex(n,h);let f=this.parseVertexIndex(r,h);this.addVertex(d,p,f);this.addColor(d,p,f);if(l!==void 0&&l!==""){const e=(this||t).normals.length;d=this.parseNormalIndex(l,e);p=this.parseNormalIndex(c,e);f=this.parseNormalIndex(u,e);this.addNormal(d,p,f)}else this.addFaceNormal(d,p,f);if(s!==void 0&&s!==""){const e=(this||t).uvs.length;d=this.parseUVIndex(s,e);p=this.parseUVIndex(a,e);f=this.parseUVIndex(o,e);this.addUV(d,p,f);(this||t).object.geometry.hasUVIndices=true}else this.addDefaultUV()},addPointGeometry:function(e){(this||t).object.geometry.type="Points";const n=(this||t).vertices.length;for(let t=0,r=e.length;t<r;t++){const r=this.parseVertexIndex(e[t],n);this.addVertexPoint(r);this.addColor(r)}},addLineGeometry:function(e,n){(this||t).object.geometry.type="Line";const r=(this||t).vertices.length;const s=(this||t).uvs.length;for(let t=0,n=e.length;t<n;t++)this.addVertexLine(this.parseVertexIndex(e[t],r));for(let e=0,t=n.length;e<t;e++)this.addUVLine(this.parseUVIndex(n[e],s))}};e.startObject("",false);return e}class OBJLoader extends s.Loader{constructor(e){super(e);this.materials=null}load(e,t,n,r){const a=this;const o=new s.FileLoader(this.manager);o.setPath(this.path);o.setRequestHeader(this.requestHeader);o.setWithCredentials(this.withCredentials);o.load(e,(function(n){try{t(a.parse(n))}catch(t){r?r(t):console.error(t);a.manager.itemError(e)}}),n,r)}setMaterials(e){this.materials=e;return this}parse(e){const t=new ParserState;e.indexOf("\r\n")!==-1&&(e=e.replace(/\r\n/g,"\n"));e.indexOf("\\\n")!==-1&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let r=[];for(let e=0,h=n.length;e<h;e++){const h=n[e].trimStart();if(h.length===0)continue;const d=h.charAt(0);if(d!=="#")if(d==="v"){const e=h.split(u);switch(e[0]){case"v":t.vertices.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]));if(e.length>=7){g.setRGB(parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6]),s.SRGBColorSpace);t.colors.push(g.r,g.g,g.b)}else t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]));break;case"vt":t.uvs.push(parseFloat(e[1]),parseFloat(e[2]));break}}else if(d==="f"){const e=h.slice(1).trim();const n=e.split(u);const r=[];for(let e=0,t=n.length;e<t;e++){const t=n[e];if(t.length>0){const e=t.split("/");r.push(e)}}const s=r[0];for(let e=1,n=r.length-1;e<n;e++){const n=r[e];const a=r[e+1];t.addFace(s[0],n[0],a[0],s[1],n[1],a[1],s[2],n[2],a[2])}}else if(d==="l"){const e=h.substring(1).trim().split(" ");let n=[];const r=[];if(h.indexOf("/")===-1)n=e;else for(let t=0,s=e.length;t<s;t++){const s=e[t].split("/");s[0]!==""&&n.push(s[0]);s[1]!==""&&r.push(s[1])}t.addLineGeometry(n,r)}else if(d==="p"){const e=h.slice(1).trim();const n=e.split(" ");t.addPointGeometry(n)}else if((r=a.exec(h))!==null){const e=(" "+r[0].slice(1).trim()).slice(1);t.startObject(e)}else if(l.test(h))t.object.startMaterial(h.substring(7).trim(),t.materialLibraries);else if(o.test(h))t.materialLibraries.push(h.substring(7).trim());else if(c.test(h))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(d==="s"){r=h.split(" ");if(r.length>1){const e=r[1].trim().toLowerCase();t.object.smooth=e!=="0"&&e!=="off"}else t.object.smooth=true;const e=t.object.currentMaterial();e&&(e.smooth=t.object.smooth)}else{if(h==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+h+'"')}}t.finalize();const h=new s.Group;h.materialLibraries=[].concat(t.materialLibraries);const d=!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0);if(d===true)for(let e=0,n=t.objects.length;e<n;e++){const n=t.objects[e];const r=n.geometry;const a=n.materials;const o=r.type==="Line";const l=r.type==="Points";let c=false;if(r.vertices.length===0)continue;const u=new s.BufferGeometry;u.setAttribute("position",new s.Float32BufferAttribute(r.vertices,3));r.normals.length>0&&u.setAttribute("normal",new s.Float32BufferAttribute(r.normals,3));if(r.colors.length>0){c=true;u.setAttribute("color",new s.Float32BufferAttribute(r.colors,3))}r.hasUVIndices===true&&u.setAttribute("uv",new s.Float32BufferAttribute(r.uvs,2));const d=[];for(let e=0,n=a.length;e<n;e++){const n=a[e];const r=n.name+"_"+n.smooth+"_"+c;let u=t.materials[r];if(this.materials!==null){u=this.materials.create(n.name);if(!o||!u||u instanceof s.LineBasicMaterial){if(l&&u&&!(u instanceof s.PointsMaterial)){const e=new s.PointsMaterial({size:10,sizeAttenuation:false});s.Material.prototype.copy.call(e,u);e.color.copy(u.color);e.map=u.map;u=e}}else{const e=new s.LineBasicMaterial;s.Material.prototype.copy.call(e,u);e.color.copy(u.color);u=e}}if(u===void 0){u=o?new s.LineBasicMaterial:l?new s.PointsMaterial({size:1,sizeAttenuation:false}):new s.MeshPhongMaterial;u.name=n.name;u.flatShading=!n.smooth;u.vertexColors=c;t.materials[r]=u}d.push(u)}let p;if(d.length>1){for(let e=0,t=a.length;e<t;e++){const t=a[e];u.addGroup(t.groupStart,t.groupCount,e)}p=o?new s.LineSegments(u,d):l?new s.Points(u,d):new s.Mesh(u,d)}else p=o?new s.LineSegments(u,d[0]):l?new s.Points(u,d[0]):new s.Mesh(u,d[0]);p.name=n.name;h.add(p)}else if(t.vertices.length>0){const e=new s.PointsMaterial({size:1,sizeAttenuation:false});const n=new s.BufferGeometry;n.setAttribute("position",new s.Float32BufferAttribute(t.vertices,3));if(t.colors.length>0&&t.colors[0]!==void 0){n.setAttribute("color",new s.Float32BufferAttribute(t.colors,3));e.vertexColors=true}const r=new s.Points(n,e);h.add(r)}return h}}},"./node_modules/three/examples/jsm/math/ColorSpaces.js":(e,t,n)=>{n.r(t);n.d(t,{DisplayP3ColorSpace:()=>d,DisplayP3ColorSpaceImpl:()=>f,LinearDisplayP3ColorSpace:()=>p,LinearDisplayP3ColorSpaceImpl:()=>m,LinearRec2020ColorSpace:()=>b,LinearRec2020ColorSpaceImpl:()=>x});var r=n("./node_modules/three/build/three.core.js");const s=[.68,.32,.265,.69,.15,.06];const a=[.2289,.6917,.0793];const o=[.708,.292,.17,.797,.131,.046];const l=[.2627,.678,.0593];const c=[.3127,.329];const u=(new r.Matrix3).set(.4865709,.2656677,.1982173,.2289746,.6917385,.0792869,0,.0451134,1.0439444);const h=(new r.Matrix3).set(2.4934969,-.9313836,-.4027108,-.829489,1.7626641,.0236247,.0358458,-.0761724,.9568845);const d="display-p3";const p="display-p3-linear";const f={primaries:s,whitePoint:c,transfer:r.SRGBTransfer,toXYZ:u,fromXYZ:h,luminanceCoefficients:a,outputColorSpaceConfig:{drawingBufferColorSpace:d}};const m={primaries:s,whitePoint:c,transfer:r.LinearTransfer,toXYZ:u,fromXYZ:h,luminanceCoefficients:a,workingColorSpaceConfig:{unpackColorSpace:d},outputColorSpaceConfig:{drawingBufferColorSpace:d}};const g=(new r.Matrix3).set(.636958,.1446169,.168881,.2627002,.6779981,.0593017,0,.0280727,1.0609851);const y=(new r.Matrix3).set(1.7166512,-.3556708,-.2533663,-.6666844,1.6164812,.0157685,.0176399,-.0427706,.9421031);const b="rec2020-linear";const x={primaries:o,whitePoint:c,transfer:r.LinearTransfer,toXYZ:g,fromXYZ:y,luminanceCoefficients:l}},"./node_modules/three/examples/jsm/math/OBB.js":(e,t,n)=>{n.r(t);n.d(t,{OBB:()=>OBB});var r=n("./node_modules/three/build/three.core.js");const s={c:null,u:[new r.Vector3,new r.Vector3,new r.Vector3],e:[]};const a={c:null,u:[new r.Vector3,new r.Vector3,new r.Vector3],e:[]};const o=[[],[],[]];const l=[[],[],[]];const c=[];const u=new r.Vector3;const h=new r.Vector3;const d=new r.Vector3;const p=new r.Vector3;const f=new r.Vector3;const m=new r.Vector3;const g=new r.Matrix3;const y=new r.Box3;const b=new r.Matrix4;const x=new r.Matrix4;const _=new r.Ray;class OBB{constructor(e=new r.Vector3,t=new r.Vector3,n=new r.Matrix3){this.center=e;this.halfSize=t;this.rotation=n}set(e,t,n){this.center=e;this.halfSize=t;this.rotation=n;return this}copy(e){this.center.copy(e.center);this.halfSize.copy(e.halfSize);this.rotation.copy(e.rotation);return this}clone(){return(new this.constructor).copy(this)}getSize(e){return e.copy(this.halfSize).multiplyScalar(2)}
/**
          * Reference: Closest Point on OBB to Point in Real-Time Collision Detection
          * by Christer Ericson (chapter 5.1.4)
          *
          * @param {Vector3} point
          * @param {Vector3} result
          * @returns {Vector3}
          */clampPoint(e,t){const n=this.halfSize;p.subVectors(e,this.center);this.rotation.extractBasis(u,h,d);t.copy(this.center);const s=r.MathUtils.clamp(p.dot(u),-n.x,n.x);t.add(u.multiplyScalar(s));const a=r.MathUtils.clamp(p.dot(h),-n.y,n.y);t.add(h.multiplyScalar(a));const o=r.MathUtils.clamp(p.dot(d),-n.z,n.z);t.add(d.multiplyScalar(o));return t}containsPoint(e){p.subVectors(e,this.center);this.rotation.extractBasis(u,h,d);return Math.abs(p.dot(u))<=this.halfSize.x&&Math.abs(p.dot(h))<=this.halfSize.y&&Math.abs(p.dot(d))<=this.halfSize.z}intersectsBox3(e){return this.intersectsOBB(M.fromBox3(e))}intersectsSphere(e){this.clampPoint(e.center,m);return m.distanceToSquared(e.center)<=e.radius*e.radius}
/**
          * Reference: OBB-OBB Intersection in Real-Time Collision Detection
          * by Christer Ericson (chapter 4.4.1)
          *
          * @param {OBB} obb
          * @param {Number} [epsilon=Number.EPSILON] - A small value to prevent arithmetic errors
          * @returns {Boolean}
          */intersectsOBB(e,t=Number.EPSILON){s.c=this.center;s.e[0]=this.halfSize.x;s.e[1]=this.halfSize.y;s.e[2]=this.halfSize.z;this.rotation.extractBasis(s.u[0],s.u[1],s.u[2]);a.c=e.center;a.e[0]=e.halfSize.x;a.e[1]=e.halfSize.y;a.e[2]=e.halfSize.z;e.rotation.extractBasis(a.u[0],a.u[1],a.u[2]);for(let e=0;e<3;e++)for(let t=0;t<3;t++)o[e][t]=s.u[e].dot(a.u[t]);p.subVectors(a.c,s.c);c[0]=p.dot(s.u[0]);c[1]=p.dot(s.u[1]);c[2]=p.dot(s.u[2]);for(let e=0;e<3;e++)for(let n=0;n<3;n++)l[e][n]=Math.abs(o[e][n])+t;let n,r;for(let e=0;e<3;e++){n=s.e[e];r=a.e[0]*l[e][0]+a.e[1]*l[e][1]+a.e[2]*l[e][2];if(Math.abs(c[e])>n+r)return false}for(let e=0;e<3;e++){n=s.e[0]*l[0][e]+s.e[1]*l[1][e]+s.e[2]*l[2][e];r=a.e[e];if(Math.abs(c[0]*o[0][e]+c[1]*o[1][e]+c[2]*o[2][e])>n+r)return false}n=s.e[1]*l[2][0]+s.e[2]*l[1][0];r=a.e[1]*l[0][2]+a.e[2]*l[0][1];if(Math.abs(c[2]*o[1][0]-c[1]*o[2][0])>n+r)return false;n=s.e[1]*l[2][1]+s.e[2]*l[1][1];r=a.e[0]*l[0][2]+a.e[2]*l[0][0];if(Math.abs(c[2]*o[1][1]-c[1]*o[2][1])>n+r)return false;n=s.e[1]*l[2][2]+s.e[2]*l[1][2];r=a.e[0]*l[0][1]+a.e[1]*l[0][0];if(Math.abs(c[2]*o[1][2]-c[1]*o[2][2])>n+r)return false;n=s.e[0]*l[2][0]+s.e[2]*l[0][0];r=a.e[1]*l[1][2]+a.e[2]*l[1][1];if(Math.abs(c[0]*o[2][0]-c[2]*o[0][0])>n+r)return false;n=s.e[0]*l[2][1]+s.e[2]*l[0][1];r=a.e[0]*l[1][2]+a.e[2]*l[1][0];if(Math.abs(c[0]*o[2][1]-c[2]*o[0][1])>n+r)return false;n=s.e[0]*l[2][2]+s.e[2]*l[0][2];r=a.e[0]*l[1][1]+a.e[1]*l[1][0];if(Math.abs(c[0]*o[2][2]-c[2]*o[0][2])>n+r)return false;n=s.e[0]*l[1][0]+s.e[1]*l[0][0];r=a.e[1]*l[2][2]+a.e[2]*l[2][1];if(Math.abs(c[1]*o[0][0]-c[0]*o[1][0])>n+r)return false;n=s.e[0]*l[1][1]+s.e[1]*l[0][1];r=a.e[0]*l[2][2]+a.e[2]*l[2][0];if(Math.abs(c[1]*o[0][1]-c[0]*o[1][1])>n+r)return false;n=s.e[0]*l[1][2]+s.e[1]*l[0][2];r=a.e[0]*l[2][1]+a.e[1]*l[2][0];return!(Math.abs(c[1]*o[0][2]-c[0]*o[1][2])>n+r)}
/**
          * Reference: Testing Box Against Plane in Real-Time Collision Detection
          * by Christer Ericson (chapter 5.2.3)
          *
          * @param {Plane} plane
          * @returns {Boolean}
          */intersectsPlane(e){this.rotation.extractBasis(u,h,d);const t=this.halfSize.x*Math.abs(e.normal.dot(u))+this.halfSize.y*Math.abs(e.normal.dot(h))+this.halfSize.z*Math.abs(e.normal.dot(d));const n=e.normal.dot(this.center)-e.constant;return Math.abs(n)<=t}
/**
          * Performs a ray/OBB intersection test and stores the intersection point
          * to the given 3D vector. If no intersection is detected, *null* is returned.
          *
          * @param {Ray} ray
          * @param {Vector3} result
          * @return {Vector3?}
          */intersectRay(e,t){this.getSize(f);y.setFromCenterAndSize(p.set(0,0,0),f);b.setFromMatrix3(this.rotation);b.setPosition(this.center);x.copy(b).invert();_.copy(e).applyMatrix4(x);return _.intersectBox(y,t)?t.applyMatrix4(b):null}
/**
          * Performs a ray/OBB intersection test. Returns either true or false if
          * there is a intersection or not.
          *
          * @param {Ray} ray
          * @returns {Boolean}
          */intersectsRay(e){return this.intersectRay(e,p)!==null}fromBox3(e){e.getCenter(this.center);e.getSize(this.halfSize).multiplyScalar(.5);this.rotation.identity();return this}equals(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)}applyMatrix4(e){const t=e.elements;let n=p.set(t[0],t[1],t[2]).length();const r=p.set(t[4],t[5],t[6]).length();const s=p.set(t[8],t[9],t[10]).length();const a=e.determinant();a<0&&(n=-n);g.setFromMatrix4(e);const o=1/n;const l=1/r;const c=1/s;g.elements[0]*=o;g.elements[1]*=o;g.elements[2]*=o;g.elements[3]*=l;g.elements[4]*=l;g.elements[5]*=l;g.elements[6]*=c;g.elements[7]*=c;g.elements[8]*=c;this.rotation.multiply(g);this.halfSize.x*=n;this.halfSize.y*=r;this.halfSize.z*=s;p.setFromMatrixPosition(e);this.center.add(p);return this}}const M=new OBB},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(e,t,n)=>{n.r(t);n.d(t,{computeMikkTSpaceTangents:()=>computeMikkTSpaceTangents,computeMorphedAttributes:()=>computeMorphedAttributes,deepCloneAttribute:()=>deepCloneAttribute,deinterleaveAttribute:()=>deinterleaveAttribute,deinterleaveGeometry:()=>deinterleaveGeometry,estimateBytesUsed:()=>estimateBytesUsed,interleaveAttributes:()=>interleaveAttributes,mergeAttributes:()=>mergeAttributes,mergeGeometries:()=>mergeGeometries,mergeGroups:()=>mergeGroups,mergeVertices:()=>mergeVertices,toCreasedNormals:()=>toCreasedNormals,toTrianglesDrawMode:()=>toTrianglesDrawMode});var r=n("./node_modules/three/build/three.core.js");function computeMikkTSpaceTangents(e,t,n=true){if(!t||!t.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!e.hasAttribute("position")||!e.hasAttribute("normal")||!e.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function getAttributeArray(e){if(e.normalized||e.isInterleavedBufferAttribute){const t=new Float32Array(e.count*e.itemSize);for(let n=0,r=0;n<e.count;n++){t[r++]=e.getX(n);t[r++]=e.getY(n);e.itemSize>2&&(t[r++]=e.getZ(n))}return t}return e.array instanceof Float32Array?e.array:new Float32Array(e.array)}const s=e.index?e.toNonIndexed():e;const a=t.generateTangents(getAttributeArray(s.attributes.position),getAttributeArray(s.attributes.normal),getAttributeArray(s.attributes.uv));if(n)for(let e=3;e<a.length;e+=4)a[e]*=-1;s.setAttribute("tangent",new r.BufferAttribute(a,4));e!==s&&e.copy(s);return e}
/**
         * @param  {Array<BufferGeometry>} geometries
         * @param  {Boolean} useGroups
         * @return {BufferGeometry}
         */function mergeGeometries(e,t=false){const n=e[0].index!==null;const s=new Set(Object.keys(e[0].attributes));const a=new Set(Object.keys(e[0].morphAttributes));const o={};const l={};const c=e[0].morphTargetsRelative;const u=new r.BufferGeometry;let h=0;for(let r=0;r<e.length;++r){const d=e[r];let p=0;if(n!==(d.index!==null)){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+r+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.");return null}for(const e in d.attributes){if(!s.has(e)){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+r+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.');return null}o[e]===void 0&&(o[e]=[]);o[e].push(d.attributes[e]);p++}if(p!==s.size){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+r+". Make sure all geometries have the same number of attributes.");return null}if(c!==d.morphTargetsRelative){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+r+". .morphTargetsRelative must be consistent throughout all geometries.");return null}for(const e in d.morphAttributes){if(!a.has(e)){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+r+".  .morphAttributes must be consistent throughout all geometries.");return null}l[e]===void 0&&(l[e]=[]);l[e].push(d.morphAttributes[e])}if(t){let e;if(n)e=d.index.count;else{if(d.attributes.position===void 0){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+r+". The geometry must have either an index or a position attribute");return null}e=d.attributes.position.count}u.addGroup(h,e,r);h+=e}}if(n){let t=0;const n=[];for(let r=0;r<e.length;++r){const s=e[r].index;for(let e=0;e<s.count;++e)n.push(s.getX(e)+t);t+=e[r].attributes.position.count}u.setIndex(n)}for(const e in o){const t=mergeAttributes(o[e]);if(!t){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+e+" attribute.");return null}u.setAttribute(e,t)}for(const e in l){const t=l[e][0].length;if(t===0)break;u.morphAttributes=u.morphAttributes||{};u.morphAttributes[e]=[];for(let n=0;n<t;++n){const t=[];for(let r=0;r<l[e].length;++r)t.push(l[e][r][n]);const r=mergeAttributes(t);if(!r){console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+e+" morphAttribute.");return null}u.morphAttributes[e].push(r)}}return u}
/**
         * @param {Array<BufferAttribute>} attributes
         * @return {BufferAttribute}
         */function mergeAttributes(e){let t;let n;let s;let a=-1;let o=0;for(let r=0;r<e.length;++r){const l=e[r];t===void 0&&(t=l.array.constructor);if(t!==l.array.constructor){console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.");return null}n===void 0&&(n=l.itemSize);if(n!==l.itemSize){console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.");return null}s===void 0&&(s=l.normalized);if(s!==l.normalized){console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.");return null}a===-1&&(a=l.gpuType);if(a!==l.gpuType){console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.");return null}o+=l.count*n}const l=new t(o);const c=new r.BufferAttribute(l,n,s);let u=0;for(let t=0;t<e.length;++t){const r=e[t];if(r.isInterleavedBufferAttribute){const e=u/n;for(let t=0,s=r.count;t<s;t++)for(let s=0;s<n;s++){const n=r.getComponent(t,s);c.setComponent(t+e,s,n)}}else l.set(r.array,u);u+=r.count*n}a!==void 0&&(c.gpuType=a);return c}
/**
         * @param {BufferAttribute} attribute
         * @return {BufferAttribute}
         */function deepCloneAttribute(e){return e.isInstancedInterleavedBufferAttribute||e.isInterleavedBufferAttribute?deinterleaveAttribute(e):e.isInstancedBufferAttribute?(new r.InstancedBufferAttribute).copy(e):(new r.BufferAttribute).copy(e)}
/**
         * @param {Array<BufferAttribute>} attributes
         * @return {Array<InterleavedBufferAttribute>}
         */function interleaveAttributes(e){let t;let n=0;let s=0;for(let r=0,a=e.length;r<a;++r){const a=e[r];t===void 0&&(t=a.array.constructor);if(t!==a.array.constructor){console.error("AttributeBuffers of different types cannot be interleaved");return null}n+=a.array.length;s+=a.itemSize}const a=new r.InterleavedBuffer(new t(n),s);let o=0;const l=[];const c=["getX","getY","getZ","getW"];const u=["setX","setY","setZ","setW"];for(let t=0,n=e.length;t<n;t++){const n=e[t];const s=n.itemSize;const h=n.count;const d=new r.InterleavedBufferAttribute(a,s,o,n.normalized);l.push(d);o+=s;for(let e=0;e<h;e++)for(let t=0;t<s;t++)d[u[t]](e,n[c[t]](e))}return l}function deinterleaveAttribute(e){const t=e.data.array.constructor;const n=e.count;const s=e.itemSize;const a=e.normalized;const o=new t(n*s);let l;l=e.isInstancedInterleavedBufferAttribute?new r.InstancedBufferAttribute(o,s,a,e.meshPerAttribute):new r.BufferAttribute(o,s,a);for(let t=0;t<n;t++){l.setX(t,e.getX(t));s>=2&&l.setY(t,e.getY(t));s>=3&&l.setZ(t,e.getZ(t));s>=4&&l.setW(t,e.getW(t))}return l}function deinterleaveGeometry(e){const t=e.attributes;const n=e.morphTargets;const r=new Map;for(const e in t){const n=t[e];if(n.isInterleavedBufferAttribute){r.has(n)||r.set(n,deinterleaveAttribute(n));t[e]=r.get(n)}}for(const e in n){const t=n[e];if(t.isInterleavedBufferAttribute){r.has(t)||r.set(t,deinterleaveAttribute(t));n[e]=r.get(t)}}}
/**
         * @param {BufferGeometry} geometry
         * @return {number}
         */function estimateBytesUsed(e){let t=0;for(const n in e.attributes){const r=e.getAttribute(n);t+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}const n=e.getIndex();t+=n?n.count*n.itemSize*n.array.BYTES_PER_ELEMENT:0;return t}
/**
         * @param {BufferGeometry} geometry
         * @param {number} tolerance
         * @return {BufferGeometry}
         */function mergeVertices(e,t=1e-4){t=Math.max(t,Number.EPSILON);const n={};const r=e.getIndex();const s=e.getAttribute("position");const a=r?r.count:s.count;let o=0;const l=Object.keys(e.attributes);const c={};const u={};const h=[];const d=["getX","getY","getZ","getW"];const p=["setX","setY","setZ","setW"];for(let t=0,n=l.length;t<n;t++){const n=l[t];const r=e.attributes[n];c[n]=new r.constructor(new r.array.constructor(r.count*r.itemSize),r.itemSize,r.normalized);const s=e.morphAttributes[n];if(s){u[n]||(u[n]=[]);s.forEach(((e,t)=>{const r=new e.array.constructor(e.count*e.itemSize);u[n][t]=new e.constructor(r,e.itemSize,e.normalized)}))}}const f=t*.5;const m=Math.log10(1/t);const g=Math.pow(10,m);const y=f*g;for(let t=0;t<a;t++){const s=r?r.getX(t):t;let a="";for(let t=0,n=l.length;t<n;t++){const n=l[t];const r=e.getAttribute(n);const o=r.itemSize;for(let e=0;e<o;e++)a+=~~(r[d[e]](s)*g+y)+","}if(a in n)h.push(n[a]);else{for(let t=0,n=l.length;t<n;t++){const n=l[t];const r=e.getAttribute(n);const a=e.morphAttributes[n];const h=r.itemSize;const f=c[n];const m=u[n];for(let e=0;e<h;e++){const t=d[e];const n=p[e];f[n](o,r[t](s));if(a)for(let e=0,r=a.length;e<r;e++)m[e][n](o,a[e][t](s))}}n[a]=o;h.push(o);o++}}const b=e.clone();for(const t in e.attributes){const e=c[t];b.setAttribute(t,new e.constructor(e.array.slice(0,o*e.itemSize),e.itemSize,e.normalized));if(t in u)for(let e=0;e<u[t].length;e++){const n=u[t][e];b.morphAttributes[t][e]=new n.constructor(n.array.slice(0,o*n.itemSize),n.itemSize,n.normalized)}}b.setIndex(h);return b}
/**
         * @param {BufferGeometry} geometry
         * @param {number} drawMode
         * @return {BufferGeometry}
         */function toTrianglesDrawMode(e,t){if(t===r.TrianglesDrawMode){console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.");return e}if(t===r.TriangleFanDrawMode||t===r.TriangleStripDrawMode){let n=e.getIndex();if(n===null){const t=[];const r=e.getAttribute("position");if(r===void 0){console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.");return e}for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t);n=e.getIndex()}const s=n.count-2;const a=[];if(t===r.TriangleFanDrawMode)for(let e=1;e<=s;e++){a.push(n.getX(0));a.push(n.getX(e));a.push(n.getX(e+1))}else for(let e=0;e<s;e++)if(e%2===0){a.push(n.getX(e));a.push(n.getX(e+1));a.push(n.getX(e+2))}else{a.push(n.getX(e+2));a.push(n.getX(e+1));a.push(n.getX(e))}a.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=e.clone();o.setIndex(a);o.clearGroups();return o}console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t);return e}
/**
         * Calculates the morphed attributes of a morphed/skinned BufferGeometry.
         * Helpful for Raytracing or Decals.
         * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.
         * @return {Object} An Object with original position/normal attributes and morphed ones.
         */function computeMorphedAttributes(e){const t=new r.Vector3;const n=new r.Vector3;const s=new r.Vector3;const a=new r.Vector3;const o=new r.Vector3;const l=new r.Vector3;const c=new r.Vector3;const u=new r.Vector3;const h=new r.Vector3;function _calculateMorphedAttributeData(e,r,d,p,f,m,g,y){t.fromBufferAttribute(r,f);n.fromBufferAttribute(r,m);s.fromBufferAttribute(r,g);const b=e.morphTargetInfluences;if(d&&b){c.set(0,0,0);u.set(0,0,0);h.set(0,0,0);for(let e=0,r=d.length;e<r;e++){const r=b[e];const y=d[e];if(r!==0){a.fromBufferAttribute(y,f);o.fromBufferAttribute(y,m);l.fromBufferAttribute(y,g);if(p){c.addScaledVector(a,r);u.addScaledVector(o,r);h.addScaledVector(l,r)}else{c.addScaledVector(a.sub(t),r);u.addScaledVector(o.sub(n),r);h.addScaledVector(l.sub(s),r)}}}t.add(c);n.add(u);s.add(h)}if(e.isSkinnedMesh){e.applyBoneTransform(f,t);e.applyBoneTransform(m,n);e.applyBoneTransform(g,s)}y[f*3+0]=t.x;y[f*3+1]=t.y;y[f*3+2]=t.z;y[m*3+0]=n.x;y[m*3+1]=n.y;y[m*3+2]=n.z;y[g*3+0]=s.x;y[g*3+1]=s.y;y[g*3+2]=s.z}const d=e.geometry;const p=e.material;let f,m,g;const y=d.index;const b=d.attributes.position;const x=d.morphAttributes.position;const _=d.morphTargetsRelative;const M=d.attributes.normal;const w=d.morphAttributes.position;const S=d.groups;const T=d.drawRange;let I,R,L,D;let P;let F,U;const O=new Float32Array(b.count*b.itemSize);const k=new Float32Array(M.count*M.itemSize);if(y!==null)if(Array.isArray(p))for(I=0,L=S.length;I<L;I++){P=S[I];F=Math.max(P.start,T.start);U=Math.min(P.start+P.count,T.start+T.count);for(R=F,D=U;R<D;R+=3){f=y.getX(R);m=y.getX(R+1);g=y.getX(R+2);_calculateMorphedAttributeData(e,b,x,_,f,m,g,O);_calculateMorphedAttributeData(e,M,w,_,f,m,g,k)}}else{F=Math.max(0,T.start);U=Math.min(y.count,T.start+T.count);for(I=F,L=U;I<L;I+=3){f=y.getX(I);m=y.getX(I+1);g=y.getX(I+2);_calculateMorphedAttributeData(e,b,x,_,f,m,g,O);_calculateMorphedAttributeData(e,M,w,_,f,m,g,k)}}else if(Array.isArray(p))for(I=0,L=S.length;I<L;I++){P=S[I];F=Math.max(P.start,T.start);U=Math.min(P.start+P.count,T.start+T.count);for(R=F,D=U;R<D;R+=3){f=R;m=R+1;g=R+2;_calculateMorphedAttributeData(e,b,x,_,f,m,g,O);_calculateMorphedAttributeData(e,M,w,_,f,m,g,k)}}else{F=Math.max(0,T.start);U=Math.min(b.count,T.start+T.count);for(I=F,L=U;I<L;I+=3){f=I;m=I+1;g=I+2;_calculateMorphedAttributeData(e,b,x,_,f,m,g,O);_calculateMorphedAttributeData(e,M,w,_,f,m,g,k)}}const N=new r.Float32BufferAttribute(O,3);const G=new r.Float32BufferAttribute(k,3);return{positionAttribute:b,normalAttribute:M,morphedPositionAttribute:N,morphedNormalAttribute:G}}function mergeGroups(e){if(e.groups.length===0){console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.");return e}let t=e.groups;t=t.sort(((e,t)=>e.materialIndex!==t.materialIndex?e.materialIndex-t.materialIndex:e.start-t.start));if(e.getIndex()===null){const t=e.getAttribute("position");const n=[];for(let e=0;e<t.count;e+=3)n.push(e,e+1,e+2);e.setIndex(n)}const n=e.getIndex();const r=[];for(let e=0;e<t.length;e++){const s=t[e];const a=s.start;const o=a+s.count;for(let e=a;e<o;e++)r.push(n.getX(e))}e.dispose();e.setIndex(r);let s=0;for(let e=0;e<t.length;e++){const n=t[e];n.start=s;s+=n.count}let a=t[0];e.groups=[a];for(let n=1;n<t.length;n++){const r=t[n];if(a.materialIndex===r.materialIndex)a.count+=r.count;else{a=r;e.groups.push(a)}}return e}
/**
         * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,
         * non-indexed geometry. Returns the geometry with smooth normals everywhere except
         * faces that meet at an angle greater than the crease angle.
         *
         * @param {BufferGeometry} geometry
         * @param {number} [creaseAngle]
         * @return {BufferGeometry}
         */function toCreasedNormals(e,t=Math.PI/3){const n=Math.cos(t);const s=100*(1+1e-10);const a=[new r.Vector3,new r.Vector3,new r.Vector3];const o=new r.Vector3;const l=new r.Vector3;const c=new r.Vector3;const u=new r.Vector3;function hashVertex(e){const t=~~(e.x*s);const n=~~(e.y*s);const r=~~(e.z*s);return`${t},${n},${r}`}const h=e.index?e.toNonIndexed():e;const d=h.attributes.position;const p={};for(let e=0,t=d.count/3;e<t;e++){const t=3*e;const n=a[0].fromBufferAttribute(d,t+0);const s=a[1].fromBufferAttribute(d,t+1);const c=a[2].fromBufferAttribute(d,t+2);o.subVectors(c,s);l.subVectors(n,s);const u=(new r.Vector3).crossVectors(o,l).normalize();for(let e=0;e<3;e++){const t=a[e];const n=hashVertex(t);n in p||(p[n]=[]);p[n].push(u)}}const f=new Float32Array(d.count*3);const m=new r.BufferAttribute(f,3,false);for(let e=0,t=d.count/3;e<t;e++){const t=3*e;const r=a[0].fromBufferAttribute(d,t+0);const s=a[1].fromBufferAttribute(d,t+1);const h=a[2].fromBufferAttribute(d,t+2);o.subVectors(h,s);l.subVectors(r,s);c.crossVectors(o,l).normalize();for(let e=0;e<3;e++){const r=a[e];const s=hashVertex(r);const o=p[s];u.set(0,0,0);for(let e=0,t=o.length;e<t;e++){const t=o[e];c.dot(t)>n&&u.add(t)}u.normalize();m.setXYZ(t+e,u.x,u.y,u.z)}}h.setAttribute("normal",m);return h}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(e,t,n)=>{n.r(t);n.d(t,{WorkerPool:()=>WorkerPool});class WorkerPool{constructor(e=4){this.pool=e;this.queue=[];this.workers=[];this.workersResolve=[];this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e));this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const n=this.workersResolve[e];n&&n(t);if(this.queue.length){const{resolve:t,msg:n,transfer:r}=this.queue.shift();this.workersResolve[e]=t;this.workers[e].postMessage(n,r)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise((n=>{const r=this._getIdleWorker();if(r!==-1){this._initWorker(r);this.workerStatus|=1<<r;this.workersResolve[r]=n;this.workers[r].postMessage(e,t)}else this.queue.push({resolve:n,msg:e,transfer:t})}))}dispose(){this.workers.forEach((e=>e.terminate()));this.workersResolve.length=0;this.workers.length=0;this.queue.length=0;this.workerStatus=0}}},"./package.json":e=>{e.exports=JSON.parse('{"name":"aframe","version":"1.7.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"./dist/aframe-master.js","module":"./dist/aframe-master.module.min.js","exports":{".":{"import":"./dist/aframe-master.module.min.js","require":"./dist/aframe-master.js"}},"scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max && npm run dist:module","dist:max":"webpack --config webpack.config.cjs","dist:min":"webpack --config webpack.prod.config.cjs","dist:module":"webpack --config webpack.module.config.cjs","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"gh-pages -d gh-pages","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.6.0 1.7.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","start:webgpu":"cross-env WEBGPU=true npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.173.4","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695"},"devDependencies":{"@babel/core":"^7.24.0","babel-loader":"^9.1.3","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^7.1.2","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","gh-pages":"^6.3.0","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^8.3.0","shelljs":"^0.8.5","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^4.0.0","too-wordy":"ngokevin/too-wordy","webpack":"^5.91.0","webpack-cli":"^5.1.4","webpack-dev-server":"~5.0.4","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}};var n={};function __webpack_require__(t){var r=n[t];if(r!==void 0)return r.exports;var s=n[t]={id:t,exports:{}};e[t](s,s.exports,__webpack_require__);return s.exports}__webpack_require__.m=e;(()=>{__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;__webpack_require__.d(t,{a:t});return t}})();(()=>{__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:true,get:t[n]})}})();(()=>{__webpack_require__.g=function(){if(typeof globalThis==="object")return globalThis;try{return this||t||new Function("return this")()}catch(e){if(typeof window==="object")return window}}()})();(()=>{__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();(()=>{__webpack_require__.r=e=>{typeof Symbol!=="undefined"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:true})}})();(()=>{__webpack_require__.b=document.baseURI||self.location.href})();(()=>{__webpack_require__.nc=void 0})();var s={};(()=>{__webpack_require__.r(s);__webpack_require__.d(s,{default:()=>w});var e=__webpack_require__("./node_modules/super-animejs/lib/anime.es.js");var t=__webpack_require__("./src/lib/three.js");var n=__webpack_require__("./src/core/scene/a-scene.js");var r=__webpack_require__("./src/core/scene/scenes.js");var a=__webpack_require__("./src/core/a-node.js");var o=__webpack_require__("./src/core/a-entity.js");var l=__webpack_require__("./src/core/component.js");var c=__webpack_require__("./src/core/geometry.js");var u=__webpack_require__("./src/extras/primitives/primitives.js");var h=__webpack_require__("./src/core/shader.js");var d=__webpack_require__("./src/core/system.js");var p=__webpack_require__("./src/core/schema.js");var f=__webpack_require__("./src/core/readyState.js");__webpack_require__("./src/core/a-assets.js");__webpack_require__("./src/core/a-cubemap.js");__webpack_require__("./src/core/a-mixin.js");var m=__webpack_require__("./src/utils/index.js");var g=__webpack_require__("./package.json");__webpack_require__("./src/components/index.js");__webpack_require__("./src/geometries/index.js");__webpack_require__("./src/shaders/index.js");__webpack_require__("./src/systems/index.js");var y=__webpack_require__("./src/extras/primitives/getMeshMixin.js");__webpack_require__("./src/extras/components/index.js");__webpack_require__("./src/extras/primitives/index.js");var b=m.debug;var x=b("A-Frame:error");var _=b("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&_("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML.");window.cordova||window.location.protocol!=="file:"||x("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server.");if(m.device.isBrowserEnvironment){window.logs=b;__webpack_require__("./src/style/aframe.css");__webpack_require__("./src/style/rStats.css")}console.log("A-Frame Version: 1.7.0 (Date 2025-02-20, Commit #ad5cef10)");console.log("THREE Version (https://github.com/supermedium/three.js):",t.default.REVISION);window.AFRAME_ASYNC||f.waitForDocumentReadyState();var M=globalThis.AFRAME={AComponent:l.Component,AEntity:o.AEntity,ANode:a.ANode,ANIME:e.default,AScene:n.AScene,components:l.components,coreComponents:Object.keys(l.components),geometries:c.geometries,registerComponent:l.registerComponent,registerGeometry:c.registerGeometry,registerPrimitive:u.registerPrimitive,registerShader:h.registerShader,registerSystem:d.registerSystem,primitives:{getMeshMixin:y.default,primitives:u.primitives},scenes:r.default,schema:p,shaders:h.shaders,systems:d.systems,emitReady:f.emitReady,THREE:t.default,utils:m,version:g.version};const w=M})();s=s.default;return s})()));var s=n;const a=n.byteLength,o=n.toByteArray,l=n.fromByteArray,c=n.SlowBuffer,u=n.INSPECT_MAX_BYTES,h=n.kMaxLength,d=n.formatArgs,p=n.save,f=n.load,m=n.useColors,g=n.storage,y=n.destroy,b=n.colors,x=n.log,_=n.read,M=n.write,w=n.computeBox,S=n.computeSphere,T=n.pages,I=n.uvs,R=n.positions,L=n.lines,D=n.glStats,P=n.__esModule;const F=n.AFRAME,U=n.Buffer;export{F as AFRAME,U as Buffer,u as INSPECT_MAX_BYTES,c as SlowBuffer,P as __esModule,a as byteLength,b as colors,w as computeBox,S as computeSphere,s as default,y as destroy,d as formatArgs,l as fromByteArray,D as glStats,h as kMaxLength,L as lines,f as load,x as log,T as pages,R as positions,_ as read,p as save,g as storage,o as toByteArray,m as useColors,I as uvs,M as write};

